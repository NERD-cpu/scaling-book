
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The convection-diffusion equation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="Scaling of Differential Equations" href="index.html" />
    <link rel="next" title="Advanced PDE models" href="._book009.html" />
    <link rel="prev" title="The diffusion equation" href="._book007.html" />
 
  
       <style type="text/css">
         div.admonition {
           background-color: whiteSmoke;
           border: 1px solid #bababa;
         }
       </style>
      </head>
    
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._book009.html" title="Advanced PDE models"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._book007.html" title="The diffusion equation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Scaling of Differential Equations</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-convection-diffusion-equation">
<span id="scale-convdiff"></span><h1>The convection-diffusion equation<a class="headerlink" href="#the-convection-diffusion-equation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="convection-diffusion-without-a-force-term">
<h2>Convection-diffusion without a force term<a class="headerlink" href="#convection-diffusion-without-a-force-term" title="Permalink to this headline">¶</a></h2>
<p id="index-0">We now add a convection term <span class="math">\(\boldsymbol{v}\cdot\nabla u\)</span> to the diffusion
equation to obtain the well-known convection-diffusion equation:</p>
<div class="math" id="eq-scale-convdiff-pde1">
\[\tag{165}
\frac{\partial u}{\partial t} + \boldsymbol{v}\cdot\nabla u =
    {\alpha}\nabla^2 u,
    \quad  x,y, z\in \Omega,\ t\in (0, T]{\thinspace .}\]</div>
<p>The velocity field <span class="math">\(\boldsymbol{v}\)</span> is prescribed, and its characteristic size <span class="math">\(V\)</span>
is normally clear from the problem description.</p>
<p>[<strong>hpl 20</strong>: Drop specification of spatial and temporal domain? Is this basically notational noise when the PDE gets more complicated?]</p>
<p>[<strong>hpl 21</strong>: Show a sketch of a couple of cases, can be the same as Navier-Stokes, where different <span class="math">\(V\)</span> is obvious.]</p>
<p>Inserting</p>
<div class="math">
\[\bar x = \frac{x}{x_c},\ \bar y = \frac{y}{y_c},\ \bar z = \frac{z}{z_c},
\ \bar t = \frac{t}{t_c}, \ \bar\boldsymbol{v} = \frac{\boldsymbol{v}}{V},
\ \bar u =\frac{u}{u_c}\]</div>
<p>in <a class="reference internal" href="#eq-scale-convdiff-pde1"><span class="std std-ref">(165)</span></a> yields</p>
<div class="math">
\[\frac{u_c}{t_c}
\frac{\partial \bar u}{\partial \bar t} +
\frac{u_c V}{L}\bar\boldsymbol{v}\cdot\bar\nabla\bar u =
\frac{{\alpha} u_c}{L^2}\bar\nabla^2\bar u,
\quad \bar x,\bar y,\bar z\in \Omega,\ \bar t\in (0,\bar T]{\thinspace .}\]</div>
<p>For <span class="math">\(u_c\)</span> we simply introduce the symbol <span class="math">\(U\)</span>, which we may estimate
from an initial condition. It is not critical here since it vanishes
from the scaled equation anyway as long as there is no source term
present.
With some velocity measure <span class="math">\(V\)</span> and length measure <span class="math">\(L\)</span>, it is
tempting to just let <span class="math">\(t_c = L/V\)</span>. This is the characteristic time it takes to
transport a signal by convection through the domain.
The alternative is to use the
diffusion length scale <span class="math">\(t_c=L^2/{\alpha}\)</span>. Very often in these kind of
problems, the convection term <span class="math">\(\boldsymbol{v}\cdot\nabla u\)</span> dominates over the
diffusion term <span class="math">\({\alpha}\nabla^2 u\)</span>, so the time scale for convection,
which is <span class="math">\(L/V\)</span>,
is most appropriate of the two. Only when
the diffusion term is very much larger than the convection
term (corresponding to very small Peclet numbers, see below)
we would apply <span class="math">\(t_c=L^2/{\alpha}\)</span>.</p>
<p>The non-dimensional form of the PDE with <span class="math">\(t_c=L/V\)</span> becomes</p>
<div class="math" id="eq-scale-convdiff-pde1-d">
\[\tag{166}
\frac{\partial \bar u}{\partial \bar t} +
    \bar\boldsymbol{v}\cdot\bar\nabla\bar u =
    \hbox{Pe}^{-1}\bar\nabla^2\bar u,
    \quad \bar x,\bar y,\bar z\in \Omega,\ \bar t\in (0,\bar T],\]</div>
<p>where Pe is the <em>Peclet number</em>,</p>
<div class="math">
\[\hbox{Pe} = \frac{LV}{{\alpha}}{\thinspace .}\]</div>
<p>Estimating the size of the convection term <span class="math">\(\boldsymbol{v}\cdot\nabla u\)</span> as
<span class="math">\(VU/L\)</span> and the diffusion term <span class="math">\({\alpha}\nabla^2 u\)</span> as <span class="math">\({\alpha} U/L^2\)</span>,
we see that the Peclet number measures the ratio of the convection
and the diffusion terms:</p>
<div class="math">
\[\hbox{Pe} = \frac{\hbox{convection}}{\hbox{diffusion}} =
\frac{VU/L}{{\alpha} U/L^2}= \frac{LV}{{\alpha}}{\thinspace .}\]</div>
<p>In case we use the diffusion time scale
<span class="math">\(t_c=L^2/{\alpha}\)</span>, we get the non-dimensional PDE</p>
<div class="math" id="eq-scale-convdiff-pde1-d2">
\[\tag{167}
\frac{\partial \bar u}{\partial \bar t} +
    \hbox{Pe}\,\bar\boldsymbol{v}\cdot\bar\nabla\bar u =
    \bar\nabla^2\bar u,
    \quad \bar x,\bar y,\bar z\in \Omega,\ \bar t\in (0,\bar T]{\thinspace .}\]</div>
<div class="admonition-discussion-of-scales-and-balance-of-terms-in-the-pde admonition">
<p class="first admonition-title">Discussion of scales and balance of terms in the PDE</p>
<p>We see that <a class="reference internal" href="#eq-scale-convdiff-pde1-d"><span class="std std-ref">(166)</span></a> and <a class="reference internal" href="#eq-scale-convdiff-pde1-d2"><span class="std std-ref">(167)</span></a>
are not equivalent, and they are based on two different time scales.
For moderate Peclet numbers around 1, all terms have the same size
in <a class="reference internal" href="#eq-scale-convdiff-pde1-d"><span class="std std-ref">(166)</span></a>, i.e., a size around unity.
For large Peclet numbers,
<a class="reference internal" href="#eq-scale-convdiff-pde1-d"><span class="std std-ref">(166)</span></a> expresses a balance
between the time derivative term and the convection term, both of size
unity, and then there is a very small term
<span class="math">\(\hbox{Pe}^{-1}\bar\nabla^2\bar u\)</span> term because Pe is large and
<span class="math">\(\bar\nabla^2\bar u\)</span> should be of size unity.
That the convection term dominates over the diffusion term is
consistent with the time scale <span class="math">\(t_c=L/V\)</span> based on convection transport.
In this case, we can neglect the diffusion term as Pe goes to infinity
and work with a pure convection (or advection) equation</p>
<div class="math">
\[\frac{\partial \bar u}{\partial \bar t} +
\bar\boldsymbol{v}\cdot\bar\nabla\bar u = 0{\thinspace .}\]</div>
<p>For small Peclet numbers, <span class="math">\(\hbox{Pe}^{-1}\bar\nabla^2\bar u\)</span> becomes
very large and can only be balanced by two terms that are supposed to
be unity of size.  The time-derivative and/or the convection term must
be much larger than unity, but that means we use wrong scales,
since right scales imply that <span class="math">\(\partial\bar u/\partial\bar t\)</span> and
<span class="math">\(\bar v\cdot\bar\nabla\bar u\)</span> of order unity. Switching to a time
scale based on diffusion as the dominating physical effect gives
<a class="reference internal" href="#eq-scale-convdiff-pde1-d2"><span class="std std-ref">(167)</span></a>.  For very small Peclet numbers this
equation tells that the time-derivative balances the diffusion, while
the convection <span class="math">\(\bar\boldsymbol{v}\cdot\bar\nabla\bar\boldsymbol{u}\)</span> is around
unity, but multiplied by a very small coefficient Pe, so this term is
negligible in the PDE. An approximate PDE for small Peclet numbers is
therefore</p>
<div class="math">
\[\frac{\partial \bar u}{\partial \bar t}
= \bar\nabla^2\bar u{\thinspace .}\]</div>
<p class="last">Scaling can with the above type of reasoning be used
to neglect terms from a differential equation under precise mathematical
conditions.</p>
</div>
</div>
<div class="section" id="stationary-pde">
<h2>Stationary PDE<a class="headerlink" href="#stationary-pde" title="Permalink to this headline">¶</a></h2>
<p>Suppose the problem is stationary and that there is no need for
any time scale. How is this type of convection-diffusion problem
scaled? We get</p>
<div class="math">
\[\frac{VU}{L}\bar\boldsymbol{v}\cdot\bar\nabla\bar u =
\frac{{\alpha} U}{L^2}\bar\nabla^2\bar u,\]</div>
<p>or</p>
<div class="math" id="eq-scale-convdiff-pde1-d3">
\[\tag{168}
\bar\boldsymbol{v}\cdot\bar\nabla\bar u =
    \hbox{Pe}^{-1}\bar\nabla^2\bar u{\thinspace .}\]</div>
<p>This scaling only &#8220;works&#8221; for moderate Peclet numbers. For very small or
very large Pe, either the convection term <span class="math">\(\bar\boldsymbol{v}\cdot\bar\nabla\bar u\)</span>
or the diffusion term <span class="math">\(\bar\nabla^2\bar u\)</span> must deviate significantly
from unity.</p>
<p>Consider the following 1D example to illustrate the point: <span class="math">\(\boldsymbol{v} = v\boldsymbol{i}\)</span>,
<span class="math">\(v&gt;0\)</span> constant, a domain <span class="math">\([0,L]\)</span>, with boundary conditions <span class="math">\(u(0)=0\)</span> and
<span class="math">\(u(L)=U_L\)</span>. (The vector <span class="math">\(\boldsymbol{i}\)</span> is a unit vector in <span class="math">\(x\)</span> direction.)
The problem with dimensions is now</p>
<div class="math">
\[vu^{\prime} = {\alpha} u^{\prime\prime},\quad u(0)=0,\ u(L)=U_L{\thinspace .}\]</div>
<p>Scaling results in</p>
<div class="math">
\[\frac{d\bar u}{d\bar x} = \hbox{Pe}^{-1}\frac{d^2\bar u}{d\bar x^2},\quad
\bar x\in (0,1),\quad \bar u(0)=0,\ \bar u(1) = 1,\]</div>
<p>if we choose <span class="math">\(U=U_L\)</span>. The solution of the scaled problem is</p>
<div class="math">
\[\bar u(\bar x) = \frac{1 - e^{\bar x\hbox{Pe}}}{1 - e^{\hbox{Pe}}}{\thinspace .}\]</div>
<p>Figure <a class="reference internal" href="#scale-convdiff-fig-scaled"><span class="std std-ref">Solution of scaled problem for 1D convection-diffusion</span></a> indicates how <span class="math">\(\bar u\)</span> depends on
Pe: small Pe values give approximately a straight line while large Pe
values lead to a <em>boundary layer</em> close to <span class="math">\(x=1\)</span>, where the solution
changes very rapidly.</p>
<div class="figure" id="id1">
<span id="scale-convdiff-fig-scaled"></span><a class="reference internal image-reference" href="_images/boundary_layer1D.png"><img alt="_images/boundary_layer1D.png" src="_images/boundary_layer1D.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><em>Solution of scaled problem for 1D convection-diffusion</em></span></p>
</div>
<p>We realize that for large Pe,</p>
<div class="math">
\[\max_{\bar x}\frac{d\bar u}{d\bar x} \approx \hbox{Pe},\quad
\max_{\bar x}\frac{d^2\bar u}{d\bar x^2} \approx \hbox{Pe}^{2},\]</div>
<p>which are consistent results with the PDE since the double derivative term
is multiplied by <span class="math">\(\hbox{Pe}^{-1}\)</span>.
For small Pe,</p>
<div class="math">
\[\max_{\bar x}\frac{d\bar u}{d\bar x}     \approx 1,\quad
  \max_{\bar x}\frac{d^2\bar u}{d\bar x^2} \approx 0,\]</div>
<p>which is also consistent with the PDE
since an almost vanishing second-order derivative
is multiplied by a very large coefficient <span class="math">\(\hbox{Pe}^{-1}\)</span>.
However, we have a problem with very large
derivatives of <span class="math">\(\bar u\)</span> when Pe is large.</p>
<p>To arrive at a proper scaling for large Peclet numbers,
we need to remove the Pe coefficient
from the differential equation. There are only two scales at our
disposals: <span class="math">\(u_c\)</span> and <span class="math">\(x_c\)</span> for <span class="math">\(u\)</span> and <span class="math">\(x\)</span>, respectively.
The natural value for <span class="math">\(u_c\)</span> is the boundary value <span class="math">\(U_L\)</span> at <span class="math">\(x=L\)</span>.
The scaling of <span class="math">\(Vu_x = {\alpha} u_{xx}\)</span> then results in</p>
<div class="math">
\[\frac{d\bar u}{d\bar x} = \frac{{\alpha}}{Vx_c}\frac{d^2\bar u}{d\bar x^2},
\quad \bar x\in (0,\bar L),\quad \bar u(0)=0,\ \bar u(\bar L)=1,\]</div>
<p>where <span class="math">\(\bar L = L/x_c\)</span>. Choosing the coefficient <span class="math">\({\alpha}/(Vx_c)\)</span> to
be unity results in the scale <span class="math">\(x_c={\alpha}/V\)</span>, and <span class="math">\(\bar L\)</span> becomes Pe.
The final, scaled boundary-value
problem is now</p>
<div class="math">
\[\frac{d\bar u}{d\bar x} = \frac{d^2\bar u}{d\bar x^2},
\quad \bar x \in (0, \hbox{Pe}), \quad \bar u(0)=0,\ \bar u(\hbox{Pe})=1,\]</div>
<p>with solution</p>
<div class="math">
\[\bar u(\bar x) = \frac{1 - e^{\bar x}}{1 - e^{\hbox{Pe}}}{\thinspace .}\]</div>
<p>Figure <a class="reference internal" href="#scale-convdiff-fig-rescaled"><span class="std std-ref">Solution of scaled problem where the length scale depends on the Peclet number</span></a> displays <span class="math">\(\bar u\)</span> for some
Peclet numbers, and we see that the shape of the graphs are the same
with this scaling. For large Peclet numbers we realize that <span class="math">\(\bar u\)</span>
and its derivatives are around unity (<span class="math">\(1-e^{\hbox{Pe}}\approx -e^{\hbox{Pe}}\)</span>),
but for small Peclet numbers <span class="math">\(d\bar u/d\bar x \sim \hbox{Pe}^{-1}\)</span>.</p>
<div class="figure" id="id2">
<span id="scale-convdiff-fig-rescaled"></span><a class="reference internal image-reference" href="_images/boundary_layer1D_scale2.png"><img alt="_images/boundary_layer1D_scale2.png" src="_images/boundary_layer1D_scale2.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><em>Solution of scaled problem where the length scale depends on the Peclet number</em></span></p>
</div>
<p>The conclusion is that for small Peclet numbers, <span class="math">\(x_c=L\)</span> is an
appropriate length scale.
The scaled equation <span class="math">\(\hbox{Pe}\,\bar u' = \bar u''\)</span> indicates that <span class="math">\(\bar
u''\approx 0\)</span>, and the solution is close to a straight line.  For
large Pe values, <span class="math">\(x_c={\alpha}/V\)</span> is an appropriate length scale, and the
scaled equation <span class="math">\(\bar u' = \bar u''\)</span>
expresses that the terms <span class="math">\(\bar u'\)</span> and <span class="math">\(\bar u''\)</span> are
equal and of size around unity.</p>
<span class="target" id="index-1"></span></div>
<div class="section" id="convection-diffusion-with-a-force-term">
<span id="scale-convdiff-f"></span><span id="index-2"></span><h2>Convection-diffusion with a force term<a class="headerlink" href="#convection-diffusion-with-a-force-term" title="Permalink to this headline">¶</a></h2>
<p>Let us add a force term <span class="math">\(f(\boldsymbol{x},t)\)</span> to the convection-diffusion equation :</p>
<div class="math" id="eq-scale-convdiff-pde2">
\[\tag{169}
\frac{\partial u}{\partial t} + \boldsymbol{v}\cdot\nabla u =
    {\alpha}\nabla^2 u + f{\thinspace .}\]</div>
<p>The scaled version reads</p>
<div class="math">
\[\frac{\partial u}{\partial t} + \frac{t_cV}{L}\bar\boldsymbol{v}\cdot\bar\nabla \bar u =
\frac{t_c{\alpha}}{L^2}\bar\nabla^2 \bar u + \frac{t_cf_c}{u_c}\bar f{\thinspace .}\]</div>
<p>We can base <span class="math">\(t_c\)</span> on convective transport: <span class="math">\(t_c = L/V\)</span>. Now,
<span class="math">\(u_c\)</span> could be chosen to make the coefficient in the source term unity:
<span class="math">\(u_c = t_cf_c = Lf_c/V\)</span>.
This leaves us with</p>
<div class="math">
\[\frac{\partial u}{\partial t} + \bar\boldsymbol{v}\cdot\bar \nabla\bar u =
\hbox{Pe}^{-1}\bar \nabla^2 \bar u + \bar f{\thinspace .}\]</div>
<p>In the diffusion limit, we base <span class="math">\(t_c\)</span> on the diffusion time scale:
<span class="math">\(t_c=L^2/{\alpha}\)</span>, and the coefficient of the source term set to unity
determines <span class="math">\(u_c\)</span> according to</p>
<div class="math">
\[\frac{L^2 f_c}{{\alpha} u_c} = 1\quad\Rightarrow\quad u_c = \frac{L^2 f_c}{{\alpha}}{\thinspace .}\]</div>
<p>The corresponding PDE reads</p>
<div class="math">
\[\frac{\partial u}{\partial t} + \hbox{Pe}\,\bar\boldsymbol{v}\cdot\bar \nabla\bar u =
\bar\nabla^2 \bar u + \bar f,\]</div>
<p>so for small Peclet numbers, which we have, the convective term can
be neglected and we get a pure diffusion equation with a source term.</p>
<p>What if the problem is stationary?
Then there is no time scale and we get</p>
<div class="math">
\[\frac{V u_c}{L}\bar\boldsymbol{v}\cdot\bar \nabla \bar u =
\frac{u_c {\alpha}}{L^2}\bar\nabla^2 \bar u + f_c\bar f,\]</div>
<p>or</p>
<div class="math">
\[\bar\boldsymbol{v}\cdot\bar \nabla \bar u =
\hbox{Pe}^{-1}\bar\nabla^2 \bar u + \frac{f_c L}{V u_c}\bar f,\]</div>
<p>Again, choosing <span class="math">\(u_c\)</span> such that the source term coefficient is unity leads
to <span class="math">\(u_c= f_c L/V\)</span>.
Alternatively, <span class="math">\(u_c\)</span> can be based on the initial condition, with similar
results as found in the sections on the wave and diffusion PDEs.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <center>
            <p class="logo"><a href="http://cbc.simula.no/" title="Go to Center for Biomedical Computing">
              <img class="logo" src="_static/cbc_logo.png" alt="Logo"/>
            </a></p>
            </center>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The convection-diffusion equation</a><ul>
<li><a class="reference internal" href="#convection-diffusion-without-a-force-term">Convection-diffusion without a force term</a></li>
<li><a class="reference internal" href="#stationary-pde">Stationary PDE</a></li>
<li><a class="reference internal" href="#convection-diffusion-with-a-force-term">Convection-diffusion with a force term</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._book007.html"
                        title="previous chapter">The diffusion equation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._book009.html"
                        title="next chapter">Advanced PDE models</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/._book008.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._book009.html" title="Advanced PDE models"
             >next</a> |</li>
        <li class="right" >
          <a href="._book007.html" title="The diffusion equation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Scaling of Differential Equations</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
    <a href="http://cbc.simula.no"><img src="_static/cbc_banner.png" width="100%"><a>
    <br />
    <br />
      &copy;2015, Geir K. Pedersen, Hans Petter Langtangen. Released under CC Attribution 4.0 license.
  </div>
</div>

  </body>
</html>