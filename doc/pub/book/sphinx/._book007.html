
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The diffusion equation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="Scaling of Differential Equations" href="index.html" />
    <link rel="next" title="The convection-diffusion equation" href="._book008.html" />
    <link rel="prev" title="Basic PDE models" href="._book006.html" />
 
  
       <style type="text/css">
         div.admonition {
           background-color: whiteSmoke;
           border: 1px solid #bababa;
         }
       </style>
      </head>
    
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._book008.html" title="The convection-diffusion equation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._book006.html" title="Basic PDE models"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Scaling of Differential Equations</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-diffusion-equation">
<span id="sec-scale-diffu"></span><h1>The diffusion equation<a class="headerlink" href="#the-diffusion-equation" title="Permalink to this headline">¶</a></h1>
<p>The diffusion equation in a one-dimensional homogeneous medium reads</p>
<div class="math" id="equation-sec:scale:diffu:pde1">
<span id="eq-sec-scale-diffu-pde1"></span><span class="eqno">(1)</span>\[     \frac{\partial u}{\partial t} =
     {\alpha}\frac{\partial^2 u}{\partial x^2}, \quad  x\in (0,L),\ t\in (0,T],\]</div>
<p>where <span class="math">\({\alpha}\)</span> is the diffusion coefficient. The
multi-dimensional generalization to a heterogeneous medium
and a force term takes the form</p>
<div class="math" id="equation-sec:scale:diffu:pde1:3D">
<span id="eq-sec-scale-diffu-pde1-3d"></span><span class="eqno">(2)</span>\[     \frac{\partial u}{\partial t} =
     \nabla\cdot\left({\alpha} \nabla u\right) + f, \quad  x,y,z\in \Omega,\ t\in (0,T]{\thinspace .}\]</div>
<p>We first look at scaling the PDE itself, and thereafter we discuss
some types of boundary conditions and how to scale the complete
initial-boundary value problem.</p>
<div class="section" id="homogeneous-diffusion-equation">
<span id="sec-scale-diffu-homo1d"></span><h2>Homogeneous diffusion equation<a class="headerlink" href="#homogeneous-diffusion-equation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="simplified-1d-pde">
<h3>Simplified 1D PDE<a class="headerlink" href="#simplified-1d-pde" title="Permalink to this headline">¶</a></h3>
<p>To make <a href="#equation-sec:scale:diffu:pde1">(1)</a> dimensionless,
we introduce as usual dimensionless dependent and independent variables:</p>
<div class="math">
\[\bar x = \frac{x}{x_c},
\quad \bar t = \frac{t}{t_c}, \quad \bar u =\frac{u}{u_c}{\thinspace .}\]</div>
<p>Inserting the dimensionless quantities in the one-dimensional
PDE <a href="#equation-sec:scale:diffu:pde1">(1)</a> results in</p>
<div class="math" id="equation-sec:scale:diffu:pde1:d0">
<span id="eq-sec-scale-diffu-pde1-d0"></span><span class="eqno">(3)</span>\[     \frac{\partial \bar u}{\partial \bar t} =
     \frac{t_c{\alpha}}{L^2}
     \frac{\partial^2 \bar u}{\partial \bar x^2}, \quad  \bar x\in (0,1),\ \bar t\in (0,\bar T = T/t_c]{\thinspace .}\]</div>
<p>Arguing as for the wave equation that the scaling should result in</p>
<div class="math">
\[\frac{\partial \bar u}{\partial \bar t}\hbox{ and }
\frac{\partial^2 \bar u}{\partial \bar x^2}\]</div>
<p>of the same size (about unity),
implies <span class="math">\(t_c{\alpha}/L^2=1\)</span> and therefore <span class="math">\(t_c = L^2/{\alpha}\)</span>.</p>
<p>Insight through an analytical solution can alternatively
help with choosing <span class="math">\(t_c\)</span>.
One can show that <span class="math">\(u=Ae^{-pt}\sin (kx)\)</span> is a solution of
<a href="#equation-sec:scale:diffu:pde1:d0">(3)</a> if <span class="math">\(p={\alpha} k^2\)</span>, for any <span class="math">\(k\)</span>. Exponential decay in
time is a characteristic feature of the diffusion equation, and
the e-folding time can then be taken as a time scale. This means
<span class="math">\(t_c = 1/p \sim k^{-2}\)</span>. Since <span class="math">\(k\)</span> is related to the spatial
wave length <span class="math">\(\lambda\)</span>
through <span class="math">\(k=2\pi/\lambda\)</span>, it means that <span class="math">\(t_c\)</span> depends strongly on the wave
length of the sine term <span class="math">\(\sin(kx)\)</span>.
In particular, short waves (as found in noisy signals) with
large <span class="math">\(k\)</span> decay very rapidly.
For the overall solution we are interested in how the longest meaningful
wave decays and use that time scale for <span class="math">\(t_c\)</span>. The longest wave
typically has half a wave length over the domain <span class="math">\([0,L]\)</span>:
<span class="math">\(u = Ae^{-pt}\sin(\pi x/L)\)</span> (<span class="math">\(k=\pi/L\)</span>). Then <span class="math">\(t_c=L^2/{\alpha} \pi^{-2}\)</span>,
but factor <span class="math">\(\pi^{-2}\)</span> is not important and we simply choose
<span class="math">\(t_c=L^2/{\alpha}\)</span>, which equals the time scale we arrived at above.
We may say that <span class="math">\(t_c\)</span> is the time it takes for the diffusion to
significantly change the solution in the entire domain.</p>
<p>Another fundamental solution of the diffusion equation is the
diffusion of a Gaussian function: <span class="math">\(u(x,t)=(4\pi{\alpha}
t)^{-1/2}\exp{(-x^2/(4{\alpha} t))}\)</span>. For the diffusion to be significant
at a distance <span class="math">\(x=L\)</span>, we may demand the exponential factor to have a
value of <span class="math">\(e^{-1}\approx 0.37\)</span>, which implies <span class="math">\(t=L^2/(4{\alpha})\)</span>, but the
factor 4 is not of importance, so again, a relevant time scale is
<span class="math">\(t_c=L^2/{\alpha}\)</span>.</p>
<p>The scale <span class="math">\(u_c\)</span> is chosen according to the initial condition:
<span class="math">\(u_c=\max_{x\in(0,L)}|I(x)|\)</span>. For a diffusion equation <span class="math">\(u_t={\alpha} u_{xx}\)</span>
with <span class="math">\(u=0\)</span> at the boundaries <span class="math">\(x=0,L\)</span>, the solution is bounded by
the initial condition <span class="math">\(I(x)\)</span>. Therefore, the listed choice of <span class="math">\(u_c\)</span>
implies that
<span class="math">\(|u|\leq 1\)</span>. (The solution <span class="math">\(u=Ae^{-pt}\sin (kx)\)</span> is such an example
if <span class="math">\(k=n\pi/L\)</span> for integer <span class="math">\(n\)</span> such that <span class="math">\(u=0\)</span> for <span class="math">\(x=0\)</span> and <span class="math">\(x=L\)</span>.)</p>
<p>The resulting dimensionless PDE becomes</p>
<div class="math" id="equation-sec:scale:diffu:pde1:d">
<span id="eq-sec-scale-diffu-pde1-d"></span><span class="eqno">(4)</span>\[     \frac{\partial \bar u}{\partial \bar t} =
     \frac{\partial^2 \bar u}{\partial \bar x^2}, \quad  \bar x\in (0,1),\ \bar t\in (0,\bar T],\]</div>
<p>with initial condition</p>
<div class="math">
\[\bar u(\bar x, 0) = \bar I(\bar x) = \frac{I(x_c\bar x)}{\max_x |I(x)|}{\thinspace .}\]</div>
<p>Notice that <a href="#equation-sec:scale:diffu:pde1:d">(4)</a> is without physical parameters!</p>
</div>
<div class="section" id="generalized-pde">
<h3>Generalized PDE<a class="headerlink" href="#generalized-pde" title="Permalink to this headline">¶</a></h3>
<p>Turning the attention to <a href="#equation-sec:scale:diffu:pde1:3D">(2)</a>, we introduce
the dimensionless diffusion coefficient</p>
<div class="math">
\[\bar{\alpha}(\bar x,\bar y,\bar z) =
{\alpha}_c^{-1}{\alpha} (x_c\bar x, y_c\bar y, z_c\bar z),\]</div>
<p>typically with</p>
<div class="math">
\[{\alpha}_c = \max_{x,y,z}{\alpha}(x,y,z){\thinspace .}\]</div>
<p>The length scales are</p>
<div class="math">
\[\bar x = \frac{x}{x_c},\quad \bar y = \frac{y}{y_c},\quad
\bar z = \frac{z}{z_c}{\thinspace .}\]</div>
<p>We scale <span class="math">\(f\)</span> in a similar fashion:</p>
<div class="math">
\[\bar f(\bar x, \bar y, \bar z, \bar t)
= f_c^{-1}f(\bar xx_c, \bar yy_c \bar zz_c, \bar tt_c),\]</div>
<p>with</p>
<div class="math">
\[f_c = \max_{x,y,z,t}|f(x,y,z,t)|{\thinspace .}\]</div>
<p>Also assuming
that <span class="math">\(x_c=y_c=z_c=L\)</span>, and <span class="math">\(u_c=\max_{x,y,z}(I(x,y,z)\)</span>,
we end up with the scaled PDE</p>
<div class="math" id="equation-sec:scale:diffu:pde1:3D:d">
<span id="eq-sec-scale-diffu-pde1-3d-d"></span><span class="eqno">(5)</span>\[     \frac{\partial \bar u}{\partial \bar t} =
     \nabla\cdot\left(\bar{\alpha} \bar\nabla \bar u\right) + \beta f, \quad  \bar x,\bar y,\bar z\in \bar \Omega,\ \bar t\in (0,\bar T]{\thinspace .}\]</div>
<p>Here, <span class="math">\(\bar\nabla\)</span> means differentiation with respect to dimensionless
coordinates <span class="math">\(\bar x\)</span>, <span class="math">\(\bar y\)</span>, and <span class="math">\(\bar z\)</span>. The dimensionless parameter
<span class="math">\(\beta\)</span> takes the form</p>
<div class="math">
\[\beta = \frac{t_cf_c}{u_c} = \frac{L^2}{{\alpha}}
\frac{\max_{x,y,z,t}|f(x,y,z,t)|}{\max_{x,y,z}|I(x,y,z)|}{\thinspace .}\]</div>
<p>The scaled initial condition is <span class="math">\(\bar u = \bar I\)</span> as in the 1D case.</p>
<p>An alternative choice <span class="math">\(u_c\)</span> is to make the coefficient <span class="math">\(t_cf_c/u_c\)</span>
in the source term unity. The scaled PDE now becomes</p>
<div class="math" id="equation-sec:scale:diffu:pde1:3D:d2">
<span id="eq-sec-scale-diffu-pde1-3d-d2"></span><span class="eqno">(6)</span>\[     \frac{\partial \bar u}{\partial \bar t} =
     \nabla\cdot\left(\bar{\alpha} \bar\nabla \bar u\right) + f,\]</div>
<p>but the initial condition features the <span class="math">\(\beta\)</span> parameter:</p>
<div class="math">
\[\bar u(\bar x, \bar y, \bar z, 0) = \frac{I}{t_cf_c} =
\beta^{-1}\bar I(\bar x,\bar y,\bar z){\thinspace .}\]</div>
<p>We may check that <span class="math">\(\beta\)</span> is really non-dimensional. From the PDE,
<span class="math">\(f\)</span> must have the same dimensions as <span class="math">\(\partial u/\partial t\)</span>, i.e.,
<span class="math">\([\Theta\hbox{T}^{-1}]\)</span>.
The dimension of <span class="math">\({\alpha}\)</span> is more intricate, but from the term
<span class="math">\({\alpha} u_{xx}\)</span> we know that <span class="math">\(u_{xx}\)</span> has dimensions <span class="math">\([\Theta\hbox{L}^{-2}]\)</span>,
and then <span class="math">\({\alpha}\)</span> must have dimension <span class="math">\(\hbox{L}^2\hbox{T}^{-1}]\)</span>
to match the target <span class="math">\([\Theta\hbox{T}^{-1}]\)</span>.
In the expression for <span class="math">\(\beta\)</span> we get
<span class="math">\([\hbox{L}^2\Theta\hbox{T}^{-1}(\hbox{L}^2\hbox{T}^{-1}\Theta)^{-1}]\)</span>,
which equals 1 as it should.</p>
</div>
</div>
<div class="section" id="jump-boundary-condition">
<h2>Jump boundary condition<a class="headerlink" href="#jump-boundary-condition" title="Permalink to this headline">¶</a></h2>
<p>A classical one-dimensional
heat conduction problem goes as follows. An insulated rod
at some constant temperature <span class="math">\(U_0\)</span> is suddenly heated from one end
(<span class="math">\(x=0\)</span>), modeled as a constant Dirichlet condition <span class="math">\(u(0,t)=U_L\neq U_0\)</span>
at that end. That is, the boundary temperature jumps from <span class="math">\(U_0\)</span> to <span class="math">\(U_1\)</span>
at <span class="math">\(t=0\)</span>. All the other surfaces of the rod are insulated such that
a one-dimensional model is appropriate.
Heat cannot escape, and we supply heat at <span class="math">\(x=0\)</span> at the temperature <span class="math">\(U_1\)</span>,
which will warm up all of the material to the temperature <span class="math">\(U_1\)</span>.
That is, <span class="math">\(u\rightarrow U_1\)</span> as <span class="math">\(t\rightarrow\infty\)</span>.</p>
<p>The initial-boundary value problem reads</p>
<div class="math" id="equation-scale:heat:pde3">
<span id="eq-scale-heat-pde3"></span><span class="eqno">(7)</span>\[     \frac{\partial u}{\partial t} =
     {\alpha} \frac{\partial^2 u}{\partial x^2},
     \quad   x\in (0,L),\ t\in (0, T],\]</div>
<div class="math" id="equation-scale:heat:pde3:ic:u">
<span id="eq-scale-heat-pde3-ic-u"></span><span class="eqno">(8)</span>\[     u(x,0) = U_0,
     \quad  x\in [0,L],\]</div>
<div class="math" id="equation-scale:heat:pde3:bc:0">
<span id="eq-scale-heat-pde3-bc-0"></span><span class="eqno">(9)</span>\[     u(0, t)  = U_1,
     \quad   t\in (0, T],\]</div>
<div class="math" id="equation-scale:heat:pde3:bc:L">
<span id="eq-scale-heat-pde3-bc-l"></span><span class="eqno">(10)</span>\[     \frac{\partial}{\partial x} u(L, t)  = 0,
     \quad  t\in (0, T].\]</div>
<p>The diffusion coefficient is related to heat transfer parameters
by <span class="math">\({\alpha} = k/(\varrho c)\)</span>, where <span class="math">\(k\)</span> is the heat conduction coefficient,
<span class="math">\(\varrho\)</span> is the density, and <span class="math">\(c\)</span> is a specific heat capacity parameter.</p>
<p>The natural dimensionless temperature for this problem is</p>
<div class="math">
\[\bar u = \frac{u - U_0}{U_1 - U_0},\]</div>
<p>since this choice makes <span class="math">\(\bar u\in [0,1]\)</span>. The reason is that <span class="math">\(u\)</span> is bounded by
the initial and boundary conditions (in the absence of a source term),
and we have
<span class="math">\(\bar u(\bar x,0)=0\)</span>, <span class="math">\(\bar u(\bar x,\infty)=1\)</span>, and <span class="math">\(\bar u(0,\bar t)=1\)</span>.</p>
<p>The choice of <span class="math">\(t_c\)</span> is as in the previous cases. We arrive at
the dimensionless initial-boundary value problem</p>
<div class="math" id="equation-scale:heat:pde3:d">
<span id="eq-scale-heat-pde3-d"></span><span class="eqno">(11)</span>\[     \frac{\partial \bar u}{\partial \bar t} =
     \frac{\partial^2 \bar u}{\partial \bar x^2},
     \quad   \bar x\in (0,1),\ \bar t\in (0, \bar T],\]</div>
<div class="math" id="equation-scale:heat:pde3:ic:u:d">
<span id="eq-scale-heat-pde3-ic-u-d"></span><span class="eqno">(12)</span>\[     \bar u(\bar x,0) = 0,
     \quad  \bar x\in [0,1],\]</div>
<div class="math" id="equation-scale:heat:pde3:bc:0:d">
<span id="eq-scale-heat-pde3-bc-0-d"></span><span class="eqno">(13)</span>\[     \bar u(0, \bar t)  = 1,
     \quad   \bar t\in (0, \bar T],\]</div>
<div class="math" id="equation-scale:heat:pde3:bc:L:d">
<span id="eq-scale-heat-pde3-bc-l-d"></span><span class="eqno">(14)</span>\[     \frac{\partial}{\partial \bar x} u(1, \bar t)  = 0,
     \quad  \bar t\in (0, \bar T].\]</div>
<p>The striking feature is that there are no physical parameters left in
this problem. One simulation can be carried out for <span class="math">\(\bar u(\bar x,\bar t)\)</span>,
and the temperature in a rod of any material and any constant initial and
boundary temperature can be retrieved by</p>
<div class="math">
\[u(x,t) = U_0 + (U_1-U_0)\bar u(x/L, t{\alpha}/L^2){\thinspace .}\]</div>
<p>[<strong>hpl 6</strong>: Include simulation results.]</p>
</div>
<div class="section" id="oscillating-dirichlet-condition">
<h2>Oscillating Dirichlet condition<a class="headerlink" href="#oscillating-dirichlet-condition" title="Permalink to this headline">¶</a></h2>
<p>Let us address the heat equation problem where the temperature is
oscillating on the boundary <span class="math">\(x=0\)</span>:</p>
<div class="math" id="equation-scale:heat:pde2">
<span id="eq-scale-heat-pde2"></span><span class="eqno">(15)</span>\[     \frac{\partial u}{\partial t} =
     {\alpha} \frac{\partial^2 u}{\partial x^2},
     \quad   x\in (0,L),\ t\in (0, T],\]</div>
<div class="math" id="equation-scale:heat:pde2:ic:u">
<span id="eq-scale-heat-pde2-ic-u"></span><span class="eqno">(16)</span>\[     u(x,0) = U_0,
     \quad  x\in [0,L],\]</div>
<div class="math" id="equation-scale:heat:pde2:bc:0">
<span id="eq-scale-heat-pde2-bc-0"></span><span class="eqno">(17)</span>\[     u(0, t)  = U_0 + A\sin(\omega t),
     \quad   t\in (0, T],\]</div>
<div class="math" id="equation-scale:heat:pde2:bc:L">
<span id="eq-scale-heat-pde2-bc-l"></span><span class="eqno">(18)</span>\[     \frac{\partial}{\partial x} u(L, t)  = 0,
     \quad  t\in (0, T].\]</div>
<p>One important physical application is temperature oscillations in the
ground, either day and night variations
at a short temporal and spatial scale, or seasonal variations in the
Earth&#8217;s crust.</p>
<p>Since the boundary temperature is oscillating around the initial
condition, we expect <span class="math">\(u\in [-A,A]\)</span>.
Then the dimensionless temperature is therefore taken as</p>
<div class="math">
\[\bar u = \frac{u-U_0}{2A},\]</div>
<p>such that <span class="math">\(\bar u\in [-1,1]\)</span>.</p>
<p>What is an appropriate time scale? There will be two time scales involved,
the oscillations <span class="math">\(\sin(\omega t)\)</span> with period <span class="math">\(P=2\pi/\omega\)</span> at
the boundary and the &#8220;speed of diffusion&#8221; where <span class="math">\(t_c=L^2/{\alpha}\)</span> is
the appropriate scale.
Analytical insight exists in this model problem because the exact
solution is known to be</p>
<div class="math" id="equation-scale:heat:daynight:sol">
<span id="eq-scale-heat-daynight-sol"></span><span class="eqno">(19)</span>\[     u(x,t) = U_0 - Ae^{-bx}\sin (bx - \omega t),\quad b =\sqrt{\frac{\omega}{2{\alpha}}}{\thinspace .}\]</div>
<p>This solution is of the form <span class="math">\(e^{-bx}g(x-ct)\)</span>, i.e., a wave that
moves to the right with velocity <span class="math">\(c\)</span> and a damped amplitude <span class="math">\(e^{-bx}\)</span>.
This is seen if we make a rewrite</p>
<div class="math">
\[u(x,t) = U_0 - Ae^{-bx}\sin\left(b(x - ct)\right),\quad
c=\omega/b = \sqrt{2{\alpha}\omega},\  b =\sqrt{\frac{\omega}{2{\alpha}}}{\thinspace .}\]</div>
<p>The boundary oscillations lead to the time scale <span class="math">\(t_c=1/\omega\)</span>.
The speed of the wave suggests another time scale: the time it
takes to propagate through the domain, which is <span class="math">\(L/c\)</span>, and
hence <span class="math">\(t_c = L/c = L/\sqrt{2{\alpha}\omega}\)</span>.</p>
<p>One may argue that <span class="math">\(L\)</span> is not the appropriate length scale, because
<span class="math">\(u\)</span> is damped by <span class="math">\(e^{-bx}\)</span> so for <span class="math">\(x &gt; 4/b\)</span>, <span class="math">\(u\)</span> is close to zero.
Using <span class="math">\(1/b\)</span> as length scale, which is the e-folding distance of the
damping factor, and basing
<span class="math">\(t_c\)</span> on the time it takes a signal to propagate one length scale,
<span class="math">\(t_c^{-1}=bc=\omega\)</span>. Similarly, the time scale based on
the &#8220;speed of diffusion&#8221; changes to
<span class="math">\(t_c^{-1}= b^2{\alpha} = \frac{1}{2}\omega\)</span> if we employ <span class="math">\(1/b\)</span> as length scale.</p>
<p>To summarize, we have three candidates for the time scale:
<span class="math">\(t_c=L^2/{\alpha}\)</span>, <span class="math">\(t_c=2/\omega\)</span>, and <span class="math">\(t_c=1/\omega\)</span>.</p>
<p>Let us look
at the dimensionless exact solution to see if it can help with the choice.
We introduce the dimensionless
parameters</p>
<div class="math">
\[\beta = bx_c = x_c\sqrt{\frac{\omega}{2dfc}},\quad
\gamma = \omega t_c{\thinspace .}\]</div>
<p>The scaled solution becomes</p>
<div class="math">
\[\bar u(\bar x, \bar t; \beta,\gamma) = e^{-\beta\bar x}\sin(\beta\bar x - \gamma\bar t){\thinspace .}\]</div>
<p>The three choices of <span class="math">\(\gamma\)</span>, implied by the three choices of <span class="math">\(t_c\)</span>, are</p>
<div class="math" id="equation-scale:heat:daynight:gamma3">
<span id="eq-scale-heat-daynight-gamma3"></span><span class="eqno">(20)</span>\[\begin{split}     \gamma = \left\lbrace\begin{array}{ll}
     1, &amp; t_c=1/\omega,\\
     2, &amp; t_c = 2/\omega,\\
     2\beta^2, &amp; t_c = L^2/{\alpha},\ x_c=L
     \end{array}\right.\end{split}\]</div>
<p>The former two choices leaves only <span class="math">\(\beta\)</span> as parameter in <span class="math">\(\bar u\)</span>,
and with <span class="math">\(x_c=1/b\)</span> as length scale, <span class="math">\(\beta\)</span> becomes unity, and there
are no parameters in the dimensionless solution:</p>
<div class="math" id="equation-scale:heat:daynight:xcb">
<span id="eq-scale-heat-daynight-xcb"></span><span class="eqno">(21)</span>\[     \bar u(\bar x, \bar t) = e^{-\bar x}\sin(\bar x - \bar t){\thinspace .}\]</div>
<p>Therefore, <span class="math">\(x_c=1/b\)</span> and <span class="math">\(t_c=1/\omega\)</span> (or <span class="math">\(t_c=2/\omega\)</span>, but the
factor 2 is of no importance) are therefore the most appropriate scales.</p>
<p>To further argue why <a href="#equation-scale:heat:daynight:xcb">(21)</a> these scales are
preferred, think of
<span class="math">\(\omega\)</span> as large. Then the wave is damped over a short
distance and there will be a thin boundary layer of temperature
oscillations near <span class="math">\(x=0\)</span> and little changes in <span class="math">\(u\)</span> in the rest of
the domain. The scaling <a href="#equation-scale:heat:daynight:xcb">(21)</a> resolves
this problem by using <span class="math">\(1/b \sim \omega^{-1/2}\)</span> as length scale,
because then the boundary layer thickness is independent of
<span class="math">\(\omega\)</span>. The length of the domain can be chosen as, e.g., <span class="math">\(4/b\)</span>
such that <span class="math">\(\bar u\approx 0\)</span> at this end. The length scale <span class="math">\(1/b\)</span>
help us to zoom in on the part of <span class="math">\(u\)</span> where significant changes
take place.</p>
<p>In the other limit, <span class="math">\(\omega\)</span> small, <span class="math">\(b\)</span> becomes small, and the wave
is hardly damped in the domain <span class="math">\([0,L]\)</span> unless <span class="math">\(L\)</span> is large enough.
The imposed boundary condition on <span class="math">\(x=L\)</span> in fact requires <span class="math">\(u\)</span> to
be constant so its derivative vanishes, and this property can only
be obtained if <span class="math">\(L\)</span> is
enough to ensure that the wave becomes significantly damped.
Therefore, the length scale is dictated by <span class="math">\(b\)</span>, not <span class="math">\(L\)</span>, and <span class="math">\(L\)</span>
should be adapted to <span class="math">\(b\)</span>, typically <span class="math">\(L\geq 4/b\)</span>.</p>
<p>The resulting scaled problem becomes</p>
<div class="math" id="equation-scale:heat:pde2:d">
<span id="eq-scale-heat-pde2-d"></span><span class="eqno">(22)</span>\[     \frac{\partial \bar u}{\partial \bar t} =
     \frac{1}{2}\frac{\partial^2 u}{\partial x^2},
     \quad  \bar x\in (0,4/b),\ \bar t\in (0,\bar T],\]</div>
<div class="math" id="equation-scale:heat:pde2:ic:u:d">
<span id="eq-scale-heat-pde2-ic-u-d"></span><span class="eqno">(23)</span>\[     \bar u(\bar x,0) = 0,
     \quad \bar x\in [0,1]\]</div>
<div class="math" id="equation-scale:heat:pde2:bc:0:d">
<span id="eq-scale-heat-pde2-bc-0-d"></span><span class="eqno">(24)</span>\[     \bar u(0,\bar t)  = \sin(\bar t),
     \quad  \bar t\in (0,\bar T],\]</div>
<div class="math" id="equation-scale:heat:pde2:bc:L:d">
<span id="eq-scale-heat-pde2-bc-l-d"></span><span class="eqno">(25)</span>\[     \frac{\partial}{\partial\bar x}\bar u(1,\bar t)  = 0,
     \quad \bar t\in (0,\bar T].\]</div>
<p>The coefficient in front of the second-derivative becomes</p>
<div class="math">
\[\frac{t_c{\alpha}}{1/b^2} = \frac{b^2{\alpha}}{\omega} =
= \frac{1}{2}{\thinspace .}\]</div>
<p>We may, of course, choose <span class="math">\(t_c=2/\omega\)</span> and get rid of the <span class="math">\(\frac{1}{2}\)</span> factor,
if desired, but then it turns up in <a href="#equation-scale:heat:pde2:bc:0:d">(24)</a> instead,
as <span class="math">\(\sin (2\bar t)\)</span>.</p>
</div>
<div class="section" id="diffusion-equation-with-source-term">
<span id="sec-scale-diffu-source"></span><h2>Diffusion equation with source term<a class="headerlink" href="#diffusion-equation-with-source-term" title="Permalink to this headline">¶</a></h2>
<p>Let us add a source term <span class="math">\(f(x,t)\)</span> to the diffusion equation,</p>
<div class="math" id="equation-sec:scale:diffu:pde1f">
<span id="eq-sec-scale-diffu-pde1f"></span><span class="eqno">(26)</span>\[     \frac{\partial u}{\partial t} =
     {\alpha}\frac{\partial^2 u}{\partial x^2} + f(x,t), \quad  x\in (0,L),\ t\in (0,T]
     {\thinspace .}\]</div>
<p>As always, we introduce</p>
<div class="math">
\[\bar x = \frac{x}{x_c},\quad
\ \bar t = \frac{t}{t_c}, \quad\bar u =\frac{u}{u_c},\]</div>
<p>and a scaling of <span class="math">\(f\)</span>,</p>
<div class="math">
\[\bar f(\bar x,\bar t) = \frac{f(x,t)}{f_c},\quad f_c=\max_{x,t}f(x,t){\thinspace .}\]</div>
<p>Inserting the dimensionless quantities in <a href="#equation-sec:scale:diffu:pde1f">(26)</a>
and making each term dimensionless results in</p>
<div class="math" id="equation-sec:scale:diffu:pde1f:nondim0">
<span id="eq-sec-scale-diffu-pde1f-nondim0"></span><span class="eqno">(27)</span>\[     \frac{\partial \bar u}{\partial \bar t} =
     \frac{t_c{\alpha}}{x_c^2}
     \frac{\partial^2 u}{\partial x^2} + \frac{t_cf_c}{u_c}
     \bar f(\bar x,\bar t), \quad  \bar x\in (0,L/x_c),\ \bar t\in (0,T/t_c]
     {\thinspace .}\]</div>
<p>The magnitude of <span class="math">\(u\)</span> is governed by <span class="math">\(f\)</span> as well as by
initial and boundary conditions. Suppose initial and boundary conditions
are zero.
The length scale <span class="math">\(x_c\)</span> is naturally chosen as <span class="math">\(L\)</span> such that <span class="math">\(\bar x\in[0,1]\)</span>.
It is also natural to choose <span class="math">\(t_c\)</span> to be the time scale
of diffusion, as before, <span class="math">\(t_c=x_c^2/{\alpha} = L^2/{\alpha}\)</span>. The source term can match
the unit size of the two other terms by choosing its coefficient to be
unity, i.e.,</p>
<div class="math">
\[u_c=t_cf_c=\frac{L^2 \max_{x,t} f}{{\alpha}}{\thinspace .}\]</div>
<p>The scaled equation then becomes free of physical parameters:</p>
<div class="math" id="equation-sec:scale:diffu:pde1f:nondim">
<span id="eq-sec-scale-diffu-pde1f-nondim"></span><span class="eqno">(28)</span>\[     \frac{\partial \bar u}{\partial \bar t} =
     \frac{\partial^2 u}{\partial x^2} +
     \bar f(\bar x,\bar t), \quad  \bar x\in (0,L/x_c),\ \bar t\in (0,T/t_c]
     {\thinspace .}\]</div>
<p>With an initial condition <span class="math">\(u=I\)</span>, we get a scaled initial condition</p>
<div class="math">
\[\bar u(\bar x, 0) = \beta \bar I(L\bar x),\]</div>
<p>where <span class="math">\(\bar I = I/\max_x I(x)\)</span> is a scaled version of <span class="math">\(I\)</span>, and <span class="math">\(\beta\)</span>
is a dimensionless number</p>
<div class="math">
\[\beta = \frac{\max_xI(x)}{\max_{x,t}f(x,t)}\frac{{\alpha}}{L^2}{\thinspace .}\]</div>
<p>It measures the ratios of <span class="math">\(I\)</span> and <span class="math">\(f\)</span> per unit
characteristic time.</p>
<p>Suppose now that we choose <span class="math">\(u_c=\max_x I(x)\)</span> because <span class="math">\(f\)</span> is small compared
to <span class="math">\(I\)</span>. The initial condition then reads <span class="math">\(\bar u(\bar x,0)=\bar I(\bar x)\)</span>,
and the differential equation becomes</p>
<div class="math">
\[\frac{\partial \bar u}{\partial \bar t} =
\frac{\partial^2 u}{\partial x^2} +
\beta^{-1} \bar f(\bar x,\bar t)
{\thinspace .}\]</div>
<p>This is the relevant scaling for a small <span class="math">\(f\)</span> and large <span class="math">\(\beta\)</span>,
indicating that <span class="math">\(\beta^{-1} \bar f\)</span> can be neglected from the
PDE. A major influence of <span class="math">\(f\)</span> leads to a balance between all
three terms in the PDE, but the initial condition has a small
<span class="math">\(\beta\)</span>, and one can set <span class="math">\(\bar u(\bar x, 0)\approx 0\)</span>.
<a class="reference internal" href="._book009.html#scale-vib-exer-couette-wpressure"><span class="std std-ref">Exercise 17: Scale Couette flow with pressure gradient</span></a> explores a similar
stationary problem.</p>
</div>
<div class="section" id="fisher-s-equation">
<span id="sec-scale-diffu-fisher"></span><h2>Fisher&#8217;s equation<a class="headerlink" href="#fisher-s-equation" title="Permalink to this headline">¶</a></h2>
<p>Fisher&#8217;s equation is essentially the logistic equation at each point
for population dynamics combined with spatial movement through
ordinary diffusion:</p>
<div class="math" id="equation-sec:scale:diffu:Fisher:pde">
<span id="eq-sec-scale-diffu-fisher-pde"></span><span class="eqno">(29)</span>\[     \frac{\partial u}{\partial t} =
     {\alpha}\frac{\partial^2 u}{\partial x^2} + \varrho u(1-u/M)
     {\thinspace .}\]</div>
<p>This PDE is also known as the KPP equation after
Kolmogorov, Petrovsky, and Piskynov (who introduced the equation
independently of Fisher).</p>
<p>Introducing</p>
<div class="math">
\[\bar x = \frac{x}{x_c},\quad
\ \bar t = \frac{t}{t_c}, \quad\bar u =\frac{u}{u_c},\]</div>
<p>results in</p>
<div class="math">
\[\frac{\partial \bar u}{\partial \bar t} =
\frac{t_c{\alpha}}{x_c^2}
\frac{\partial^2 u}{\partial x^2} + t_c \varrho \bar u (1 - u_c\bar u/M){\thinspace .}\]</div>
<p>If all terms are equally important, the scales can be determined from
demanding the coefficients to be unity and by scaling <span class="math">\(u\)</span> by <span class="math">\(M\)</span>:</p>
<div class="math">
\[u_c=M,\quad t_c = \frac{1}{\varrho},\quad x_c = \sqrt{\frac{{\alpha}}{\varrho}}
{\thinspace .}\]</div>
<p>The scaled PDE becomes</p>
<div class="math">
\[\frac{\partial \bar u}{\partial \bar t} =
\frac{\partial^2 u}{\partial x^2} + \bar u (1 - \bar u){\thinspace .}\]</div>
<p>With this scaling, the length scale <span class="math">\(x_c=\sqrt{{\alpha}/\varrho}\)</span>
is not related to the domain size, so the scale is most relevant for
an infinite domain. Also, note that the time scale <span class="math">\(t_c=\varrho^{-1}\)</span>
is governed by the logistic term (exponential growth for small <span class="math">\(u\)</span>)
and not the diffusion process as in most previous examples.</p>
<p>On a finite domain <span class="math">\([0,L]\)</span> we set <span class="math">\(x_c=L\)</span>, <span class="math">\(t_c=\varrho^{-1}\)</span>,
<span class="math">\(u_c=M\)</span>, which gives</p>
<div class="math">
\[\frac{\partial \bar u}{\partial \bar t} =
\beta
\frac{\partial^2 u}{\partial x^2} + \bar u (1 - \bar u),\]</div>
<p>where <span class="math">\(\beta\)</span> is a dimensionless number</p>
<div class="math">
\[\beta = \frac{{\alpha}}{\varrho L^2} = \frac{\varrho^{-1}}{L^2/{\alpha}},\]</div>
<p>demonstrating that <span class="math">\(\beta\)</span> measures the ratio of the time scale
for exponential growth in the beginning of the logistic process
and the time scale of diffusion <span class="math">\(L^2/{\alpha}\)</span>.
For small <span class="math">\(\beta\)</span> we can neglect the diffusion and spatial movements,
and the PDE is essentially a logistic ODE at each point, while for
large <span class="math">\(\beta\)</span>, diffusion dominates, and <span class="math">\(t_c\)</span> should in that case be
based on the diffusion time scale <span class="math">\(L^2/{\alpha}\)</span>. This leads to the
scaled PDE</p>
<div class="math">
\[\frac{\partial \bar u}{\partial \bar t} =
\frac{\partial^2 u}{\partial x^2} + \beta^{-1}\bar u (1 - \bar u),\]</div>
<p>showing that a large <span class="math">\(\beta\)</span> encourages omission of the logistic term,
because the point-wise growth takes place on large time scales while
diffusion is rapid. The effect of diffusion is then more prominent
and it suffices to solve <span class="math">\(\bar u_{\bar t} = \bar u_{\bar x\bar x}\)</span>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <center>
            <p class="logo"><a href="http://cbc.simula.no/" title="Go to Center for Biomedical Computing">
              <img class="logo" src="_static/cbc_logo.png" alt="Logo"/>
            </a></p>
            </center>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The diffusion equation</a><ul>
<li><a class="reference internal" href="#homogeneous-diffusion-equation">Homogeneous diffusion equation</a><ul>
<li><a class="reference internal" href="#simplified-1d-pde">Simplified 1D PDE</a></li>
<li><a class="reference internal" href="#generalized-pde">Generalized PDE</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jump-boundary-condition">Jump boundary condition</a></li>
<li><a class="reference internal" href="#oscillating-dirichlet-condition">Oscillating Dirichlet condition</a></li>
<li><a class="reference internal" href="#diffusion-equation-with-source-term">Diffusion equation with source term</a></li>
<li><a class="reference internal" href="#fisher-s-equation">Fisher&#8217;s equation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._book006.html"
                        title="previous chapter">Basic PDE models</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._book008.html"
                        title="next chapter">The convection-diffusion equation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/._book007.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._book008.html" title="The convection-diffusion equation"
             >next</a> |</li>
        <li class="right" >
          <a href="._book006.html" title="Basic PDE models"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Scaling of Differential Equations</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
    <a href="http://cbc.simula.no"><img src="_static/cbc_banner.png" width="100%"><a>
    <br />
    <br />
      &copy;2015, Hans Petter Langtangen. Released under CC Attribution 4.0 license.
  </div>
</div>

  </body>
</html>