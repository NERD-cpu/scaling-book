
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Vibration problems</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="Scaling of Differential Equations" href="index.html" />
    <link rel="next" title="Basic PDE models" href="._book006.html" />
    <link rel="prev" title="ODE models" href="._book004.html" />
 
  
       <style type="text/css">
         div.admonition {
           background-color: whiteSmoke;
           border: 1px solid #bababa;
         }
       </style>
      </head>
    
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._book006.html" title="Basic PDE models"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._book004.html" title="ODE models"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Scaling of Differential Equations</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="vibration-problems">
<span id="sec-scale-vib"></span><h1>Vibration problems<a class="headerlink" href="#vibration-problems" title="Permalink to this headline">¶</a></h1>
<p>We shall in this section
address a range of different second-order ODEs for mechanical
vibrations and demonstrate how to reason about the scaling in
different physical scenarios.</p>
<p>[<strong>hpl 10</strong>: Include more figures.]</p>
<div class="section" id="undamped-vibrations-without-forcing">
<span id="sec-scale-vib-undamped"></span><h2>Undamped vibrations without forcing<a class="headerlink" href="#undamped-vibrations-without-forcing" title="Permalink to this headline">¶</a></h2>
<p>The simplest differential equation model for mechanical vibrations
reads</p>
<div class="math" id="eq-sec-scale-vib-undamped-model">
\[\tag{64}
mu'' + ku = 0,\quad u(0)=I,\ u'(0)=V{\thinspace .}\]</div>
<p>This is a common model for a vibrating body  with mass <span class="math">\(m\)</span> attached
to a linear spring with spring constant <span class="math">\(k\)</span> (and force <span class="math">\(-ku\)</span>).
The quantity <span class="math">\(u(t)\)</span> measures the displacement of the body.
Figure <a class="reference internal" href="#sec-scale-vib-undamped-sketch"><span class="std std-ref">Oscillating body attached to a spring</span></a> shows a typical mechanical
sketch of such a system: some mass can move horizontally without friction
and is connected to a spring that exerts a force <span class="math">\(-ku\)</span> on the body.</p>
<div class="figure" id="id3">
<span id="sec-scale-vib-undamped-sketch"></span><a class="reference internal image-reference" href="_images/oscillator_spring.png"><img alt="_images/oscillator_spring.png" src="_images/oscillator_spring.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text"><em>Oscillating body attached to a spring</em></span></p>
</div>
<div class="section" id="the-first-technical-steps-of-scaling">
<h3>The first technical steps of scaling<a class="headerlink" href="#the-first-technical-steps-of-scaling" title="Permalink to this headline">¶</a></h3>
<p>The problem <a class="reference internal" href="#eq-sec-scale-vib-undamped-model"><span class="std std-ref">(64)</span></a> has one independent
variable <span class="math">\(t\)</span> and one dependent variable <span class="math">\(u\)</span>. We introduce dimensionless
versions of these variables:</p>
<div class="math">
\[\bar u =\frac{u}{u_c},\quad\bar t = \frac{t}{t_c},\]</div>
<p>where <span class="math">\(u_c\)</span> and <span class="math">\(t_c\)</span> are characteristic values of <span class="math">\(u\)</span> and <span class="math">\(t\)</span>.
Inserted in <a class="reference internal" href="#eq-sec-scale-vib-undamped-model"><span class="std std-ref">(64)</span></a>, we get</p>
<div class="math">
\[m\frac{u_c}{t_c^2}\frac{d^2\bar u}{d\bar t^2} + ku_c\bar u = 0,
\quad u_c\bar u(0)=I,\quad \frac{u_c}{t_c}\frac{d\bar u}{d\bar t}(0)=V,\]</div>
<p>resulting in</p>
<div class="math" id="eq-sec-scale-vib-undamped-model-scaled0">
\[\tag{65}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c^2 k}{m}\bar u = 0,
    \quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}{\thinspace .}\]</div>
<p>What is an appropriate displacement scale <span class="math">\(u_c\)</span>? The initial condition
<span class="math">\(u(0)=I\)</span> is a candidate, i.e., <span class="math">\(u_c=I\)</span>. But how to choose the time scale?
Making the coefficient in front of the <span class="math">\(\bar u\)</span> unity, such that
both terms balance and are of size unity, is a candidate.</p>
</div>
<div class="section" id="the-exact-solution-1">
<h3>The exact solution<a class="headerlink" href="#the-exact-solution-1" title="Permalink to this headline">¶</a></h3>
<p>To better see what the proper scales of <span class="math">\(u\)</span> and <span class="math">\(t\)</span> are, we can look
into the analytical solution of this problem.
Although the exact solution of
<a class="reference internal" href="#eq-sec-scale-vib-undamped-model"><span class="std std-ref">(64)</span></a> is quite straightforward to calculate
by hand, we take the opportunity to make use of SymPy to
find <span class="math">\(u(t)\)</span>. The use of SymPy can later be generalized to vibration
ODEs that are harder to solve by hand.</p>
<p>SymPy need all mathematical symbols to be explicitly created:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">cls</span><span class="o">=</span><span class="n">Function</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">I</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">C2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s">&#39;I V C1 C2&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>To specify the ODE to be solved, we can make a Python function returning
all the terms in the ODE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Define differential equation: u&#39;&#39; + w**2*u = 0</span>
<span class="k">def</span> <span class="nf">ode</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">diff</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span>

<span class="n">diffeq</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">diffeq</span></code> variable, defining the ODE, can be passed to a SymPy
function <code class="docutils literal"><span class="pre">dsolve</span></code> to find the symbolic solution of the ODE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">s</span> <span class="o">=</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">diffeq</span><span class="p">,</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="c"># s is an u(t) == expression (Eq obj.), s.rhs grabs the expression</span>
<span class="n">u_sol</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">rhs</span>
<span class="k">print</span> <span class="n">u_sol</span>
</pre></div>
</div>
<p>The solution that gets printed is <code class="docutils literal"><span class="pre">C1*sin(t*w)</span> <span class="pre">+</span> <span class="pre">C2*cos(t*w)</span></code>, indicating
that there are two integration constants <code class="docutils literal"><span class="pre">C1</span></code> and <code class="docutils literal"><span class="pre">C2</span></code> to be determined
by the initial conditions. The result of applying these conditions is
a <span class="math">\(2\times 2\)</span> linear system of algebraic equations that SymPy can solve
by the <code class="docutils literal"><span class="pre">solve</span></code> function. The code goes as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># The solution u_sol contains integration constants C1 and C2</span>
<span class="c"># but these are not symbols, substitute them by symbols</span>
<span class="n">u_sol</span> <span class="o">=</span> <span class="n">u_sol</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="s">&#39;C1&#39;</span><span class="p">,</span> <span class="n">C1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="s">&#39;C2&#39;</span><span class="p">,</span> <span class="n">C2</span><span class="p">)</span>

<span class="c"># Determine C1 and C2 from the initial conditions</span>
<span class="n">ic</span> <span class="o">=</span> <span class="p">[</span><span class="n">u_sol</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="p">,</span> <span class="n">u_sol</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">]</span>
<span class="k">print</span> <span class="n">ic</span>   <span class="c"># 2x2 algebraic system for C1 and C2</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">ic</span><span class="p">,</span> <span class="p">[</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">])</span>
<span class="c"># s is now a dictionary: {C2: I, C1: V/w}</span>
<span class="c"># substitute solution back in u_sol</span>
<span class="n">u_sol</span> <span class="o">=</span> <span class="n">u_sol</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">C1</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="n">C1</span><span class="p">])</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="n">C2</span><span class="p">])</span>
<span class="k">print</span> <span class="n">u_sol</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">u_sol</span></code> variable is now <code class="docutils literal"><span class="pre">I*cos(t*w)</span> <span class="pre">+</span> <span class="pre">V*sin(t*w)/w</span></code>.
Since symbolic software is far from bug-free and can give wrong results,
we should always check the answer. Here, we insert the solution in the ODE
to see if the result is zero, and we insert the solution in the initial
conditions to see that these are fulfilled:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Check that the solution fulfills the ODE and init.cond.</span>
<span class="k">print</span> <span class="n">simplify</span><span class="p">(</span><span class="n">ode</span><span class="p">(</span><span class="n">u_sol</span><span class="p">)),</span>
<span class="k">print</span> <span class="n">u_sol</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="p">,</span> <span class="n">diff</span><span class="p">(</span><span class="n">u_sol</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span>
</pre></div>
</div>
<p>There will be many more examples on using SymPy to find exact solutions
of differential equation problems.</p>
<p>The solution of the ODE in mathematical notation is</p>
<div class="math">
\[u(t) = I\cos(\omega t) + \frac{V}{\omega}\sin(\omega t),\quad \omega = \sqrt{\frac{k}{m}}{\thinspace .}\]</div>
<p>More insight arises from rewriting such an expression in the form
<span class="math">\(A\cos(wt - \phi)\)</span>:</p>
<div class="math">
\[u(t) = \sqrt{I^2 + \frac{V^2}{\omega^2}}\cos(wt - \phi),\quad
\phi = \tan^{-1}(V/(\omega I)){\thinspace .}\]</div>
<p>Now we see that the <span class="math">\(u\)</span> corresponds to cosine oscillations with a
phase shift <span class="math">\(\phi\)</span> and amplitude <span class="math">\(\sqrt{I^2 + (V/\omega)^2}\)</span>.</p>
</div>
<div class="section" id="discussion-of-the-displacement-scale">
<h3>Discussion of the displacement scale<a class="headerlink" href="#discussion-of-the-displacement-scale" title="Permalink to this headline">¶</a></h3>
<p>The amplitude of <span class="math">\(u\)</span> is <span class="math">\(\sqrt{I^2 + V^2/\omega^2}\)</span>, and this
expression is obviously a candidate for <span class="math">\(u_c\)</span>.  However, the simpler
choice <span class="math">\(u_c=\max (I, V/\omega)\)</span> is also relevant and more attractive
than the square root expression (but potentially a factor 1.4 wrong
compared to the exact amplitude).  It is not very important to have
<span class="math">\(|u|\leq 1\)</span>, the point is to avoid <span class="math">\(|u|\)</span> very small or large.</p>
</div>
<div class="section" id="discussion-of-the-time-scale-2">
<h3>Discussion of the time scale<a class="headerlink" href="#discussion-of-the-time-scale-2" title="Permalink to this headline">¶</a></h3>
<p>What is an appropriate time scale? Looking at
<a class="reference internal" href="#eq-sec-scale-vib-undamped-model-scaled0"><span class="std std-ref">(65)</span></a> and arguing that
<span class="math">\(\bar u''\)</span> and <span class="math">\(\bar u\)</span> both should be around unity in size, the
coefficient <span class="math">\(t_c^2k/m\)</span> must equal unity, implying that <span class="math">\(t_c=\sqrt{m/k}\)</span>.
Also from the analytical solution we see that the solution goes like the
sine or cosine of <span class="math">\(\omega t\)</span> so <span class="math">\(1/\omega = \sqrt{m/k}\)</span> can be a characteristic
time scale. Likewise, one period of the oscillations, <span class="math">\(P=2\pi/\omega\)</span> can
be the characteristic time, leading to <span class="math">\(t_c=2\pi/\omega\)</span>.</p>
</div>
<div class="section" id="the-dimensionless-solution">
<h3>The dimensionless solution<a class="headerlink" href="#the-dimensionless-solution" title="Permalink to this headline">¶</a></h3>
<p>With <span class="math">\(u_c=I\)</span> and <span class="math">\(t_c=\sqrt{m/k}\)</span> we get the scaled model</p>
<div class="math" id="eq-sec-scale-vib-undamped-model-scaled1">
\[\tag{66}
\frac{d^2\bar u}{d\bar t^2} + \bar u = 0,
    \quad \bar u(0)=1,\ \bar u'(0)=\alpha,\]</div>
<p>where <span class="math">\(\alpha\)</span> is a dimensionless parameter:</p>
<div class="math">
\[\alpha = \frac{V}{I}\sqrt{\frac{m}{k}}{\thinspace .}\]</div>
<p>Note that in case <span class="math">\(V=0\)</span>, we have &#8220;scaled away&#8221; all physical parameters.
The universal solution without physical parameters is then
<span class="math">\(\bar u(\bar t)=\cos\bar t\)</span>.</p>
<p>The unscaled solution is recovered as</p>
<div class="math" id="eq-auto13">
\[\tag{67}
u(t) = I\bar u(\sqrt{k/m}\bar t){\thinspace .}\]</div>
<p>This expressions shows that the scaling is simply a matter of
<em>stretching or shrinking the axes</em>.</p>
</div>
<div class="section" id="alternative-displacement-scale">
<h3>Alternative displacement scale<a class="headerlink" href="#alternative-displacement-scale" title="Permalink to this headline">¶</a></h3>
<p>Using <span class="math">\(u_c = V/\omega\)</span>, the equation
is not changed, but the initial conditions become</p>
<div class="math">
\[\bar u(0) = \frac{I}{u_c} = \frac{I\omega}{V} =\frac{I}{V}\sqrt{\frac{k}{m}} = \alpha^{-1},\quad \bar u'(0)=1{\thinspace .}\]</div>
<p>With <span class="math">\(u_c=V/\omega\)</span> and one period as time scale,
<span class="math">\(t_c=2\pi\sqrt{m/k}\)</span>,
we get the alternative model</p>
<div class="math" id="eq-sec-scale-vib-undamped-model-scaled2">
\[\tag{68}
\frac{d^2\bar u}{d\bar t^2} + 4\pi^2 \bar u = 0,
    \quad \bar u(0)=\alpha^{-1},\ \bar u'(0)=2\pi{\thinspace .}\]</div>
<p>The unscaled solution is in this case recovered by</p>
<div class="math" id="eq-auto14">
\[\tag{69}
u(t) = V\sqrt{\frac{m}{k}}\bar u(2\pi\sqrt{k/m}\bar t){\thinspace .}\]</div>
<span class="target" id="index-0"></span><span class="target" id="index-1"></span><span class="target" id="index-2"></span><span class="target" id="index-3"></span></div>
<div class="section" id="about-frequency-and-dimensions">
<span id="index-4"></span><h3>About frequency and dimensions<a class="headerlink" href="#about-frequency-and-dimensions" title="Permalink to this headline">¶</a></h3>
<p>The solution goes like <span class="math">\(\cos\omega t\)</span>, where <span class="math">\(\omega =\sqrt{m/k}\)</span>
must have dimension 1/s. Actually, <span class="math">\(\omega\)</span> has dimension <em>radians
per second</em>: rad/s. A radian is dimensionless since it is arc (length)
divided by radius (length), but still regarded as a unit.
The period <span class="math">\(P\)</span> of vibrations is a more intuitive quantity than the frequency
<span class="math">\(\omega\)</span>. The relation between <span class="math">\(P\)</span> and <span class="math">\(\omega\)</span> is <span class="math">\(P=2\pi/\omega\)</span>.
The number of oscillation cycles per period, <span class="math">\(f\)</span>, is a more intuitive
measurement of frequency and also known as <em>frequency</em>. Therefore, to be
precise, <span class="math">\(\omega\)</span> should be named <em>angular frequency</em>. The relation between
<span class="math">\(f\)</span> and <span class="math">\(T\)</span> is <span class="math">\(f=1/T\)</span>, so <span class="math">\(f=2\pi\omega\)</span> and measured in Hz (1/s), which is
the unit for counts per unit time.</p>
</div>
</div>
<div class="section" id="undamped-vibrations-with-constant-forcing">
<span id="sec-scale-vib-undamped-mg"></span><h2>Undamped vibrations with constant forcing<a class="headerlink" href="#undamped-vibrations-with-constant-forcing" title="Permalink to this headline">¶</a></h2>
<p>For vertical vibrations in the gravity field, the model
<a class="reference internal" href="#eq-sec-scale-vib-undamped-model"><span class="std std-ref">(64)</span></a> must also take the gravity force
<span class="math">\(-mg\)</span> into account:</p>
<div class="math">
\[mu'' + ku = -mg{\thinspace .}\]</div>
<p>How does the new term <span class="math">\(-mg\)</span> influence
the scaling? We observe that if there is no movement of the body,
<span class="math">\(u''=0\)</span>, and the spring elongation matches the gravity force:
<span class="math">\(ku = -mg\)</span>, leading to a steady displacement <span class="math">\(u=-mg/k\)</span>. We can then
have oscillations around this equilibrium point. A natural scaling
for <span class="math">\(u\)</span> is therefore</p>
<div class="math">
\[\bar u = \frac{u - (-mg/k)}{u_c}=\frac{uk + mg}{ku_c}{\thinspace .}\]</div>
<p>The scaled differential equation with the same time scale as before
reads</p>
<div class="math">
\[\frac{d^2\bar u}{d\bar t^2} + \bar u - \frac{t_c^2}{u_c}g
= -\frac{t_c^2}{u_c}g,\]</div>
<p>leading to</p>
<div class="math">
\[\frac{d^2\bar u}{d\bar t^2} + \bar u = 0{\thinspace .}\]</div>
<p>The initial conditions <span class="math">\(u(0)=I\)</span> and <span class="math">\(u'(0)=V\)</span> become, with <span class="math">\(u_c=I\)</span>,</p>
<div class="math">
\[\bar u(0) = 1 + \frac{mg}{kI},\quad \frac{d\bar u}{d\bar t}(0)=\sqrt{\frac{m}{k}}\frac{V}{I}{\thinspace .}\]</div>
<p>We see that the oscillations around the equilibrium point in the
gravity field are identical to the horizontal oscillations without
gravity, except for an offset <span class="math">\(mg/(kI)\)</span> in the displacement.</p>
</div>
<div class="section" id="undamped-vibrations-with-time-dependent-forcing">
<span id="sec-scale-vib-undamped-f"></span><h2>Undamped vibrations with time-dependent forcing<a class="headerlink" href="#undamped-vibrations-with-time-dependent-forcing" title="Permalink to this headline">¶</a></h2>
<p>Now we add a transient forcing term <span class="math">\(F(t)\)</span> to the model
<a class="reference internal" href="#eq-sec-scale-vib-undamped-model"><span class="std std-ref">(64)</span></a>:</p>
<div class="math" id="eq-sec-scale-vib-undamped-f-model">
\[\tag{70}
mu'' + ku = F(t),\quad u(0)=I,\ u'(0)=V{\thinspace .}\]</div>
<p>Take the forcing to be oscillating:</p>
<div class="math">
\[F(t) = A\cos(\psi t){\thinspace .}\]</div>
<p>The technical steps of the scaling are still the same, with the
intermediate result</p>
<div class="math" id="eq-sec-scale-vib-undamped-f-model-scaled0">
\[\tag{71}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c^2 k}{m}\bar u =
    \frac{t_c^2}{mu_c}A\cos(\psi t_c\bar t),
    \quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}{\thinspace .}\]</div>
<p>What are typical displacement and time scales? This is not so obvious
without knowing the details of the solution, because there are
three parameters (<span class="math">\(I\)</span>, <span class="math">\(V\)</span>, and <span class="math">\(A\)</span>) that influence the magnitude of <span class="math">\(u\)</span>.
Moreover, there are two time scales, one for the free vibrations of
the systems and one for the forced vibrations <span class="math">\(F(t)\)</span>.</p>
<div class="section" id="investigating-scales-via-analytical-solutions">
<h3>Investigating scales via analytical solutions<a class="headerlink" href="#investigating-scales-via-analytical-solutions" title="Permalink to this headline">¶</a></h3>
<p>We may look into the exact solution to see what the scales are.  We
continue the SymPy session from the previous section and perform much
of the same steps. Note that we use <code class="docutils literal"><span class="pre">w</span></code> for <span class="math">\(\omega = \sqrt{k/m}\)</span>
in the computer code (to obtain a more direct visual counterpart to
<span class="math">\(\omega\)</span>).
SymPy may get confused when coefficients in differential equations
contain several symbols. We therefore rewrite the equation with
at most one symbol in each coefficient.
The amplitude <span class="math">\(A/m\)</span> in the forcing term is of this reason
replaced by the symbol <code class="docutils literal"><span class="pre">A1</span></code>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">A</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">psi</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s">&#39;A A1 m psi&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">ode</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">diff</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span> <span class="o">-</span> <span class="n">A1</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="n">diffeq</span> <span class="o">=</span> <span class="n">ode</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">u_sol</span> <span class="o">=</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">diffeq</span><span class="p">,</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">u_sol</span> <span class="o">=</span> <span class="n">u_sol</span><span class="o">.</span><span class="n">rhs</span>

<span class="c"># Determine the constants C1 and C2 in u_sol</span>
<span class="c"># (first substitute our own declared C1 and C2 symbols,</span>
<span class="c"># then use the initial conditions)</span>
<span class="n">u_sol</span> <span class="o">=</span> <span class="n">u_sol</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="s">&#39;C1&#39;</span><span class="p">,</span> <span class="n">C1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="s">&#39;C2&#39;</span><span class="p">,</span> <span class="n">C2</span><span class="p">)</span>
<span class="n">eqs</span> <span class="o">=</span> <span class="p">[</span><span class="n">u_sol</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="p">,</span> <span class="n">u_sol</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">]</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">eqs</span><span class="p">,</span> <span class="p">[</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">])</span>
<span class="n">u_sol</span> <span class="o">=</span> <span class="n">u_sol</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">C1</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="n">C1</span><span class="p">])</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="n">C2</span><span class="p">])</span>

<span class="c"># Check that the solution fulfills the equation and init.cond.</span>
<span class="k">print</span> <span class="n">simplify</span><span class="p">(</span><span class="n">ode</span><span class="p">(</span><span class="n">u_sol</span><span class="p">))</span>
<span class="k">print</span> <span class="n">simplify</span><span class="p">(</span><span class="n">u_sol</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="p">)</span>
<span class="k">print</span> <span class="n">simplify</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">u_sol</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">)</span>

<span class="n">u_sol</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">expand</span><span class="p">(</span><span class="n">u_sol</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A</span><span class="o">/</span><span class="n">m</span><span class="p">)))</span>
<span class="k">print</span> <span class="n">u_sol</span>
</pre></div>
</div>
<p>The output from the last line is</p>
<div class="highlight-text"><div class="highlight"><pre>A/m*cos(psi*t)/(-psi**2 + w**2) + V*sin(t*w)/w +
(A/m + I*psi**2 - I*w**2)*cos(t*w)/(psi**2 - w**2)
</pre></div>
</div>
<p>With a bit of rewrite this expression becomes</p>
<div class="math">
\[u(t) = \frac{A/m}{\omega^2 - \psi^2}\cos(\psi t) + \frac{V}{\omega}
   \sin(\omega t) +
\left(\frac{A/m}{\psi^2 - \omega^2} + I\right) \cos (\omega t){\thinspace .}\]</div>
<p>Obviously, this expression is only meaningful for <span class="math">\(\psi\neq\omega\)</span>. The
case <span class="math">\(\psi = \omega\)</span> gives an infinite amplitude in this model, a
phenomenon known as resonance. The amplitude becomes finite when
damping is included,
see the section <a class="reference internal" href="#sec-scale-vib-damped-f"><span class="std std-ref">Damped vibrations with forcing</span></a>.</p>
<p>For the case the system starts from rest, <span class="math">\(I=V=0\)</span>, and the
forcing is the only driving mechanism, we can simplify:</p>
<div class="math">
\[\begin{split}u(t) &amp;= \frac{A}{m(\omega^2 - \psi^2)}\cos(\psi t)
+
\frac{A}{m(\psi^2 - \omega^2)}\cos (\omega t)\\
&amp;= \frac{A}{m(\omega^2 - \psi^2)}(\cos(\psi t) - \cos(\omega t)){\thinspace .}\end{split}\]</div>
<p>To gain more insight, <span class="math">\(\cos(\psi t) - \cos(\omega t)\)</span> can be
rewritten in terms of the mean frequency <span class="math">\((\psi + \omega)/2\)</span> and
the difference in frequency <span class="math">\((\psi - \omega)/2\)</span>:</p>
<div class="math" id="eq-sec-scale-vib-undamped-f-model-sinsin">
\[\tag{72}
u(t) = \frac{A}{m(\omega^2 - \psi^2)} 2
    \sin\left(\frac{\psi - \omega}{2}t\right)
    \sin\left(\frac{\psi + \omega}{2}t\right),\]</div>
<p>showing that there is a signal with frequency <span class="math">\((\psi + \omega)/2\)</span>
whose amplitude has a (much) slower frequency
<span class="math">\((\psi - \omega)/2\)</span>. Figure <a class="reference internal" href="#sec-scale-vib-fig-envelope"><span class="std std-ref">Signal with frequency 3.1 and envelope frequency 0.2</span></a> shows
an example on such a signal.</p>
<div class="figure" id="id4">
<span id="sec-scale-vib-fig-envelope"></span><a class="reference internal image-reference" href="_images/envelope.png"><img alt="_images/envelope.png" src="_images/envelope.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><em>Signal with frequency 3.1 and envelope frequency 0.2</em></span></p>
</div>
</div>
<div class="section" id="the-displacement-and-time-scales">
<h3>The displacement and time scales<a class="headerlink" href="#the-displacement-and-time-scales" title="Permalink to this headline">¶</a></h3>
<p>A characteristic displacement can in the latter special case
be taken as <span class="math">\(u_c= A/(m(\omega^2 - \psi^2))\)</span>. This is also a relevant choice
in the more general case <span class="math">\(I\neq0, V\neq 0\)</span>, unless <span class="math">\(I\)</span> or <span class="math">\(V\)</span>
is so large that it dominates over the amplitude
caused by the forcing. With <span class="math">\(u_c= A/(m(\omega^2 - \psi^2))\)</span> we also
have three special cases: <span class="math">\(\omega \ll \psi\)</span>, <span class="math">\(\omega \gg\psi\)</span>, and
<span class="math">\(\psi \sim \omega\)</span>. In the latter case we need
<span class="math">\(u_c= A/(m(\omega^2 - \psi^2))\)</span> if we want <span class="math">\(|u|\leq 1\)</span>. When
<span class="math">\(\omega\)</span> and <span class="math">\(\psi\)</span> are significantly different, we may choose one
of them and neglect the smaller. Choosing <span class="math">\(\omega\)</span> means <span class="math">\(u_c=A/k\)</span>,
which is the relevant scale
if <span class="math">\(\omega\gg\psi\)</span>. In the opposite case, <span class="math">\(\omega\ll\psi\)</span>,
<span class="math">\(u_c=A/(m\psi^2)\)</span>.</p>
<p>The time scale is dominated by the fastest oscillations, which are
of frequency <span class="math">\(\psi\)</span> or <span class="math">\(\omega\)</span> when these are close and the largest
of them when they are distant. In any case, we set
<span class="math">\(t_c=1/\max(\psi,\omega)\)</span>.</p>
</div>
<div class="section" id="finding-the-displacement-scale-from-the-differential-equation">
<h3>Finding the displacement scale from the differential equation<a class="headerlink" href="#finding-the-displacement-scale-from-the-differential-equation" title="Permalink to this headline">¶</a></h3>
<p>Going back to <a class="reference internal" href="#eq-sec-scale-vib-undamped-f-model-scaled0"><span class="std std-ref">(71)</span></a>, we
may demand that all the three terms in the differential equation
are of size unity. This leads to <span class="math">\(t_c=\sqrt{m/k}\)</span>
and <span class="math">\(u_c=At_c^2/m = A/k\)</span>. The formula for <span class="math">\(u_c\)</span> is a kind of measure
of the ratio of the
forcing and the spring force (the dimensionless number
<span class="math">\(A/(ku_c)\)</span> would be this ratio).</p>
<p>Looking at <a class="reference internal" href="#eq-sec-scale-vib-undamped-f-model-sinsin"><span class="std std-ref">(72)</span></a>, we see
that if <span class="math">\(\psi\ll\omega\)</span>, the amplitude can be approximated
by <span class="math">\(A/(m\omega^2)=A/k\)</span>, showing that the scale <span class="math">\(u_c=A/k\)</span> is
relevant for small excitation frequency <span class="math">\(\psi\)</span> compared to
the free vibration frequency <span class="math">\(\omega\)</span>.</p>
</div>
<div class="section" id="scaling-with-free-vibrations-as-time-scale">
<h3>Scaling with free vibrations as time scale<a class="headerlink" href="#scaling-with-free-vibrations-as-time-scale" title="Permalink to this headline">¶</a></h3>
<p>The next step is to work out the dimensionless ODE for the chosen scales.
We first select the time scale based on the free oscillations
with frequency <span class="math">\(\omega\)</span>, i.e., <span class="math">\(t_c=1/\omega\)</span>. Inserting the expression in
<a class="reference internal" href="#eq-sec-scale-vib-undamped-f-model-scaled0"><span class="std std-ref">(71)</span></a> results in</p>
<div class="math" id="eq-sec-scale-vib-undamped-f-model-scaled2">
\[\tag{73}
\frac{d^2\bar u}{d\bar t^2} + \bar u =
    \gamma
    \cos(\delta\bar t),
    \quad \bar u(0)=\alpha,\ \bar u'(0)=\beta{\thinspace .}\]</div>
<p>Here we have four dimensionless variables</p>
<div class="math" id="eq-auto15">
\[\tag{74}
\alpha = \frac{I}{u_c},\]</div>
<div class="math" id="eq-auto16">
\[\tag{75}
\beta  = \frac{Vt_c}{u_c} = \frac{V}{\omega u_c},\]</div>
<div class="math" id="eq-auto17">
\[\tag{76}
\gamma = \frac{t_c^2 A}{mu_c} = \frac{A}{ku_c},\]</div>
<div class="math" id="eq-auto18">
\[\tag{77}
\delta = \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega}{\thinspace .}\]</div>
<p>These dimensionless variables have interpretations as ratios of
physical effects:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(\alpha\)</span>: ratio of the initial displacement and
the typical displacement <span class="math">\(u_c\)</span>,</li>
<li><span class="math">\(\beta\)</span>: ratio of the initial velocity
and the typical velocity measure <span class="math">\(u_c/t_c\)</span>,</li>
<li><span class="math">\(\gamma\)</span>: ratio of
the forcing <span class="math">\(A\)</span> and the mass times acceleration <span class="math">\(mu_c/t_c^2\)</span> <em>or</em>
the ratio of the forcing and the spring force <span class="math">\(ku_c\)</span></li>
<li><span class="math">\(\delta\)</span>: ratio of the
frequencies or the time scales of the forcing and the free vibrations.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="software-5">
<h3>Software<a class="headerlink" href="#software-5" title="Permalink to this headline">¶</a></h3>
<p>Any solver for <a class="reference internal" href="#eq-sec-scale-vib-undamped-f-model-scaled0"><span class="std std-ref">(71)</span></a>
can be used for <a class="reference internal" href="#eq-sec-scale-vib-undamped-f-model-scaled2"><span class="std std-ref">(73)</span></a>.
More details are provided at the end of
the section <a class="reference internal" href="#sec-scale-vib-damped-f"><span class="std std-ref">Damped vibrations with forcing</span></a>.</p>
</div>
<div class="section" id="choice-of-close-to-resonance">
<h3>Choice of <span class="math">\(u_c\)</span> close to resonance<a class="headerlink" href="#choice-of-close-to-resonance" title="Permalink to this headline">¶</a></h3>
<p>We have chosen not to specify <span class="math">\(u_c\)</span> in the formulas above. Now we shall
discuss various choices of <span class="math">\(u_c\)</span>.
Close to resonance, when <span class="math">\(\psi\sim\omega\)</span>, we may set
<span class="math">\(u_c=A/(m(\omega^2 - \psi^2))\)</span>. The dimensionless numbers
become in this case</p>
<div class="math">
\[\begin{split}\alpha &amp;= \frac{I}{u_c} = \frac{I}{A/k}(1-\delta^2),\\
\beta  &amp;= \frac{V}{\omega u_c} = \frac{V\sqrt{km}}{A}(1-\delta^2),\\
\gamma &amp;= \frac{A}{ku_c} = 1-\delta^2,\\
\delta &amp;= \frac{\psi}{\omega}{\thinspace .}\end{split}\]</div>
<p>With <span class="math">\(\psi = 0.99\omega\)</span>, <span class="math">\(\delta =0.99\)</span>, <span class="math">\(V=0\)</span>,
<span class="math">\(\alpha = \gamma = 1-\delta^2 = 0.02\)</span>, we have the problem</p>
<div class="math">
\[\frac{d^2\bar u}{d\bar t^2} + \bar u =
0.02 \cos(0.99\bar t),
\quad \bar u(0)=0.02,\ \bar u'(0)=0{\thinspace .}\]</div>
<p>This is a problem with a very small initial condition and a very small
forcing, but the state close to resonance brings the amplitude up to
about unity, see the result of numerical simulations with <span class="math">\(\delta=0.99\)</span> in
Figure <a class="reference internal" href="#sec-scale-vib-fig-fcos-b0-1"><span class="std std-ref">Forced undamped vibrations close to resonance</span></a>.
Neglecting <span class="math">\(\alpha\)</span>,
the solution is given by <a class="reference internal" href="#eq-sec-scale-vib-undamped-f-model-sinsin"><span class="std std-ref">(72)</span></a>,
which here means <span class="math">\(A=1-\delta^2\)</span>, <span class="math">\(m=1\)</span>, <span class="math">\(\omega=1\)</span>, <span class="math">\(\psi=\delta\)</span>:</p>
<div class="math">
\[\bar u(\bar t) = 2\sin(-0.005\bar t)\sin(0.995\bar t){\thinspace .}\]</div>
<p>Note that this is a problem which demands very high accuracy in the
numerical calculations. Using 20 time steps per period gives a
significant angular frequency error and an amplitude of about 1.4. We used
160 steps per period for the results in
Figure <a class="reference internal" href="#sec-scale-vib-fig-fcos-b0-1"><span class="std std-ref">Forced undamped vibrations close to resonance</span></a>.</p>
<div class="figure" id="id5">
<span id="sec-scale-vib-fig-fcos-b0-1"></span><a class="reference internal image-reference" href="_images/vib_delta099_b0_Fcos.png"><img alt="_images/vib_delta099_b0_Fcos.png" src="_images/vib_delta099_b0_Fcos.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><em>Forced undamped vibrations close to resonance</em></span></p>
</div>
</div>
<div class="section" id="unit-size-of-all-terms-in-the-ode">
<h3>Unit size of all terms in the ODE<a class="headerlink" href="#unit-size-of-all-terms-in-the-ode" title="Permalink to this headline">¶</a></h3>
<p>Using the displacement scale <span class="math">\(u_c=A/k\)</span> leads to
<a class="reference internal" href="#eq-sec-scale-vib-undamped-f-model-scaled2"><span class="std std-ref">(73)</span></a> with</p>
<div class="math">
\[\begin{split}\alpha &amp;= \frac{I}{u_c} = \frac{I}{A/k},\\
\beta  &amp;= \frac{V}{\omega u_c} = \frac{V k}{A\omega},\\
\gamma &amp;= \frac{A}{ku_c} = 1,\\
\delta &amp;= \frac{\psi}{\omega}{\thinspace .}\end{split}\]</div>
<p>Simulating a case with <span class="math">\(\delta=0.5\)</span>, <span class="math">\(\alpha=1\)</span>, and <span class="math">\(\beta=0\)</span> gives
the oscillations in Figure <a class="reference internal" href="#sec-scale-vib-fig-fcos-b0-2"><span class="std std-ref">Forced undamped vibrations away from resonance</span></a>, which is
a case away from resonance, and the amplitude is about unity. However,
choosing <span class="math">\(\delta =0.99\)</span> (close to resonance) results in a figure
similar to Figure <a class="reference internal" href="#sec-scale-vib-fig-fcos-b0-1"><span class="std std-ref">Forced undamped vibrations close to resonance</span></a>, except that the
amplitude is about <span class="math">\(10^2\)</span> because of the moderate size of <span class="math">\(u_c\)</span>.
The present scaling is therefore most suitable away from resonance,
and when the terms containing <span class="math">\(\cos\omega t\)</span> and <span class="math">\(\sin\omega t\)</span>
are important (e.g., <span class="math">\(\omega\gg\psi\)</span>).</p>
<div class="figure" id="id6">
<span id="sec-scale-vib-fig-fcos-b0-2"></span><a class="reference internal image-reference" href="_images/vib_delta05_b0_Fcos.png"><img alt="_images/vib_delta05_b0_Fcos.png" src="_images/vib_delta05_b0_Fcos.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><em>Forced undamped vibrations away from resonance</em></span></p>
</div>
</div>
<div class="section" id="choice-of-when">
<h3>Choice of <span class="math">\(u_c\)</span> when <span class="math">\(\psi\gg\omega\)</span><a class="headerlink" href="#choice-of-when" title="Permalink to this headline">¶</a></h3>
<p>Finally, we may look at the case where <span class="math">\(\psi\gg\omega\)</span> such that
<span class="math">\(u_c=A/(m\psi^2)\)</span> is a relevant scale (i.e., omitting <span class="math">\(\omega^2\)</span> compared to
<span class="math">\(\psi^2\)</span> in the denominator), but in this case we should
use <span class="math">\(t_c=1/\psi\)</span> since the force varies much faster than the
free vibrations of the system.
This choice of <span class="math">\(t_c\)</span> changes the scaled ODE to</p>
<div class="math" id="eq-sec-scale-vib-undamped-f-model-scaled6">
\[\tag{78}
\frac{d^2\bar u}{d\bar t^2} + \delta^{-2}\bar u =
    \gamma
    \cos(\bar t),
    \quad \bar u(0)=\alpha,\ \bar u'(0)=\beta,\]</div>
<p>where</p>
<div class="math">
\[\begin{split}\alpha &amp;= \frac{I}{u_c} = \frac{I}{A/k}\delta^2,\\
\beta  &amp;= \frac{Vt_c}{u_c} = \frac{V\sqrt{km}}{A}\delta,\\
\gamma &amp;= \frac{t_c^2 A}{mu_c} = 1,\\
\delta &amp;= \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega}{\thinspace .}\end{split}\]</div>
<p>In the regime <span class="math">\(\psi\gg\omega\)</span>, <span class="math">\(\delta\gg 1\)</span>, thus making <span class="math">\(\alpha\)</span> and
<span class="math">\(\beta\)</span> large.
However, if <span class="math">\(\alpha\)</span> and/or <span class="math">\(\beta\)</span> is large,
the initial condition dominates over the forcing, and will also dominate
the amplitude of <span class="math">\(u\)</span>, thereby making the scaling of <span class="math">\(u\)</span> inappropriate.
In case <span class="math">\(I=V=0\)</span> so that <span class="math">\(\alpha=\beta=0\)</span>,
<a class="reference internal" href="#eq-sec-scale-vib-undamped-f-model-sinsin"><span class="std std-ref">(72)</span></a> predicts
(<span class="math">\(A=m=1\)</span>, <span class="math">\(\omega=\delta^{-1}\)</span>, <span class="math">\(\psi=1\)</span>)</p>
<div class="math">
\[\bar u(\bar t) = (\delta^{-2}-1)^{-1}2
\sin\left(\frac{1}{2}(1 -\delta^{-1})\bar t\right)
\sin\left(\frac{1}{2}(1 +\delta^{-1})\bar t\right),\]</div>
<p>which has an amplitude about <span class="math">\(2\)</span> for <span class="math">\(\delta\gg 1\)</span>.
Figure <a class="reference internal" href="#sec-scale-vib-fig-fcos-b0-3"><span class="std std-ref">Forced undamped vibrations with rapid forcing</span></a> shows
numerical simulations with 160 time steps per period of <span class="math">\(F(t)\)</span>.</p>
<div class="figure" id="id7">
<span id="sec-scale-vib-fig-fcos-b0-3"></span><a class="reference internal image-reference" href="_images/vib_delta10_b0_Fcos.png"><img alt="_images/vib_delta10_b0_Fcos.png" src="_images/vib_delta10_b0_Fcos.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><em>Forced undamped vibrations with rapid forcing</em></span></p>
</div>
<p>With <span class="math">\(\alpha=0.05\delta^2=5\)</span>, we get a significant contribution from
the free vibrations (the homogeneous solution of the ODE) as
shown in Figure <a class="reference internal" href="#sec-scale-vib-fig-fcos-b0-4"><span class="std std-ref">Forced undamped vibrations with rapid forcing and initial displacement of 5</span></a>. For larger <span class="math">\(\alpha\)</span>
values, one must base <span class="math">\(u_c\)</span> on <span class="math">\(I\)</span> instead.</p>
<div class="figure" id="id8">
<span id="sec-scale-vib-fig-fcos-b0-4"></span><a class="reference internal image-reference" href="_images/vib_delta10_b0_a5_Fcos.png"><img alt="_images/vib_delta10_b0_a5_Fcos.png" src="_images/vib_delta10_b0_a5_Fcos.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text"><em>Forced undamped vibrations with rapid forcing and initial displacement of 5</em></span></p>
</div>
</div>
<div class="section" id="displacement-scale-based-on">
<h3>Displacement scale based on <span class="math">\(I\)</span><a class="headerlink" href="#displacement-scale-based-on" title="Permalink to this headline">¶</a></h3>
<p>Choosing <span class="math">\(u_c=I\)</span> gives</p>
<div class="math" id="eq-sec-scale-vib-undamped-f-model-scaled5">
\[\tag{79}
\frac{d^2\bar u}{d\bar t^2} + \bar u =
    \gamma\cos(\delta\bar t),
    \quad \bar u(0)=1,\ \bar u'(0)=\beta,\]</div>
<p>with</p>
<div class="math" id="eq-auto19">
\[\tag{80}
\beta  = \frac{Vt_c}{u_c} = \frac{V}{I}\sqrt\frac{{m}{k}},\]</div>
<div class="math" id="eq-auto20">
\[\tag{81}
\gamma  = \frac{tc^2A}{mu_c} = \frac{A}{ku_c} = \frac{A}{kI} {\thinspace .}\]</div>
<p>This scaling is not relevant close to resonance since then <span class="math">\(u_c\gg I\)</span>.</p>
</div>
</div>
<div class="section" id="damped-vibrations-with-forcing">
<span id="sec-scale-vib-damped-f"></span><h2>Damped vibrations with forcing<a class="headerlink" href="#damped-vibrations-with-forcing" title="Permalink to this headline">¶</a></h2>
<p>We now introduce a linear damping force <span class="math">\(bu'(t)\)</span> in the equation of motion:</p>
<div class="math" id="eq-sec-scale-vib-damped-f-model">
\[\tag{82}
mu'' + bu' + ku = A\cos(\psi t),\quad u(0)=I,\ u'(0)=V{\thinspace .}\]</div>
<p>Figure <a class="reference internal" href="#sec-scale-vib-damped-sketch"><span class="std std-ref">Oscillating body with external force, attached to a spring and damper</span></a> shows a typical
one-degree-of-freedom mechanical system with a linear dashpot, representing
the damper (<span class="math">\(bu'\)</span>), a linear spring (<span class="math">\(ku\)</span>), and an external force (<span class="math">\(F\)</span>).</p>
<div class="figure" id="id9">
<span id="sec-scale-vib-damped-sketch"></span><a class="reference internal image-reference" href="_images/oscillator.png"><img alt="_images/oscillator.png" src="_images/oscillator.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text"><em>Oscillating body with external force, attached to a spring and damper</em></span></p>
</div>
<p>The standard scaling procedure results in</p>
<div class="math" id="eq-sec-scale-vib-damped-f-model-scaled0">
\[\tag{83}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c b}{m}\frac{d\bar u}{d\bar t}
    + \frac{t_c^2 k}{m}\bar u =
    \frac{t_c^2}{mu_c}A\cos(\psi t_c\bar t),
    \quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}{\thinspace .}\]</div>
<div class="section" id="the-exact-solution-2">
<h3>The exact solution<a class="headerlink" href="#the-exact-solution-2" title="Permalink to this headline">¶</a></h3>
<p>To choose scales, it is (as always)
a great advantage to look into exact solutions.
Using SymPy to solve <a class="reference internal" href="#eq-sec-scale-vib-damped-f-model"><span class="std std-ref">(82)</span></a> turns out
to be difficult, because with damping, we have three solutions
of <a class="reference internal" href="#eq-sec-scale-vib-damped-f-model"><span class="std std-ref">(82)</span></a>, and for vibrations we are
only interested in one of them, the one with damped oscillations.
So we have to drop <code class="docutils literal"><span class="pre">dsolve</span></code> and perform manual steps, either by
hand or with the aid of SymPy. The solution is composed of a homogeneous
solution <span class="math">\(u_h\)</span> of <span class="math">\(mu'' + bu' + ku=0\)</span> and one particular solution <span class="math">\(u_p\)</span>
of the nonhomogeneous equation
<span class="math">\(mu'' + bu' + ku=A\cos(\psi t)\)</span>. The homogeneous solution with
damped oscillations (requiring <span class="math">\(b &lt; 2\sqrt{mk}\)</span>) can be
found by the following code. We have divided the differential equation
by <span class="math">\(m\)</span> and introduced <span class="math">\(B=\frac{1}{2}b/m\)</span> and let <code class="docutils literal"><span class="pre">A1</span></code> represent
<span class="math">\(A/m\)</span> to simplify expressions and
help SymPy with less symbols in the equation (without these simplifications,
SymPy stalls in the computations due to too many symbols in the equation).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">u</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">cls</span><span class="o">=</span><span class="n">Function</span><span class="p">)</span>
<span class="n">t</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">A1</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">psi</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s">&#39;t w B A A1 m psi&#39;</span><span class="p">,</span>
                                 <span class="n">positive</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ode</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">homogeneous</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">A1</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">h</span> <span class="k">if</span> <span class="n">homogeneous</span> <span class="k">else</span> <span class="n">h</span> <span class="o">-</span> <span class="n">f</span>

<span class="c"># Find coefficients in polynomial (in r) for exp(r*t) ansatz</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ansatz</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">ode</span><span class="p">(</span><span class="n">ansatz</span><span class="p">)</span><span class="o">/</span><span class="n">ansatz</span><span class="p">)</span>

<span class="c"># Convert to polynomial to extract coefficients</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="c"># Extract coefficients in poly: a_*t**2 + b_*t + c_</span>
<span class="n">a_</span><span class="p">,</span> <span class="n">b_</span><span class="p">,</span> <span class="n">c_</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="c"># Assume b_**2 - 4*a_*c_ &lt; 0</span>
<span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="n">b_</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a_</span><span class="p">)</span>
<span class="k">if</span> <span class="n">a_</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">c_</span> <span class="o">-</span> <span class="p">(</span><span class="n">b_</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c"># nicer formula</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">a_</span><span class="o">*</span><span class="n">c_</span> <span class="o">-</span> <span class="n">b_</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a_</span><span class="p">)</span>

<span class="c"># The homogeneous solution is a linear combination of a</span>
<span class="c"># cos term (u1) and a sin term (u2)</span>
<span class="n">u1</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">u2</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s">&#39;C1 C2 V I&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">u_h</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">C1</span><span class="o">*</span><span class="n">u1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">u2</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&#39;u_h:&#39;</span><span class="p">,</span> <span class="n">u_h</span>
</pre></div>
</div>
<p>The print out shows</p>
<div class="math">
\[u_h = e^{-Bt}\left(C_1 \cos(\sqrt{\omega^2 - B^2}t) +
C_2 \sin(\sqrt{\omega^2 - B^2}t)\right),\]</div>
<p>where <span class="math">\(C_1\)</span> and <span class="math">\(C_2\)</span> must be determined by the initial conditions later.
It is wise to check that <span class="math">\(u_h\)</span> is indeed a solution of the homogeneous
differential equation:</p>
<div class="highlight-python" id="index-5"><div class="highlight"><pre><span class="k">assert</span> <span class="n">simplify</span><span class="p">(</span><span class="n">ode</span><span class="p">(</span><span class="n">u_h</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
<p>We have previously just printed the residuals of the ODE and initial
conditions after inserting the solution, but it is better in a code to
let the programming language test that the residuals are symbolically zero.
This is achieved using the <code class="docutils literal"><span class="pre">assert</span></code> statement in Python. The argument is
a boolean expression, and if the expression evaluates to <code class="docutils literal"><span class="pre">False</span></code>,
an <code class="docutils literal"><span class="pre">AssertionError</span></code> is raised and the program aborts (otherwise <code class="docutils literal"><span class="pre">assert</span></code>
runs silently for a <code class="docutils literal"><span class="pre">True</span></code> boolean expression). Hereafter, we will use
<code class="docutils literal"><span class="pre">assert</span></code> for consistency checks in computer code.</p>
<p>The ansatz for the particular solution <span class="math">\(u_p\)</span> is</p>
<div class="math">
\[u_p= C_3\cos(\psi t) + C_4\sin(\psi t),\]</div>
<p>which inserted in the ODE gives two equations
for <span class="math">\(C_3\)</span> and <span class="math">\(C_4\)</span>. The relevant SymPy statements are</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Particular solution</span>
<span class="n">C3</span><span class="p">,</span> <span class="n">C4</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s">&#39;C3 C4&#39;</span><span class="p">)</span>
<span class="n">u_p</span> <span class="o">=</span> <span class="n">C3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">C4</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">psi</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">eqs</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">ode</span><span class="p">(</span><span class="n">u_p</span><span class="p">,</span> <span class="n">homogeneous</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>

<span class="c"># Collect cos(omega*t) terms</span>
<span class="k">print</span> <span class="s">&#39;eqs:&#39;</span><span class="p">,</span> <span class="n">eqs</span>
<span class="n">eq_cos</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">eqs</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">psi</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">eq_sin</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">eqs</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">psi</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">solve</span><span class="p">([</span><span class="n">eq_cos</span><span class="p">,</span> <span class="n">eq_sin</span><span class="p">],</span> <span class="p">[</span><span class="n">C3</span><span class="p">,</span> <span class="n">C4</span><span class="p">])</span>
<span class="n">u_p</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">u_p</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">C3</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="n">C3</span><span class="p">])</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">C4</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="n">C4</span><span class="p">]))</span>

<span class="c"># Check that the solution is correct</span>
<span class="k">assert</span> <span class="n">simplify</span><span class="p">(</span><span class="n">ode</span><span class="p">(</span><span class="n">u_p</span><span class="p">,</span> <span class="n">homogeneous</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Using the initial conditions for the complete solution <span class="math">\(u=u_h+u_p\)</span>
determines <span class="math">\(C_1\)</span> and <span class="math">\(C_2\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">u_sol</span> <span class="o">=</span> <span class="n">u_h</span> <span class="o">+</span> <span class="n">u_p</span>  <span class="c"># total solution</span>
<span class="c"># Initial conditions</span>
<span class="n">eqs</span> <span class="o">=</span> <span class="p">[</span><span class="n">u_sol</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="p">,</span> <span class="n">u_sol</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">]</span>
<span class="c"># Determine C1 and C2 from the initial conditions</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">eqs</span><span class="p">,</span> <span class="p">[</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">])</span>
<span class="n">u_sol</span> <span class="o">=</span> <span class="n">u_sol</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">C1</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="n">C1</span><span class="p">])</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="n">C2</span><span class="p">])</span>
</pre></div>
</div>
<p>Finally, we should check that <code class="docutils literal"><span class="pre">u_sol</span></code> is indeed the correct solution:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">checks</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">ODE</span><span class="o">=</span><span class="n">simplify</span><span class="p">(</span><span class="n">expand</span><span class="p">(</span><span class="n">ode</span><span class="p">(</span><span class="n">u_sol</span><span class="p">,</span> <span class="n">homogeneous</span><span class="o">=</span><span class="bp">False</span><span class="p">))),</span>
    <span class="n">IC1</span><span class="o">=</span><span class="n">simplify</span><span class="p">(</span><span class="n">u_sol</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="p">),</span>
    <span class="n">IC2</span><span class="o">=</span><span class="n">simplify</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">u_sol</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">V</span><span class="p">))</span>
<span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="n">checks</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> residual: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">check</span><span class="p">,</span> <span class="n">checks</span><span class="p">[</span><span class="n">check</span><span class="p">])</span>
    <span class="k">assert</span> <span class="n">checks</span><span class="p">[</span><span class="n">check</span><span class="p">]</span> <span class="o">==</span> <span class="n">sympify</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">msg</span>
</pre></div>
</div>
<p>Finally, we may take <code class="docutils literal"><span class="pre">u_sol</span> <span class="pre">=</span> <span class="pre">u_sol.subs(A,</span> <span class="pre">A/m)</span></code> to get the right
expression for the solution.
Using <code class="docutils literal"><span class="pre">latex(u_sol)</span></code> results in a huge expression, which should be
manually ordered to something like the following:</p>
<div class="math">
\[\begin{split}u = &amp;
\frac{Am^{-1}}{4 B^{2} \psi^{2} +
\Omega^{2}} \left(2 B \psi
\sin{\left (\psi t \right )} - \Omega\cos{\left (\psi t \right )}\right) + \\
&amp;
{e^{-B t}} \biggl(
C_1 \cos{\left( t \sqrt{\omega^{2}- B^{2}}\right)} +
C_2 \sin{\left (t \sqrt{\omega^{2}- B^{2}}\right )}\biggr)\\
C_1 &amp;= \frac{Am^{-1} \Omega + 4 I B^{2} \psi^{2} +
I\Omega^2}{
4 B^{2} \psi^{2} + \Omega^2}\\
C_2 &amp;=
\frac{- Am^{-1} B\Omega + 4 I B^{3} \psi^{2} +
I B\Omega^2 + 4 V B^{2}\psi^{2} +
V\Omega^2}{
\sqrt{\omega^{2} - B^{2}}
\left(4 B^{2} \psi^{2} + \Omega^2\right)},\\
\Omega &amp;= \psi^2 - \omega^2{\thinspace .}\end{split}\]</div>
<span class="target" id="index-6"></span><p id="index-7">The most important feature of this solution is that there are
two time scales with frequencies <span class="math">\(\psi\)</span> and <span class="math">\(\sqrt{\omega^2 - B^2}\)</span>,
but the latter appears in terms that decay as <span class="math">\(e^{-Bt}\)</span> in time.
The attention is usually on longer periods of time, so in that
case the solution simplifies to</p>
<div class="math">
\[u = \frac{Am^{-1}}{4 B^{2} \psi^{2} +
\Omega^{2}} \left(2 B \psi
\sin{\left (\psi t \right )} - \Omega\cos{\left (\psi t \right )}\right)
\nonumber\]</div>
<div class="math">
\[= \frac{A}{m}\frac{1}{\sqrt{4B^2\psi^2 + \Omega^2}}\cos(\psi t + \phi)
\frac{(\psi\omega)^{-1}}{(\psi\omega)^{-1}}
\nonumber\]</div>
<div class="math" id="eq-sec-scale-vib-damped-f-model-u-forced0">
\[\tag{84}
= \frac{A}{k} Q\delta^{-1}\left(1 + Q^2(\delta - \delta^{-1})\right)^{-
    \frac{1}{2}}\cos(\psi t + \phi),\]</div>
<p>where we have introduced the dimensionless numbers</p>
<div class="math">
\[Q = \frac{\omega}{2B},\quad\delta = \frac{\psi}{\omega},\]</div>
<p>and</p>
<div class="math">
\[\phi = \tan^{-1}\left(-\frac{2B}{\omega^2 - \psi^2}\right)
= \tan^{-1}\left(\frac{Q^{-1}}{\delta^2 - 1}\right){\thinspace .}\]</div>
<p><span class="math">\(Q\)</span> is commonly called <em>quality factor</em> and <span class="math">\(\phi\)</span> is the
<em>phase shift</em>. Dividing
<a class="reference internal" href="#eq-sec-scale-vib-damped-f-model-u-forced0"><span class="std std-ref">(84)</span></a> by <span class="math">\(A/k\)</span>, which is a common
scale for <span class="math">\(u\)</span>, gives the dimensionless relation</p>
<div class="math" id="eq-sec-scale-vib-damped-f-model-u-forced">
\[\tag{85}
\frac{u}{A/k} = \frac{Q}{\delta} R(Q,\delta)^{\frac{1}{2}}\cos(\psi t + \phi),
    \quad
    R(Q,\delta) = \left(1 + Q^2(\delta - \delta^{-1})\right)^{-1}{\thinspace .}\]</div>
</div>
<div class="section" id="choosing-scales">
<h3>Choosing scales<a class="headerlink" href="#choosing-scales" title="Permalink to this headline">¶</a></h3>
<p>Much of the discussion about scales in the previous sections are
relevant also when damping is included.  Although the oscillations
with frequency <span class="math">\(\sqrt{\omega^2-B^2}\)</span> die out for <span class="math">\(t\gg B^{-1}\)</span>, we
start with using this frequency for the time scale.  A highly relevant
assumption for engineering applications of
<a class="reference internal" href="#eq-sec-scale-vib-damped-f-model"><span class="std std-ref">(82)</span></a> is that the damping is small.
Therefore, <span class="math">\(\sqrt{\omega^2-B^2}\)</span> is close to <span class="math">\(\omega\)</span> and we simply
apply <span class="math">\(t_c=1/\omega\)</span> as before.  [<strong>hpl 11</strong>: Why? According to <a class="reference internal" href="#eq-sec-scale-vib-damped-f-model-u-forced0"><span class="std std-ref">(84)</span></a>, no <span class="math">\(\omega\)</span> is of interest for the time variation!]</p>
<p>The coefficient in front of the <span class="math">\(\bar u'\)</span> term then becomes</p>
<div class="math">
\[\frac{b}{m\omega} = \frac{2B}{\omega} = Q^{-1}{\thinspace .}\]</div>
<p>The rest of the ODE is given in the previous section, and the particular
formulas depend on the choices of <span class="math">\(t_c\)</span> and <span class="math">\(u_c\)</span>.</p>
</div>
<div class="section" id="choice-of-at-resonance">
<h3>Choice of <span class="math">\(u_c\)</span> at resonance<a class="headerlink" href="#choice-of-at-resonance" title="Permalink to this headline">¶</a></h3>
<p>The relevant scale for <span class="math">\(u_c\)</span> at or nearby resonance (<span class="math">\(\psi = \omega\)</span>)
becomes different from the previous section, since with damping,
the maximum amplitude is a finite value. For <span class="math">\(t\gg B^{-1}\)</span> when the
<span class="math">\(\sin\psi t\)</span> term is dominating, we have for <span class="math">\(\psi = \omega\)</span>:</p>
<div class="math">
\[u = \frac{Am^{-1}2B\psi}{4B^2\psi^2}\sin (\psi t) =
\frac{A}{2Bm\psi}\sin (\psi t) =
\frac{A}{b\psi}\sin (\psi t)
{\thinspace .}\]</div>
<p>This motivates the choice</p>
<div class="math">
\[u_c = \frac{A}{b\psi} = \frac{A}{b\omega}{\thinspace .}\]</div>
<p>(It is wise during computations like this to stop and check the
dimensions: <span class="math">\(A\)</span> must be <span class="math">\([\hbox{MLT}^{-2}]\)</span> from the original
equation (<span class="math">\(F(t)\)</span> must have same dimension as <span class="math">\(mu''\)</span>),
<span class="math">\(bu'\)</span> also has dimension <span class="math">\([\hbox{MLT}^{-2}]\)</span>, implying that
<span class="math">\(b\)</span> has dimension <span class="math">\([\hbox{MT}^{-1}]\)</span>. <span class="math">\(A/b\)</span> then has dimension
<span class="math">\(LT^{-1}\)</span>, and <span class="math">\(A/(b\psi)\)</span> gets dimension <span class="math">\([L]\)</span>, which matches
what we want for <span class="math">\(u_c\)</span>.)</p>
<p>The differential equation on dimensionless form becomes</p>
<div class="math" id="eq-sec-scale-vib-damped-f-model-scaled1">
\[\tag{86}
\frac{d^2\bar u}{d\bar t^2} + Q^{-1}\frac{d\bar u}{d\bar t} + \bar u =
    \gamma
    \cos(\delta\bar t),
    \quad \bar u(0)=\alpha,\ \bar u'(0)=\beta,\]</div>
<p>with</p>
<div class="math" id="eq-auto21">
\[\tag{87}
\alpha = \frac{I}{u_c} = \frac{Ib}{A}\sqrt{\frac{k}{m}},\]</div>
<div class="math" id="eq-auto22">
\[\tag{88}
\beta  = \frac{Vt_c}{u_c} = \frac{Vb}{A},\]</div>
<div class="math" id="eq-auto23">
\[\tag{89}
\gamma = \frac{t_c^2 A}{mu_c} = \frac{b\omega}{k},\]</div>
<div class="math" id="eq-auto24">
\[\tag{90}
\delta = \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega} = 1{\thinspace .}\]</div>
</div>
<div class="section" id="id1">
<h3>Choice of <span class="math">\(u_c\)</span> when <span class="math">\(\omega\gg\psi\)</span><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>In the limit <span class="math">\(\omega\gg\psi\)</span> and <span class="math">\(t\gg B^{-1}\)</span>,</p>
<div class="math">
\[u \approx \frac{A}{m\omega^2}\cos\psi t = \frac{A}{k}\cos\psi t,\]</div>
<p>showing that <span class="math">\(u_c=A/k\)</span> is an appropriate displacement scale.
(Alternatively, we get this scale also from demanding <span class="math">\(\gamma=1\)</span> in the ODE.)
The dimensionless numbers <span class="math">\(\alpha\)</span>, <span class="math">\(\beta\)</span>, and <span class="math">\(\delta\)</span> are as
for the forced vibrations without damping.</p>
</div>
<div class="section" id="id2">
<h3>Choice of <span class="math">\(u_c\)</span> when <span class="math">\(\omega\ll\psi\)</span><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>In the limit <span class="math">\(\omega\ll\psi\)</span>, we should base <span class="math">\(t_c\)</span> on the rapid
variations in the excitation: <span class="math">\(t_c=1/\psi\)</span>.</p>
</div>
<div class="section" id="software-6">
<h3>Software<a class="headerlink" href="#software-6" title="Permalink to this headline">¶</a></h3>
<p>It is easy to reuse a solver for a general vibration problem also
in the dimensionless case.
In particular, we may use the <code class="docutils literal"><span class="pre">solver</span></code> function in the
file <a class="reference external" href="http://tinyurl.com/o8pb3yy/vib.py">vib.py</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">solver</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">damping</span><span class="o">=</span><span class="s">&#39;linear&#39;</span><span class="p">):</span>
</pre></div>
</div>
<p>for solving the ODE problem</p>
<div class="math">
\[mu'' + f(u') + s(u) = F(t),\quad u(0)=I,\ u'(0)=V,\ t\in (0,T],\]</div>
<p>with time steps <code class="docutils literal"><span class="pre">dt</span></code>. With <code class="docutils literal"><span class="pre">damping='linear'</span></code>, we have <span class="math">\(f(u')=bu'\)</span>, while the
other value is <code class="docutils literal"><span class="pre">'quadratic'</span></code>, meaning <span class="math">\(f(u')=b|u'|u'\)</span>.
Given the dimensionless numbers <span class="math">\(\alpha\)</span>, <span class="math">\(\beta\)</span>, <span class="math">\(\gamma\)</span>, <span class="math">\(\delta\)</span>,
and <span class="math">\(Q\)</span>,
an appropriate call for solving <a class="reference internal" href="#eq-sec-scale-vib-undamped-f-model-scaled2"><span class="std std-ref">(73)</span></a> is</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">u</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">solver</span><span class="p">(</span><span class="n">I</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="n">Q</span><span class="p">,</span>
              <span class="n">s</span><span class="o">=</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span> <span class="n">F</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">gamma</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">delta</span><span class="o">*</span><span class="n">t</span><span class="p">),</span>
              <span class="n">dt</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">n</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">P</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">n</span></code> is the number intervals per period and <code class="docutils literal"><span class="pre">P</span></code> is the number
of periods to be simulated.
We way wrap this call in a <code class="docutils literal"><span class="pre">solver_scaled</span></code> function and wrap it furthermore
with <code class="docutils literal"><span class="pre">joblib</span></code> to avoid repeated calls,
as we explained in
the section <a class="reference internal" href="._book004.html#sec-scale-decay-prog"><span class="std std-ref">Making software for utilizing the scaled model</span></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">vib</span> <span class="kn">import</span> <span class="n">solver</span> <span class="k">as</span> <span class="n">solver_unscaled</span>

<span class="k">def</span> <span class="nf">solver_scaled</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve u&#39;&#39; + (1/Q)*u&#39; + u = gamma*cos(delta*t),</span>
<span class="sd">    u(0)=alpha, u&#39;(1)=beta, for (0,T] with step dt.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">print</span> <span class="s">&#39;Computing the numerical solution&#39;</span>
    <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">cos</span>
    <span class="k">return</span> <span class="n">solver_unscaled</span><span class="p">(</span><span class="n">I</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="n">Q</span><span class="p">,</span>
                           <span class="n">s</span><span class="o">=</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
                           <span class="n">F</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">gamma</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">delta</span><span class="o">*</span><span class="n">t</span><span class="p">),</span>
                           <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">damping</span><span class="o">=</span><span class="s">&#39;linear&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">joblib</span>
<span class="n">disk_memory</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">Memory</span><span class="p">(</span><span class="n">cachedir</span><span class="o">=</span><span class="s">&#39;temp&#39;</span><span class="p">)</span>
<span class="n">solver_scaled</span> <span class="o">=</span> <span class="n">disk_memory</span><span class="o">.</span><span class="n">cache</span><span class="p">(</span><span class="n">solver_scaled</span><span class="p">)</span>
</pre></div>
</div>
<p>This code is found in <a class="reference external" href="http://tinyurl.com/o8pb3yy/vib_scaled.py">vib_scaled.py</a>
and features an application for running the scaled problem with
options on the command-line for <span class="math">\(\alpha\)</span>, <span class="math">\(\beta\)</span>, <span class="math">\(\gamma\)</span>, <span class="math">\(\delta\)</span>,
<span class="math">\(Q\)</span>, number of time steps per period, and number of periods (see
the <code class="docutils literal"><span class="pre">main</span></code> function). It is an ideal application for exploring
scaled vibration models.</p>
</div>
</div>
<div class="section" id="oscillating-electric-circuits">
<h2>Oscillating electric circuits<a class="headerlink" href="#oscillating-electric-circuits" title="Permalink to this headline">¶</a></h2>
<p>The differential equation for an oscillating electric circuit is
very similar to the equation for forced, damped,
mechanical vibrations, and their
dimensionless form is identical.
The current <span class="math">\(I(t)\)</span> in a
circuit with an inductor with inductance <span class="math">\(L\)</span>, a capacitor with
capacitance <span class="math">\(C\)</span>, and overall resistance <span class="math">\(R\)</span>, obeys the equation</p>
<div class="math" id="eq-auto25">
\[\tag{91}
\ddot I + \frac{R}{L}\dot I + \frac{1}{LC}I = \dot V(t),\]</div>
<p>where <span class="math">\(V(t)\)</span> is the voltage source powering the circuit.
We introduce</p>
<div class="math">
\[\bar I=\frac{I}{I_c},\quad \bar t = \frac{t}{t_c},\]</div>
<p>and get</p>
<div class="math">
\[\frac{d^2\bar I}{d\bar t^2} + \frac{t_c R}{L}\frac{d\bar I}{d\bar t}
+ \frac{t_c^2}{LC}\bar I = \frac{t_c^2V_c}{I_c} \bar V(t){\thinspace .}\]</div>
<p>Here, we have scaled <span class="math">\(V(t)\)</span> according to</p>
<div class="math">
\[\bar V(\bar t) = \frac{V(t_c\bar t)}{\max_t V(t)}{\thinspace .}\]</div>
<p>The time scale <span class="math">\(t_c\)</span> is chosen to make <span class="math">\(\ddot I\)</span> and <span class="math">\(I/(LC)\)</span> balance,
<span class="math">\(t_c = \sqrt{LC}\)</span>.
Choosing <span class="math">\(I_c\)</span> to make the coefficient in the source term of unit size,
means <span class="math">\(I_c = LCV_c\)</span>.
With</p>
<div class="math">
\[Q^{-1} = R\sqrt{\frac{C}{L}},\]</div>
<p>we get the scaled equation</p>
<div class="math" id="eq-auto26">
\[\tag{92}
\frac{d^2\bar I}{d\bar t^2} + Q^{-1}\frac{d\bar I}{d\bar t}
    + \bar I = \bar V(t),\]</div>
<p>which is basically the same as we derived for mechanical vibrations.
(Two additional dimensionless variables will arise from the initial
conditions for <span class="math">\(I\)</span>, just as in the mechanics cases.)</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <center>
            <p class="logo"><a href="http://cbc.simula.no/" title="Go to Center for Biomedical Computing">
              <img class="logo" src="_static/cbc_logo.png" alt="Logo"/>
            </a></p>
            </center>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Vibration problems</a><ul>
<li><a class="reference internal" href="#undamped-vibrations-without-forcing">Undamped vibrations without forcing</a><ul>
<li><a class="reference internal" href="#the-first-technical-steps-of-scaling">The first technical steps of scaling</a></li>
<li><a class="reference internal" href="#the-exact-solution-1">The exact solution</a></li>
<li><a class="reference internal" href="#discussion-of-the-displacement-scale">Discussion of the displacement scale</a></li>
<li><a class="reference internal" href="#discussion-of-the-time-scale-2">Discussion of the time scale</a></li>
<li><a class="reference internal" href="#the-dimensionless-solution">The dimensionless solution</a></li>
<li><a class="reference internal" href="#alternative-displacement-scale">Alternative displacement scale</a></li>
<li><a class="reference internal" href="#about-frequency-and-dimensions">About frequency and dimensions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#undamped-vibrations-with-constant-forcing">Undamped vibrations with constant forcing</a></li>
<li><a class="reference internal" href="#undamped-vibrations-with-time-dependent-forcing">Undamped vibrations with time-dependent forcing</a><ul>
<li><a class="reference internal" href="#investigating-scales-via-analytical-solutions">Investigating scales via analytical solutions</a></li>
<li><a class="reference internal" href="#the-displacement-and-time-scales">The displacement and time scales</a></li>
<li><a class="reference internal" href="#finding-the-displacement-scale-from-the-differential-equation">Finding the displacement scale from the differential equation</a></li>
<li><a class="reference internal" href="#scaling-with-free-vibrations-as-time-scale">Scaling with free vibrations as time scale</a></li>
<li><a class="reference internal" href="#software-5">Software</a></li>
<li><a class="reference internal" href="#choice-of-close-to-resonance">Choice of <span class="math">\(u_c\)</span> close to resonance</a></li>
<li><a class="reference internal" href="#unit-size-of-all-terms-in-the-ode">Unit size of all terms in the ODE</a></li>
<li><a class="reference internal" href="#choice-of-when">Choice of <span class="math">\(u_c\)</span> when <span class="math">\(\psi\gg\omega\)</span></a></li>
<li><a class="reference internal" href="#displacement-scale-based-on">Displacement scale based on <span class="math">\(I\)</span></a></li>
</ul>
</li>
<li><a class="reference internal" href="#damped-vibrations-with-forcing">Damped vibrations with forcing</a><ul>
<li><a class="reference internal" href="#the-exact-solution-2">The exact solution</a></li>
<li><a class="reference internal" href="#choosing-scales">Choosing scales</a></li>
<li><a class="reference internal" href="#choice-of-at-resonance">Choice of <span class="math">\(u_c\)</span> at resonance</a></li>
<li><a class="reference internal" href="#id1">Choice of <span class="math">\(u_c\)</span> when <span class="math">\(\omega\gg\psi\)</span></a></li>
<li><a class="reference internal" href="#id2">Choice of <span class="math">\(u_c\)</span> when <span class="math">\(\omega\ll\psi\)</span></a></li>
<li><a class="reference internal" href="#software-6">Software</a></li>
</ul>
</li>
<li><a class="reference internal" href="#oscillating-electric-circuits">Oscillating electric circuits</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._book004.html"
                        title="previous chapter">ODE models</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._book006.html"
                        title="next chapter">Basic PDE models</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/._book005.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._book006.html" title="Basic PDE models"
             >next</a> |</li>
        <li class="right" >
          <a href="._book004.html" title="ODE models"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Scaling of Differential Equations</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
    <a href="http://cbc.simula.no"><img src="_static/cbc_banner.png" width="100%"><a>
    <br />
    <br />
      &copy;2015, Geir K. Pedersen, Hans Petter Langtangen. Released under CC Attribution 4.0 license.
  </div>
</div>

  </body>
</html>