<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Scaling of Differential Equations">
<meta name="keywords" content="units,base unit,length,mass,time,dimension of physical quantities,Pi theorem,Buckingham Pi theorem,units US,units British,units conversion,units software,multiple software runs,web interface (Parampool),graphical web interface,scaling,non-dimensionalization,dimensionless variable,exponential decay,dimensionless variable,characteristic time,e-folding time,memoize function,dimensionless number,dimensionless number,dimensionless number,logistic equation,dimensionless number,frequency,frequency, angular,period (of oscillations),radians,angular frequency,quality factor $Q$,phase shift,Lotka-Volterra, predator-prey model,Lotka-Volterra, competing species model,dimensionless number,Peclet number,dimensionless number,Reynolds number,Biot number,thermo-elasticity,Navier-Stokes equations,dimensionless number,Reynolds number,Bernoulli's equation,Reynolds number,low Reynolds number flow,Stokes problem,Stokes' flow,Froude number,creeping flow,Strouhal number,vortex shedding,Euler number,Weber number,forced convection,Peclet number,Reynolds number,free convection,Grashof number,Reynolds number,Peclet number,Eckert number,Nusselt number,Biot number,Mach number,bidomain equations">

<title>Scaling of Differential Equations</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

body { font-size:20px;line-height:1.5; }
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [(u'Preface', 0, u'ch:preface', u'ch:preface'),
              (u'Dimensions and units',
               0,
               u'scale:dimunit',
               u'scale:dimunit'),
              (u'Fundamental concepts', 1, None, '___sec2'),
              (u'Base units and dimensions', 2, None, '___sec3'),
              (u'Dimensions of common physical quantities',
               2,
               u'scale:dimunit:tables',
               u'scale:dimunit:tables'),
              (u'Prefixes for units', 3, None, '___sec5'),
              (u'The Buckingham Pi theorem',
               2,
               u'scale:dimunit:Pi',
               u'scale:dimunit:Pi'),
              (u'Absolute errors, relative errors, and units',
               2,
               None,
               '___sec7'),
              (u'Units and computers', 2, None, '___sec8'),
              (u'Unit systems', 2, None, '___sec9'),
              (u'Example on challenges arising from unit systems',
               2,
               None,
               '___sec10'),
              (u'PhysicalQuantity: a tool for computing with units',
               2,
               u'scale:PQ',
               u'scale:PQ'),
              (u'Parampool: user interfaces with automatic unit conversion',
               1,
               u'scale:parampool',
               u'scale:parampool'),
              (u'Example application', 3, None, '___sec13'),
              (u'Pool of parameters', 2, None, '___sec14'),
              (u'Fetching pool data for computing', 2, None, '___sec15'),
              (u'Reading command-line options', 2, None, '___sec16'),
              (u'Setting default values in a file', 2, None, '___sec17'),
              (u'Specifying multiple values of input parameters',
               2,
               None,
               '___sec18'),
              (u'Generating a graphical user interface', 2, None, '___sec19'),
              (u'Ordinary differential equation models', 0, None, '___sec20'),
              (u'Exponential decay problems',
               1,
               u'sec:scale:decay',
               u'sec:scale:decay'),
              (u'Fundamental ideas of scaling', 2, None, '___sec22'),
              (u'The basic model problem', 2, None, '___sec23'),
              (u'Example: Population dynamics', 3, None, '___sec24'),
              (u'Example: Decay of pressure with altitude',
               3,
               None,
               '___sec25'),
              (u'The technical steps of the scaling procedure',
               2,
               u'sec:scale:steps',
               u'sec:scale:steps'),
              (u'Step 1: Identify independent and dependent variables',
               3,
               None,
               '___sec27'),
              (u'Step 2: Make independent and dependent variables dimensionless',
               3,
               None,
               '___sec28'),
              (u'Step 3: Derive the model involving only dimensionless variables',
               3,
               None,
               '___sec29'),
              (u'Step 4: Make each term dimensionless', 3, None, '___sec30'),
              (u'Step 5: Estimate the scales', 3, None, '___sec31'),
              (u'Making software for utilizing the scaled model',
               2,
               u'sec:scale:prog',
               u'sec:scale:prog'),
              (u'Software for the original unscaled problem',
               3,
               None,
               '___sec33'),
              (u'Software for the scaled problem', 3, None, '___sec34'),
              (u'Implementation with joblib', 3, None, '___sec35'),
              (u'Scaling a generalized problem',
               2,
               u'sec:scale:body',
               u'sec:scale:body'),
              (u'Exact solution', 3, None, '___sec37'),
              (u'Theory', 3, None, '___sec38'),
              (u'Software', 3, None, '___sec39'),
              (u'Variable coefficients',
               2,
               u'sec:scale:jump',
               u'sec:scale:jump'),
              (u'Scaling a cooling problem with constant temperature in the surroundings',
               2,
               u'scale:cooling:const',
               u'scale:cooling:const'),
              (u'Exact solution', 3, None, '___sec42'),
              (u'Scaling', 3, None, '___sec43'),
              (u'Software', 3, None, '___sec44'),
              (u'Alternative scaling', 3, None, '___sec45'),
              (u'Scaling a cooling problem with time-dependent surroundings',
               2,
               u'scale:cooling:osc',
               u'scale:cooling:osc'),
              (u'Exact solution', 3, None, '___sec47'),
              (u'Scaling', 3, None, '___sec48'),
              (u'Software', 3, None, '___sec49'),
              (u'Discussion of the time scale', 3, None, '___sec50'),
              (u'Scaling a nonlinear ODE',
               2,
               u'sec:scale:nonlinear',
               u'sec:scale:nonlinear'),
              (u'Scaling', 3, None, '___sec52'),
              (u'Alternative scaling', 3, None, '___sec53'),
              (u'SIR ODE system for spreading of diseases',
               2,
               None,
               '___sec54'),
              (u'Scaling', 3, None, '___sec55'),
              (u'Software', 3, None, '___sec56'),
              (u'Alternative scaling', 3, None, '___sec57'),
              (u'SIRV model with finite immunity', 2, None, '___sec58'),
              (u'Michaelis-Menten kinetics for biochemical reactions',
               2,
               u'scale:MMK',
               u'scale:MMK'),
              (u'Classical analysis', 3, None, '___sec60'),
              (u'Dimensionless ODE system', 3, None, '___sec61'),
              (u'Determining scales', 3, None, '___sec62'),
              (u'Conservation equations', 3, None, '___sec63'),
              (u'Analysis of the scaled system', 3, None, '___sec64'),
              (u'Vibration problems', 1, u'sec:scale:vib', u'sec:scale:vib'),
              (u'Undamped vibrations without forcing',
               2,
               u'sec:scale:vib:undamped',
               u'sec:scale:vib:undamped'),
              (u'The first technical steps of scaling', 3, None, '___sec67'),
              (u'The exact solution', 3, None, '___sec68'),
              (u'Discussion of the displacement scale', 3, None, '___sec69'),
              (u'Discussion of the time scale', 3, None, '___sec70'),
              (u'The dimensionless solution', 3, None, '___sec71'),
              (u'Alternative displacement scale', 3, None, '___sec72'),
              (u'About frequency and dimensions', 3, None, '___sec73'),
              (u'Undamped vibrations with constant forcing',
               2,
               u'sec:scale:vib:undamped:mg',
               u'sec:scale:vib:undamped:mg'),
              (u'Undamped vibrations with time-dependent forcing',
               2,
               u'sec:scale:vib:undamped:F',
               u'sec:scale:vib:undamped:F'),
              (u'Investigating scales via analytical solutions',
               3,
               None,
               '___sec76'),
              (u'The displacement and time scales', 3, None, '___sec77'),
              (u'Finding the displacement scale from the differential equation',
               3,
               None,
               '___sec78'),
              (u'Scaling with free vibrations as time scale',
               3,
               None,
               '___sec79'),
              (u'Software', 3, None, '___sec80'),
              (u'Choice of $u_c$ close to resonance', 3, None, '___sec81'),
              (u'Unit size of all terms in the ODE', 3, None, '___sec82'),
              (u'Choice of $u_c$ when $\\psi\\gg\\omega$',
               3,
               None,
               '___sec83'),
              (u'Displacement scale based on $I$', 3, None, '___sec84'),
              (u'Damped vibrations with forcing',
               2,
               u'sec:scale:vib:damped:F',
               u'sec:scale:vib:damped:F'),
              (u'The exact solution', 3, None, '___sec86'),
              (u'Choosing scales', 3, None, '___sec87'),
              (u'Choice of $u_c$ at resonance', 3, None, '___sec88'),
              (u'Choice of $u_c$ when $\\omega\\gg\\psi$',
               3,
               None,
               '___sec89'),
              (u'Choice of $u_c$ when $\\omega\\ll\\psi$',
               3,
               None,
               '___sec90'),
              (u'Software', 3, None, '___sec91'),
              (u'Oscillating electric circuits', 2, None, '___sec92'),
              (u'Exercises', 1, None, '___sec93'),
              (u'Exercise 2.1: Perform unit conversion',
               2,
               u'sec:scale:exer:US2SI1',
               u'sec:scale:exer:US2SI1'),
              (u'Problem 2.2: Scale a simple formula',
               2,
               u'sec:scale:exer:ball_y',
               u'sec:scale:exer:ball_y'),
              (u'Exercise 2.3: Perform alternative scalings',
               2,
               u'sec:scale:exer:decay:cooling:osc',
               u'sec:scale:exer:decay:cooling:osc'),
              (u'Problem 2.4: A nonlinear ODE for vertical motion with air resistance',
               2,
               u'sec:scale:exer:ball_y_wdrag',
               u'sec:scale:exer:ball_y_wdrag'),
              (u'Exercise 2.5: Solve a decay ODE with discontinuous coefficient',
               2,
               u'sec:scale:exer:decay:jump',
               u'sec:scale:exer:decay:jump'),
              (u'Exercise 2.6: Implement a scaled model for cooling',
               2,
               u'sec:scale:exer:decay:cooling',
               u'sec:scale:exer:decay:cooling'),
              (u'Problem 2.7: Decay ODE with discontinuous coefficients',
               2,
               u'scale:exer:decay:step',
               u'scale:exer:decay:step'),
              (u'Exercise 2.8: Alternative scalings of a cooling model',
               2,
               u'scale:exer:nonlin:logistic2',
               u'scale:exer:nonlin:logistic2'),
              (u'Exercise 2.9: Projectile motion',
               2,
               u'scale:vib:exer:projectile',
               u'scale:vib:exer:projectile'),
              (u'Problem 2.10: A predator-prey model',
               2,
               u'scale:exer:predprey',
               u'scale:exer:predprey'),
              (u'Problem 2.11: A model for competing species',
               2,
               u'scale:exer:competing_species',
               u'scale:exer:competing_species'),
              (u'Problem 2.12: Find the period of sinusoidal signals',
               2,
               u'scale:exer:sine',
               u'scale:exer:sine'),
              (u'Remarks', 3, None, '___sec106'),
              (u'Problem 2.13: Oscillating mass with sliding friction',
               2,
               u'scale:vib:exer:sliding',
               u'scale:vib:exer:sliding'),
              (u'Problem 2.14: Pendulum equations',
               2,
               u'sec:scale:exer:pendulum',
               u'sec:scale:exer:pendulum'),
              (u'Exercise 2.15: ODEs for a binary star',
               2,
               u'sec:scale:exer:binary_star',
               u'sec:scale:exer:binary_star'),
              (u"Problem 2.16: Duffing's equation",
               2,
               u'scale:vib:exer:Duffing',
               u'scale:vib:exer:Duffing'),
              (u'Problem 2.17: Vertical motion in a varying gravity field',
               2,
               u'scale:vib:exer:rocket',
               u'scale:vib:exer:rocket'),
              (u'Problem 2.18: A simplified Schroedinger equation',
               2,
               u'scale:vib:exer:quantum',
               u'scale:vib:exer:quantum'),
              (u'Remarks', 3, None, '___sec113'),
              (u'Basic partial differential equation models',
               0,
               None,
               '___sec114'),
              (u'The wave equation', 1, u'sec:scale:wave', u'sec:scale:wave'),
              (u'Homogeneous Dirichlet conditions in 1D',
               2,
               u'sec:scale:wave:bc_u0',
               u'sec:scale:wave:bc_u0'),
              (u'Implementation of the scaled wave equation',
               2,
               u'sec:scale:wave:impl',
               u'sec:scale:wave:impl'),
              (u'Waves on a string', 3, None, '___sec118'),
              (u'Detecting an already computed case', 3, None, '___sec119'),
              (u'Time-dependent Dirichlet condition',
               2,
               u'scale:wave:pde2',
               u'scale:wave:pde2'),
              (u'Scaling', 3, None, '___sec121'),
              (u'Software', 3, None, '___sec122'),
              (u'Specific case', 3, None, '___sec123'),
              (u'Velocity initial condition',
               2,
               u'scale:wave:pde2:Vcond',
               u'scale:wave:pde2:Vcond'),
              (u'Analytical insight', 3, None, '___sec125'),
              (u'Scaling', 3, None, '___sec126'),
              (u'Nonzero initial shape', 3, None, '___sec127'),
              (u'Variable wave velocity and forcing',
               2,
               u'scale:wave:pde2:cvar',
               u'scale:wave:pde2:cvar'),
              (u'Non-dimensionalization', 3, None, '___sec129'),
              (u'Choosing the time scale', 3, None, '___sec130'),
              (u'Choosing the spatial scale', 3, None, '___sec131'),
              (u'Scaling the velocity initial condition',
               3,
               None,
               '___sec132'),
              (u'Damped wave equation',
               2,
               u'scale:wave:pde2:damped',
               u'scale:wave:pde2:damped'),
              (u'A three-dimensional wave equation problem',
               2,
               None,
               '___sec134'),
              (u'The diffusion equation',
               1,
               u'sec:scale:diffu',
               u'sec:scale:diffu'),
              (u'Homogeneous 1D diffusion equation',
               2,
               u'sec:scale:diffu:homo1D',
               u'sec:scale:diffu:homo1D'),
              (u'Choosing the time scale', 3, None, '___sec137'),
              (u'Analytical insight', 3, None, '___sec138'),
              (u'Choosing other scales', 3, None, '___sec139'),
              (u'Generalized diffusion PDE', 2, None, '___sec140'),
              (u'Jump boundary condition', 2, None, '___sec141'),
              (u'Oscillating Dirichlet condition', 2, None, '___sec142'),
              (u'Scaling issues', 3, None, '___sec143'),
              (u'Exact solution', 3, None, '___sec144'),
              (u'Time and length scales', 3, None, '___sec145'),
              (u'The scaled problem', 3, None, '___sec146'),
              (u'Simulations', 3, None, '___sec147'),
              (u'Reaction-diffusion equations',
               1,
               u'sec:scale:diffu:Fisher',
               u'sec:scale:diffu:Fisher'),
              (u"Fisher's equation", 2, None, '___sec149'),
              (u'Balance of all terms', 3, None, '___sec150'),
              (u'Fixed length scale', 3, None, '___sec151'),
              (u'Nonlinear reaction-diffusion PDE', 2, None, '___sec152'),
              (u'The convection-diffusion equation',
               1,
               u'scale:convdiff',
               u'scale:convdiff'),
              (u'Convection-diffusion without a force term',
               2,
               None,
               '___sec154'),
              (u'Stationary PDE', 2, None, '___sec155'),
              (u'Convection-diffusion with a source term',
               2,
               u'scale:convdiff:f',
               u'scale:convdiff:f'),
              (u'Exercises', 1, None, '___sec157'),
              (u'Problem 3.1: Stationary Couette flow',
               2,
               u'scale:vib:exer:stationary_Couette',
               u'scale:vib:exer:stationary_Couette'),
              (u'Remarks', 3, None, '___sec159'),
              (u'Exercise 3.2: Couette-Poiseuille flow',
               2,
               u'scale:vib:exer:Couette_wpressure',
               u'scale:vib:exer:Couette_wpressure'),
              (u'Exercise 3.3: Pulsatile pipeflow',
               2,
               u'scale:exer:pipeflow:pulsatile',
               u'scale:exer:pipeflow:pulsatile'),
              (u'Exercise 3.4: The linear cable equation',
               2,
               u'scale:exer:cable_eq',
               u'scale:exer:cable_eq'),
              (u'Exercise 3.5: Heat conduction with discontinuous initial condition',
               2,
               u'scale:exer:twometal',
               u'scale:exer:twometal'),
              (u'Remarks', 3, None, '___sec164'),
              (u'Problem 3.6: Scaling a welding problem',
               2,
               u'diffu:exer:welding',
               u'diffu:exer:welding'),
              (u'Advanced partial differential equation models',
               0,
               None,
               '___sec166'),
              (u'The equations of linear elasticity',
               1,
               u'scale:elasticity',
               u'scale:elasticity'),
              (u'The general time-dependent elasticity problem',
               2,
               u'scale:elasticity:timedep',
               u'scale:elasticity:timedep'),
              (u'Software', 3, None, '___sec169'),
              (u'Dimensionless stress tensor',
               2,
               u'scale:elasticity:PDE1:stress',
               u'scale:elasticity:PDE1:stress'),
              (u'When can the acceleration term be neglected?',
               2,
               u'scale:elasticity:waves',
               u'scale:elasticity:waves'),
              (u'S waves', 3, None, '___sec172'),
              (u'P waves', 3, None, '___sec173'),
              (u'Time-varying load', 3, None, '___sec174'),
              (u'The stationary elasticity problem',
               2,
               u'scale:elasticity:stationary',
               u'scale:elasticity:stationary'),
              (u'Scaling of the PDE', 3, None, '___sec176'),
              (u'Remark on the characteristic displacement',
               3,
               None,
               '___sec177'),
              (u'Scaling of displacement boundary conditions',
               3,
               None,
               '___sec178'),
              (u'Scaling of traction boundary conditions',
               3,
               None,
               '___sec179'),
              (u'Quasi-static thermo-elasticity',
               2,
               u'scale:elasticity:thermo',
               u'scale:elasticity:thermo'),
              (u'The Navier-Stokes equations',
               1,
               u'sec:scale:ns',
               u'sec:scale:ns'),
              (u'The momentum equation without body forces',
               2,
               None,
               '___sec182'),
              (u'Scaling', 3, None, '___sec183'),
              (u'Dimensonless PDEs and the Reynolds number',
               3,
               None,
               '___sec184'),
              (u'Scaling of time for low Reynolds numbers',
               2,
               None,
               '___sec185'),
              (u'Shear stress as pressure scale', 2, None, '___sec186'),
              (u'Gravity force and the Froude number', 2, None, '___sec187'),
              (u'Oscillating boundary conditions and the Strouhal number',
               2,
               None,
               '___sec188'),
              (u'Cavitation and the Euler number', 2, None, '___sec189'),
              (u'Free surface conditions and the Weber number',
               2,
               u'freesurface:Weber',
               u'freesurface:Weber'),
              (u'Thermal convection', 1, None, '___sec191'),
              (u'Forced convection', 2, None, '___sec192'),
              (u'Free convection',
               2,
               u'scale:fluid:forced_convection',
               u'scale:fluid:forced_convection'),
              (u'Governing equations', 3, None, '___sec194'),
              (u'Heating by viscous effects', 3, None, '___sec195'),
              (u'Relation between density and temperature',
               3,
               None,
               '___sec196'),
              (u'The Boussinesq approximation', 3, None, '___sec197'),
              (u'Scaling', 3, None, '___sec198'),
              (u'The Grashof, Prandtl, and Eckert numbers',
               2,
               None,
               '___sec199'),
              (u'Interpretations of the Grashof number',
               3,
               None,
               '___sec200'),
              (u'Heat transfer at boundaries and the Nusselt and Biot numbers',
               2,
               None,
               '___sec201'),
              (u'Compressible gas dynamics',
               1,
               u'scale:gasdyn',
               u'scale:gasdyn'),
              (u'The Euler equations of gas dynamics',
               2,
               u'scale:Euler_eqs',
               u'scale:Euler_eqs'),
              (u'General isentropic flow', 2, None, '___sec204'),
              (u'Elimination of the pressure', 3, None, '___sec205'),
              (u'The acoustic approximation for sound waves',
               2,
               u'scale:gas:acoustic',
               u'scale:gas:acoustic'),
              (u'Wave nature of isentropic flow with small perturbations',
               3,
               None,
               '___sec207'),
              (u'Basic scaling for small wave perturbations',
               3,
               None,
               '___sec208'),
              (u'Water surface waves driven by gravity',
               1,
               u'scale:surfacewaves',
               u'scale:surfacewaves'),
              (u'The mathematical model',
               2,
               u'scale:surfacewaves:Eulereq',
               u'scale:surfacewaves:Eulereq'),
              (u'Scaling', 2, None, '___sec211'),
              (u'Waves in deep  water', 2, None, '___sec212'),
              (u'Long waves in shallow water', 2, None, '___sec213'),
              (u'Two-phase porous media flow', 1, None, '___sec214'),
              (u'The bidomain model in electrophysiology',
               1,
               u'scale:bidomain',
               u'scale:bidomain'),
              (u'The mathematical model', 2, None, '___sec216'),
              (u'Scaling', 2, None, '___sec217'),
              (u'An alternative $I_{\\rm{ion}}$', 2, None, '___sec218'),
              (u'Exercises', 1, None, '___sec219'),
              (u'Exercise 4.1: Comparison of vibration models for elastic structures',
               2,
               u'scale::exer:elasticity:vibmodels',
               u'scale::exer:elasticity:vibmodels'),
              (u'Exercise 4.2: A model for quasi-static poro-elasticity',
               2,
               u'scale:exer:poroelasticity',
               u'scale:exer:poroelasticity'),
              (u'Problem 4.3: Starting Couette flow',
               2,
               u'scale:vib:exer:starting_Couette',
               u'scale:vib:exer:starting_Couette'),
              (u'References', 1, None, '___sec223')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\half}{\frac{1}{2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\x}{\boldsymbol{x}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\w}{\boldsymbol{w}}
\newcommand{\rpos}{\boldsymbol{r}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\stress}{\boldsymbol{\sigma}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\U}{\boldsymbol{U}}
\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
\newcommand{\ir}{\boldsymbol{i}_r}
\newcommand{\ith}{\boldsymbol{i}_{\theta}}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href=".trash82dee82e1274a586571086dca04d00308d3a0d86.html">Scaling of Differential Equations</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#ch:preface" style="font-size: 80%;"><b>Preface</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#scale:dimunit" style="font-size: 80%;"><b>Dimensions and units</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Fundamental concepts</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Base units and dimensions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#scale:dimunit:tables" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dimensions of common physical quantities</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Prefixes for units</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#scale:dimunit:Pi" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Buckingham Pi theorem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Absolute errors, relative errors, and units</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec8" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Units and computers</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec9" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unit systems</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec10" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example on challenges arising from unit systems</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#scale:PQ" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PhysicalQuantity: a tool for computing with units</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#scale:parampool" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Parampool: user interfaces with automatic unit conversion</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec13" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example application</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec14" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pool of parameters</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec15" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fetching pool data for computing</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec16" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reading command-line options</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec17" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setting default values in a file</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec18" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specifying multiple values of input parameters</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec19" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generating a graphical user interface</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec20" style="font-size: 80%;"><b>Ordinary differential equation models</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:decay" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exponential decay problems</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec22" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fundamental ideas of scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec23" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The basic model problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec24" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Population dynamics</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec25" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Decay of pressure with altitude</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:steps" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The technical steps of the scaling procedure</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec27" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 1: Identify independent and dependent variables</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 2: Make independent and dependent variables dimensionless</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec29" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 3: Derive the model involving only dimensionless variables</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec30" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 4: Make each term dimensionless</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec31" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 5: Estimate the scales</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:prog" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making software for utilizing the scaled model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec33" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software for the original unscaled problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec34" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software for the scaled problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec35" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation with joblib</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:body" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling a generalized problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec37" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec38" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Theory</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec39" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:jump" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variable coefficients</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#scale:cooling:const" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling a cooling problem with constant temperature in the surroundings</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec42" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec43" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec44" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec45" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#scale:cooling:osc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling a cooling problem with time-dependent surroundings</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec47" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec48" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec49" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec50" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discussion of the time scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:nonlinear" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling a nonlinear ODE</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec52" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec53" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec54" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIR ODE system for spreading of diseases</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec55" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec56" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec57" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec58" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIRV model with finite immunity</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#scale:MMK" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Michaelis-Menten kinetics for biochemical reactions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec60" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Classical analysis</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec61" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dimensionless ODE system</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec62" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Determining scales</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec63" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Conservation equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec64" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis of the scaled system</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#sec:scale:vib" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vibration problems</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#sec:scale:vib:undamped" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Undamped vibrations without forcing</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec67" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The first technical steps of scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec68" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec69" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discussion of the displacement scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec70" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discussion of the time scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec71" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The dimensionless solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec72" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative displacement scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec73" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;About frequency and dimensions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#sec:scale:vib:undamped:mg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Undamped vibrations with constant forcing</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#sec:scale:vib:undamped:F" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Undamped vibrations with time-dependent forcing</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec76" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Investigating scales via analytical solutions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec77" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The displacement and time scales</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec78" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finding the displacement scale from the differential equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec79" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling with free vibrations as time scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec80" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec81" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) close to resonance</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec82" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unit size of all terms in the ODE</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec83" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) when \( \psi\gg\omega \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec84" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Displacement scale based on \( I \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#sec:scale:vib:damped:F" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Damped vibrations with forcing</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec86" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec87" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing scales</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec88" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) at resonance</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec89" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) when \( \omega\gg\psi \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec90" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) when \( \omega\ll\psi \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec91" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec92" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oscillating electric circuits</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec93" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#sec:scale:exer:US2SI1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.1: Perform unit conversion</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#sec:scale:exer:ball_y" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.2: Scale a simple formula</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#sec:scale:exer:decay:cooling:osc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.3: Perform alternative scalings</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#sec:scale:exer:ball_y_wdrag" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.4: A nonlinear ODE for vertical motion with air resistance</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#sec:scale:exer:decay:jump" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.5: Solve a decay ODE with discontinuous coefficient</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#sec:scale:exer:decay:cooling" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.6: Implement a scaled model for cooling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#scale:exer:decay:step" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.7: Decay ODE with discontinuous coefficients</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#scale:exer:nonlin:logistic2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.8: Alternative scalings of a cooling model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#scale:vib:exer:projectile" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.9: Projectile motion</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#scale:exer:predprey" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.10: A predator-prey model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#scale:exer:competing_species" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.11: A model for competing species</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#scale:exer:sine" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.12: Find the period of sinusoidal signals</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec106" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#scale:vib:exer:sliding" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.13: Oscillating mass with sliding friction</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#sec:scale:exer:pendulum" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.14: Pendulum equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#sec:scale:exer:binary_star" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.15: ODEs for a binary star</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#scale:vib:exer:Duffing" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.16: Duffing's equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#scale:vib:exer:rocket" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.17: Vertical motion in a varying gravity field</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#scale:vib:exer:quantum" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.18: A simplified Schroedinger equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86006.html#___sec113" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec114" style="font-size: 80%;"><b>Basic partial differential equation models</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#sec:scale:wave" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The wave equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#sec:scale:wave:bc_u0" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Homogeneous Dirichlet conditions in 1D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#sec:scale:wave:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation of the scaled wave equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec118" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Waves on a string</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec119" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Detecting an already computed case</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#scale:wave:pde2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time-dependent Dirichlet condition</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec121" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec122" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec123" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specific case</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#scale:wave:pde2:Vcond" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Velocity initial condition</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec125" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analytical insight</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec126" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec127" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nonzero initial shape</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#scale:wave:pde2:cvar" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variable wave velocity and forcing</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec129" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Non-dimensionalization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec130" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing the time scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec131" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing the spatial scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec132" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling the velocity initial condition</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#scale:wave:pde2:damped" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Damped wave equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec134" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A three-dimensional wave equation problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#sec:scale:diffu" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#sec:scale:diffu:homo1D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Homogeneous 1D diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec137" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing the time scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec138" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analytical insight</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec139" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing other scales</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec140" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generalized diffusion PDE</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec141" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jump boundary condition</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec142" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oscillating Dirichlet condition</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec143" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling issues</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec144" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec145" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time and length scales</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec146" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The scaled problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec147" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Simulations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#sec:scale:diffu:Fisher" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Reaction-diffusion equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec149" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fisher's equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec150" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Balance of all terms</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec151" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fixed length scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec152" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nonlinear reaction-diffusion PDE</a></li>
     <!-- navigation toc: --> <li><a href="#scale:convdiff" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The convection-diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="#___sec154" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Convection-diffusion without a force term</a></li>
     <!-- navigation toc: --> <li><a href="#___sec155" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stationary PDE</a></li>
     <!-- navigation toc: --> <li><a href="#scale:convdiff:f" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Convection-diffusion with a source term</a></li>
     <!-- navigation toc: --> <li><a href="#___sec157" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="#scale:vib:exer:stationary_Couette" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 3.1: Stationary Couette flow</a></li>
     <!-- navigation toc: --> <li><a href="#___sec159" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#scale:vib:exer:Couette_wpressure" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.2: Couette-Poiseuille flow</a></li>
     <!-- navigation toc: --> <li><a href="#scale:exer:pipeflow:pulsatile" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.3: Pulsatile pipeflow</a></li>
     <!-- navigation toc: --> <li><a href="#scale:exer:cable_eq" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.4: The linear cable equation</a></li>
     <!-- navigation toc: --> <li><a href="#scale:exer:twometal" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.5: Heat conduction with discontinuous initial condition</a></li>
     <!-- navigation toc: --> <li><a href="#___sec164" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#diffu:exer:welding" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 3.6: Scaling a welding problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec166" style="font-size: 80%;"><b>Advanced partial differential equation models</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:elasticity" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The equations of linear elasticity</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:elasticity:timedep" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The general time-dependent elasticity problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec169" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:elasticity:PDE1:stress" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dimensionless stress tensor</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:elasticity:waves" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When can the acceleration term be neglected?</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec172" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S waves</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec173" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P waves</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec174" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time-varying load</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:elasticity:stationary" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The stationary elasticity problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec176" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling of the PDE</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec177" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark on the characteristic displacement</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec178" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling of displacement boundary conditions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec179" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling of traction boundary conditions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:elasticity:thermo" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Quasi-static thermo-elasticity</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#sec:scale:ns" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The Navier-Stokes equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec182" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The momentum equation without body forces</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec183" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec184" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dimensonless PDEs and the Reynolds number</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec185" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling of time for low Reynolds numbers</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec186" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shear stress as pressure scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec187" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gravity force and the Froude number</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec188" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oscillating boundary conditions and the Strouhal number</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec189" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cavitation and the Euler number</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#freesurface:Weber" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Free surface conditions and the Weber number</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec191" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Thermal convection</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec192" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Forced convection</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:fluid:forced_convection" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Free convection</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec194" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Governing equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec195" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Heating by viscous effects</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec196" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relation between density and temperature</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec197" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Boussinesq approximation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec198" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec199" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Grashof, Prandtl, and Eckert numbers</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec200" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interpretations of the Grashof number</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec201" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Heat transfer at boundaries and the Nusselt and Biot numbers</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:gasdyn" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Compressible gas dynamics</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:Euler_eqs" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Euler equations of gas dynamics</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec204" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;General isentropic flow</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec205" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Elimination of the pressure</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:gas:acoustic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The acoustic approximation for sound waves</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec207" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wave nature of isentropic flow with small perturbations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec208" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic scaling for small wave perturbations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:surfacewaves" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Water surface waves driven by gravity</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:surfacewaves:Eulereq" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The mathematical model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec211" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec212" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Waves in deep  water</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec213" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Long waves in shallow water</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec214" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Two-phase porous media flow</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:bidomain" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The bidomain model in electrophysiology</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec216" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The mathematical model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec217" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec218" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An alternative \( I_{\rm{ion}} \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec219" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale::exer:elasticity:vibmodels" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4.1: Comparison of vibration models for elastic structures</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:exer:poroelasticity" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4.2: A model for quasi-static poro-elasticity</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:vib:exer:starting_Couette" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 4.3: Starting Couette flow</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#___sec223" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;References</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0009"></a>
<!-- !split -->

<h1 id="scale:convdiff">The convection-diffusion equation</h1>

<h2 id="___sec154">Convection-diffusion without a force term </h2>

<p>
We now add a convection term \( \boldsymbol{v}\cdot\nabla u \) to the diffusion
equation to obtain the well-known convection-diffusion equation:

$$
\begin{equation}
\frac{\partial u}{\partial t} + \v\cdot\nabla u =
\dfc\nabla^2 u,
\quad  x,y, z\in \Omega,\ t\in (0, T]\tp
\tag{3.69}
\end{equation}
$$

The velocity field \( \v \) is prescribed, and its characteristic size \( V \)
is normally clear from the problem description. In the sketch below,
we have some given flow over a bump, and \( u \) may be the concentration
of some substance in the fluid. Here, \( V \) is typically \( \max_y v(y) \).
The characteristic length \( L \) could be the entire domain, \( L=c+\ell \),
or the height of the bump, \( L=D \). (The latter is the important length
scale for the flow.)

<p>
<br />
<br />

<p>
<center><p><img src="fig-scaling/flow_over_gaussian.png" align="bottom" width=500></p></center>

<p>
<br />
<br />

<p>
Inserting

$$ \bar x = \frac{x}{x_c},\ \bar y = \frac{y}{y_c},\ \bar z = \frac{z}{z_c},
\ \bar t = \frac{t}{t_c}, \ \bar\v = \frac{\v}{V},
\ \bar u =\frac{u}{u_c}$$

in <a href="#mjx-eqn-3.69">(3.69)</a> yields

$$
\frac{u_c}{t_c}
\frac{\partial \bar u}{\partial \bar t} +
\frac{u_c V}{L}\bar\v\cdot\bar\nabla\bar u =
\frac{\dfc u_c}{L^2}\bar\nabla^2\bar u,
\quad \bar x,\bar y,\bar z\in \Omega,\ \bar t\in (0,\bar T]\tp
$$

For \( u_c \) we simply introduce the symbol \( U \), which we may estimate
from an initial condition. It is not critical here, since it vanishes
from the scaled equation anyway, as long as there is no source term
present.
With some velocity measure \( V \) and length measure \( L \), it is
tempting to just let \( t_c = L/V \). This is the characteristic time it takes to
transport a signal by convection through the domain.
The alternative is to use the
diffusion length scale \( t_c=L^2/\dfc \). A common physical scenario in
convection-diffusion problems is that
the convection term \( \v\cdot\nabla u \) dominates over the
diffusion term \( \dfc\nabla^2 u \). Therefore, the time scale for convection
(\( L/V \))
is most appropriate of the two. Only when
the diffusion term is very much larger than the convection
term (corresponding to very small Peclet numbers, see below)
\( t_c=L^2/\dfc \) is the right time scale.

<p>
The non-dimensional form of the PDE with \( t_c=L/V \) becomes

$$
\begin{equation}
\frac{\partial \bar u}{\partial \bar t} +
\bar\v\cdot\bar\nabla\bar u =
\hbox{Pe}^{-1}\bar\nabla^2\bar u,
\quad \bar x,\bar y,\bar z\in \Omega,\ \bar t\in (0,\bar T],
\tag{3.70}
\end{equation}
$$

where Pe is the <em>Peclet number</em>,

$$ \hbox{Pe} = \frac{LV}{\dfc}\tp$$

Estimating the size of the convection term \( \v\cdot\nabla u \) as
\( VU/L \) and the diffusion term \( \dfc\nabla^2 u \) as \( \dfc U/L^2 \),
we see that the Peclet number measures the ratio of the convection
and the diffusion terms:

$$ \hbox{Pe} = \frac{\hbox{convection}}{\hbox{diffusion}} =
\frac{VU/L}{\dfc U/L^2}= \frac{LV}{\dfc}\tp
$$

<p>
In case we use the diffusion time scale
\( t_c=L^2/\dfc \), we get the non-dimensional PDE

$$
\begin{equation}
\frac{\partial \bar u}{\partial \bar t} +
\hbox{Pe}\,\bar\v\cdot\bar\nabla\bar u =
\bar\nabla^2\bar u,
\quad \bar x,\bar y,\bar z\in \Omega,\ \bar t\in (0,\bar T]\tp
\tag{3.71}
\end{equation}
$$

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Discussion of scales and balance of terms in the PDE.</b>
We see that <a href="#mjx-eqn-3.70">(3.70)</a> and <a href="#mjx-eqn-3.71">(3.71)</a>
are not equal, and they are based on two different time scales.
For moderate Peclet numbers around 1, all terms have the same size
in <a href="#mjx-eqn-3.70">(3.70)</a>, i.e., a size around unity.
For large Peclet numbers,
<a href="#mjx-eqn-3.70">(3.70)</a> expresses a balance
between the time derivative term and the convection term, both of size
unity, and then there is a very small
\( \hbox{Pe}^{-1}\bar\nabla^2\bar u \) term because Pe is large and
\( \bar\nabla^2\bar u \) should be of size unity.
That the convection term dominates over the diffusion term is
consistent with the time scale \( t_c=L/V \) based on convection transport.
In this case, we can neglect the diffusion term as Pe goes to infinity
and work with a pure convection (or advection) equation

$$
\frac{\partial \bar u}{\partial \bar t} +
\bar\v\cdot\bar\nabla\bar u = 0\tp
$$

<p>
For small Peclet numbers, \( \hbox{Pe}^{-1}\bar\nabla^2\bar u \) becomes
very large and can only be balanced by two terms that are supposed to
be unity of size.  The time-derivative and/or the convection term must
be much larger than unity, but that means we use suboptimal scales,
since right scales imply that \( \partial\bar u/\partial\bar t \) and
\( \bar v\cdot\bar\nabla\bar u \) are of order unity. Switching to a time
scale based on diffusion as the dominating physical effect gives
<a href="#mjx-eqn-3.71">(3.71)</a>.  For very small Peclet numbers this
equation tells that the time-derivative balances the diffusion.
The convection term \( \bar\v\cdot\bar\nabla\bar\u \) is around
unity in size, but multiplied by a very small coefficient Pe, so this term is
negligible in the PDE. An approximate PDE for small Peclet numbers is
therefore

$$
\frac{\partial \bar u}{\partial \bar t}
= \bar\nabla^2\bar u\tp
$$

<p>
Scaling can, with the above type of reasoning, be used
to neglect terms from a differential equation under precise mathematical
conditions.
</div>


<h2 id="___sec155">Stationary PDE </h2>

<p>
Suppose the problem is stationary and that there is no need for
any time scale. How is this type of convection-diffusion problem
scaled? We get

$$
\frac{VU}{L}\bar\v\cdot\bar\nabla\bar u =
\frac{\dfc U}{L^2}\bar\nabla^2\bar u,
$$

or

$$
\begin{equation}
\bar\v\cdot\bar\nabla\bar u =
\hbox{Pe}^{-1}\bar\nabla^2\bar u\tp
\tag{3.72}
\end{equation}
$$

This scaling only &quot;works&quot; for moderate Peclet numbers. For very small or
very large Pe, either the convection term \( \bar\v\cdot\bar\nabla\bar u \)
or the diffusion term \( \bar\nabla^2\bar u \) must deviate significantly
from unity.

<p>
Consider the following 1D example to illustrate the point: \( \v = v\ii \),
\( v>0 \) constant, a domain \( [0,L] \), with boundary conditions \( u(0)=0 \) and
\( u(L)=U_L \). (The vector \( \ii \) is a unit vector in \( x \) direction.)
The problem with dimensions is now

$$ vu^{\prime} = \dfc u^{\prime\prime},\quad u(0)=0,\ u(L)=U_L\tp$$

Scaling results in

$$ \frac{d\bar u}{d\bar x} = \hbox{Pe}^{-1}\frac{d^2\bar u}{d\bar x^2},\quad
\bar x\in (0,1),\quad \bar u(0)=0,\ \bar u(1) = 1,$$

if we choose \( U=U_L \). The solution of the scaled problem is

<p>
\[ \bar u(\bar x) = \frac{1 - e^{\bar x{\small\hbox{Pe}}}}{1 - e^{\small\hbox{Pe}}}\tp\]
Figure <a href="#scale:convdiff:fig:scaled">18</a> indicates how \( \bar u \) depends on
Pe: small Pe values give approximately a straight line while large Pe
values lead to a <em>boundary layer</em> close to \( x=1 \), where the solution
changes very rapidly.

<p>
<center> <!-- figure label: --> <div id="scale:convdiff:fig:scaled"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 18:  Solution of scaled problem for 1D convection-diffusion.  <!-- caption label: scale:convdiff:fig:scaled --> </p></center>
<p><img src="fig-scaling/boundary_layer1D.png" align="bottom" width=600></p>
</center>

<p>
We realize that for large Pe,

$$ \max_{\bar x}\frac{d\bar u}{d\bar x} \approx \hbox{Pe},\quad
\max_{\bar x}\frac{d^2\bar u}{d\bar x^2} \approx \hbox{Pe}^{2},$$

which are consistent results with the PDE, since the double derivative term
is multiplied by \( \hbox{Pe}^{-1} \).
For small Pe,

$$ \max_{\bar x}\frac{d\bar u}{d\bar x}\approx 1,\quad
   \max_{\bar x}\frac{d^2\bar u}{d\bar x^2} \approx 0,$$

which is also consistent with the PDE,
since an almost vanishing second-order derivative
is multiplied by a very large coefficient \( \hbox{Pe}^{-1} \).
However, we have a problem with very large
derivatives of \( \bar u \) when Pe is large.

<p>
To arrive at a proper scaling for large Peclet numbers,
we need to remove the Pe coefficient
from the differential equation. There are only two scales at our
disposals: \( u_c \) and \( x_c \) for \( u \) and \( x \), respectively.
The natural value for \( u_c \) is the boundary value \( U_L \) at \( x=L \).
The scaling of \( Vu_x = \dfc u_{xx} \) then results in

$$ \frac{d\bar u}{d\bar x} = \frac{\dfc}{Vx_c}\frac{d^2\bar u}{d\bar x^2},
\quad \bar x\in (0,\bar L),\quad \bar u(0)=0,\ \bar u(\bar L)=1,$$

where \( \bar L = L/x_c \). Choosing the coefficient \( \dfc/(Vx_c) \) to
be unity results in the scale \( x_c=\dfc/V \), and \( \bar L \) becomes Pe.
The final, scaled boundary-value
problem is now

$$ \frac{d\bar u}{d\bar x} = \frac{d^2\bar u}{d\bar x^2},
\quad \bar x \in (0, \hbox{Pe}), \quad \bar u(0)=0,\ \bar u(\hbox{Pe})=1,$$

with solution

$$ \bar u(\bar x) = \frac{1 - e^{\bar x}}{1 - e^{\small\mbox{Pe}}}\tp$$

Figure <a href="#scale:convdiff:fig:rescaled">19</a> displays \( \bar u \) for some
Peclet numbers, and we see that the shape of the graphs are the same
with this scaling. For large Peclet numbers we realize that \( \bar u \)
and its derivatives are around unity
(\( 1-e^{\hbox{Pe}}\approx -e^{\small\hbox{Pe}} \)),
but for small Peclet numbers \( d\bar u/d\bar x \sim \hbox{Pe}^{-1} \).

<p>
<center> <!-- figure label: --> <div id="scale:convdiff:fig:rescaled"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 19:  Solution of scaled problem where the length scale depends on the Peclet number.  <!-- caption label: scale:convdiff:fig:rescaled --> </p></center>
<p><img src="fig-scaling/boundary_layer1D_scale2.png" align="bottom" width=600></p>
</center>

<p>
The conclusion is that for small Peclet numbers, \( x_c=L \) is an
appropriate length scale.
The scaled equation \( \hbox{Pe}\,\bar u' = \bar u'' \) indicates that \( \bar
u''\approx 0 \), and the solution is close to a straight line.  For
large Pe values, \( x_c=\dfc/V \) is an appropriate length scale, and the
scaled equation \( \bar u' = \bar u'' \)
expresses that the terms \( \bar u' \) and \( \bar u'' \) are
equal and of size around unity.

<h2 id="scale:convdiff:f">Convection-diffusion with a source term</h2>

<p>
Let us add a force term \( f(\x,t) \) to the convection-diffusion equation:

$$
\begin{equation}
\frac{\partial u}{\partial t} + \v\cdot\nabla u =
\dfc\nabla^2 u + f\tp
\tag{3.73}
\end{equation}
$$

The scaled version reads

$$
\frac{\partial\bar u}{\partial\bar t} +
\frac{t_cV}{L}\bar\v\cdot\bar\nabla \bar u =
\frac{t_c\dfc}{L^2}\bar\nabla^2 \bar u +
\frac{t_cf_c}{u_c}\bar f\tp
$$

We can base \( t_c \) on convective transport: \( t_c = L/V \). Now,
\( u_c \) could be chosen to make the coefficient in the source term unity:
\( u_c = t_cf_c = Lf_c/V \).
This leaves us with

$$
\frac{\partial\bar u}{\partial\bar t} +
\bar\v\cdot\bar \nabla\bar u =
\hbox{Pe}^{-1}\bar \nabla^2 \bar u + \bar f\tp
$$

<p>
In the diffusion limit, we base \( t_c \) on the diffusion time scale:
\( t_c=L^2/\dfc \), and the coefficient of the source term set to unity
determines \( u_c \) according to

$$ \frac{L^2 f_c}{\dfc u_c} = 1\quad\Rightarrow\quad u_c = \frac{L^2 f_c}{\dfc}\tp$$

The corresponding PDE reads

$$
\frac{\partial\bar u}{\partial\bar t} +
\hbox{Pe}\,\bar\v\cdot\bar \nabla\bar u =
\bar\nabla^2 \bar u + \bar f,
$$

so for small Peclet numbers, which we have, the convective term can
be neglected and we get a pure diffusion equation with a source term.

<p>
What if the problem is stationary?
Then there is no time scale and we get

$$
\frac{V u_c}{L}\bar\v\cdot\bar \nabla \bar u =
\frac{u_c \dfc}{L^2}\bar\nabla^2 \bar u + f_c\bar f,
$$

or

$$
\bar\v\cdot\bar \nabla \bar u =
\hbox{Pe}^{-1}\bar\nabla^2 \bar u + \frac{f_c L}{V u_c}\bar f\tp
$$

Again, choosing \( u_c \) such that the source term coefficient is unity leads
to \( u_c= f_c L/V \).
Alternatively, \( u_c \) can be based on the initial condition, with similar
results as found in the sections on the wave and diffusion PDEs.

<h1 id="___sec157">Exercises </h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:stationary_Couette">Problem 3.1: Stationary Couette flow</h2>

<p>
A fluid flows between two flat plates, with one plate at rest while
the other moves with velocity \( U_0 \). This classical flow case is known as
stationary <a href="https://en.wikipedia.org/wiki/Couette_flow" target="_self">Couette flow</a>.

<p>
<b>a)</b>
Directing the \( x \) axis in the flow direction and letting \( y \) be
a coordinate perpendicular to the walls, one can assume that
the velocity field simplifies to \( \u = u(y)\ii \).
Show from the Navier-Stokes equations that the boundary-value problem
for \( u(y) \) is

$$ u^{\prime\prime}(u) = 0,\quad u(0)=0,\ u(H)=U_0\tp$$

We have here assumed at \( y=0 \) corresponds to the plate at rest and
that \( y=H \) represents the plate that moves. There are no pressure
gradients present in the flow.

<p>
<b>b)</b>
Scale the problem in a) and show that the result has no physical parameters
left in the model:

$$ \frac{d^2\bar u}{d\bar y^2} = 0,\quad \bar u(0)=0,\ \bar u(1)=1\tp$$

<p>
<b>c)</b>
We can compute \( \bar u(\bar y) \) from one numerical simulation (or a
straightforward integration of the differential equation). Set up
the formula that finds \( u(y; H, u_0) \) from \( \bar u(\bar y) \) for any
values of \( H \) and \( U_0 \).

<p>
Filename: <code>stationary_Couette</code>.

<p>
<!-- Closing remarks for this Problem -->

<h3 id="___sec159">Remarks </h3>

<p>
The problem for \( u \) is a classical two-point boundary-value problem
in applied mathematics and arises in a number of applications, where
Couette flow is just one example. Heat conduction is another
example: \( u \) is temperature, and the heat conduction equation for
an insulated rod reduces to \( u^{\prime\prime}=0 \) under stationary
conditions and no heat source.
Controlling the end \( x=0 \) at 0 degrees Celsius the other end \( x=L \)
at \( U_0 \) degrees
Celsius, gives the same boundary conditions as in the above flow problem.
The scaled problem is of course the same whether we have flow of
fluid or heat.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:Couette_wpressure">Exercise 3.2: Couette-Poiseuille flow</h2>

<p>
Viscous fluid flow between two infinite flat plates \( z=0 \) and \( z=H \)
is governed by

$$
\begin{align}
\mu u''(z) &= -\beta
\tag{3.74}\\ 
u(0) &= 0,
\tag{3.75}\\ 
u(H) &= U_0\tp
\tag{3.76}
\end{align}
$$

Here, \( u(z) \) is the fluid velocity in \( x \) direction (perpendicular to the
\( z \) axis), \( \mu \) is the dynamic viscosity of the fluid, \( \beta \) is
a positive constant pressure gradient, and \( U_0 \) is the
constant velocity of the upper
plate \( z=H \) in \( x \) direction. The model represents
<a href="https://en.wikipedia.org/wiki/Couette_flow" target="_self">Couette flow</a> for \( \beta=0 \)
and <a href="https://en.wikipedia.org/wiki/Hagen-Poiseuille_equation" target="_self">Poiseuille flow</a>
for \( U_0=0 \).

<p>
<b>a)</b>
Find the exact solution \( u(z) \). Point out how \( \beta \) and \( U_0 \)
influence the magnitude of \( u \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_20_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_20_1">

<p>
SymPy can integrate the differential equation twice and fit the
integration constants to the boundary conditions:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">sym</span>
mu, beta, z, H <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>symbols(<span style="color: #BA2121">&#39;mu beta z H&#39;</span>,
                             real<span style="color: #666666">=</span><span style="color: #008000">True</span>, positive<span style="color: #666666">=</span><span style="color: #008000">True</span>)
U0, C1, C2 <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>symbols(<span style="color: #BA2121">&#39;U0 C1 C2&#39;</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>)

<span style="color: #408080; font-style: italic"># Integrate u&#39;&#39;(z) = -beta/mu twice and add integration constants</span>
u <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>integrate(sym<span style="color: #666666">.</span>integrate(<span style="color: #666666">-</span>beta<span style="color: #666666">/</span>mu, z) <span style="color: #666666">+</span> C1, z) <span style="color: #666666">+</span> C2

<span style="color: #408080; font-style: italic"># Use the boundary conditions</span>
eq <span style="color: #666666">=</span> [sym<span style="color: #666666">.</span>Eq(u<span style="color: #666666">.</span>subs(z, <span style="color: #666666">0</span>), <span style="color: #666666">0</span>),
      sym<span style="color: #666666">.</span>Eq(u<span style="color: #666666">.</span>subs(z, H), U0)]
s <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>solve(eq, [C1, C2])
<span style="color: #008000; font-weight: bold">print</span> s
u <span style="color: #666666">=</span> u<span style="color: #666666">.</span>subs(C1, s[C1])<span style="color: #666666">.</span>subs(C2, s[C2])
u <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>simplify(sym<span style="color: #666666">.</span>expand(u))
</pre></div>
<p>
The result becomes

$$ u(z) =
\frac{z}{2 H \mu} \left(H \beta \left(H - z\right) + 2 U_{0} \mu\right)\tp $$

<p>
The maximum value of \( u \) is found by

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># Find max u</span>
dudz <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>diff(u, z)
s <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>solve(dudz, z)
<span style="color: #008000; font-weight: bold">print</span> s
umax <span style="color: #666666">=</span> u<span style="color: #666666">.</span>subs(z, s[<span style="color: #666666">0</span>])
umax <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>simplify(sym<span style="color: #666666">.</span>expand(umax))
</pre></div>
<p>
and reads

$$ \max_z u =
\frac{H^{2} \beta}{8 \mu} + \frac{U_{0}}{2} +
\frac{U_{0}^{2} \mu}{2 H^{2} \beta}\tp
$$

If the pressure gradient is the dominating driving force, we can neglect
the \( U_0 \) terms: \( \max_z u = H^2\beta/(8\mu) \). In case the movement
of the upper plate is much more important than the pressure gradient
for driving the flow, we can neglect the \( \beta \) terms. However, we must
then resort to the \( u(z) \) expression for \( \beta=0 \), \( u(z)=zU_0/H \),
and realize that the maximum then is obtained at the boundary for
\( z=H \): \( \max_z h=U_0 \) (as intuitively obvious).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Scale the problem.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_20_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_20_2">

<p>
Introducing

$$ \bar z = \frac{z}{z_c}, \quad \bar u (\bar z) = \frac{u(z_c\bar z)}{u_c},$$

in the equation gives

$$ \frac{d^2\bar u}{d\bar z^2} = -\frac{z_c^2\beta}{\mu u_c}\tp$$

The natural scale for \( z_c \) is \( H \) since that makes \( \bar z\in [0,1] \).
For the two terms in the differential equation to be of order unity
(with a correct scaling, the left-hand side should be of order unity),
we must have

$$ u_c = \frac{H^2\beta}{\mu}\tp$$

The boundary value problem is

$$
\begin{align*}
\frac{d^2\bar u}{d\bar z^2} &= -1,\quad &\bar z\in (0,1),\\ 
\bar u(0) &= 0,\\ 
\bar u(1) &= \alpha,
\end{align*}
$$

where \( \alpha \) is a dimensionless number

$$ \alpha = \frac{\mu U_0}{H^2\beta}\tp$$

This is meaningful only for \( \beta\neq 0 \).

<p>
Looking at the exact solution, we see that \( \max_z u =
H^2\beta/(8\mu) \), and with this \( \max_z u \) as \( u_c \) we get a
differential equation \( \bar u'' = -8 \) instead, and \( \bar u\in [0,1] \)
(if \( U_0=0 \)). However, the factor \( 1 \) or \( 8 \) on the right-hand side is
not significant, neither if \( \bar u\in [0,1] \) or \( \bar u\in [0,8] \).

<p>
The scale \( u_c \) used above is relevant if the pressure gradient is the
dominating force. If \( U_0 \) is more important than \( \beta \), or \( \beta =0 \),
we choose \( u_c=U_0 \) and get instead

$$
\begin{align}
\frac{d^2\bar u}{d\bar z^2} &= -\alpha^{-1},\quad &\bar z\in (0,1),
\tag{3.77}\\ 
\bar u(0) &= 0,
\tag{3.78}\\ 
\bar u(1) &= 1\tp
\tag{3.79}
\end{align}
$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>Couette_wpressure</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:exer:pipeflow:pulsatile">Exercise 3.3: Pulsatile pipeflow</h2>

<p>
The flow of a viscous fluid in a straight pipe with circular
cross section with radius \( R \) is governed by

$$
\begin{align}
\varrho\frac{\partial u}{\partial t} &= \frac{\mu}{r}\frac{\partial}{\partial r}
\left(r\frac{\partial u}{\partial r}\right) - P(t), & r\in (0,R),\ t\in (0,T],
\tag{3.80}\\ 
\frac{\partial u}{\partial r}(0,t) &= 0, & t\in (0,T],
\tag{3.81}\\ 
u(R,t) &= 0, & t\in (0,T],
\tag{3.82}\\ 
u(r,0) &= 0, & r\in [0,R].
\tag{3.83}
\end{align}
$$

The quantity \( u(r,t) \) is the fluid velocity, \( P(t) \) is a given
pressure gradient, \( \varrho \) is the fluid density, and \( \mu \) is the
dynamic viscosity.

<p>
Assume \( P(t) = A\cos\omega t \). Scale the problem and identify
appropriate dimensionless numbers. Thereafter, assume \( P(t) \) is a more
complicated function, but still period with period \( p \).
Discuss how the scaling can be extended to this case.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_21_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_21_1">

<p>
We introduce dimensionless quantities:

$$ \bar r = \frac{r}{R},\quad \bar t = \frac{t}{t_c},\quad \bar u = \frac{u}{u_c}\tp$$

The function \( P(t) \) can be scaled as

$$ \bar P(\bar t) = \frac{P(t_c\bar t)}{A} = \sin (t_c\omega \bar t)\tp$$

Inserted in the PDE, we get

$$ \frac{\partial\bar u}{\partial\bar t} = \frac{t_c \nu }{R^2}\frac{1}{\bar r}\frac{\partial}{\partial\bar r}
\left(\bar r\frac{\partial\bar u}{\partial\bar r}\right) - \frac{t_c A}{\varrho u_c}\sin (t_c\omega\bar t),$$

where \( \mu = \mu/\varrho \).

<p>
The scale for \( u \) can be explored by seeking an analytical solution
of the problem. Such solutions do exist, they are typically series
expansions of Bessel functions, and it is not so easy to extract
a simple expression for the maximum value of \( |u(r,t)| \).
A simpler approach is to estimate \( u_c \) by demanding the coefficient
in the pressure term to be of unit size:

$$ u_c = \frac{t_cA}{\varrho}\tp$$

There are two choices of time scales: the pressure time scale \( t_c=1/\omega \)
and the viscosity (or diffusion) time scale \( t_c=R^2/nu \). With the latter,
we get \( u_c = R^2 A/\mu \) and

$$ \frac{\partial\bar u}{\partial\bar t} = \frac{1}{\bar r}\frac{\partial}{\partial\bar r}
\left(\bar r\frac{\partial\bar u}{\partial\bar r}\right) - \sin (\alpha\bar t),$$

where

$$ \alpha = \frac{R^2\omega}{\nu} = \frac{R^2/\nu}{1/\omega},$$

showing that \( \alpha \) is the ratio of the viscosity time scale and
the pressure oscillation time scale.

<p>
With the pressure time scale we have

$$ u_c = \frac{\varrho A}{\omega},$$

and the scaled PDE becomes

$$ \frac{\partial\bar u}{\partial\bar t} = \alpha^{-1}\frac{1}{\bar r}\frac{\partial}{\partial\bar r}
\left(\bar r\frac{\partial\bar u}{\partial\bar r}\right) - \sin (\bar t)\tp$$

In both cases the scaled boundary conditions become

$$ \frac{\partial\bar u}{\partial\bar t} = 0,\quad
\bar u(1,\bar t) = 0,$$

for \( t\in (0,T/t_c] \), and \( \bar u(\bar r, 0)=0 \) for \( \bar r\in [0,1] \).

<p>
If \( P(t) \) is not sinusoidal but periodic with period \( p \), we have that
\( P \) is a function of \( \omega t \) as above, with \( \omega = 2\pi/p \).
Everything in the scaling remains the same, just the \( \sin \) term changes
to \( P(\alpha\bar t) \) if the time scale is based on viscosity (diffusion),
and \( P(\bar t) \) if the time scale is based on the pressure oscillations.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>pipeflow</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:exer:cable_eq">Exercise 3.4: The linear cable equation</h2>

<p>
A key PDE in neuroscience is the <a href="https://en.wikipedia.org/wiki/Cable_theory" target="_self">cable equation</a>, here given in its simplest linear form:

$$
\begin{equation}
\tau\frac{\partial u}{\partial t} = \lambda^2\frac{\partial^2 u}{\partial x^2}
-u\tp
\tag{3.84}
\end{equation}
$$

The unknown \( u \) is the voltage (measured in volt) associated with
an electric current along one-dimensional dendrites (&quot;cables&quot;)
in neural networks, while \( \tau \) and \( \lambda \) are given parameters.

<p>
Scale <a href="#mjx-eqn-3.84">(3.84)</a> in three ways: 1) let all terms in
the scaled equation have unit coefficients, 2) use the domain size
\( L \) as spatial scale and base the time scale on diffusion, 3) use the
domain size \( L \) as spatial scale and base the time scale on
reaction, i.e., the \( -u \) term.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_22_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_22_1">

<p>
Straightforward scaling, with scales \( u_c \), \( t_c \), and \( x_c \),
leads in the first step to

$$ \frac{\partial\bar u}{\partial\bar t} =
\frac{t_c\lambda^2}{\tau x_c^2}\frac{\partial^2\bar u}{\partial\bar x^2}
- \frac{t_c}{\tau}\bar u\tp$$

Assuming that all terms are equally important and of unit size
in the scaled PDE, we get a uniquely determined length and space scale:

$$ t_c = \tau,\quad x_c = \lambda\tp$$

The scaled cable equation is then

$$
\frac{\partial\bar u}{\partial\bar t} =
\frac{\partial^2\bar u}{\partial\bar x^2}
- \bar u\tp
$$

<p>
Let now the spatial scale be fixed as \( x_c=L \).  Basing \( t_c \) on
diffusion means \( t_c = \tau (L/\lambda)^2 \), and the scaled PDE becomes

$$ \frac{\partial\bar u}{\partial\bar t} =
\frac{\partial^2\bar u}{\partial\bar x^2}
- \beta\bar u,$$

where

$$ \beta = \left(\frac{L}{\lambda}\right)^2\tp$$

<p>
Basing \( t_c \) on the reaction scale, i.e., the balance of the time
derivative and the reaction term, gives \( t_c=\tau \) and the scaled PDE

$$ \frac{\partial\bar u}{\partial\bar t} =
\beta^{-1}\frac{\partial^2\bar u}{\partial\bar x^2}
- \bar u\tp$$

<p>
In neuroscience applications of the cable equation to dendrites, it
appears that \( \lambda \) is about 1 mm and of the same order of
magnitude as the cable length, so \( \beta \) is around 1 in size.
Then there are not big differences in these scalings, and the first
one is to be preferred. The two others are more suitable when
\( \beta \) is small or large, e.g., such that the term with \( \beta \) can be
left out of the PDE.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>cable_eq</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:exer:twometal">Exercise 3.5: Heat conduction with discontinuous initial condition</h2>

<p>
Two pieces of metal at different temperature are brought in contact
at \( t=0 \). The following initial-boundary value problem governs the
temperature evolution in the two pieces:

$$
\begin{align}
\frac{\partial u}{\partial t} &= \dfc\nabla^2 u,\ & \x\in\Omega,\ t\in (0,T],
\tag{3.85}\\ 
u(\x,0)&=I(x), & \x\in \Omega,
\tag{3.86}\\ 
-\dfc\frac{\partial u}{\partial n} &= h(u-u_S),
& x\in\partial\Omega,\ t\in (0,T].
\tag{3.87}
\end{align}
$$

Here, \( u(\x,t) \) is the temperature, \( \dfc \) the effective heat diffusion
coefficient (assuming both pieces are homogeneous and of the same type of
metal), and \( u_S \) is the surrounding temperature.
The domain \( \Omega \) consists of the two pieces \( \Omega_1 \) and \( \Omega_2 \):
\( \Omega = \Omega_1\cup\Omega_2 \). The initial condition can be specified as

$$ I(x) = \left\lbrace\begin{array}{ll}
U_1, & \x\in\Omega_1,\\ 
U_2, & \x\in\Omega_2,
\end{array}\right.
$$

where \( U_1 \) and \( U_2 \) are the constant initial temperatures in each piece.

<p>
Thinking of two identical pieces \( \Omega_1 \) and \( \Omega_2 \) with shapes
as bricks, it is tempting to develop a one-dimensional model,
especially if the pieces are somewhat slender. We then expect the main
temperature variations to take place in the \( x \) direction, where the
\( x \) axis is perpendicular to the contact surface between the pieces.
A simplified PDE problem, neglecting variations in the \( y \) and \( z \)
directions, takes the form

$$
\begin{align}
\frac{\partial v}{\partial t} &=
\dfc \frac{\partial^2 v}{\partial x^2}
-\frac{hP}{A}(v(x,t) -u_S),\ & x\in (0,L),\ t\in (0,T],
\tag{3.88}\\ 
v(x,0)&=I(x), & x\in (0,L),
\tag{3.89}\\ 
 \dfc\frac{\partial v}{\partial x} &= h(v(x,t)-u_S), & x=0,\ t\in (0,T],
\tag{3.90}\\ 
-\dfc\frac{\partial v}{\partial x} &= h(v(x,t)-u_S), & x=L,\ t\in (0,T],
\tag{3.91}
\end{align}
$$

with

$$
I(x) = \left\lbrace\begin{array}{ll}
U_1, & x\in [0,L/2),\\ 
U_2, & x\in [L/2, L]\tp
\end{array}\right.
$$

The parameter \( P \) is the perimeter of the cross section and \( A \) is the
area of the cross section. Scale this problem.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_23_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_23_1">

<p>
We expect the temperature to start from the discontinuous state with
\( U_1 \) and \( U_2 \) and approach the surrounding temperature \( u_S \) in
the cooling law as \( t\rightarrow\infty \). One suitable scaling is
then

$$ \bar v = \frac{v - \min (U_1,U_2)}{u_S-\min (U_1, U_2)},$$

since this implies that \( u \) varies from 0 to 1. Without loss of
generality we number the bricks such that \( U_1 < U_2 \), so

$$ \bar v = \frac{v - U_1}{u_S-U_1}\tp$$

Furthermore,

$$ \bar x = \frac{x}{L},\quad \bar t = \frac{t}{t_c}\tp$$

Inserted in the governing PDE, we have

$$
\frac{\partial\bar v}{\partial\bar t} =
\frac{t_c\dfc}{L^2}\frac{\partial^2\bar v}{\partial\bar x^2}
-\frac{t_c hP}{A(u_S-U_1)}
(U_1 + (u_S-U_1) \bar v(x,t) - u_S),$$

which simplifies to

$$
\frac{\partial\bar v}{\partial\bar t} =
\frac{t_c\dfc}{L^2}\frac{\partial^2\bar v}{\partial\bar x^2}
-\frac{t_c hP}{A}
(\bar v(x,t) - 1)\tp$$

The natural time scale is that of diffusion: \( t_c = L^2/\dfc \).
This choice results in the scaled PDE

$$
\frac{\partial\bar v}{\partial\bar t} =
\frac{\partial^2\bar v}{\partial\bar x^2}
-\overline{\hbox{Bi}}^{}\,(\bar v(x,t) - 1),$$

where the dimensionless number

$$ \overline{\hbox{Bi}}^{} = \frac{hL^2P}{\dfc A}$$

can be interpreted as a modified <a href="https://en.wikipedia.org/wiki/Biot_number" target="_self">Biot number</a> (if \( A/P=L \), it would an
ordinary Biot number, but here this is not an appropriate
approximation: for bricks with square cross section of length \( a \), \( A/P=a/4 \),
and for a circular cross section, \( A/P=R/2 \)).
This modified Biot number governs the significance of
lateral heat loss/gain to/from the environment.

<p>
The scaled initial condition becomes

$$
\bar v(\bar x,0)=0
\hbox{ if } 0\leq x < 1/2\hbox{ else } \beta,$$

where \( \beta \) is the dimensionless number

$$ \beta = \frac{U_2 - U_1}{U_s - U_1}\tp$$

The scaled boundary conditions take the form

$$
 \frac{\partial}{\partial\bar x}\bar v(0,t) = \hbox{Bi}\,
 (\bar v(0,t)-1),\quad
-\frac{\partial}{\partial\bar x}\bar v(L,t) = \hbox{Bi}\,
(\bar v(L,t)-1),
$$

where Bi is the standard Biot number for heat conduction from solids:

$$ \hbox{Bi} = \frac{Lh}{\dfc}\tp$$

<p>
Here is a simulation with \( \hbox{Bi}=0.01 \), \( \overline{\hbox{Bi}}^{} = 0.2 \),
and \( \beta =1.5 \)
(using the <code>diffusion_two_metal_pieces</code> function in
<a href="http://tinyurl.com/o8pb3yy/session.py" target="_self"><tt>session.py</tt></a>).

<p>

<div>
<video  loop controls width='640' height='365' preload='none'>
    <source src='https://github.com/hplgit/scaling-book/raw/master/doc/pub/book/html/mov-scaling/metal_pieces/movie.mp4'  type='video/mp4;  codecs="avc1.42E01E, mp4a.40.2"'>
    <source src='https://github.com/hplgit/scaling-book/raw/master/doc/pub/book/html/mov-scaling/metal_pieces/movie.webm' type='video/webm; codecs="vp8, vorbis"'>
    <source src='https://github.com/hplgit/scaling-book/raw/master/doc/pub/book/html/mov-scaling/metal_pieces/movie.ogg'  type='video/ogg;  codecs="theora, vorbis"'>
</video>
</div>
<p><em></em></p>

<!-- Issue warning if in a Safari browser -->
<script language="javascript">
if (!!(window.safari)) {
  document.write("<div style=\"width: 95%%; padding: 10px; border: 1px solid #100; border-radius: 4px;\"><p><font color=\"red\">The above movie will not play in Safari - use Chrome, Firefox, or Opera.</font></p></div>")}
</script>

<p>
Another temperature scaling is also possible:

$$ \bar v = \frac{v - U_s}{U_2-U_s}\tp$$

The initial condition is then

$$
\bar v(\bar x,0)=\gamma
\hbox{ if } 0\leq x < 1/2\hbox{ else } 1,$$

where \( \gamma \) is the dimensionless number

$$ \gamma = \frac{U_1 - U_s}{U_2 - U_s}\tp$$

Note that \( \gamma < 1 \) if \( U_1 < U_2 \), and we expect \( \bar v\in [0, 1] \)
(\( \bar v\rightarrow 0 \) as \( \bar t\rightarrow\infty \)).
The PDE now becomes homogeneous,

$$
\frac{\partial\bar v}{\partial\bar t} =
\frac{\partial^2\bar v}{\partial\bar x^2}
-\overline{\hbox{Bi}}^{}\,\bar v(x,t),$$

and the boundary conditions take the form

$$
 \frac{\partial}{\partial\bar x}\bar v(0,t) = \hbox{Bi}\,
 \bar v(0,t),\quad
-\frac{\partial}{\partial\bar x}\bar v(L,t) = \hbox{Bi}\,
\bar v(L,t)\tp
$$

Many will find the homogeneous PDE and boundary conditions of the latter
scaling attractive, especially for analytical solution of the problem.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>metal_pieces</code>.

<p>
<!-- Closing remarks for this Exercise -->

<h3 id="___sec164">Remarks </h3>

<p>
We can derive <a href="#mjx-eqn-3.88">(3.88)</a>-<a href="#mjx-eqn-3.91">(3.91)</a> from <a href="#mjx-eqn-3.86">(3.86)</a>-<a href="#mjx-eqn-3.87">(3.87)</a>.
The idea is to integrate the governing PDE
<a href="#mjx-eqn-3.88">(3.88)</a> in the two directions where we
expect negligible variations,
use the Gauss divergence theorem in these directions, and
apply the cooling boundary condition. Let \( A \) be the cross section of
the bricks. Integrating over \( A \) gives

$$
\begin{align*}
\int\limits_A \frac{\partial u}{\partial t}dydz &=
\int\limits_A \dfc\left(
\frac{\partial^2 u}{\partial x^2} +
\frac{\partial^2 u}{\partial y^2} +
\frac{\partial^2 u}{\partial z^2}
\right)dydz \\ 
&=\int\limits_A \dfc
\frac{\partial^2 u}{\partial x^2}
dydz +
\int\limits_A \dfc\left(
\frac{\partial^2 u}{\partial y^2} +
\frac{\partial^2 u}{\partial z^2}
\right)dydz \\ 
& =
\int\limits_A \dfc
\frac{\partial^2 u}{\partial x^2}
dydz +
\dfc\int\limits_{\partial A}\frac{\partial u}{\partial n}ds\\ 
& = \int\limits_A \dfc
\frac{\partial^2 u}{\partial x^2}
dydz -h(v(x,t) -u_S)P\tp
\end{align*}
$$

The parameter \( P \) is the perimeter of the cross section \( A \).
The function \( v(x,t) \) means \( u(\x,t) \) evaluated at the boundary \( \partial A \).
Assuming \( u \) to vary little across the cross section \( A \), we can
approximate the integrals by \( u \) evaluated at \( \partial A \) as \( v \):

$$ \int\limits_A \frac{\partial u}{\partial t}dydz\approx A
\frac{\partial}{\partial t} v(x,t),
\quad
\int\limits_A \dfc
\frac{\partial^2 u}{\partial x^2}
dydz \approx A \dfc \frac{\partial^2 v}{\partial x^2},
$$

where \( A \) now is the cross-section <em>area</em>.
The result is the 1D initial-boundary value problem
<a href="#mjx-eqn-3.88">(3.88)</a>-<a href="#mjx-eqn-3.91">(3.91)</a>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="diffu:exer:welding">Problem 3.6: Scaling a welding problem</h2>

<p>
Welding equipment makes a very localized heat source that moves in
time. We shall investigate the heating due to welding and choose, for
maximum simplicity, a one-dimensional heat equation with a fixed
temperature at the ends (a 2D or 3D model with cooling conditions at
the boundaries would be of greater physical significance, but now the
scaling is in focus). The effect of melting is not included in the
heat equation. Our goal is to investigate two alternative scalings
through numerical experimentation.

<p>
The governing PDE problem reads

$$
\begin{align*}
\varrho c\frac{\partial u}{\partial t} &= k\frac{\partial^2 u}{\partial x^2}
+ f, & x\in (0,L),\ t\in (0,T),\\ 
u(x,0) &= U_s, & x\in [0,L],\\ 
u(0,t) = u(L,t) &= U_s, & t\in (0,T].
\end{align*}
$$

Here, \( u \) is the temperature, \( \varrho \) the density of the material,
\( c \) a heat capacity, \( k \) the heat conduction coefficient, \( f \) is
the heat source from the welding equipment, and \( U_s \) is the
initial constant (room) temperature in the material.

<p>
A possible model for the heat source is a moving Gaussian function:

$$ f = A\exp{\left(-\frac{1}{2}\left(\frac{x-vt}{\sigma}\right)^2\right)},$$

where \( A \) is the strength, \( \sigma \) is a parameter governing how
peak-shaped (or localized in space) the heat source is, and
\( v \) is the velocity (in positive \( x \) direction) of the source.

<p>
<b>a)</b>
Let \( x_c \), \( t_c \), \( u_c \), and \( f_c \) be scales, i.e., characteristic
sizes, of \( x \), \( t \), \( u \), and \( f \), respectively. The natural choice of
\( x_c \) and \( f_c \) is \( L \) and \( A \), since these make the scaled \( x \) and
\( f \) in the interval \( [0,1] \).  If each of the three terms in the PDE
are equally important, we can find \( t_c \) and \( u_c \) by demanding that
the coefficients in the scaled PDE are all equal to unity.  Perform
this scaling. Use scaled quantities in the arguments for the
exponential function in \( f \) too and show that

$$ \bar f= \exp{\left(-\frac{1}{2}\beta^2(\bar x -\gamma \bar t)^2\right)},$$

where \( \beta \) and \( \gamma \) are dimensionless numbers. Give an
interpretation of \( \beta \) and \( \gamma \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_24_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_24_2">

<p>
We introduce

$$ \bar x=\frac{x}{L},\quad \bar t = \frac{t}{t_c},\quad \bar u = \frac{u-U_s}{u_c},
\quad \bar f=\frac{f}{A}\tp$$

Inserted in the PDE and dividing by \( \varrho c u_c/t_c \) such that the
coefficient in front of \( \partial\bar u/\partial\bar t \) becomes unity, and
thereby all terms become dimensionless, we
get

$$ \frac{\partial\bar u}{\partial\bar t} =
\frac{k t_c}{\varrho c L^2}\frac{\partial^2\bar u}{\partial\bar x^2}
+ \frac{A t_c}{\varrho c u_c}\bar f\tp
$$

Demanding that all three terms are equally important, it follows that

$$ \frac{k t_c}{\varrho c L^2} = 1,\quad \frac{A t_c}{\varrho c u_c}=1\tp$$

These constraints imply the diffusion time scale

$$ t_c = \frac{\varrho cL^2}{k},$$

and a scale for \( u_c \),

$$ u_c = \frac{AL^2}{k}\tp$$

The scaled PDE reads

$$ \frac{\partial\bar u}{\partial\bar t} =
\frac{\partial^2\bar u}{\partial\bar x^2}
+ \bar f\tp$$

<p>
Scaling \( f \) results in

$$
\begin{align*}
\bar f &= \exp{\left(-\frac{1}{2}\left(\frac{x-vt}{\sigma}\right)^2\right)}\\ 
&= \exp{\left(-\frac{1}{2}\frac{L^2}{\sigma^2}
\left(\bar x- \frac{vt_c}{L}\bar t\right)^2\right)}\\ 
&= \exp{\left(-\frac{1}{2}\beta^2\left(\bar x-\gamma \bar t\right)^2\right)},
\end{align*}
$$

where \( \beta \) and \( \gamma \) are dimensionless numbers:

$$ \beta = \frac{L}{\sigma},\quad
\gamma = \frac{vt_c}{L} = \frac{v\varrho cL}{k}\tp$$

The \( \sigma \) parameter measures the width of the Gaussian peak, so
\( \beta \) is the ratio of the domain and the width of the heat source (large
\( \beta \) implies a very peak-formed heat source).  The \( \gamma \)
parameter arises from \( t_c/(L/v) \), which is the ratio of the diffusion
time scale and the time it takes for the heat source to travel through
the domain. Equivalently, we can multiply by \( t_c/t_c \) to get \( \gamma
= v/(t_cL) \) as the ratio between the velocity of the heat source and
the diffusion velocity.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Argue that for large \( \gamma \) we should base the time scale on the
movement of the heat source. Using \( L \) as length scale,
show that this gives rise to the scaled
PDE

$$ \frac{\partial\bar u}{\partial\bar t} =
\gamma^{-1}\frac{\partial^2\bar u}{\partial\bar x^2}
+ \bar f,
$$

and

$$ \bar f = \exp{(-\frac{1}{2}\beta^2(\bar x - \bar t)^2)}\tp$$

Discuss when the scalings in a) and b) are appropriate.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_24_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_24_3">

<p>
We perform the scaling as in a), but this time we determine \( t_c \) such
that the heat source moves with unit velocity. This means that

$$ \frac{vt_c}{L} = 1\quad\Rightarrow\quad t_c = \frac{L}{v}\tp$$

Scaling of the PDE gives, as before,

$$ \frac{\partial\bar u}{\partial\bar t} =
\frac{k t_c}{\varrho c L^2}\frac{\partial^2\bar u}{\partial\bar x^2}
+ \frac{A t_c}{\varrho c u_c}\bar f\tp
$$

Inserting the expression for \( t_c \), we have

$$ \frac{\partial\bar u}{\partial\bar t} =
\frac{k L}{\varrho c L^2v}\frac{\partial^2\bar u}{\partial\bar x^2}
+ \frac{A L}{v\varrho c u_c}\bar f\tp
$$

We recognize the first coefficient as \( \gamma^{-1} \), while \( u_c \) can
be determined from demanding the second coefficient to be unity:

$$ u_c = \frac{AL}{v\varrho c}\tp$$

The scaled PDE is therefore

$$ \frac{\partial\bar u}{\partial\bar t} =
\gamma^{-1}\frac{\partial^2\bar u}{\partial\bar x^2}
+ \bar f\tp$$

If the heat source moves very fast, there is little time for the
diffusion to transport the heat away from the source, and the heat
conduction term becomes insignificant. This is reflected in the
coefficient \( \gamma^{-1} \), which is small when \( \gamma \), the ratio of
the heat source velocity and the diffusion velocity, is large.

<p>
The scaling in a) is therefore appropriate if diffusion is a
significant process, i.e., the welding equipment moves at a slow speed
so heat can efficiently spread out by diffusion. For large \( \gamma \),
the scaling in b) is appropriate, and \( t=1 \) corresponds to having the
heat source traveled through the domain (with the scaling in a), the
heat source will leave the domain in short time).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
For fast movement of the welding equipment, i.e., when heat transfer
is less important than the local heating by the equipment, the
typical length scale of the local heating is the size of the source,
reflected by the \( \sigma \) parameter. Modify the scaling in b) when
\( \sigma \) is chosen as length scale.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_24_4" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_24_4">

<p>
With \( \sigma \) as length scale, the scaled PDE has the initial form

$$ \frac{\partial\bar u}{\partial\bar t} =
\frac{k t_c}{\varrho c \sigma^2}\frac{\partial^2\bar u}{\partial\bar x^2}
+ \frac{A t_c}{\varrho c u_c}\bar f\tp
$$

The scaling of \( f \) becomes

$$
\begin{align*}
\bar f &= \exp{\left(-\frac{1}{2}\left(\frac{x-vt}{\sigma}\right)^2\right)}\\ 
&= \exp{\left(-\frac{1}{2}
\left(\bar x- \frac{vt_c}{\sigma}\bar t\right)^2\right)}\\ 
&= \exp{\left(-\frac{1}{2}\left(\bar x- \bar t\right)^2\right)},
\end{align*}
$$

where we have chosen \( t_c \) as \( \sigma/v \). Inserting \( t_c \) in
the PDE leads to a coefficient

$$ \frac{k}{v\varrho c \sigma} = \gamma^{-1}\beta\tp$$

As before, we chose \( u_c \) to make the other coefficient equal unity,
modulo a scaling factor.
The \( \gamma^{-1}\beta \) parameter is the ratio of the moving heat source time
scale \( v/\sigma \) and the diffusion time scale \( \sigma^2/(k/\varrho c) \).

<p>
The equations are as in), except that \( \beta =1 \) and \( \epsilon \)
replaces \( \gamma \). Moreover, the length of the domain is now \( L/\sigma \),
i.e., \( \beta \) enters the problem in the domain size.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>d)</b>
One aim with scaling is to get a solution that lies in the interval
\( [-1,1] \). This is not always the case when \( u_c \) is based on a scale
involving a source term, as we do in a)-c).  However, from the
scaled PDE we realize that if we replace \( \bar f \) with \( \delta\bar f \),
where \( \delta \) is a dimensionless factor, this corresponds to
replacing \( u_c \) by \( u_c/\delta \). So, if we observe that \( \bar
u\sim1/\delta \) in simulations, we can just replace \( \bar f \) by \( \delta
\bar f \) in the scaled PDE.

<p>
Use this trick and implement the three scaled models. Reuse software for
the 1D diffusion equation.  Make a function <code>run(gamma, beta=10, delta=40,
scaling=1, animate=False)</code> that runs an implementation of
the unscaled model with the given
\( \gamma \), \( \beta \), and \( \delta \) parameters as well as an indicator
<code>scaling</code> that is 1 for the scaling in a), 2 for the scaling in
b), and 3 for the scaling in c).
The last argument can be used to turn screen animations on or off.

<p>
Perform experiments to find the proper value of \( \delta \) for each \( \gamma \)
and for each scaling.

<p>
Equip the <code>run</code> function with visualization, both animation of \( \bar u \)
and \( \bar f \), and plots with \( \bar u \) and \( \bar f \) for \( t=0.2 \) and \( t=0.5 \).

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_24_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_24_1">

<p>
Since the amplitudes of \( \bar u \) and \( \bar f \) differs by a factor \( \delta \),
it is attractive to plot \( \bar f/\delta \) together with \( \bar u \).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_24_5" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_24_5">

<p>
Here is a possible general <code>solver</code> function for solving the 1D
diffusion equation:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">scipy.sparse</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">scipy.sparse.linalg</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">time</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">sys</span>


<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">solver</span>(I, a, f, L, Nx, D, T, theta<span style="color: #666666">=0.5</span>, u_L<span style="color: #666666">=1</span>, u_R<span style="color: #666666">=0</span>,
           user_action<span style="color: #666666">=</span><span style="color: #008000">None</span>):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    The a variable is an array of length Nx+1 holding the values of</span>
<span style="color: #BA2121; font-style: italic">    a(x) at the mesh points.</span>

<span style="color: #BA2121; font-style: italic">    Method: (implicit) theta-rule in time.</span>

<span style="color: #BA2121; font-style: italic">    Nx is the total number of mesh cells; mesh points are numbered</span>
<span style="color: #BA2121; font-style: italic">    from 0 to Nx.</span>
<span style="color: #BA2121; font-style: italic">    D = dt/dx**2 and implicitly specifies the time step.</span>
<span style="color: #BA2121; font-style: italic">    T is the stop time for the simulation.</span>
<span style="color: #BA2121; font-style: italic">    I is a function of x.</span>

<span style="color: #BA2121; font-style: italic">    user_action is a function of (u, x, t, n) where the calling code</span>
<span style="color: #BA2121; font-style: italic">    can add visualization, error computations, data analysis,</span>
<span style="color: #BA2121; font-style: italic">    store solutions, etc.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">time</span>
    t0 <span style="color: #666666">=</span> time<span style="color: #666666">.</span>clock()

    x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, L, Nx<span style="color: #666666">+1</span>)   <span style="color: #408080; font-style: italic"># mesh points in space</span>
    dx <span style="color: #666666">=</span> x[<span style="color: #666666">1</span>] <span style="color: #666666">-</span> x[<span style="color: #666666">0</span>]
    dt <span style="color: #666666">=</span> D<span style="color: #666666">*</span>dx<span style="color: #666666">**2</span>
    <span style="color: #408080; font-style: italic">#print &#39;dt=%g&#39; % dt</span>
    Nt <span style="color: #666666">=</span> <span style="color: #008000">int</span>(<span style="color: #008000">round</span>(T<span style="color: #666666">/</span><span style="color: #008000">float</span>(dt)))
    t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, T, Nt<span style="color: #666666">+1</span>)   <span style="color: #408080; font-style: italic"># mesh points in time</span>

    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(a, (<span style="color: #008000">float</span>,<span style="color: #008000">int</span>)):
        a <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(Nx<span style="color: #666666">+1</span>) <span style="color: #666666">+</span> a
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(u_L, (<span style="color: #008000">float</span>,<span style="color: #008000">int</span>)):
        u_L_ <span style="color: #666666">=</span> <span style="color: #008000">float</span>(u_L)  <span style="color: #408080; font-style: italic"># must take copy of u_L number</span>
        u_L <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> t: u_L_
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(u_R, (<span style="color: #008000">float</span>,<span style="color: #008000">int</span>)):
        u_R_ <span style="color: #666666">=</span> <span style="color: #008000">float</span>(u_R)  <span style="color: #408080; font-style: italic"># must take copy of u_R number</span>
        u_R <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> t: u_R_

    u   <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(Nx<span style="color: #666666">+1</span>)   <span style="color: #408080; font-style: italic"># solution array at t[n+1]</span>
    u_1 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(Nx<span style="color: #666666">+1</span>)   <span style="color: #408080; font-style: italic"># solution at t[n]</span>

    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Basic formula in the scheme:</span>

<span style="color: #BA2121; font-style: italic">    0.5*(a[i+1] + a[i])*(u[i+1] - u[i]) -</span>
<span style="color: #BA2121; font-style: italic">    0.5*(a[i] + a[i-1])*(u[i] - u[i-1])</span>

<span style="color: #BA2121; font-style: italic">    0.5*(a[i+1] + a[i])*u[i+1]</span>
<span style="color: #BA2121; font-style: italic">    0.5*(a[i] + a[i-1])*u[i-1]</span>
<span style="color: #BA2121; font-style: italic">    -0.5*(a[i+1] + 2*a[i] + a[i-1])*u[i]</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    Dl <span style="color: #666666">=</span> <span style="color: #666666">0.5*</span>D<span style="color: #666666">*</span>theta
    Dr <span style="color: #666666">=</span> <span style="color: #666666">0.5*</span>D<span style="color: #666666">*</span>(<span style="color: #666666">1-</span>theta)

    <span style="color: #408080; font-style: italic"># Representation of sparse matrix and right-hand side</span>
    diagonal <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(Nx<span style="color: #666666">+1</span>)
    lower    <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(Nx)
    upper    <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(Nx)
    b        <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(Nx<span style="color: #666666">+1</span>)

    <span style="color: #408080; font-style: italic"># Precompute sparse matrix (scipy format)</span>
    diagonal[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">=</span> <span style="color: #666666">1</span> <span style="color: #666666">+</span> Dl<span style="color: #666666">*</span>(a[<span style="color: #666666">2</span>:] <span style="color: #666666">+</span> <span style="color: #666666">2*</span>a[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">+</span> a[:<span style="color: #666666">-2</span>])
    lower[:<span style="color: #666666">-1</span>] <span style="color: #666666">=</span> <span style="color: #666666">-</span>Dl<span style="color: #666666">*</span>(a[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">+</span> a[:<span style="color: #666666">-2</span>])
    upper[<span style="color: #666666">1</span>:]  <span style="color: #666666">=</span> <span style="color: #666666">-</span>Dl<span style="color: #666666">*</span>(a[<span style="color: #666666">2</span>:] <span style="color: #666666">+</span> a[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>])
    <span style="color: #408080; font-style: italic"># Insert boundary conditions</span>
    diagonal[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> <span style="color: #666666">1</span>
    upper[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    diagonal[Nx] <span style="color: #666666">=</span> <span style="color: #666666">1</span>
    lower[<span style="color: #666666">-1</span>] <span style="color: #666666">=</span> <span style="color: #666666">0</span>

    A <span style="color: #666666">=</span> scipy<span style="color: #666666">.</span>sparse<span style="color: #666666">.</span>diags(
        diagonals<span style="color: #666666">=</span>[diagonal, lower, upper],
        offsets<span style="color: #666666">=</span>[<span style="color: #666666">0</span>, <span style="color: #666666">-1</span>, <span style="color: #666666">1</span>],
        shape<span style="color: #666666">=</span>(Nx<span style="color: #666666">+1</span>, Nx<span style="color: #666666">+1</span>),
        format<span style="color: #666666">=</span><span style="color: #BA2121">&#39;csr&#39;</span>)
    <span style="color: #408080; font-style: italic">#print A.todense()</span>

    <span style="color: #408080; font-style: italic"># Set initial condition</span>
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">0</span>,Nx<span style="color: #666666">+1</span>):
        u_1[i] <span style="color: #666666">=</span> I(x[i])

    <span style="color: #008000; font-weight: bold">if</span> user_action <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
        user_action(u_1, x, t, <span style="color: #666666">0</span>)

    <span style="color: #408080; font-style: italic"># Time loop</span>
    <span style="color: #008000; font-weight: bold">for</span> n <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">0</span>, Nt):
        b[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">=</span> u_1[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">+</span> Dr<span style="color: #666666">*</span>(
            (a[<span style="color: #666666">2</span>:] <span style="color: #666666">+</span> a[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>])<span style="color: #666666">*</span>(u_1[<span style="color: #666666">2</span>:] <span style="color: #666666">-</span> u_1[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>]) <span style="color: #666666">-</span>
            (a[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">+</span> a[<span style="color: #666666">0</span>:<span style="color: #666666">-2</span>])<span style="color: #666666">*</span>(u_1[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>] <span style="color: #666666">-</span> u_1[:<span style="color: #666666">-2</span>])) <span style="color: #666666">+</span> \ 
            dt<span style="color: #666666">*</span>theta<span style="color: #666666">*</span>f(x[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>], t[n<span style="color: #666666">+1</span>]) <span style="color: #666666">+</span> \ 
            dt<span style="color: #666666">*</span>(<span style="color: #666666">1-</span>theta)<span style="color: #666666">*</span>f(x[<span style="color: #666666">1</span>:<span style="color: #666666">-1</span>], t[n])
        <span style="color: #408080; font-style: italic"># Boundary conditions</span>
        b[<span style="color: #666666">0</span>]  <span style="color: #666666">=</span> u_L(t[n<span style="color: #666666">+1</span>])
        b[<span style="color: #666666">-1</span>] <span style="color: #666666">=</span> u_R(t[n<span style="color: #666666">+1</span>])
        <span style="color: #408080; font-style: italic"># Solve</span>
        u[:] <span style="color: #666666">=</span> scipy<span style="color: #666666">.</span>sparse<span style="color: #666666">.</span>linalg<span style="color: #666666">.</span>spsolve(A, b)

        <span style="color: #008000; font-weight: bold">if</span> user_action <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
            user_action(u, x, t, n<span style="color: #666666">+1</span>)

        <span style="color: #408080; font-style: italic"># Switch variables before next step</span>
        u_1, u <span style="color: #666666">=</span> u, u_1

    t1 <span style="color: #666666">=</span> time<span style="color: #666666">.</span>clock()
    <span style="color: #008000; font-weight: bold">return</span> t1<span style="color: #666666">-</span>t0
</pre></div>
<p>
And here is our <code>run</code> function tailored to the problem:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">run</span>(gamma, beta<span style="color: #666666">=10</span>, delta<span style="color: #666666">=40</span>, scaling<span style="color: #666666">=1</span>, animate<span style="color: #666666">=</span><span style="color: #008000">False</span>):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Run the scaled model for welding.&quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">if</span> scaling <span style="color: #666666">==</span> <span style="color: #666666">1</span>:
        v <span style="color: #666666">=</span> gamma
        a <span style="color: #666666">=</span> <span style="color: #666666">1</span>
        L <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
        b <span style="color: #666666">=</span> <span style="color: #666666">0.5*</span>beta<span style="color: #666666">**2</span>
    <span style="color: #008000; font-weight: bold">elif</span> scaling <span style="color: #666666">==</span> <span style="color: #666666">2</span>:
        v <span style="color: #666666">=</span> <span style="color: #666666">1</span>
        a <span style="color: #666666">=</span> <span style="color: #666666">1.0/</span>gamma
        L <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
        b <span style="color: #666666">=</span> <span style="color: #666666">0.5*</span>beta<span style="color: #666666">**2</span>
    <span style="color: #008000; font-weight: bold">elif</span> scaling <span style="color: #666666">==</span> <span style="color: #666666">3</span>:
        v <span style="color: #666666">=</span> <span style="color: #666666">1</span>
        a <span style="color: #666666">=</span> beta<span style="color: #666666">/</span>gamma
        L <span style="color: #666666">=</span> beta
        b <span style="color: #666666">=</span> <span style="color: #666666">0.5</span>

    ymin <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    <span style="color: #408080; font-style: italic"># Need global ymax to be able change ymax in closure process_u</span>
    <span style="color: #008000; font-weight: bold">global</span> ymax
    ymax <span style="color: #666666">=</span> <span style="color: #666666">1.2</span>

    I <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: <span style="color: #666666">0</span>
    f <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x, t: delta<span style="color: #666666">*</span>np<span style="color: #666666">.</span>exp(<span style="color: #666666">-</span>b<span style="color: #666666">*</span>(x <span style="color: #666666">-</span> v<span style="color: #666666">*</span>t)<span style="color: #666666">**2</span>)

    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">time</span>
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">scitools.std</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
    plot_arrays <span style="color: #666666">=</span> []
    <span style="color: #008000; font-weight: bold">if</span> scaling <span style="color: #666666">==</span> <span style="color: #666666">3</span>:
        plot_times <span style="color: #666666">=</span> [<span style="color: #666666">0.2*</span>beta, <span style="color: #666666">0.5*</span>beta]
    <span style="color: #008000; font-weight: bold">else</span>:
        plot_times <span style="color: #666666">=</span> [<span style="color: #666666">0.2</span>, <span style="color: #666666">0.5</span>]

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">process_u</span>(u, x, t, n):
        <span style="color: #008000; font-weight: bold">global</span> ymax
        <span style="color: #008000; font-weight: bold">if</span> animate:
            plt<span style="color: #666666">.</span>plot(x, u, <span style="color: #BA2121">&#39;r-&#39;</span>,
                     x, f(x, t[n])<span style="color: #666666">/</span>delta, <span style="color: #BA2121">&#39;b-&#39;</span>,
                     axis<span style="color: #666666">=</span>[<span style="color: #666666">0</span>, L, ymin, ymax], title<span style="color: #666666">=</span><span style="color: #BA2121">&#39;t=</span><span style="color: #BB6688; font-weight: bold">%f</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> t[n],
                     xlabel<span style="color: #666666">=</span><span style="color: #BA2121">&#39;x&#39;</span>, ylabel<span style="color: #666666">=</span><span style="color: #BA2121">&#39;u and f/</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> delta)
        <span style="color: #008000; font-weight: bold">if</span> t[n] <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
            time<span style="color: #666666">.</span>sleep(<span style="color: #666666">1</span>)
            plot_arrays<span style="color: #666666">.</span>append(x)
        dt <span style="color: #666666">=</span> t[<span style="color: #666666">1</span>] <span style="color: #666666">-</span> t[<span style="color: #666666">0</span>]
        tol <span style="color: #666666">=</span> dt<span style="color: #666666">/10.0</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">abs</span>(t[n] <span style="color: #666666">-</span> plot_times[<span style="color: #666666">0</span>]) <span style="color: #666666">&lt;</span> tol <span style="color: #AA22FF; font-weight: bold">or</span> \ 
           <span style="color: #008000">abs</span>(t[n] <span style="color: #666666">-</span> plot_times[<span style="color: #666666">1</span>]) <span style="color: #666666">&lt;</span> tol:
            plot_arrays<span style="color: #666666">.</span>append((u<span style="color: #666666">.</span>copy(), f(x, t[n])<span style="color: #666666">/</span>delta))
            <span style="color: #008000; font-weight: bold">if</span> u<span style="color: #666666">.</span>max() <span style="color: #666666">&gt;</span> ymax:
                ymax <span style="color: #666666">=</span> u<span style="color: #666666">.</span>max()

    Nx <span style="color: #666666">=</span> <span style="color: #666666">100</span>
    D <span style="color: #666666">=</span> <span style="color: #666666">10</span>
    <span style="color: #008000; font-weight: bold">if</span> scaling <span style="color: #666666">==</span> <span style="color: #666666">3</span>:
        T <span style="color: #666666">=</span> <span style="color: #666666">0.5*</span>beta
    <span style="color: #008000; font-weight: bold">else</span>:
        T <span style="color: #666666">=</span> <span style="color: #666666">0.5</span>
    u_L <span style="color: #666666">=</span> u_R <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    theta <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
    cpu <span style="color: #666666">=</span> solver(
        I, a, f, L, Nx, D, T, theta, u_L, u_R, user_action<span style="color: #666666">=</span>process_u)
    x <span style="color: #666666">=</span> plot_arrays[<span style="color: #666666">0</span>]
    plt<span style="color: #666666">.</span>figure()
    <span style="color: #008000; font-weight: bold">for</span> u, f <span style="color: #AA22FF; font-weight: bold">in</span> plot_arrays[<span style="color: #666666">1</span>:]:
        plt<span style="color: #666666">.</span>plot(x, u, <span style="color: #BA2121">&#39;r-&#39;</span>, x, f, <span style="color: #BA2121">&#39;b--&#39;</span>, axis<span style="color: #666666">=</span>[x[<span style="color: #666666">0</span>], x[<span style="color: #666666">-1</span>], <span style="color: #666666">0</span>, ymax],
                 xlabel<span style="color: #666666">=</span><span style="color: #BA2121">&#39;$x$&#39;</span>, ylabel<span style="color: #666666">=</span><span style="color: #BA2121">r&#39;$u, \ f/</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$&#39;</span> <span style="color: #666666">%</span> delta)
        plt<span style="color: #666666">.</span>hold(<span style="color: #BA2121">&#39;on&#39;</span>)
    plt<span style="color: #666666">.</span>legend([<span style="color: #BA2121">&#39;$u,</span><span style="color: #BB6622; font-weight: bold">\\</span><span style="color: #BA2121"> t=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$&#39;</span> <span style="color: #666666">%</span> plot_times[<span style="color: #666666">0</span>],
                <span style="color: #BA2121">&#39;$f/</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">,</span><span style="color: #BB6622; font-weight: bold">\\</span><span style="color: #BA2121"> t=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$&#39;</span> <span style="color: #666666">%</span> (delta, plot_times[<span style="color: #666666">0</span>]),
                <span style="color: #BA2121">&#39;$u,</span><span style="color: #BB6622; font-weight: bold">\\</span><span style="color: #BA2121"> t=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$&#39;</span> <span style="color: #666666">%</span> plot_times[<span style="color: #666666">1</span>],
                <span style="color: #BA2121">&#39;$f/</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">,</span><span style="color: #BB6622; font-weight: bold">\\</span><span style="color: #BA2121"> t=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$&#39;</span> <span style="color: #666666">%</span> (delta, plot_times[<span style="color: #666666">1</span>])])
    filename <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;tmp1_gamma</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">_s</span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (gamma, scaling)
    <span style="color: #008000; font-weight: bold">if</span> scaling <span style="color: #666666">==</span> <span style="color: #666666">1</span>:
        s <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;diffusion&#39;</span>
    <span style="color: #008000; font-weight: bold">elif</span> scaling <span style="color: #666666">==</span> <span style="color: #666666">2</span>:
        s <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;source&#39;</span>
    <span style="color: #008000; font-weight: bold">elif</span> scaling <span style="color: #666666">==</span> <span style="color: #666666">3</span>:
        s <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;sigma&#39;</span>
    plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">r&#39;$\beta = </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">,\ \gamma = </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">,\ $&#39;</span> <span style="color: #666666">%</span> (beta, gamma)
              <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;scaling=</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> s)
    plt<span style="color: #666666">.</span>savefig(filename <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;.pdf&#39;</span>);  plt<span style="color: #666666">.</span>savefig(filename <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;.png&#39;</span>)
    <span style="color: #008000; font-weight: bold">return</span> cpu
</pre></div>
<p>
Note that we have dropped the bar notation in the plots. It is common
to drop the bars as soon as the scaled problem is established.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>e)</b>
Use the software in d) to investigate \( \gamma=0.2,1,5,40 \) for the
three scalings. Discuss the results.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_24_6" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_24_6">

<p>
For these investigations, we compare the three scalings for each of
the different \( \gamma \) values. An appropriate function for automating
the tasks is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">investigate</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Do scienfic experiments with the run function above.&quot;&quot;&quot;</span>
    <span style="color: #408080; font-style: italic"># Clean up old files</span>
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">glob</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">os</span>
    <span style="color: #008000; font-weight: bold">for</span> filename <span style="color: #AA22FF; font-weight: bold">in</span> glob<span style="color: #666666">.</span>glob(<span style="color: #BA2121">&#39;tmp1_gamma*&#39;</span>) <span style="color: #666666">+</span> \ 
            glob<span style="color: #666666">.</span>glob(<span style="color: #BA2121">&#39;welding_gamma*&#39;</span>):
        os<span style="color: #666666">.</span>remove(filename)

    scaling_values <span style="color: #666666">=</span> <span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>
    gamma_values <span style="color: #666666">=</span> <span style="color: #666666">1</span>, <span style="color: #666666">40</span>, <span style="color: #666666">5</span>, <span style="color: #666666">0.2</span>, <span style="color: #666666">0.025</span>
    delta_values <span style="color: #666666">=</span> {}  <span style="color: #408080; font-style: italic"># delta_values[scaling][gamma]</span>
    delta_values[<span style="color: #666666">1</span>] <span style="color: #666666">=</span> {<span style="color: #666666">0.025</span>: <span style="color: #666666">140</span>, <span style="color: #666666">0.2</span>: <span style="color: #666666">60</span>,  <span style="color: #666666">1</span>: <span style="color: #666666">20</span>, <span style="color: #666666">5</span>: <span style="color: #666666">40</span>,  <span style="color: #666666">40</span>: <span style="color: #666666">800</span>}
    delta_values[<span style="color: #666666">2</span>] <span style="color: #666666">=</span> {<span style="color: #666666">0.025</span>: <span style="color: #666666">700</span>, <span style="color: #666666">0.2</span>: <span style="color: #666666">100</span>, <span style="color: #666666">1</span>: <span style="color: #666666">20</span>, <span style="color: #666666">5</span>: <span style="color: #666666">8</span>,   <span style="color: #666666">40</span>: <span style="color: #666666">5</span>}
    delta_values[<span style="color: #666666">3</span>] <span style="color: #666666">=</span> {<span style="color: #666666">0.025</span>: <span style="color: #666666">80</span>,  <span style="color: #666666">0.2</span>: <span style="color: #666666">10</span>,  <span style="color: #666666">1</span>: <span style="color: #666666">2</span>,  <span style="color: #666666">5</span>: <span style="color: #666666">0.8</span>, <span style="color: #666666">40</span>: <span style="color: #666666">0.5</span>}
    <span style="color: #008000; font-weight: bold">for</span> gamma <span style="color: #AA22FF; font-weight: bold">in</span> gamma_values:
        <span style="color: #008000; font-weight: bold">for</span> scaling <span style="color: #AA22FF; font-weight: bold">in</span> scaling_values:
            run(gamma<span style="color: #666666">=</span>gamma, beta<span style="color: #666666">=10</span>,
                delta<span style="color: #666666">=</span>delta_values[scaling][gamma],
                scaling<span style="color: #666666">=</span>scaling)

    <span style="color: #408080; font-style: italic"># Combine images</span>
    <span style="color: #008000; font-weight: bold">for</span> gamma <span style="color: #AA22FF; font-weight: bold">in</span> gamma_values:
        <span style="color: #008000; font-weight: bold">for</span> ext <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #BA2121">&#39;pdf&#39;</span>, <span style="color: #BA2121">&#39;png&#39;</span>:
            cmd <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;doconce combine_images -&#39;</span> <span style="color: #666666">+</span> <span style="color: #008000">str</span>(<span style="color: #008000">len</span>(scaling_values)) <span style="color: #666666">+</span> <span style="color: #BA2121">&#39; &#39;</span>
            <span style="color: #008000; font-weight: bold">for</span> s <span style="color: #AA22FF; font-weight: bold">in</span> scaling_values:
                cmd <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39; tmp1_gamma</span><span style="color: #BB6688; font-weight: bold">%(gamma)g</span><span style="color: #BA2121">_s</span><span style="color: #BB6688; font-weight: bold">%(s)d</span><span style="color: #BA2121">.</span><span style="color: #BB6688; font-weight: bold">%(ext)s</span><span style="color: #BA2121"> &#39;</span> <span style="color: #666666">%</span> <span style="color: #008000">vars</span>()
            cmd <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39; welding_gamma</span><span style="color: #BB6688; font-weight: bold">%(gamma)g</span><span style="color: #BA2121">.</span><span style="color: #BB6688; font-weight: bold">%(ext)s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> <span style="color: #008000">vars</span>()
            os<span style="color: #666666">.</span>system(cmd)
            <span style="color: #408080; font-style: italic"># pdflatex doesn&#39;t like a dot (as in 0.2) in filenames...</span>
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #BA2121">&#39;.&#39;</span> <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">str</span>(gamma):
                os<span style="color: #666666">.</span>rename(
                <span style="color: #BA2121">&#39;welding_gamma</span><span style="color: #BB6688; font-weight: bold">%(gamma)g</span><span style="color: #BA2121">.</span><span style="color: #BB6688; font-weight: bold">%(ext)s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> <span style="color: #008000">vars</span>(),
                (<span style="color: #BA2121">&#39;welding_gamma</span><span style="color: #BB6688; font-weight: bold">%(gamma)g</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> <span style="color: #008000">vars</span>())<span style="color: #666666">.</span>replace(<span style="color: #BA2121">&#39;.&#39;</span>, <span style="color: #BA2121">&#39;_&#39;</span>)
                <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;.&#39;</span> <span style="color: #666666">+</span> ext)
</pre></div>
<p>
Note that for each \( \gamma \) value and each scaling, we have found
a \( \delta \) value such that the maximum \( u \) value is around unity in size.
We did this first by trial and error, and thereafter filled out the
<code>delta_values</code> dictionary.

<p>
The scalings in b) and c) are illustrated at the same <em>physical</em> times.
The scaling in a) is plotted at the same non-dimensional time as
the scaling in b), but observe that this is a different physical time
than used for the  b) and c) scalings.

<p>
We get the following plots, with diffusion time scale to the left,
heat source time scale in the middle, and the time scale based on \( \sigma \)
to the right, starting with \( \gamma=0.025 \)
and increasing its value to \( \gamma=40 \):

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 1</b>: Geir, I feel we need some better discussions. It seems that scaling in time based on the heat source velocity is the &quot;winner&quot;. However, for a very low \( \gamma \) it will be inappropriate since heat transfer has worked for a very long time before have the equipment in the middle position of the domain.)</font>
<!-- end inline comment -->

<p>
<center><p><img src="fig-scaling/welding_gamma0_025.png" align="bottom" width=800></p></center>

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 2</b>: I think it is a bit difficult to understand the graphs. This low \( \gamma \) value corresponds to a very slowly moving heat source. There is then time for the heat to spread ahead of the source. This is easy to see in the left plot. Since the time scales are so different, the graphs to the right and left are at two very different time points. This should be pointed out. The graphs on the left are early in the process, while heat transfer has been working for a long time in the graphs to the right. Also in the right plot we see that a lot of material around the source is heated, but the boundary conditions forces heat out of the two boundaries. Had we used insulated ends, there would be a significant build-up of heating (probably constant \( u \) in space for large times).)</font>
<!-- end inline comment -->

<p>
<center><p><img src="fig-scaling/welding_gamma0_2.png" align="bottom" width=800></p></center>

<p>
<center><p><img src="fig-scaling/welding_gamma1.png" align="bottom" width=800></p></center>

<p>
<center><p><img src="fig-scaling/welding_gamma5.png" align="bottom" width=800></p></center>

<p>
<center><p><img src="fig-scaling/welding_gamma40.png" align="bottom" width=800></p></center>

<p>
For \( \gamma\ll 1 \) as in \( \gamma = 0.025 \), the heat source moves very
slowly on the diffusion time scale and has hardly entered the medium,
while the scaling in b) is not inappropriate, but a larger \( \delta \) is
needed to bring \( \bar u \) around unity.  We see that for \( \gamma=0.2 \),
each of the scalings work, but with the diffusion time scale, the heat
source has not moved much into the domain. For \( \gamma=1 \), the
mathematical problems are identical and hence the plots too. For
\( \gamma=5 \), the time scale based on the source is clearly the best
choice, and for \( \gamma=40 \), only this scale is appropriate.

<p>
A conclusion is that the scaling in b) works well for a range of \( \gamma \)
values, also in the case \( \gamma\ll 1 \).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>welding</code>.

<p>
<!-- --- end exercise --- -->

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>


</body>
</html>
    

