<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Scaling of Differential Equations">
<meta name="keywords" content="units,base unit,length,mass,time,dimension of physical quantities,units US,units British,units conversion,units software,multiple software runs,web interface (Parampool),graphical web interface,scaling,non-dimensionalization,dimensionless variable,exponential decay,dimensionless variable,characteristic time,e-folding time,memoize function,dimensionless number,dimensionless number,dimensionless number,logistic equation,dimensionless number,frequency,frequency, angular,period (of oscillations),radians,angular frequency,quality factor $Q$,phase shift,dimensionless number,Peclet number,dimensionless number,Reynolds number,Navier-Stokes equations,dimensionless number,Reynolds number,Reynolds number,low Reynolds number flow,Stokes problem,Stokes' flow,Froude number,creeping flow,Strouhal number,vortex shedding,Euler number,Weber number,forced convection,Peclet number,Reynolds number,free convection,Grashof number,Reynolds number,Peclet number,Eckert number,Nusselt number,Lotka-Volterra, predator-pray model,Lotka-Volterra, competing species model">

<title>Scaling of Differential Equations</title>


<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/css/solarized_light_code.css" rel="stylesheet" type="text/css" title="light"/>
<script src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="http://thomasf.github.io/solarized-css/solarized-light.min.css" rel="stylesheet">
<style type="text/css">
h1 {color: #b58900;}  /* yellow */
/* h1 {color: #cb4b16;}  orange */
/* h1 {color: #d33682;}  magenta, the original choice of thomasf */
code { padding: 0px; background-color: inherit; }
pre {
  border: 0pt solid #93a1a1;
  box-shadow: none;
}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #93a1a1;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #eee8d5;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [('Preface', 0, 'ch:preface', 'ch:preface'),
              ('Dimensions and units', 0, 'scale:dimunit', 'scale:dimunit'),
              ('Fundamental concepts', 1, None, '___sec2'),
              ('Base units and dimensions', 2, None, '___sec3'),
              ('Dimensions of common physical quantities',
               2,
               None,
               '___sec4'),
              ('Prefixes for units', 2, None, '___sec5'),
              ('Unit systems', 2, None, '___sec6'),
              ('PhysicalQuantity: object for computing with units',
               2,
               'scale:PQ',
               'scale:PQ'),
              ('Parampool: user interfaces with automatic unit conversion',
               1,
               'scale:parampool',
               'scale:parampool'),
              ('Example application', 3, None, '___sec9'),
              ('Pool of parameters', 2, None, '___sec10'),
              ('Fetching pool data for computing', 2, None, '___sec11'),
              ('Reading command-line options', 2, None, '___sec12'),
              ('Setting default values in a file', 2, None, '___sec13'),
              ('Specifying multiple values of input parameters',
               2,
               None,
               '___sec14'),
              ('Generating a graphical user interface', 2, None, '___sec15'),
              ('ODE models', 0, None, '___sec16'),
              ('Exponential decay problems',
               1,
               'sec:scale:decay',
               'sec:scale:decay'),
              ('Fundamental ideas', 2, None, '___sec18'),
              ('The basic model problem', 2, None, '___sec19'),
              ('Example: Population dynamics', 3, None, '___sec20'),
              ('Example: Decay of pressure with altitude',
               3,
               None,
               '___sec21'),
              ('The technical steps of the scaling procedure',
               2,
               'sec:scale:decay:steps',
               'sec:scale:decay:steps'),
              ('Step 1: Identify independent and dependent variables',
               3,
               None,
               '___sec23'),
              ('Step 2: Make independent and dependent variables dimensionless',
               3,
               None,
               '___sec24'),
              ('Step 3: Derive the model involving only dimensionless variables',
               3,
               None,
               '___sec25'),
              ('Step 4: Make each term dimensionless', 3, None, '___sec26'),
              ('Step 5: Estimate the scales', 3, None, '___sec27'),
              ('Making software utilizing the dimensionless model',
               2,
               'sec:scale:decay:prog',
               'sec:scale:decay:prog'),
              ('Software for the original problem with dimensions',
               3,
               None,
               '___sec29'),
              ('A plain solution', 3, None, '___sec30'),
              ('Simplifying the implementation with joblib',
               3,
               None,
               '___sec31'),
              ('Scaling a generalized problem',
               2,
               'sec:scale:decay:body',
               'sec:scale:decay:body'),
              ('Exact solution', 3, None, '___sec33'),
              ('Theory', 3, None, '___sec34'),
              ('Software', 3, None, '___sec35'),
              ('Variable coefficients',
               2,
               'sec:scale:decay:jump',
               'sec:scale:decay:jump'),
              ('Scaling a cooling problem with constant surroundings',
               2,
               'scale:decay:cooling:const',
               'scale:decay:cooling:const'),
              ('Scaling a cooling problem with time-dependent surroundings',
               2,
               'scale:decay:cooling:osc',
               'scale:decay:cooling:osc'),
              ('Exact solution', 3, None, '___sec39'),
              ('Scaling', 3, None, '___sec40'),
              ('Software', 3, None, '___sec41'),
              ('Discussion of the time scale', 3, None, '___sec42'),
              ('Scaling a nonlinear ODE',
               2,
               'sec:scale:decay:nonlinear',
               'sec:scale:decay:nonlinear'),
              ('ODE systems for spreading of diseases', 2, None, '___sec44'),
              ('SIR model', 3, None, '___sec45'),
              ('SIRV model with finite immunity', 3, None, '___sec46'),
              ('Michaelis-Menten kinetics for biochemical reactions',
               2,
               'scale:MMK',
               'scale:MMK'),
              ('Classical analysis', 3, None, '___sec48'),
              ('Dimensionless ODE system', 3, None, '___sec49'),
              ('Determining scales', 3, None, '___sec50'),
              ('Analysis of the scaled system', 3, None, '___sec51'),
              ('Vibration problems', 1, 'sec:scale:vib', 'sec:scale:vib'),
              ('Undamped vibrations without forcing',
               2,
               'sec:scale:vib:undamped',
               'sec:scale:vib:undamped'),
              ('The first technical steps of scaling', 3, None, '___sec54'),
              ('The exact solution', 3, None, '___sec55'),
              ('Discussion of the displacement scale', 3, None, '___sec56'),
              ('Discussion of the time scale', 3, None, '___sec57'),
              ('Alternative displacement scale', 3, None, '___sec58'),
              ('About frequency and dimensions', 3, None, '___sec59'),
              ('Undamped vibrations with constant forcing',
               2,
               'sec:scale:vib:undamped:mg',
               'sec:scale:vib:undamped:mg'),
              ('Undamped vibrations with time-dependent forcing',
               2,
               'sec:scale:vib:undamped:F',
               'sec:scale:vib:undamped:F'),
              ('Investigating scales via analytical solutions',
               3,
               None,
               '___sec62'),
              ('The displacement and time scales', 3, None, '___sec63'),
              ('Finding the displacement scale from the differential equation',
               3,
               None,
               '___sec64'),
              ('Scaling with free vibrations as time scale',
               3,
               None,
               '___sec65'),
              ('Software', 3, None, '___sec66'),
              ('Choice of $u_c$ close to resonance', 3, None, '___sec67'),
              ('Unit size of all terms in the ODE', 3, None, '___sec68'),
              ('Choice of $u_c$ when $\\psi\\gg\\omega$',
               3,
               None,
               '___sec69'),
              ('Displacement scale based on $I$', 3, None, '___sec70'),
              ('Damped vibrations with forcing',
               2,
               'sec:scale:vib:damped:F',
               'sec:scale:vib:damped:F'),
              ('The exact solution', 3, None, '___sec72'),
              ('Choosing scales', 3, None, '___sec73'),
              ('Choice of $u_c$ at resonance', 3, None, '___sec74'),
              ('Choice of $u_c$ when $\\omega\\gg\\psi$',
               3,
               None,
               '___sec75'),
              ('Choice of $u_c$ when $\\omega\\ll\\psi$',
               3,
               None,
               '___sec76'),
              ('Oscillating electric circuits', 2, None, '___sec77'),
              ('Basic PDE models', 0, None, '___sec78'),
              ('The wave equation', 1, 'sec:scale:wave', 'sec:scale:wave'),
              ('Simple homogeneous Dirichlet conditions',
               2,
               None,
               '___sec80'),
              ('Implementation of the scaled wave equation',
               2,
               None,
               '___sec81'),
              ('Waves on a string', 3, None, '___sec82'),
              ('Detecting an already computed case', 3, None, '___sec83'),
              ('Time-dependent Dirichlet condition',
               2,
               'scale:wave:pde2',
               'scale:wave:pde2'),
              ('Velocity initial condition',
               2,
               'scale:wave:pde2:Vcond',
               'scale:wave:pde2:Vcond'),
              ('Variable wave velocity and forcing',
               2,
               'scale:wave:pde2:cvar',
               'scale:wave:pde2:cvar'),
              ('Damped wave equation',
               2,
               'scale:wave:pde2:damped',
               'scale:wave:pde2:damped'),
              ('A three-dimensional wave equation problem',
               2,
               None,
               '___sec88'),
              ('The diffusion equation',
               1,
               'sec:scale:diffu',
               'sec:scale:diffu'),
              ('Homogeneous diffusion equation',
               2,
               'sec:scale:diffu:homo1D',
               'sec:scale:diffu:homo1D'),
              ('Simplified 1D PDE', 3, None, '___sec91'),
              ('Generalized PDE', 3, None, '___sec92'),
              ('Jump boundary condition', 2, None, '___sec93'),
              ('Oscillating Dirichlet condition', 2, None, '___sec94'),
              ('Diffusion equation with source term',
               2,
               'sec:scale:diffu:source',
               'sec:scale:diffu:source'),
              ("Fisher's equation",
               2,
               'sec:scale:diffu:Fisher',
               'sec:scale:diffu:Fisher'),
              ('The convection-diffusion equation',
               1,
               'scale:convdiff',
               'scale:convdiff'),
              ('Convection-diffusion without a force term',
               2,
               None,
               '___sec98'),
              ('Stationary PDE', 2, None, '___sec99'),
              ('Convection-diffusion with a force term',
               2,
               'scale:convdiff',
               'scale:convdiff'),
              ('Advanced PDE models', 0, None, '___sec101'),
              ('The equations of linear elasticity', 1, None, '___sec102'),
              ('The Navier-Stokes equations',
               1,
               'sec:scale:ns',
               'sec:scale:ns'),
              ('The momentum equation without body forces',
               2,
               None,
               '___sec104'),
              ('The most common dimensionless form of the Navier-Stokes equations',
               2,
               None,
               '___sec105'),
              ('Scaling of time for low Reynolds numbers',
               2,
               None,
               '___sec106'),
              ('Shear stress as pressure scale', 2, None, '___sec107'),
              ('Including the gravity force', 2, None, '___sec108'),
              ('Oscillating boundary conditions', 2, None, '___sec109'),
              ('The Euler number', 2, None, '___sec110'),
              ('Free surface conditions', 2, None, '___sec111'),
              ('Thermal convection', 1, None, '___sec112'),
              ('Forced convection', 2, None, '___sec113'),
              ('Free convection',
               2,
               'scale:fluid:forced_convection',
               'scale:fluid:forced_convection'),
              ('Governing equations', 3, None, '___sec115'),
              ('Heating by viscous effects', 3, None, '___sec116'),
              ('Relation between density and temperature',
               3,
               None,
               '___sec117'),
              ('Comment on the form of the equation of continuity',
               3,
               None,
               '___sec118'),
              ('The Boussinesq approximation', 3, None, '___sec119'),
              ('Scaling', 3, None, '___sec120'),
              ('The Grashof, Prandtl, and Eckert numbers',
               2,
               None,
               '___sec121'),
              ('Heat transfer at boundaries', 2, None, '___sec122'),
              ('The bidomain model in electrophysiology',
               1,
               'scale:bidomain',
               'scale:bidomain'),
              ('Two-phase porous media flow', 1, None, '___sec124'),
              ('The Euler equations of gas dynamics', 1, None, '___sec125'),
              ('Exercises', 1, None, '___sec126'),
              ('Exercise 1: Perform unit conversion',
               2,
               'sec:scale:exer:US2SI1',
               'sec:scale:exer:US2SI1'),
              ('Problem 2: Scale a simple formula',
               2,
               'sec:scale:exer:ball_y',
               'sec:scale:exer:ball_y'),
              ('Problem 3: Scale a nonlinear ODE',
               2,
               'sec:scale:exer:ball_y_wdrag',
               'sec:scale:exer:ball_y_wdrag'),
              ('Exercise 4: Implement a scaled model with jump',
               2,
               'sec:scale:exer:decay:jump',
               'sec:scale:exer:decay:jump'),
              ('Exercise 5: Implement a scaled model for cooling',
               2,
               'sec:scale:exer:decay:cooling',
               'sec:scale:exer:decay:cooling'),
              ('Problem 6: Scale variable coefficients',
               2,
               'scale:decay:exer:decay:step',
               'scale:decay:exer:decay:step'),
              ('Exercise 7: Alternative scalings of a cooling model',
               2,
               'scale:decay:exer:cooling:Ts',
               'scale:decay:exer:cooling:Ts'),
              ('Exercise 8: Alternative scalings of a cooling model',
               2,
               'scale:decay:exer:nonlin:logistic2',
               'scale:decay:exer:nonlin:logistic2'),
              ('Exercise 9: Scale projectile motion',
               2,
               'scale:vib:exer:projectile',
               'scale:vib:exer:projectile'),
              ('Problem 10: Scale a predator-pray model',
               2,
               'scale:decay:exer:predpray',
               'scale:decay:exer:predpray'),
              ('Problem 11: Scale a model for competing species',
               2,
               'scale:decay:exer:competing_species',
               'scale:decay:exer:competing_species'),
              ('Problem 12: Find the period of sinusoidal signals',
               2,
               'scale:decay:exer:sine',
               'scale:decay:exer:sine'),
              ('Remarks', 3, None, '___sec139'),
              ('Problem 13: Scale the pendulum equation',
               2,
               'sec:scale:exer:pendulum',
               'sec:scale:exer:pendulum'),
              ("Problem 14: Scale Duffing's equation",
               2,
               'scale:vib:exer:Duffing',
               'scale:vib:exer:Duffing'),
              ('Problem 15: Scale a stationary Couette flow',
               2,
               'scale:vib:exer:stationary_Couette',
               'scale:vib:exer:stationary_Couette'),
              ('Remarks', 3, None, '___sec143'),
              ('Problem 16: Scale a starting Couette flow',
               2,
               'scale:vib:exer:starting_Couette',
               'scale:vib:exer:starting_Couette'),
              ('Exercise 17: Scale Couette flow with pressure gradient',
               2,
               'scale:vib:exer:Couette_wpressure',
               'scale:vib:exer:Couette_wpressure'),
              ('Exercise 18: Suggestions...',
               2,
               'scale::exer:suggest',
               'scale::exer:suggest'),
              ('References', 1, None, '___sec147')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\half}{\frac{1}{2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\x}{\boldsymbol{x}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
$$




    
<a name="part0008"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._scaling-book-solarized007.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._scaling-book-solarized009.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- !split -->

<h1 id="sec:scale:diffu">The diffusion equation</h1>

<p>
The diffusion equation in a one-dimensional homogeneous medium reads

$$
\begin{equation}
\frac{\partial u}{\partial t} =
\dfc\frac{\partial^2 u}{\partial x^2}, \quad  x\in (0,L),\ t\in (0,T],
\tag{94}
\end{equation}
$$

where \( \dfc \) is the diffusion coefficient. The
multi-dimensional generalization to a heterogeneous medium
and a force term takes the form

$$
\begin{equation}
\frac{\partial u}{\partial t} =
\nabla\cdot\left(\dfc \nabla u\right) + f, \quad  x,y,z\in \Omega,\ t\in (0,T]\tp
\tag{95}
\end{equation}
$$

We first look at scaling the PDE itself, and thereafter we discuss
some types of boundary conditions and how to scale the complete
initial-boundary value problem.

<h2 id="sec:scale:diffu:homo1D">Homogeneous diffusion equation</h2>

<h3 id="___sec91">Simplified 1D PDE </h3>

<p>
To make <a href="#mjx-eqn-94">(94)</a> dimensionless,
we introduce as usual dimensionless dependent and independent variables:

$$ \bar x = \frac{x}{x_c},
\quad \bar t = \frac{t}{t_c}, \quad \bar u =\frac{u}{u_c}\tp$$

Inserting the dimensionless quantities in the one-dimensional
PDE <a href="#mjx-eqn-94">(94)</a> results in

$$
\frac{\partial \bar u}{\partial \bar t} =
\frac{t_c\dfc}{L^2}
\frac{\partial^2 \bar u}{\partial \bar x^2}, \quad  \bar x\in (0,1),\ \bar t\in (0,\bar T = T/t_c]\tp
\tag{96}
$$

Arguing as for the wave equation that the scaling should result in

$$ \frac{\partial \bar u}{\partial \bar t}\hbox{ and }
\frac{\partial^2 \bar u}{\partial \bar x^2}$$

of the same size (about unity),
implies \( t_c\dfc/L^2=1 \) and therefore \( t_c = L^2/\dfc \).

<p>
Insight through an analytical solution can alternatively
help with choosing \( t_c \).
One can show that \( u=Ae^{-pt}\sin (kx) \) is a solution of
<a href="#mjx-eqn-96">(96)</a> if \( p=\dfc k^2 \), for any \( k \). Exponential decay in
time is a characteristic feature of the diffusion equation, and
the e-folding time can then be taken as a time scale. This means
\( t_c = 1/p \sim k^{-2} \). Since \( k \) is related to the spatial
wave length \( \lambda \)
through \( k=2\pi/\lambda \), it means that \( t_c \) depends strongly on the wave
length of the sine term \( \sin(kx) \).
In particular, short waves (as found in noisy signals) with
large \( k \) decay very rapidly.
For the overall solution we are interested in how the longest meaningful
wave decays and use that time scale for \( t_c \). The longest wave
typically has half a wave length over the domain \( [0,L] \):
\( u = Ae^{-pt}\sin(\pi x/L) \) (\( k=\pi/L \)). Then \( t_c=L^2/\dfc \pi^{-2} \),
but factor \( \pi^{-2} \) is not important and we simply choose
\( t_c=L^2/\dfc \), which equals the time scale we arrived at above.
We may say that \( t_c \) is the time it takes for the diffusion to
significantly change the solution in the entire domain.

<p>
Another fundamental solution of the diffusion equation is the
diffusion of a Gaussian function: \( u(x,t)=(4\pi\dfc
t)^{-1/2}\exp{(-x^2/(4\dfc t))} \). For the diffusion to be significant
at a distance \( x=L \), we may demand the exponential factor to have a
value of \( e^{-1}\approx 0.37 \), which implies \( t=L^2/(4\dfc) \), but the
factor 4 is not of importance, so again, a relevant time scale is
\( t_c=L^2/\dfc \).

<p>
The scale \( u_c \) is chosen according to the initial condition:
\( u_c=\max_{x\in(0,L)}|I(x)| \). For a diffusion equation \( u_t=\dfc u_{xx} \)
with \( u=0 \) at the boundaries \( x=0,L \), the solution is bounded by
the initial condition \( I(x) \). Therefore, the listed choice of \( u_c \)
implies that
\( |u|\leq 1 \). (The solution \( u=Ae^{-pt}\sin (kx) \) is such an example
if \( k=n\pi/L \) for integer \( n \) such that \( u=0 \) for \( x=0 \) and \( x=L \).)

<p>
The resulting dimensionless PDE becomes

$$
\begin{equation}
\frac{\partial \bar u}{\partial \bar t} =
\frac{\partial^2 \bar u}{\partial \bar x^2}, \quad  \bar x\in (0,1),\ \bar t\in (0,\bar T],
\tag{97}
\end{equation}
$$

with initial condition

$$ \bar u(\bar x, 0) = \bar I(\bar x) = \frac{I(x_c\bar x)}{\max_x |I(x)|}\tp$$

Notice that <a href="#mjx-eqn-97">(97)</a> is without physical parameters!

<h3 id="___sec92">Generalized PDE </h3>

<p>
Turning the attention to <a href="#mjx-eqn-95">(95)</a>, we introduce
the dimensionless diffusion coefficient

$$ \bar\dfc(\bar x,\bar y,\bar z) =
\dfc_c^{-1}\dfc (x_c\bar x, y_c\bar y, z_c\bar z),$$

typically with

$$ \dfc_c = \max_{x,y,z}\dfc(x,y,z)\tp$$

The length scales are

$$ \bar x = \frac{x}{x_c},\quad \bar y = \frac{y}{y_c},\quad
\bar z = \frac{z}{z_c}\tp
$$

We scale \( f \) in a similar fashion:

$$ \bar f(\bar x, \bar y, \bar z, \bar t)
= f_c^{-1}f(\bar xx_c, \bar yy_c \bar zz_c, \bar tt_c),$$

with

$$ f_c = \max_{x,y,z,t}|f(x,y,z,t)|\tp$$

Also assuming
that \( x_c=y_c=z_c=L \), and \( u_c=\max_{x,y,z}(I(x,y,z) \),
we end up with the scaled PDE

$$
\begin{equation}
\frac{\partial \bar u}{\partial \bar t} =
\nabla\cdot\left(\bar\dfc \bar\nabla \bar u\right) + \beta f, \quad  \bar x,\bar y,\bar z\in \bar \Omega,\ \bar t\in (0,\bar T]\tp
\tag{98}
\end{equation}
$$

Here, \( \bar\nabla \) means differentiation with respect to dimensionless
coordinates \( \bar x \), \( \bar y \), and \( \bar z \). The dimensionless parameter
\( \beta \) takes the form

$$ \beta = \frac{t_cf_c}{u_c} = \frac{L^2}{\dfc}
\frac{\max_{x,y,z,t}|f(x,y,z,t)|}{\max_{x,y,z}|I(x,y,z)|}\tp$$

The scaled initial condition is \( \bar u = \bar I \) as in the 1D case.

<p>
An alternative choice \( u_c \) is to make the coefficient \( t_cf_c/u_c \)
in the source term unity. The scaled PDE now becomes

$$
\begin{equation}
\frac{\partial \bar u}{\partial \bar t} =
\nabla\cdot\left(\bar\dfc \bar\nabla \bar u\right) + f,
\tag{99}
\end{equation}
$$

but the initial condition features the \( \beta \) parameter:

$$ \bar u(\bar x, \bar y, \bar z, 0) = \frac{I}{t_cf_c} =
\beta^{-1}\bar I(\bar x,\bar y,\bar z)\tp
$$

<p>
We may check that \( \beta \) is really non-dimensional. From the PDE,
\( f \) must have the same dimensions as \( \partial u/\partial t \), i.e.,
\( [\Theta\hbox{T}^{-1}] \).
The dimension of \( \dfc \) is more intricate, but from the term
\( \dfc u_{xx} \) we know that \( u_{xx} \) has dimensions \( [\Theta\hbox{L}^{-2}] \),
and then \( \dfc \) must have dimension \( \hbox{L}^2\hbox{T}^{-1}] \)
to match the target \( [\Theta\hbox{T}^{-1}] \).
In the expression for \( \beta \) we get
\( [\hbox{L}^2\Theta\hbox{T}^{-1}(\hbox{L}^2\hbox{T}^{-1}\Theta)^{-1}] \),
which equals 1 as it should.

<h2 id="___sec93">Jump boundary condition </h2>

<p>
A classical one-dimensional
heat conduction problem goes as follows. An insulated rod
at some constant temperature \( U_0 \) is suddenly heated from one end
(\( x=0 \)), modeled as a constant Dirichlet condition \( u(0,t)=U_L\neq U_0 \)
at that end. That is, the boundary temperature jumps from \( U_0 \) to \( U_1 \)
at \( t=0 \). All the other surfaces of the rod are insulated such that
a one-dimensional model is appropriate.
Heat cannot escape, and we supply heat at \( x=0 \) at the temperature \( U_1 \),
which will warm up all of the material to the temperature \( U_1 \).
That is, \( u\rightarrow U_1 \) as \( t\rightarrow\infty \).

<p>
The initial-boundary value problem reads

$$
\begin{align}
\frac{\partial u}{\partial t} &=
\dfc \frac{\partial^2 u}{\partial x^2},
\quad &  x\in (0,L),\ t\in (0, T],
\tag{100}\\ 
u(x,0) &= U_0,
\quad & x\in [0,L],
\tag{101}\\ 
u(0, t) & = U_1,
\quad  & t\in (0, T],
\tag{102}\\ 
\frac{\partial}{\partial x} u(L, t) & = 0,
\quad & t\in (0, T].
\tag{103}
\end{align}
$$

The diffusion coefficient is related to heat transfer parameters
by \( \dfc = k/(\varrho c) \), where \( k \) is the heat conduction coefficient,
\( \varrho \) is the density, and \( c \) is a specific heat capacity parameter.

<p>
The natural dimensionless temperature for this problem is

$$ \bar u = \frac{u - U_0}{U_1 - U_0},$$

since this choice makes \( \bar u\in [0,1] \). The reason is that \( u \) is bounded by
the initial and boundary conditions (in the absence of a source term),
and we have
\( \bar u(\bar x,0)=0 \), \( \bar u(\bar x,\infty)=1 \), and \( 
\bar u(0,\bar t)=1 \).

<p>
The choice of \( t_c \) is as in the previous cases. We arrive at
the dimensionless initial-boundary value problem

$$
\begin{align}
\frac{\partial \bar u}{\partial \bar t} &=
\frac{\partial^2 \bar u}{\partial \bar x^2},
\quad &  \bar x\in (0,1),\ \bar t\in (0, \bar T],
\tag{104}\\ 
\bar u(\bar x,0) &= 0,
\quad & \bar x\in [0,1],
\tag{105}\\ 
\bar u(0, \bar t) & = 1,
\quad  & \bar t\in (0, \bar T],
\tag{106}\\ 
\frac{\partial}{\partial \bar x} u(1, \bar t) & = 0,
\quad & \bar t\in (0, \bar T].
\tag{107}
\end{align}
$$

The striking feature is that there are no physical parameters left in
this problem. One simulation can be carried out for \( \bar u(\bar x,\bar t) \),
and the temperature in a rod of any material and any constant initial and
boundary temperature can be retrieved by

$$ u(x,t) = U_0 + (U_1-U_0)\bar u(x/L, t\dfc/L^2)\tp$$

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 6</b>: Include simulation results.)</font>
<!-- end inline comment -->

<h2 id="___sec94">Oscillating Dirichlet condition </h2>

<p>
Let us address the heat equation problem where the temperature is
oscillating on the boundary \( x=0 \):

$$
\begin{align}
\frac{\partial u}{\partial t} &=
\dfc \frac{\partial^2 u}{\partial x^2},
\quad &  x\in (0,L),\ t\in (0, T],
\tag{108}\\ 
u(x,0) &= U_0,
\quad & x\in [0,L],
\tag{109}\\ 
u(0, t) & = U_0 + A\sin(\omega t),
\quad  & t\in (0, T],
\tag{110}\\ 
\frac{\partial}{\partial x} u(L, t) & = 0,
\quad & t\in (0, T].
\tag{111}
\end{align}
$$

One important physical application is temperature oscillations in the
ground, either day and night variations
at a short temporal and spatial scale, or seasonal variations in the
Earth's crust.

<p>
Since the boundary temperature is oscillating around the initial
condition, we expect \( u\in [-A,A] \).
Then the dimensionless temperature is therefore taken as

$$ \bar u = \frac{u-U_0}{2A},$$

such that \( \bar u\in [-1,1] \).

<p>
What is an appropriate time scale? There will be two time scales involved,
the oscillations \( \sin(\omega t) \) with period \( P=2\pi/\omega \) at
the boundary and the &quot;speed of diffusion&quot; where \( t_c=L^2/\dfc \) is
the appropriate scale.
Analytical insight exists in this model problem because the exact
solution is known to be

$$
\begin{equation}
u(x,t) = U_0 - Ae^{-bx}\sin (bx - \omega t),\quad b =\sqrt{\frac{\omega}{2\dfc}}\tp
\tag{112}
\end{equation}
$$

This solution is of the form \( e^{-bx}g(x-ct) \), i.e., a wave that
moves to the right with velocity \( c \) and a damped amplitude \( e^{-bx} \).
This is seen if we make a rewrite

$$ u(x,t) = U_0 - Ae^{-bx}\sin\left(b(x - ct)\right),\quad
c=\omega/b = \sqrt{2\dfc\omega},\  b =\sqrt{\frac{\omega}{2\dfc}}\tp$$

<p>
The boundary oscillations lead to the time scale \( t_c=1/\omega \).
The speed of the wave suggests another time scale: the time it
takes to propagate through the domain, which is \( L/c \), and
hence \( t_c = L/c = L/\sqrt{2\dfc\omega} \).

<p>
One may argue that \( L \) is not the appropriate length scale, because
\( u \) is damped by \( e^{-bx} \) so for \( x > 4/b \), \( u \) is close to zero.
Using \( 1/b \) as length scale, which is the e-folding distance of the
damping factor, and basing
\( t_c \) on the time it takes a signal to propagate one length scale,
\( t_c^{-1}=bc=\omega \). Similarly, the time scale based on
the &quot;speed of diffusion&quot; changes to
\( t_c^{-1}= b^2\dfc = \half\omega \) if we employ \( 1/b \) as length scale.

<p>
To summarize, we have three candidates for the time scale:
\( t_c=L^2/\dfc \), \( t_c=2/\omega \), and \( t_c=1/\omega \).

<p>
Let us look
at the dimensionless exact solution to see if it can help with the choice.
We introduce the dimensionless
parameters

$$ \beta = bx_c = x_c\sqrt{\frac{\omega}{2dfc}},\quad
\gamma = \omega t_c\tp$$

The scaled solution becomes

$$ \bar u(\bar x, \bar t; \beta,\gamma) = e^{-\beta\bar x}\sin(\beta\bar x - \gamma\bar t)\tp$$

The three choices of \( \gamma \), implied by the three choices of \( t_c \), are

$$
\begin{equation}
\gamma = \left\lbrace\begin{array}{ll}
1, & t_c=1/\omega,\\ 
2, & t_c = 2/\omega,\\ 
2\beta^2, & t_c = L^2/\dfc,\ x_c=L
\end{array}\right.
\tag{113}
\end{equation}
$$

The former two choices leaves only \( \beta \) as parameter in \( \bar u \),
and with \( x_c=1/b \) as length scale, \( \beta \) becomes unity, and there
are no parameters in the dimensionless solution:

$$
\begin{equation}
\bar u(\bar x, \bar t) = e^{-\bar x}\sin(\bar x - \bar t)\tp
\tag{114}
\end{equation}
$$

Therefore, \( x_c=1/b \) and \( t_c=1/\omega \) (or \( t_c=2/\omega \), but the
factor 2 is of no importance) are therefore the most appropriate scales.

<p>
To further argue why <a href="#mjx-eqn-114">(114)</a> these scales are
preferred, think of
\( \omega \) as large. Then the wave is damped over a short
distance and there will be a thin boundary layer of temperature
oscillations near \( x=0 \) and little changes in \( u \) in the rest of
the domain. The scaling <a href="#mjx-eqn-114">(114)</a> resolves
this problem by using \( 1/b \sim \omega^{-1/2} \) as length scale,
because then the boundary layer thickness is independent of
\( \omega \). The length of the domain can be chosen as, e.g., \( 4/b \)
such that \( \bar u\approx 0 \) at this end. The length scale \( 1/b \)
help us to zoom in on the part of \( u \) where significant changes
take place.

<p>
In the other limit, \( \omega \) small, \( b \) becomes small, and the wave
is hardly damped in the domain \( [0,L] \) unless \( L \) is large enough.
The imposed boundary condition on \( x=L \) in fact requires \( u \) to
be constant so its derivative vanishes, and this property can only
be obtained if \( L \) is
enough to ensure that the wave becomes significantly damped.
Therefore, the length scale is dictated by \( b \), not \( L \), and \( L \)
should be adapted to \( b \), typically \( L\geq 4/b \).

<p>
The resulting scaled problem becomes

$$
\begin{align}
\frac{\partial \bar u}{\partial \bar t} &=
\frac{1}{2}\frac{\partial^2 u}{\partial x^2},
\quad & \bar x\in (0,4/b),\ \bar t\in (0,\bar T],
\tag{115}\\ 
\bar u(\bar x,0) &= 0,
\quad &\bar x\in [0,1]
\tag{116}\\ 
\bar u(0,\bar t) & = \sin(\bar t),
\quad  &\bar t\in (0,\bar T],
\tag{117}\\ 
\frac{\partial}{\partial\bar x}\bar u(1,\bar t) & = 0,
\quad &\bar t\in (0,\bar T].
\tag{118}
\end{align}
$$

The coefficient in front of the second-derivative becomes

$$ \frac{t_c\dfc}{1/b^2} = \frac{b^2\dfc}{\omega} =
= \frac{1}{2}\tp$$

We may, of course, choose \( t_c=2/\omega \) and get rid of the \( \half \) factor,
if desired, but then it turns up in <a href="#mjx-eqn-117">(117)</a> instead,
as \( \sin (2\bar t) \).

<h2 id="sec:scale:diffu:source">Diffusion equation with source term</h2>

<p>
Let us add a source term \( f(x,t) \) to the diffusion equation,

$$
\begin{equation}
\frac{\partial u}{\partial t} =
\dfc\frac{\partial^2 u}{\partial x^2} + f(x,t), \quad  x\in (0,L),\ t\in (0,T]
\tp
\tag{119}
\end{equation}
$$

As always, we introduce

$$ \bar x = \frac{x}{x_c},\quad
\ \bar t = \frac{t}{t_c}, \quad\bar u =\frac{u}{u_c},$$

and a scaling of \( f \),

$$ \bar f(\bar x,\bar t) = \frac{f(x,t)}{f_c},\quad f_c=\max_{x,t}f(x,t)\tp$$

Inserting the dimensionless quantities in <a href="#mjx-eqn-119">(119)</a>
and making each term dimensionless results in

$$
\begin{equation}
\frac{\partial \bar u}{\partial \bar t} =
\frac{t_c\dfc}{x_c^2}
\frac{\partial^2 u}{\partial x^2} + \frac{t_cf_c}{u_c}
\bar f(\bar x,\bar t), \quad  \bar x\in (0,L/x_c),\ \bar t\in (0,T/t_c]
\tp
\tag{120}
\end{equation}
$$

<p>
The magnitude of \( u \) is governed by \( f \) as well as by
initial and boundary conditions. Suppose initial and boundary conditions
are zero.
The length scale \( x_c \) is naturally chosen as \( L \) such that \( \bar x\in[0,1] \).
It is also natural to choose \( t_c \) to be the time scale
of diffusion, as before, \( t_c=x_c^2/\dfc = L^2/\dfc \). The source term can match
the unit size of the two other terms by choosing its coefficient to be
unity, i.e.,

$$ u_c=t_cf_c=\frac{L^2 \max_{x,t} f}{\dfc}\tp$$

The scaled equation then becomes free of physical parameters:

$$
\begin{equation}
\frac{\partial \bar u}{\partial \bar t} =
\frac{\partial^2 u}{\partial x^2} +
\bar f(\bar x,\bar t), \quad  \bar x\in (0,L/x_c),\ \bar t\in (0,T/t_c]
\tp
\tag{121}
\end{equation}
$$

<p>
With an initial condition \( u=I \), we get a scaled initial condition

$$ \bar u(\bar x, 0) = \beta \bar I(L\bar x),$$

where \( \bar I = I/\max_x I(x) \) is a scaled version of \( I \), and \( \beta \)
is a dimensionless number

$$ \beta = \frac{\max_xI(x)}{\max_{x,t}f(x,t)}\frac{\dfc}{L^2}\tp$$

It measures the ratios of \( I \) and \( f \) per unit
characteristic time.

<p>
Suppose now that we choose \( u_c=\max_x I(x) \) because \( f \) is small compared
to \( I \). The initial condition then reads \( \bar u(\bar x,0)=\bar I(\bar x) \),
and the differential equation becomes

$$
\frac{\partial \bar u}{\partial \bar t} =
\frac{\partial^2 u}{\partial x^2} +
\beta^{-1} \bar f(\bar x,\bar t)
\tp
$$

This is the relevant scaling for a small \( f \) and large \( \beta \),
indicating that \( \beta^{-1} \bar f \) can be neglected from the
PDE. A major influence of \( f \) leads to a balance between all
three terms in the PDE, but the initial condition has a small
\( \beta \), and one can set \( \bar u(\bar x, 0)\approx 0 \).
<a href="._scaling-book-solarized010.html#scale:vib:exer:Couette_wpressure">Exercise 17: Scale Couette flow with pressure gradient</a> explores a similar
stationary problem.

<h2 id="sec:scale:diffu:Fisher">Fisher's equation</h2>

<p>
Fisher's equation is essentially the logistic equation at each point
for population dynamics combined with spatial movement through
ordinary diffusion:

$$
\begin{equation}
\frac{\partial u}{\partial t} =
\dfc\frac{\partial^2 u}{\partial x^2} + \varrho u(1-u/M)
\tp
\tag{122}
\end{equation}
$$

This PDE is also known as the KPP equation after
Kolmogorov, Petrovsky, and Piskynov (who introduced the equation
independently of Fisher).

<p>
Introducing

$$ \bar x = \frac{x}{x_c},\quad
\ \bar t = \frac{t}{t_c}, \quad\bar u =\frac{u}{u_c},$$

results in

$$
\frac{\partial \bar u}{\partial \bar t} =
\frac{t_c\dfc}{x_c^2}
\frac{\partial^2 u}{\partial x^2} + t_c \varrho \bar u (1 - u_c\bar u/M)\tp
$$

If all terms are equally important, the scales can be determined from
demanding the coefficients to be unity and by scaling \( u \) by \( M \):

$$ u_c=M,\quad t_c = \frac{1}{\varrho},\quad x_c = \sqrt{\frac{\dfc}{\varrho}}
\tp$$

The scaled PDE becomes

$$
\begin{equation}
\frac{\partial \bar u}{\partial \bar t} =
\frac{\partial^2 u}{\partial x^2} + \bar u (1 - \bar u)\tp
\end{equation}
$$

With this scaling, the length scale \( x_c=\sqrt{\dfc/\varrho} \)
is not related to the domain size, so the scale is most relevant for
an infinite domain. Also, note that the time scale \( t_c=\varrho^{-1} \)
is governed by the logistic term (exponential growth for small \( u \))
and not the diffusion process as in most previous examples.

<p>
On a finite domain \( [0,L] \) we set \( x_c=L \), \( t_c=\varrho^{-1} \),
\( u_c=M \), which gives

$$
\begin{equation}
\frac{\partial \bar u}{\partial \bar t} =
\beta
\frac{\partial^2 u}{\partial x^2} + \bar u (1 - \bar u),
\end{equation}
$$

where \( \beta \) is a dimensionless number

$$ \beta = \frac{\dfc}{\varrho L^2} = \frac{\varrho^{-1}}{L^2/\dfc},$$

demonstrating that \( \beta \) measures the ratio of the time scale
for exponential growth in the beginning of the logistic process
and the time scale of diffusion \( L^2/\dfc \).
For small \( \beta \) we can neglect the diffusion and spatial movements,
and the PDE is essentially a logistic ODE at each point, while for
large \( \beta \), diffusion dominates, and \( t_c \) should in that case be
based on the diffusion time scale \( L^2/\dfc \). This leads to the
scaled PDE

$$
\begin{equation}
\frac{\partial \bar u}{\partial \bar t} =
\frac{\partial^2 u}{\partial x^2} + \beta^{-1}\bar u (1 - \bar u),
\end{equation}
$$

showing that a large \( \beta \) encourages omission of the logistic term,
because the point-wise growth takes place on large time scales while
diffusion is rapid. The effect of diffusion is then more prominent
and it suffices to solve \( \bar u_{\bar t} = \bar u_{\bar x\bar x} \).

<p>
<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._scaling-book-solarized007.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._scaling-book-solarized009.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


<center style="font-size:80%">
<!-- copyright --> &copy; 2015, Hans Petter Langtangen. Released under CC Attribution 4.0 license
</center>


</body>
</html>
    

