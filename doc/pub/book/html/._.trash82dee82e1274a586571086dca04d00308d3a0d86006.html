<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Scaling of Differential Equations">
<meta name="keywords" content="units,base unit,length,mass,time,dimension of physical quantities,Pi theorem,Buckingham Pi theorem,units US,units British,units conversion,units software,multiple software runs,web interface (Parampool),graphical web interface,scaling,non-dimensionalization,dimensionless variable,exponential decay,dimensionless variable,characteristic time,e-folding time,memoize function,dimensionless number,dimensionless number,dimensionless number,logistic equation,dimensionless number,frequency,frequency, angular,period (of oscillations),radians,angular frequency,quality factor $Q$,phase shift,Lotka-Volterra, predator-prey model,Lotka-Volterra, competing species model,dimensionless number,Peclet number,dimensionless number,Reynolds number,Biot number,thermo-elasticity,Navier-Stokes equations,dimensionless number,Reynolds number,Bernoulli's equation,Reynolds number,low Reynolds number flow,Stokes problem,Stokes' flow,Froude number,creeping flow,Strouhal number,vortex shedding,Euler number,Weber number,forced convection,Peclet number,Reynolds number,free convection,Grashof number,Reynolds number,Peclet number,Eckert number,Nusselt number,Biot number,Mach number,bidomain equations">

<title>Scaling of Differential Equations</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

body { font-size:20px;line-height:1.5; }
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [(u'Preface', 0, u'ch:preface', u'ch:preface'),
              (u'Dimensions and units',
               0,
               u'scale:dimunit',
               u'scale:dimunit'),
              (u'Fundamental concepts', 1, None, '___sec2'),
              (u'Base units and dimensions', 2, None, '___sec3'),
              (u'Dimensions of common physical quantities',
               2,
               u'scale:dimunit:tables',
               u'scale:dimunit:tables'),
              (u'Prefixes for units', 3, None, '___sec5'),
              (u'The Buckingham Pi theorem',
               2,
               u'scale:dimunit:Pi',
               u'scale:dimunit:Pi'),
              (u'Absolute errors, relative errors, and units',
               2,
               None,
               '___sec7'),
              (u'Units and computers', 2, None, '___sec8'),
              (u'Unit systems', 2, None, '___sec9'),
              (u'Example on challenges arising from unit systems',
               2,
               None,
               '___sec10'),
              (u'PhysicalQuantity: a tool for computing with units',
               2,
               u'scale:PQ',
               u'scale:PQ'),
              (u'Parampool: user interfaces with automatic unit conversion',
               1,
               u'scale:parampool',
               u'scale:parampool'),
              (u'Example application', 3, None, '___sec13'),
              (u'Pool of parameters', 2, None, '___sec14'),
              (u'Fetching pool data for computing', 2, None, '___sec15'),
              (u'Reading command-line options', 2, None, '___sec16'),
              (u'Setting default values in a file', 2, None, '___sec17'),
              (u'Specifying multiple values of input parameters',
               2,
               None,
               '___sec18'),
              (u'Generating a graphical user interface', 2, None, '___sec19'),
              (u'Ordinary differential equation models', 0, None, '___sec20'),
              (u'Exponential decay problems',
               1,
               u'sec:scale:decay',
               u'sec:scale:decay'),
              (u'Fundamental ideas of scaling', 2, None, '___sec22'),
              (u'The basic model problem', 2, None, '___sec23'),
              (u'Example: Population dynamics', 3, None, '___sec24'),
              (u'Example: Decay of pressure with altitude',
               3,
               None,
               '___sec25'),
              (u'The technical steps of the scaling procedure',
               2,
               u'sec:scale:steps',
               u'sec:scale:steps'),
              (u'Step 1: Identify independent and dependent variables',
               3,
               None,
               '___sec27'),
              (u'Step 2: Make independent and dependent variables dimensionless',
               3,
               None,
               '___sec28'),
              (u'Step 3: Derive the model involving only dimensionless variables',
               3,
               None,
               '___sec29'),
              (u'Step 4: Make each term dimensionless', 3, None, '___sec30'),
              (u'Step 5: Estimate the scales', 3, None, '___sec31'),
              (u'Making software for utilizing the scaled model',
               2,
               u'sec:scale:prog',
               u'sec:scale:prog'),
              (u'Software for the original unscaled problem',
               3,
               None,
               '___sec33'),
              (u'Software for the scaled problem', 3, None, '___sec34'),
              (u'Implementation with joblib', 3, None, '___sec35'),
              (u'Scaling a generalized problem',
               2,
               u'sec:scale:body',
               u'sec:scale:body'),
              (u'Exact solution', 3, None, '___sec37'),
              (u'Theory', 3, None, '___sec38'),
              (u'Software', 3, None, '___sec39'),
              (u'Variable coefficients',
               2,
               u'sec:scale:jump',
               u'sec:scale:jump'),
              (u'Scaling a cooling problem with constant temperature in the surroundings',
               2,
               u'scale:cooling:const',
               u'scale:cooling:const'),
              (u'Exact solution', 3, None, '___sec42'),
              (u'Scaling', 3, None, '___sec43'),
              (u'Software', 3, None, '___sec44'),
              (u'Alternative scaling', 3, None, '___sec45'),
              (u'Scaling a cooling problem with time-dependent surroundings',
               2,
               u'scale:cooling:osc',
               u'scale:cooling:osc'),
              (u'Exact solution', 3, None, '___sec47'),
              (u'Scaling', 3, None, '___sec48'),
              (u'Software', 3, None, '___sec49'),
              (u'Discussion of the time scale', 3, None, '___sec50'),
              (u'Scaling a nonlinear ODE',
               2,
               u'sec:scale:nonlinear',
               u'sec:scale:nonlinear'),
              (u'Scaling', 3, None, '___sec52'),
              (u'Alternative scaling', 3, None, '___sec53'),
              (u'SIR ODE system for spreading of diseases',
               2,
               None,
               '___sec54'),
              (u'Scaling', 3, None, '___sec55'),
              (u'Software', 3, None, '___sec56'),
              (u'Alternative scaling', 3, None, '___sec57'),
              (u'SIRV model with finite immunity', 2, None, '___sec58'),
              (u'Michaelis-Menten kinetics for biochemical reactions',
               2,
               u'scale:MMK',
               u'scale:MMK'),
              (u'Classical analysis', 3, None, '___sec60'),
              (u'Dimensionless ODE system', 3, None, '___sec61'),
              (u'Determining scales', 3, None, '___sec62'),
              (u'Conservation equations', 3, None, '___sec63'),
              (u'Analysis of the scaled system', 3, None, '___sec64'),
              (u'Vibration problems', 1, u'sec:scale:vib', u'sec:scale:vib'),
              (u'Undamped vibrations without forcing',
               2,
               u'sec:scale:vib:undamped',
               u'sec:scale:vib:undamped'),
              (u'The first technical steps of scaling', 3, None, '___sec67'),
              (u'The exact solution', 3, None, '___sec68'),
              (u'Discussion of the displacement scale', 3, None, '___sec69'),
              (u'Discussion of the time scale', 3, None, '___sec70'),
              (u'The dimensionless solution', 3, None, '___sec71'),
              (u'Alternative displacement scale', 3, None, '___sec72'),
              (u'About frequency and dimensions', 3, None, '___sec73'),
              (u'Undamped vibrations with constant forcing',
               2,
               u'sec:scale:vib:undamped:mg',
               u'sec:scale:vib:undamped:mg'),
              (u'Undamped vibrations with time-dependent forcing',
               2,
               u'sec:scale:vib:undamped:F',
               u'sec:scale:vib:undamped:F'),
              (u'Investigating scales via analytical solutions',
               3,
               None,
               '___sec76'),
              (u'The displacement and time scales', 3, None, '___sec77'),
              (u'Finding the displacement scale from the differential equation',
               3,
               None,
               '___sec78'),
              (u'Scaling with free vibrations as time scale',
               3,
               None,
               '___sec79'),
              (u'Software', 3, None, '___sec80'),
              (u'Choice of $u_c$ close to resonance', 3, None, '___sec81'),
              (u'Unit size of all terms in the ODE', 3, None, '___sec82'),
              (u'Choice of $u_c$ when $\\psi\\gg\\omega$',
               3,
               None,
               '___sec83'),
              (u'Displacement scale based on $I$', 3, None, '___sec84'),
              (u'Damped vibrations with forcing',
               2,
               u'sec:scale:vib:damped:F',
               u'sec:scale:vib:damped:F'),
              (u'The exact solution', 3, None, '___sec86'),
              (u'Choosing scales', 3, None, '___sec87'),
              (u'Choice of $u_c$ at resonance', 3, None, '___sec88'),
              (u'Choice of $u_c$ when $\\omega\\gg\\psi$',
               3,
               None,
               '___sec89'),
              (u'Choice of $u_c$ when $\\omega\\ll\\psi$',
               3,
               None,
               '___sec90'),
              (u'Software', 3, None, '___sec91'),
              (u'Oscillating electric circuits', 2, None, '___sec92'),
              (u'Exercises', 1, None, '___sec93'),
              (u'Exercise 2.1: Perform unit conversion',
               2,
               u'sec:scale:exer:US2SI1',
               u'sec:scale:exer:US2SI1'),
              (u'Problem 2.2: Scale a simple formula',
               2,
               u'sec:scale:exer:ball_y',
               u'sec:scale:exer:ball_y'),
              (u'Exercise 2.3: Perform alternative scalings',
               2,
               u'sec:scale:exer:decay:cooling:osc',
               u'sec:scale:exer:decay:cooling:osc'),
              (u'Problem 2.4: A nonlinear ODE for vertical motion with air resistance',
               2,
               u'sec:scale:exer:ball_y_wdrag',
               u'sec:scale:exer:ball_y_wdrag'),
              (u'Exercise 2.5: Solve a decay ODE with discontinuous coefficient',
               2,
               u'sec:scale:exer:decay:jump',
               u'sec:scale:exer:decay:jump'),
              (u'Exercise 2.6: Implement a scaled model for cooling',
               2,
               u'sec:scale:exer:decay:cooling',
               u'sec:scale:exer:decay:cooling'),
              (u'Problem 2.7: Decay ODE with discontinuous coefficients',
               2,
               u'scale:exer:decay:step',
               u'scale:exer:decay:step'),
              (u'Exercise 2.8: Alternative scalings of a cooling model',
               2,
               u'scale:exer:nonlin:logistic2',
               u'scale:exer:nonlin:logistic2'),
              (u'Exercise 2.9: Projectile motion',
               2,
               u'scale:vib:exer:projectile',
               u'scale:vib:exer:projectile'),
              (u'Problem 2.10: A predator-prey model',
               2,
               u'scale:exer:predprey',
               u'scale:exer:predprey'),
              (u'Problem 2.11: A model for competing species',
               2,
               u'scale:exer:competing_species',
               u'scale:exer:competing_species'),
              (u'Problem 2.12: Find the period of sinusoidal signals',
               2,
               u'scale:exer:sine',
               u'scale:exer:sine'),
              (u'Remarks', 3, None, '___sec106'),
              (u'Problem 2.13: Oscillating mass with sliding friction',
               2,
               u'scale:vib:exer:sliding',
               u'scale:vib:exer:sliding'),
              (u'Problem 2.14: Pendulum equations',
               2,
               u'sec:scale:exer:pendulum',
               u'sec:scale:exer:pendulum'),
              (u'Exercise 2.15: ODEs for a binary star',
               2,
               u'sec:scale:exer:binary_star',
               u'sec:scale:exer:binary_star'),
              (u"Problem 2.16: Duffing's equation",
               2,
               u'scale:vib:exer:Duffing',
               u'scale:vib:exer:Duffing'),
              (u'Problem 2.17: Vertical motion in a varying gravity field',
               2,
               u'scale:vib:exer:rocket',
               u'scale:vib:exer:rocket'),
              (u'Problem 2.18: A simplified Schroedinger equation',
               2,
               u'scale:vib:exer:quantum',
               u'scale:vib:exer:quantum'),
              (u'Remarks', 3, None, '___sec113'),
              (u'Basic partial differential equation models',
               0,
               None,
               '___sec114'),
              (u'The wave equation', 1, u'sec:scale:wave', u'sec:scale:wave'),
              (u'Homogeneous Dirichlet conditions in 1D',
               2,
               u'sec:scale:wave:bc_u0',
               u'sec:scale:wave:bc_u0'),
              (u'Implementation of the scaled wave equation',
               2,
               u'sec:scale:wave:impl',
               u'sec:scale:wave:impl'),
              (u'Waves on a string', 3, None, '___sec118'),
              (u'Detecting an already computed case', 3, None, '___sec119'),
              (u'Time-dependent Dirichlet condition',
               2,
               u'scale:wave:pde2',
               u'scale:wave:pde2'),
              (u'Scaling', 3, None, '___sec121'),
              (u'Software', 3, None, '___sec122'),
              (u'Specific case', 3, None, '___sec123'),
              (u'Velocity initial condition',
               2,
               u'scale:wave:pde2:Vcond',
               u'scale:wave:pde2:Vcond'),
              (u'Analytical insight', 3, None, '___sec125'),
              (u'Scaling', 3, None, '___sec126'),
              (u'Nonzero initial shape', 3, None, '___sec127'),
              (u'Variable wave velocity and forcing',
               2,
               u'scale:wave:pde2:cvar',
               u'scale:wave:pde2:cvar'),
              (u'Non-dimensionalization', 3, None, '___sec129'),
              (u'Choosing the time scale', 3, None, '___sec130'),
              (u'Choosing the spatial scale', 3, None, '___sec131'),
              (u'Scaling the velocity initial condition',
               3,
               None,
               '___sec132'),
              (u'Damped wave equation',
               2,
               u'scale:wave:pde2:damped',
               u'scale:wave:pde2:damped'),
              (u'A three-dimensional wave equation problem',
               2,
               None,
               '___sec134'),
              (u'The diffusion equation',
               1,
               u'sec:scale:diffu',
               u'sec:scale:diffu'),
              (u'Homogeneous 1D diffusion equation',
               2,
               u'sec:scale:diffu:homo1D',
               u'sec:scale:diffu:homo1D'),
              (u'Choosing the time scale', 3, None, '___sec137'),
              (u'Analytical insight', 3, None, '___sec138'),
              (u'Choosing other scales', 3, None, '___sec139'),
              (u'Generalized diffusion PDE', 2, None, '___sec140'),
              (u'Jump boundary condition', 2, None, '___sec141'),
              (u'Oscillating Dirichlet condition', 2, None, '___sec142'),
              (u'Scaling issues', 3, None, '___sec143'),
              (u'Exact solution', 3, None, '___sec144'),
              (u'Time and length scales', 3, None, '___sec145'),
              (u'The scaled problem', 3, None, '___sec146'),
              (u'Simulations', 3, None, '___sec147'),
              (u'Reaction-diffusion equations',
               1,
               u'sec:scale:diffu:Fisher',
               u'sec:scale:diffu:Fisher'),
              (u"Fisher's equation", 2, None, '___sec149'),
              (u'Balance of all terms', 3, None, '___sec150'),
              (u'Fixed length scale', 3, None, '___sec151'),
              (u'Nonlinear reaction-diffusion PDE', 2, None, '___sec152'),
              (u'The convection-diffusion equation',
               1,
               u'scale:convdiff',
               u'scale:convdiff'),
              (u'Convection-diffusion without a force term',
               2,
               None,
               '___sec154'),
              (u'Stationary PDE', 2, None, '___sec155'),
              (u'Convection-diffusion with a source term',
               2,
               u'scale:convdiff:f',
               u'scale:convdiff:f'),
              (u'Exercises', 1, None, '___sec157'),
              (u'Problem 3.1: Stationary Couette flow',
               2,
               u'scale:vib:exer:stationary_Couette',
               u'scale:vib:exer:stationary_Couette'),
              (u'Remarks', 3, None, '___sec159'),
              (u'Exercise 3.2: Couette-Poiseuille flow',
               2,
               u'scale:vib:exer:Couette_wpressure',
               u'scale:vib:exer:Couette_wpressure'),
              (u'Exercise 3.3: Pulsatile pipeflow',
               2,
               u'scale:exer:pipeflow:pulsatile',
               u'scale:exer:pipeflow:pulsatile'),
              (u'Exercise 3.4: The linear cable equation',
               2,
               u'scale:exer:cable_eq',
               u'scale:exer:cable_eq'),
              (u'Exercise 3.5: Heat conduction with discontinuous initial condition',
               2,
               u'scale:exer:twometal',
               u'scale:exer:twometal'),
              (u'Remarks', 3, None, '___sec164'),
              (u'Problem 3.6: Scaling a welding problem',
               2,
               u'diffu:exer:welding',
               u'diffu:exer:welding'),
              (u'Advanced partial differential equation models',
               0,
               None,
               '___sec166'),
              (u'The equations of linear elasticity',
               1,
               u'scale:elasticity',
               u'scale:elasticity'),
              (u'The general time-dependent elasticity problem',
               2,
               u'scale:elasticity:timedep',
               u'scale:elasticity:timedep'),
              (u'Software', 3, None, '___sec169'),
              (u'Dimensionless stress tensor',
               2,
               u'scale:elasticity:PDE1:stress',
               u'scale:elasticity:PDE1:stress'),
              (u'When can the acceleration term be neglected?',
               2,
               u'scale:elasticity:waves',
               u'scale:elasticity:waves'),
              (u'S waves', 3, None, '___sec172'),
              (u'P waves', 3, None, '___sec173'),
              (u'Time-varying load', 3, None, '___sec174'),
              (u'The stationary elasticity problem',
               2,
               u'scale:elasticity:stationary',
               u'scale:elasticity:stationary'),
              (u'Scaling of the PDE', 3, None, '___sec176'),
              (u'Remark on the characteristic displacement',
               3,
               None,
               '___sec177'),
              (u'Scaling of displacement boundary conditions',
               3,
               None,
               '___sec178'),
              (u'Scaling of traction boundary conditions',
               3,
               None,
               '___sec179'),
              (u'Quasi-static thermo-elasticity',
               2,
               u'scale:elasticity:thermo',
               u'scale:elasticity:thermo'),
              (u'The Navier-Stokes equations',
               1,
               u'sec:scale:ns',
               u'sec:scale:ns'),
              (u'The momentum equation without body forces',
               2,
               None,
               '___sec182'),
              (u'Scaling', 3, None, '___sec183'),
              (u'Dimensonless PDEs and the Reynolds number',
               3,
               None,
               '___sec184'),
              (u'Scaling of time for low Reynolds numbers',
               2,
               None,
               '___sec185'),
              (u'Shear stress as pressure scale', 2, None, '___sec186'),
              (u'Gravity force and the Froude number', 2, None, '___sec187'),
              (u'Oscillating boundary conditions and the Strouhal number',
               2,
               None,
               '___sec188'),
              (u'Cavitation and the Euler number', 2, None, '___sec189'),
              (u'Free surface conditions and the Weber number',
               2,
               u'freesurface:Weber',
               u'freesurface:Weber'),
              (u'Thermal convection', 1, None, '___sec191'),
              (u'Forced convection',
               2,
               u'scale:fluid:forced_convection',
               u'scale:fluid:forced_convection'),
              (u'Free convection',
               2,
               u'scale:fluid:free_convection',
               u'scale:fluid:free_convection'),
              (u'Governing equations', 3, None, '___sec194'),
              (u'Heating by viscous effects', 3, None, '___sec195'),
              (u'Relation between density and temperature',
               3,
               None,
               '___sec196'),
              (u'The Boussinesq approximation', 3, None, '___sec197'),
              (u'Scaling', 3, None, '___sec198'),
              (u'The Grashof, Prandtl, and Eckert numbers',
               2,
               None,
               '___sec199'),
              (u'Interpretations of the Grashof number',
               3,
               None,
               '___sec200'),
              (u'Heat transfer at boundaries and the Nusselt and Biot numbers',
               2,
               None,
               '___sec201'),
              (u'Compressible gas dynamics',
               1,
               u'scale:gasdyn',
               u'scale:gasdyn'),
              (u'The Euler equations of gas dynamics',
               2,
               u'scale:Euler_eqs',
               u'scale:Euler_eqs'),
              (u'General isentropic flow', 2, None, '___sec204'),
              (u'Elimination of the pressure', 3, None, '___sec205'),
              (u'The acoustic approximation for sound waves',
               2,
               u'scale:gas:acoustic',
               u'scale:gas:acoustic'),
              (u'Wave nature of isentropic flow with small perturbations',
               3,
               None,
               '___sec207'),
              (u'Basic scaling for small wave perturbations',
               3,
               None,
               '___sec208'),
              (u'Water surface waves driven by gravity',
               1,
               u'scale:surfacewaves',
               u'scale:surfacewaves'),
              (u'The mathematical model',
               2,
               u'scale:surfacewaves:Eulereq',
               u'scale:surfacewaves:Eulereq'),
              (u'Scaling', 2, None, '___sec211'),
              (u'Waves in deep  water', 2, None, '___sec212'),
              (u'Long waves in shallow water', 2, None, '___sec213'),
              (u'Two-phase porous media flow', 1, None, '___sec214'),
              (u'The bidomain model in electrophysiology',
               1,
               u'scale:bidomain',
               u'scale:bidomain'),
              (u'The mathematical model', 2, None, '___sec216'),
              (u'Scaling', 2, None, '___sec217'),
              (u'An alternative $I_{\\rm{ion}}$', 2, None, '___sec218'),
              (u'Exercises', 1, None, '___sec219'),
              (u'Exercise 4.1: Comparison of vibration models for elastic structures',
               2,
               u'scale::exer:elasticity:vibmodels',
               u'scale::exer:elasticity:vibmodels'),
              (u'Exercise 4.2: A model for quasi-static poro-elasticity',
               2,
               u'scale:exer:poroelasticity',
               u'scale:exer:poroelasticity'),
              (u'Problem 4.3: Starting Couette flow',
               2,
               u'scale:vib:exer:starting_Couette',
               u'scale:vib:exer:starting_Couette'),
              (u'Problem 4.4: Channel flow',
               2,
               u'scale:vib:exer:channel',
               u'scale:vib:exer:channel'),
              (u'Remarks', 3, None, '___sec224'),
              (u'References', 1, None, '___sec225')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\half}{\frac{1}{2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\x}{\boldsymbol{x}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\w}{\boldsymbol{w}}
\newcommand{\rpos}{\boldsymbol{r}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\stress}{\boldsymbol{\sigma}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\U}{\boldsymbol{U}}
\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
\newcommand{\ir}{\boldsymbol{i}_r}
\newcommand{\ith}{\boldsymbol{i}_{\theta}}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href=".trash82dee82e1274a586571086dca04d00308d3a0d86.html">Scaling of Differential Equations</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#ch:preface" style="font-size: 80%;"><b>Preface</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#scale:dimunit" style="font-size: 80%;"><b>Dimensions and units</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Fundamental concepts</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Base units and dimensions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#scale:dimunit:tables" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dimensions of common physical quantities</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Prefixes for units</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#scale:dimunit:Pi" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Buckingham Pi theorem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Absolute errors, relative errors, and units</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec8" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Units and computers</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec9" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unit systems</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec10" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example on challenges arising from unit systems</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#scale:PQ" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PhysicalQuantity: a tool for computing with units</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#scale:parampool" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Parampool: user interfaces with automatic unit conversion</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec13" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example application</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec14" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pool of parameters</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec15" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fetching pool data for computing</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec16" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reading command-line options</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec17" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setting default values in a file</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec18" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specifying multiple values of input parameters</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#___sec19" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generating a graphical user interface</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec20" style="font-size: 80%;"><b>Ordinary differential equation models</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:decay" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exponential decay problems</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec22" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fundamental ideas of scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec23" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The basic model problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec24" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Population dynamics</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec25" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Decay of pressure with altitude</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:steps" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The technical steps of the scaling procedure</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec27" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 1: Identify independent and dependent variables</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 2: Make independent and dependent variables dimensionless</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec29" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 3: Derive the model involving only dimensionless variables</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec30" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 4: Make each term dimensionless</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec31" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 5: Estimate the scales</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:prog" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making software for utilizing the scaled model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec33" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software for the original unscaled problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec34" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software for the scaled problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec35" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation with joblib</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:body" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling a generalized problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec37" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec38" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Theory</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec39" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:jump" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variable coefficients</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#scale:cooling:const" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling a cooling problem with constant temperature in the surroundings</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec42" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec43" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec44" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec45" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#scale:cooling:osc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling a cooling problem with time-dependent surroundings</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec47" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec48" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec49" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec50" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discussion of the time scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:nonlinear" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling a nonlinear ODE</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec52" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec53" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec54" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIR ODE system for spreading of diseases</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec55" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec56" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec57" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec58" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIRV model with finite immunity</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#scale:MMK" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Michaelis-Menten kinetics for biochemical reactions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec60" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Classical analysis</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec61" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dimensionless ODE system</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec62" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Determining scales</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec63" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Conservation equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec64" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis of the scaled system</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:vib" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vibration problems</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:vib:undamped" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Undamped vibrations without forcing</a></li>
     <!-- navigation toc: --> <li><a href="#___sec67" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The first technical steps of scaling</a></li>
     <!-- navigation toc: --> <li><a href="#___sec68" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The exact solution</a></li>
     <!-- navigation toc: --> <li><a href="#___sec69" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discussion of the displacement scale</a></li>
     <!-- navigation toc: --> <li><a href="#___sec70" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discussion of the time scale</a></li>
     <!-- navigation toc: --> <li><a href="#___sec71" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The dimensionless solution</a></li>
     <!-- navigation toc: --> <li><a href="#___sec72" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative displacement scale</a></li>
     <!-- navigation toc: --> <li><a href="#___sec73" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;About frequency and dimensions</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:vib:undamped:mg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Undamped vibrations with constant forcing</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:vib:undamped:F" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Undamped vibrations with time-dependent forcing</a></li>
     <!-- navigation toc: --> <li><a href="#___sec76" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Investigating scales via analytical solutions</a></li>
     <!-- navigation toc: --> <li><a href="#___sec77" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The displacement and time scales</a></li>
     <!-- navigation toc: --> <li><a href="#___sec78" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finding the displacement scale from the differential equation</a></li>
     <!-- navigation toc: --> <li><a href="#___sec79" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling with free vibrations as time scale</a></li>
     <!-- navigation toc: --> <li><a href="#___sec80" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="#___sec81" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) close to resonance</a></li>
     <!-- navigation toc: --> <li><a href="#___sec82" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unit size of all terms in the ODE</a></li>
     <!-- navigation toc: --> <li><a href="#___sec83" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) when \( \psi\gg\omega \)</a></li>
     <!-- navigation toc: --> <li><a href="#___sec84" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Displacement scale based on \( I \)</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:vib:damped:F" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Damped vibrations with forcing</a></li>
     <!-- navigation toc: --> <li><a href="#___sec86" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The exact solution</a></li>
     <!-- navigation toc: --> <li><a href="#___sec87" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing scales</a></li>
     <!-- navigation toc: --> <li><a href="#___sec88" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) at resonance</a></li>
     <!-- navigation toc: --> <li><a href="#___sec89" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) when \( \omega\gg\psi \)</a></li>
     <!-- navigation toc: --> <li><a href="#___sec90" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) when \( \omega\ll\psi \)</a></li>
     <!-- navigation toc: --> <li><a href="#___sec91" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="#___sec92" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oscillating electric circuits</a></li>
     <!-- navigation toc: --> <li><a href="#___sec93" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:exer:US2SI1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.1: Perform unit conversion</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:exer:ball_y" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.2: Scale a simple formula</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:exer:decay:cooling:osc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.3: Perform alternative scalings</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:exer:ball_y_wdrag" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.4: A nonlinear ODE for vertical motion with air resistance</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:exer:decay:jump" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.5: Solve a decay ODE with discontinuous coefficient</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:exer:decay:cooling" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.6: Implement a scaled model for cooling</a></li>
     <!-- navigation toc: --> <li><a href="#scale:exer:decay:step" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.7: Decay ODE with discontinuous coefficients</a></li>
     <!-- navigation toc: --> <li><a href="#scale:exer:nonlin:logistic2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.8: Alternative scalings of a cooling model</a></li>
     <!-- navigation toc: --> <li><a href="#scale:vib:exer:projectile" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.9: Projectile motion</a></li>
     <!-- navigation toc: --> <li><a href="#scale:exer:predprey" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.10: A predator-prey model</a></li>
     <!-- navigation toc: --> <li><a href="#scale:exer:competing_species" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.11: A model for competing species</a></li>
     <!-- navigation toc: --> <li><a href="#scale:exer:sine" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.12: Find the period of sinusoidal signals</a></li>
     <!-- navigation toc: --> <li><a href="#___sec106" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#scale:vib:exer:sliding" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.13: Oscillating mass with sliding friction</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:exer:pendulum" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.14: Pendulum equations</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:exer:binary_star" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2.15: ODEs for a binary star</a></li>
     <!-- navigation toc: --> <li><a href="#scale:vib:exer:Duffing" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.16: Duffing's equation</a></li>
     <!-- navigation toc: --> <li><a href="#scale:vib:exer:rocket" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.17: Vertical motion in a varying gravity field</a></li>
     <!-- navigation toc: --> <li><a href="#scale:vib:exer:quantum" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 2.18: A simplified Schroedinger equation</a></li>
     <!-- navigation toc: --> <li><a href="#___sec113" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec114" style="font-size: 80%;"><b>Basic partial differential equation models</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#sec:scale:wave" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The wave equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#sec:scale:wave:bc_u0" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Homogeneous Dirichlet conditions in 1D</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#sec:scale:wave:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation of the scaled wave equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec118" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Waves on a string</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec119" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Detecting an already computed case</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#scale:wave:pde2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time-dependent Dirichlet condition</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec121" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec122" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec123" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specific case</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#scale:wave:pde2:Vcond" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Velocity initial condition</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec125" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analytical insight</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec126" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec127" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nonzero initial shape</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#scale:wave:pde2:cvar" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variable wave velocity and forcing</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec129" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Non-dimensionalization</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec130" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing the time scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec131" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing the spatial scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec132" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling the velocity initial condition</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#scale:wave:pde2:damped" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Damped wave equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec134" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A three-dimensional wave equation problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#sec:scale:diffu" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#sec:scale:diffu:homo1D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Homogeneous 1D diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec137" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing the time scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec138" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analytical insight</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec139" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing other scales</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec140" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generalized diffusion PDE</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec141" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jump boundary condition</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec142" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oscillating Dirichlet condition</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec143" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling issues</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec144" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec145" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time and length scales</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec146" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The scaled problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec147" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Simulations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#sec:scale:diffu:Fisher" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Reaction-diffusion equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec149" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fisher's equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec150" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Balance of all terms</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec151" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fixed length scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#___sec152" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nonlinear reaction-diffusion PDE</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#scale:convdiff" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The convection-diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec154" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Convection-diffusion without a force term</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec155" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stationary PDE</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#scale:convdiff:f" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Convection-diffusion with a source term</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec157" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#scale:vib:exer:stationary_Couette" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 3.1: Stationary Couette flow</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec159" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#scale:vib:exer:Couette_wpressure" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.2: Couette-Poiseuille flow</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#scale:exer:pipeflow:pulsatile" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.3: Pulsatile pipeflow</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#scale:exer:cable_eq" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.4: The linear cable equation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#scale:exer:twometal" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3.5: Heat conduction with discontinuous initial condition</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#___sec164" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#diffu:exer:welding" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 3.6: Scaling a welding problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec166" style="font-size: 80%;"><b>Advanced partial differential equation models</b></a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:elasticity" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The equations of linear elasticity</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:elasticity:timedep" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The general time-dependent elasticity problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec169" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:elasticity:PDE1:stress" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dimensionless stress tensor</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:elasticity:waves" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When can the acceleration term be neglected?</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec172" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S waves</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec173" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P waves</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec174" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time-varying load</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:elasticity:stationary" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The stationary elasticity problem</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec176" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling of the PDE</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec177" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark on the characteristic displacement</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec178" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling of displacement boundary conditions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec179" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling of traction boundary conditions</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:elasticity:thermo" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Quasi-static thermo-elasticity</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#sec:scale:ns" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The Navier-Stokes equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec182" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The momentum equation without body forces</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec183" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec184" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dimensonless PDEs and the Reynolds number</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec185" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling of time for low Reynolds numbers</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec186" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shear stress as pressure scale</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec187" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gravity force and the Froude number</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec188" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oscillating boundary conditions and the Strouhal number</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec189" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cavitation and the Euler number</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#freesurface:Weber" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Free surface conditions and the Weber number</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec191" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Thermal convection</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:fluid:forced_convection" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Forced convection</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:fluid:free_convection" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Free convection</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec194" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Governing equations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec195" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Heating by viscous effects</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec196" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relation between density and temperature</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec197" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Boussinesq approximation</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec198" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec199" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Grashof, Prandtl, and Eckert numbers</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec200" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interpretations of the Grashof number</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec201" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Heat transfer at boundaries and the Nusselt and Biot numbers</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:gasdyn" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Compressible gas dynamics</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:Euler_eqs" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Euler equations of gas dynamics</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec204" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;General isentropic flow</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec205" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Elimination of the pressure</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:gas:acoustic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The acoustic approximation for sound waves</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec207" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wave nature of isentropic flow with small perturbations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec208" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic scaling for small wave perturbations</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:surfacewaves" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Water surface waves driven by gravity</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:surfacewaves:Eulereq" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The mathematical model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec211" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec212" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Waves in deep  water</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec213" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Long waves in shallow water</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec214" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Two-phase porous media flow</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:bidomain" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The bidomain model in electrophysiology</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec216" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The mathematical model</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec217" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec218" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An alternative \( I_{\rm{ion}} \)</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec219" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale::exer:elasticity:vibmodels" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4.1: Comparison of vibration models for elastic structures</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:exer:poroelasticity" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 4.2: A model for quasi-static poro-elasticity</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:vib:exer:starting_Couette" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 4.3: Starting Couette flow</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#scale:vib:exer:channel" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 4.4: Channel flow</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec224" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#___sec225" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;References</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0006"></a>
<!-- !split -->

<h1 id="sec:scale:vib">Vibration problems</h1>

<p>
We shall in this section
address a range of different second-order ODEs for mechanical
vibrations and demonstrate how to reason about the scaling in
different physical scenarios.

<h2 id="sec:scale:vib:undamped">Undamped vibrations without forcing</h2>

<p>
The simplest differential equation model for mechanical vibrations
reads

$$
\begin{equation}
mu'' + ku = 0,\quad u(0)=I,\ u'(0)=V,
\tag{2.64}
\end{equation}
$$

where unknown \( u(t) \) measures the displacement of the body,
This is a common model for a vibrating body  with mass \( m \) attached
to a linear spring with spring constant \( k \) (and force \( -ku \)).
Figure <a href="#sec:scale:vib:undamped:sketch">7</a> shows a typical mechanical
sketch of such a system: some mass can move horizontally without friction
and is connected to a spring that exerts a force \( -ku \) on the body.

<p>
<center> <!-- figure label: --> <div id="sec:scale:vib:undamped:sketch"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 7:  Oscillating body attached to a spring.  <!-- caption label: sec:scale:vib:undamped:sketch --> </p></center>
<p><img src="fig-scaling/oscillator_spring.png" align="bottom" width=500></p>
</center>

<h3 id="___sec67">The first technical steps of scaling </h3>

<p>
The problem <a href="#mjx-eqn-2.64">(2.64)</a> has one independent
variable \( t \) and one dependent variable \( u \). We introduce dimensionless
versions of these variables:

$$ \bar u =\frac{u}{u_c},\quad\bar t = \frac{t}{t_c},$$

where \( u_c \) and \( t_c \) are characteristic values of \( u \) and \( t \).
Inserted in <a href="#mjx-eqn-2.64">(2.64)</a>, we get

$$ m\frac{u_c}{t_c^2}\frac{d^2\bar u}{d\bar t^2} + ku_c\bar u = 0,
\quad u_c\bar u(0)=I,\quad \frac{u_c}{t_c}\frac{d\bar u}{d\bar t}(0)=V,$$

resulting in

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c^2 k}{m}\bar u = 0,
\quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}\tp
\tag{2.65}
\end{equation}
$$

<p>
What is an appropriate displacement scale \( u_c \)? The initial condition
\( u(0)=I \) is a candidate, i.e., \( u_c=I \). But how to choose the time scale?
Making the coefficient in front of the \( \bar u \) unity, such that
both terms balance and are of size unity, is a candidate.

<h3 id="___sec68">The exact solution </h3>

<p>
To better see what the proper scales of \( u \) and \( t \) are, we can look
into the analytical solution of this problem.
Although the exact solution of
<a href="#mjx-eqn-2.64">(2.64)</a> is quite straightforward to calculate
by hand, we take the opportunity to make use of SymPy to
find \( u(t) \). The use of SymPy can later be generalized to vibration
ODEs that are harder to solve by hand.

<p>
SymPy requires all mathematical symbols to be explicitly created:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
u <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;u&#39;</span>, cls<span style="color: #666666">=</span>Function)
w <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;w&#39;</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>, positive<span style="color: #666666">=</span><span style="color: #008000">True</span>)
I, V, C1, C2 <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;I V C1 C2&#39;</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>)
</pre></div>
<p>
To specify the ODE to be solved, we can make a Python function returning
all the terms in the ODE:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># Define differential equation: u&#39;&#39; + w**2*u = 0</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ode</span>(u):
    <span style="color: #008000; font-weight: bold">return</span> diff(u, t, t) <span style="color: #666666">+</span> w<span style="color: #666666">**2*</span>u

diffeq <span style="color: #666666">=</span> ode(u(t))
</pre></div>
<p>
The <code>diffeq</code> variable, defining the ODE, can be passed to the SymPy
function <code>dsolve</code> to find the symbolic solution of the ODE:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">s <span style="color: #666666">=</span> dsolve(diffeq, u(t))
<span style="color: #408080; font-style: italic"># s is an u(t) == expression (Eq obj.), s.rhs grabs the expression</span>
u_sol <span style="color: #666666">=</span> s<span style="color: #666666">.</span>rhs
<span style="color: #008000; font-weight: bold">print</span> u_sol
</pre></div>
<p>
The solution that gets printed is <code>C1*sin(t*w) + C2*cos(t*w)</code>, indicating
that there are two integration constants <code>C1</code> and <code>C2</code> to be determined
by the initial conditions. The result of applying these conditions is
a \( 2\times 2 \) linear system of algebraic equations that SymPy can solve
by the <code>solve</code> function. The code goes as follows:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># The solution u_sol contains integration constants C1 and C2</span>
<span style="color: #408080; font-style: italic"># but these are not symbols, substitute them by symbols</span>
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(<span style="color: #BA2121">&#39;C1&#39;</span>, C1)<span style="color: #666666">.</span>subs(<span style="color: #BA2121">&#39;C2&#39;</span>, C2)

<span style="color: #408080; font-style: italic"># Determine C1 and C2 from the initial conditions</span>
ic <span style="color: #666666">=</span> [u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I, u_sol<span style="color: #666666">.</span>diff(t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V]
<span style="color: #008000; font-weight: bold">print</span> ic   <span style="color: #408080; font-style: italic"># 2x2 algebraic system for C1 and C2</span>
s <span style="color: #666666">=</span> solve(ic, [C1, C2])
<span style="color: #408080; font-style: italic"># s is now a dictionary: {C2: I, C1: V/w}</span>
<span style="color: #408080; font-style: italic"># substitute solution back in u_sol</span>
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(C1, s[C1])<span style="color: #666666">.</span>subs(C2, s[C2])
<span style="color: #008000; font-weight: bold">print</span> u_sol
</pre></div>
<p>
The <code>u_sol</code> variable is now <code>I*cos(t*w) + V*sin(t*w)/w</code>.
Since symbolic software is far from bug-free and can give wrong results,
we should always check the answer. Here, we insert the solution in the ODE
to see if the result is zero, and we insert the solution in the initial
conditions to see that these are fulfilled:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># Check that the solution fulfills the ODE and init.cond.</span>
<span style="color: #008000; font-weight: bold">print</span> simplify(ode(u_sol)),
<span style="color: #008000; font-weight: bold">print</span> u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I, diff(u_sol, t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V
</pre></div>
<p>
There will be many more examples on using SymPy to find exact solutions
of differential equation problems.

<p>
The solution of the ODE in mathematical notation is

$$ u(t) = I\cos(\omega t) + \frac{V}{\omega}\sin(\omega t),\quad \omega = \sqrt{\frac{k}{m}}\tp$$

More insight arises from rewriting such an expression in the form
\( A\cos(wt - \phi) \):

$$ u(t) = \sqrt{I^2 + \frac{V^2}{\omega^2}}\cos(wt - \phi),\quad
\phi = \tan^{-1}(V/(\omega I))\tp
$$

Now we see that the \( u \) corresponds to cosine oscillations with a
frequency shift \( \phi \) and amplitude \( \sqrt{I^2 + (V/\omega)^2} \).

<p>
The forthcoming text relies on a good understanding of concepts
like period, frequency, and amplitude of oscillating signals, so
readers who need to refresh these concepts are recommended to
do <a href="#scale:exer:sine">Problem 2.12: Find the period of sinusoidal signals</a> before continuing.

<h3 id="___sec69">Discussion of the displacement scale </h3>

<p>
The amplitude of \( u \) is \( \sqrt{I^2 + V^2/\omega^2} \), and this
expression is obviously a candidate for \( u_c \).  However, the simpler
choice \( u_c=\max (I, V/\omega) \) is also relevant and more attractive
than the square root expression (but potentially a factor 1.4 wrong
compared to the exact amplitude).  It is not very important to have
\( |u|\leq 1 \), the point is to avoid \( |u| \) very small or large.

<h3 id="___sec70">Discussion of the time scale </h3>

<p>
What is an appropriate time scale? Looking at
<a href="#mjx-eqn-2.65">(2.65)</a> and arguing that
\( \bar u'' \) and \( \bar u \) both should be around unity in size, the
coefficient \( t_c^2k/m \) must equal unity, implying that \( t_c=\sqrt{m/k} \).
Also from the analytical solution we see that the solution goes like the
sine or cosine of \( \omega t \), so \( 1/\omega = \sqrt{m/k} \) can be a characteristic
time scale. Likewise, one period of the oscillations, \( P=2\pi/\omega \), can
be the characteristic time, leading to \( t_c=2\pi/\omega \).

<h3 id="___sec71">The dimensionless solution </h3>

<p>
With \( u_c=I \) and \( t_c=\sqrt{m/k} \) we get the scaled model

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \bar u = 0,
\quad \bar u(0)=1,\ \bar u'(0)=\alpha,
\tag{2.66}
\end{equation}
$$

where \( \alpha \) is a dimensionless parameter:

$$ \alpha = \frac{V}{I}\sqrt{\frac{m}{k}}\tp$$

Note that in case \( V=0 \), we have &quot;scaled away&quot; all physical parameters.
The universal solution without physical parameters is then
\( \bar u(\bar t)=\cos\bar t \).

<p>
The unscaled solution is recovered as

$$
\begin{equation}
u(t) = I\bar u(\sqrt{k/m}\bar t)\tp
\tag{2.67}
\end{equation}
$$

This expressions shows that the scaling is simply a matter of
<em>stretching or shrinking the axes</em>.

<h3 id="___sec72">Alternative displacement scale </h3>

<p>
Using \( u_c = V/\omega \), the equation
is not changed, but the initial conditions become

$$ \bar u(0) = \frac{I}{u_c} = \frac{I\omega}{V} =\frac{I}{V}\sqrt{\frac{k}{m}} = \alpha^{-1},\quad \bar u'(0)=1\tp$$

<p>
With \( u_c=V/\omega \) and one period as time scale,
\( t_c=2\pi\sqrt{m/k} \),
we get the alternative model

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + 4\pi^2 \bar u = 0,
\quad \bar u(0)=\alpha^{-1},\ \bar u'(0)=2\pi\tp
\tag{2.68}
\end{equation}
$$

The unscaled solution is in this case recovered by

$$
\begin{equation}
u(t) = V\sqrt{\frac{m}{k}}\bar u(2\pi\sqrt{k/m}\bar t)\tp
\tag{2.69}
\end{equation}
$$

<h3 id="___sec73">About frequency and dimensions </h3>

<p>
The solution goes like \( \cos\omega t \), where \( \omega =\sqrt{m/k} \)
must have dimension 1/s. Actually, \( \omega \) has dimension <em>radians
per second</em>: rad/s. A radian is dimensionless since it is arc (length)
divided by radius (length), but still regarded as a unit.
The period \( P \) of vibrations is a more intuitive quantity than the frequency
\( \omega \). The relation between \( P \) and \( \omega \) is \( P=2\pi/\omega \).
The number of oscillation cycles per period, \( f \), is a more intuitive
measurement of frequency and also known as <em>frequency</em>. Therefore, to be
precise, \( \omega \) should be named <em>angular frequency</em>. The relation between
\( f \) and \( T \) is \( f=1/T \), so \( f=2\pi\omega \) and measured in Hz (1/s), which is
the unit for counts per unit time.

<h2 id="sec:scale:vib:undamped:mg">Undamped vibrations with constant forcing</h2>

<p>
For vertical vibrations in the gravity field, the model
<a href="#mjx-eqn-2.64">(2.64)</a> must also take the gravity force
\( -mg \) into account:

$$ mu'' + ku = -mg\tp$$

How does the new term \( -mg \) influence
the scaling? We observe that if there is no movement of the body,
\( u''=0 \), and the spring elongation matches the gravity force:
\( ku = -mg \), leading to a steady displacement \( u=-mg/k \). We can then
have oscillations around this equilibrium point. A natural scaling
for \( u \) is therefore

$$ \bar u = \frac{u - (-mg/k)}{u_c}=\frac{uk + mg}{ku_c}\tp$$

<!-- u = - mg/k + u_c\bar u -->
The scaled differential equation with the same time scale as before
reads

$$ \frac{d^2\bar u}{d\bar t^2} + \bar u - \frac{t_c^2}{u_c}g
= -\frac{t_c^2}{u_c}g,$$

leading to

$$ \frac{d^2\bar u}{d\bar t^2} + \bar u = 0\tp$$

The initial conditions \( u(0)=I \) and \( u'(0)=V \) become, with \( u_c=I \),

$$ \bar u(0) = 1 + \frac{mg}{kI},\quad \frac{d\bar u}{d\bar t}(0)=\sqrt{\frac{m}{k}}\frac{V}{I}\tp$$

We see that the oscillations around the equilibrium point in the
gravity field are identical to the horizontal oscillations without
gravity, except for an offset \( mg/(kI) \) in the displacement.

<h2 id="sec:scale:vib:undamped:F">Undamped vibrations with time-dependent forcing</h2>

<p>
Now we add a transient forcing term \( F(t) \) to the model
<a href="#mjx-eqn-2.64">(2.64)</a>:

$$
\begin{equation}
mu'' + ku = F(t),\quad u(0)=I,\ u'(0)=V\tp
\tag{2.70}
\end{equation}
$$

Take the forcing to be oscillating:

$$ F(t) = A\cos(\psi t)\tp$$

The technical steps of the scaling are still the same, with the
intermediate result

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c^2 k}{m}\bar u =
\frac{t_c^2}{mu_c}A\cos(\psi t_c\bar t),
\quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}\tp
\tag{2.71}
\end{equation}
$$

What are typical displacement and time scales? This is not so obvious
without knowing the details of the solution, because there are
three parameters (\( I \), \( V \), and \( A \)) that influence the magnitude of \( u \).
Moreover, there are two time scales, one for the free vibrations of
the systems and one for the forced vibrations \( F(t) \).

<h3 id="___sec76">Investigating scales via analytical solutions </h3>

<p>
As we have seen already several times, having access to
an exact solution is very fortunate as it allows us to directly
examine the scales. Also in the present problem it is possible
to derive an exact solution. We
continue the SymPy session from the previous section and perform much
of the same steps. Note that we use <code>w</code> for \( \omega = \sqrt{k/m} \)
in the computer code (to obtain a more direct visual counterpart to
\( \omega \)).
SymPy may get confused when coefficients in differential equations
contain several symbols. We therefore rewrite the equation with
at most one symbol in each coefficient (i.e., symbolic software is
in general
more successful when applied to scaled differential equations than the
unscaled counterparts, but right now our task is to solve the unscaled version).
The amplitude \( A/m \) in the forcing term is of this reason
replaced by the symbol <code>A1</code>.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">A, A1, m, psi <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;A A1 m psi&#39;</span>, positive<span style="color: #666666">=</span><span style="color: #008000">True</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>)
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ode</span>(u):
    <span style="color: #008000; font-weight: bold">return</span> diff(u, t, t) <span style="color: #666666">+</span> w<span style="color: #666666">**2*</span>u <span style="color: #666666">-</span> A1<span style="color: #666666">*</span>cos(psi<span style="color: #666666">*</span>t)

diffeq <span style="color: #666666">=</span> ode(u(t))
u_sol <span style="color: #666666">=</span> dsolve(diffeq, u(t))
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>rhs

<span style="color: #408080; font-style: italic"># Determine the constants C1 and C2 in u_sol</span>
<span style="color: #408080; font-style: italic"># (first substitute our own declared C1 and C2 symbols,</span>
<span style="color: #408080; font-style: italic"># then use the initial conditions)</span>
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(<span style="color: #BA2121">&#39;C1&#39;</span>, C1)<span style="color: #666666">.</span>subs(<span style="color: #BA2121">&#39;C2&#39;</span>, C2)
eqs <span style="color: #666666">=</span> [u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I, u_sol<span style="color: #666666">.</span>diff(t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V]
s <span style="color: #666666">=</span> solve(eqs, [C1, C2])
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(C1, s[C1])<span style="color: #666666">.</span>subs(C2, s[C2])

<span style="color: #408080; font-style: italic"># Check that the solution fulfills the equation and init.cond.</span>
<span style="color: #008000; font-weight: bold">print</span> simplify(ode(u_sol))
<span style="color: #008000; font-weight: bold">print</span> simplify(u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I)
<span style="color: #008000; font-weight: bold">print</span> simplify(diff(u_sol, t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V)

u_sol <span style="color: #666666">=</span> simplify(expand(u_sol<span style="color: #666666">.</span>subs(A1, A<span style="color: #666666">/</span>m)))
<span style="color: #008000; font-weight: bold">print</span> u_sol
</pre></div>
<p>
The output from the last line is

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">A/m*cos(psi*t)/(-psi**2 + w**2) + V*sin(t*w)/w +
(A/m + I*psi**2 - I*w**2)*cos(t*w)/(psi**2 - w**2)
</pre></div>
<p>
With a bit of rewrite this expression becomes

<p>
<!-- Note that the solution becomes a bit simpler of F is cos rather than sin -->

$$ u(t) = \frac{A/m}{\omega^2 - \psi^2}\cos(\psi t) + \frac{V}{\omega}
   \sin(\omega t) +
\left(\frac{A/m}{\psi^2 - \omega^2} + I\right) \cos (\omega t)\tp
$$

Obviously, this expression is only meaningful for \( \psi\neq\omega \). The
case \( \psi = \omega \) gives an infinite amplitude in this model, a
phenomenon known as resonance. The amplitude becomes finite when
damping is included,
see the section <a href="#sec:scale:vib:damped:F">Damped vibrations with forcing</a>.

<p>
When the system starts from rest, \( I=V=0 \), and the
forcing is the only driving mechanism, we can simplify:

$$
\begin{align*}
u(t) &= \frac{A}{m(\omega^2 - \psi^2)}\cos(\psi t)
+
\frac{A}{m(\psi^2 - \omega^2)}\cos (\omega t)\\ 
&= \frac{A}{m(\omega^2 - \psi^2)}(\cos(\psi t) - \cos(\omega t))\tp
\end{align*}
$$

To gain more insight, \( \cos(\psi t) - \cos(\omega t) \) can be
rewritten in terms of the mean frequency \( (\psi + \omega)/2 \) and
the difference in frequency \( (\psi - \omega)/2 \):

$$
\begin{equation}
u(t) = \frac{A}{m(\omega^2 - \psi^2)} 2
\sin\left(\frac{\psi - \omega}{2}t\right)
\sin\left(\frac{\psi + \omega}{2}t\right),
\tag{2.72}
\end{equation}
$$

showing that there is a signal with frequency \( (\psi + \omega)/2 \)
whose amplitude has a (much) slower frequency
\( (\psi - \omega)/2 \). Figure <a href="#sec:scale:vib:fig:envelope">8</a> shows
an example on such a signal.

<p>
<center> <!-- figure label: --> <div id="sec:scale:vib:fig:envelope"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 8:  Signal with frequency 3.1 and envelope frequency 0.2.  <!-- caption label: sec:scale:vib:fig:envelope --> </p></center>
<p><img src="fig-scaling/envelope.png" align="bottom" width=600></p>
</center>

<h3 id="___sec77">The displacement and time scales </h3>

<p>
A characteristic displacement can in the latter special case
be taken as \( u_c= A/(m(\omega^2 - \psi^2)) \). This is also a relevant choice
in the more general case \( I\neq0, V\neq 0 \), unless \( I \) or \( V \)
is so large that it dominates over the amplitude
caused by the forcing. With \( u_c= A/(m(\omega^2 - \psi^2)) \) we also
have three special cases: \( \omega \ll \psi \), \( \omega \gg\psi \), and
\( \psi \sim \omega \). In the latter case we need
\( u_c= A/(m(\omega^2 - \psi^2)) \) if we want \( |u|\leq 1 \). When
\( \omega \) and \( \psi \) are significantly different, we may choose one
of them and neglect the smaller. Choosing \( \omega \) means \( u_c=A/k \),
which is the relevant scale
if \( \omega\gg\psi \). In the opposite case, \( \omega\ll\psi \),
\( u_c=A/(m\psi^2) \).

<p>
The time scale is dominated by the fastest oscillations, which are
of frequency \( \psi \) or \( \omega \) when these are close and the largest
of them when they are distant. In any case, we set
\( t_c=1/\max(\psi,\omega) \).

<h3 id="___sec78">Finding the displacement scale from the differential equation </h3>

<p>
Going back to <a href="#mjx-eqn-2.71">(2.71)</a>, we
may demand that all the three terms in the differential equation
are of size unity. This leads to \( t_c=\sqrt{m/k} \)
and \( u_c=At_c^2/m = A/k \). The formula for \( u_c \) is a kind of measure
of the ratio of the
forcing and the spring force (the dimensionless number
\( A/(ku_c) \) would be this ratio).

<p>
Looking at <a href="#mjx-eqn-2.72">(2.72)</a>, we see
that if \( \psi\ll\omega \), the amplitude can be approximated
by \( A/(m\omega^2)=A/k \), showing that the scale \( u_c=A/k \) is
relevant for an excitation frequency \( \psi \) that is small compared to
the free vibration frequency \( \omega \).

<h3 id="___sec79">Scaling with free vibrations as time scale </h3>

<p>
The next step is to work out the dimensionless ODE for the chosen scales.
We first select the time scale based on the free oscillations
with frequency \( \omega \), i.e., \( t_c=1/\omega \). Inserting the expression in
<a href="#mjx-eqn-2.71">(2.71)</a> results in

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \bar u =
\gamma
\cos(\delta\bar t),
\quad \bar u(0)=\alpha,\ \bar u'(0)=\beta\tp
\tag{2.73}
\end{equation}
$$

Here we have four dimensionless variables

$$
\begin{align}
\alpha &= \frac{I}{u_c},
\tag{2.74}\\ 
\beta  &= \frac{Vt_c}{u_c} = \frac{V}{\omega u_c},
\tag{2.75}\\ 
\gamma &= \frac{t_c^2 A}{mu_c} = \frac{A}{ku_c},
\tag{2.76}\\ 
\delta &= \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega}\tp
\tag{2.77}
\end{align}
$$

We remark that the choice of \( u_c \) has so far not been made. Several
different cases will be considered below, and we will see that certain
choices reduce the number of independent dimensionless variables to
three.

<p>
The four dimensionless variables above have interpretations as ratios of
physical effects:

<ul>
 <li> \( \alpha \): ratio of the initial displacement and
   the characteristic response \( u_c \),</li>
 <li> \( \beta \): ratio of the initial velocity
   and the typical velocity measure \( u_c/t_c \),</li>
 <li> \( \gamma \): ratio of
   the forcing \( A \) and the mass times acceleration \( mu_c/t_c^2 \) <em>or</em>
   the ratio of the forcing and the spring force \( ku_c \)</li>
 <li> \( \delta \): ratio of the
   frequencies or the time scales of the forcing and the free vibrations.</li>
</ul>

<h3 id="___sec80">Software </h3>

<p>
Any solver for <a href="#mjx-eqn-2.71">(2.71)</a>
can be used for <a href="#mjx-eqn-2.73">(2.73)</a>.
More details are provided at the end of
the section <a href="#sec:scale:vib:damped:F">Damped vibrations with forcing</a>.

<h3 id="___sec81">Choice of \( u_c \) close to resonance </h3>

<p>
Now we shall discuss various choices of \( u_c \).
Close to resonance, when \( \psi\sim\omega \), we may set
\( u_c=A/(m(\omega^2 - \psi^2)) \). The dimensionless numbers
become in this case

$$
\begin{align*}
\alpha &= \frac{I}{u_c} = \frac{I}{A/k}(1-\delta^2),\\ 
\beta  &= \frac{V}{\omega u_c} = \frac{V\sqrt{km}}{A}(1-\delta^2),\\ 
\gamma &= \frac{A}{ku_c} = 1-\delta^2,\\ 
\delta &= \frac{\psi}{\omega}\tp
\end{align*}
$$

With \( \psi = 0.99\omega \), \( \delta =0.99 \), \( V=0 \),
\( \alpha = \gamma = 1-\delta^2 = 0.02 \), we have the problem

$$
\frac{d^2\bar u}{d\bar t^2} + \bar u =
0.02 \cos(0.99\bar t),
\quad \bar u(0)=0.02,\ \bar u'(0)=0\tp
$$

This is a problem with a very small initial condition and a very small
forcing, but the state close to resonance brings the amplitude up to
about unity, see the result of numerical simulations with \( \delta=0.99 \) in
Figure <a href="#sec:scale:vib:fig:Fcos_b0:1">9</a>.
Neglecting \( \alpha \),
the solution is given by <a href="#mjx-eqn-2.72">(2.72)</a>,
which here means \( A=1-\delta^2 \), \( m=1 \), \( \omega=1 \), \( \psi=\delta \):

$$ \bar u(\bar t) = 2\sin(-0.005\bar t)\sin(0.995\bar t)\tp $$

Note that this is a problem which demands very high accuracy in the
numerical calculations. Using 20 time steps per period gives a
significant angular frequency error and an amplitude of about 1.4. We used
160 steps per period for the results in
Figure <a href="#sec:scale:vib:fig:Fcos_b0:1">9</a>.

<p>
<center> <!-- figure label: --> <div id="sec:scale:vib:fig:Fcos_b0:1"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 9:  Forced undamped vibrations close to resonance.  <!-- caption label: sec:scale:vib:fig:Fcos_b0:1 --> </p></center>
<p><img src="fig-scaling/vib_delta099_b0_Fcos.png" align="bottom" width=600></p>
</center>

<h3 id="___sec82">Unit size of all terms in the ODE </h3>

<p>
Using the displacement scale \( u_c=A/k \) leads to
<a href="#mjx-eqn-2.73">(2.73)</a> with

$$
\begin{align*}
\alpha &= \frac{I}{u_c} = \frac{I}{A/k},\\ 
\beta  &= \frac{V}{\omega u_c} = \frac{V k}{A\omega},\\ 
\gamma &= \frac{A}{ku_c} = 1,\\ 
\delta &= \frac{\psi}{\omega}\tp
\end{align*}
$$

Simulating a case with \( \delta=0.5 \), \( \alpha=1 \), and \( \beta=0 \) gives
the oscillations in Figure <a href="#sec:scale:vib:fig:Fcos_b0:2">10</a>, which is
a case away from resonance, and the amplitude is about unity. However,
choosing \( \delta =0.99 \) (close to resonance) results in a figure
similar to Figure <a href="#sec:scale:vib:fig:Fcos_b0:1">9</a>, except that the
amplitude is about \( 10^2 \) because of the moderate size of \( u_c \).
The present scaling is therefore most suitable away from resonance,
and when the terms containing \( \cos\omega t \) and \( \sin\omega t \)
are important (e.g., \( \omega\gg\psi \)).

<p>
<center> <!-- figure label: --> <div id="sec:scale:vib:fig:Fcos_b0:2"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 10:  Forced undamped vibrations away from resonance.  <!-- caption label: sec:scale:vib:fig:Fcos_b0:2 --> </p></center>
<p><img src="fig-scaling/vib_delta05_b0_Fcos.png" align="bottom" width=600></p>
</center>

<h3 id="___sec83">Choice of \( u_c \) when \( \psi\gg\omega \) </h3>

<p>
Finally, we may look at the case where \( \psi\gg\omega \) such that
\( u_c=A/(m\psi^2) \) is a relevant scale (i.e., omitting \( \omega^2 \) compared to
\( \psi^2 \) in the denominator), but in this case we should
use \( t_c=1/\psi \) since the force varies much faster than the
free vibrations of the system.
This choice of \( t_c \) changes the scaled ODE to

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \delta^{-2}\bar u =
\gamma
\cos(\bar t),
\quad \bar u(0)=\alpha,\ \bar u'(0)=\beta,
\tag{2.78}
\end{equation}
$$

where

$$
\begin{align*}
\alpha &= \frac{I}{u_c} = \frac{I}{A/k}\delta^2,\\ 
\beta  &= \frac{Vt_c}{u_c} = \frac{V\sqrt{km}}{A}\delta,\\ 
\gamma &= \frac{t_c^2 A}{mu_c} = 1,\\ 
\delta &= \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega}\tp
\end{align*}
$$

In the regime \( \psi\gg\omega \), \( \delta\gg 1 \), thus making \( \alpha \) and
\( \beta \) large.
However, if \( \alpha \) and/or \( \beta \) is large,
the initial condition dominates over the forcing, and will also dominate
the amplitude of \( u \), thereby making the scaling of \( u \) inappropriate.
In case \( I=V=0 \) so that \( \alpha=\beta=0 \),
<a href="#mjx-eqn-2.72">(2.72)</a> predicts
(\( A=m=1 \), \( \omega=\delta^{-1} \), \( \psi=1 \))

$$ \bar u(\bar t) = (\delta^{-2}-1)^{-1}2
\sin\left(\frac{1}{2}(1 -\delta^{-1})\bar t\right)
\sin\left(\frac{1}{2}(1 +\delta^{-1})\bar t\right),
$$

which has an amplitude about \( 2 \) for \( \delta\gg 1 \).
Figure <a href="#sec:scale:vib:fig:Fcos_b0:3">11</a> shows a case.

<p>
<center> <!-- figure label: --> <div id="sec:scale:vib:fig:Fcos_b0:3"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 11:  Forced undamped vibrations with rapid forcing.  <!-- caption label: sec:scale:vib:fig:Fcos_b0:3 --> </p></center>
<p><img src="fig-scaling/vib_delta10_b0_Fcos.png" align="bottom" width=600></p>
</center>

<p>
With \( \alpha=0.05\delta^2=5 \), we get a significant contribution from
the free vibrations (the homogeneous solution of the ODE) as
shown in Figure <a href="#sec:scale:vib:fig:Fcos_b0:4">12</a>. For larger \( \alpha \)
values, one must base \( u_c \) on \( I \) instead.
(The graphs in Figure <a href="#sec:scale:vib:fig:Fcos_b0:3">11</a> and
<a href="#sec:scale:vib:fig:Fcos_b0:4">12</a> were
produced by
numerical simulations with 160 time steps per period of the forcing.)

<p>
<center> <!-- figure label: --> <div id="sec:scale:vib:fig:Fcos_b0:4"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 12:  Forced undamped vibrations with rapid forcing and initial displacement of 5.  <!-- caption label: sec:scale:vib:fig:Fcos_b0:4 --> </p></center>
<p><img src="fig-scaling/vib_delta10_b0_a5_Fcos.png" align="bottom" width=600></p>
</center>

<h3 id="___sec84">Displacement scale based on \( I \) </h3>

<p>
Choosing \( u_c=I \) gives

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \bar u =
\gamma\cos(\delta\bar t),
\quad \bar u(0)=1,\ \bar u'(0)=\beta,
\tag{2.79}
\end{equation}
$$

with

$$
\begin{align}
\beta  &= \frac{Vt_c}{u_c} = \frac{V}{I}\sqrt{\frac{m}{k}},
\tag{2.80}\\ 
\gamma & = \frac{tc^2A}{mu_c} = \frac{A}{ku_c} = \frac{A}{kI} \tp
\tag{2.81}
\end{align}
$$

This scaling is not relevant close to resonance since then \( u_c\gg I \).

<h2 id="sec:scale:vib:damped:F">Damped vibrations with forcing</h2>

<p>
We now introduce a linear damping force \( bu'(t) \) in the equation of motion:

$$
\begin{equation}
mu'' + bu' + ku = A\cos(\psi t),\quad u(0)=I,\ u'(0)=V\tp
\tag{2.82}
\end{equation}
$$

Figure <a href="#sec:scale:vib:damped:sketch">13</a> shows a typical
one-degree-of-freedom mechanical system with a linear dashpot, representing
the damper (\( bu' \)), a linear spring (\( ku \)), and an external force (\( F \)).

<p>
<center> <!-- figure label: --> <div id="sec:scale:vib:damped:sketch"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 13:  Oscillating body with external force, attached to a spring and damper.  <!-- caption label: sec:scale:vib:damped:sketch --> </p></center>
<p><img src="fig-scaling/oscillator.png" align="bottom" width=500></p>
</center>

<p>
The standard scaling procedure results in

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c b}{m}\frac{d\bar u}{d\bar t}
+ \frac{t_c^2 k}{m}\bar u =
\frac{t_c^2}{mu_c}A\cos(\psi t_c\bar t),
\quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}\tp
\tag{2.83}
\end{equation}
$$

<h3 id="___sec86">The exact solution </h3>

<p>
As always, it is
a great advantage to look into exact solutions for controlling our
choice of scales.
Using SymPy to solve <a href="#mjx-eqn-2.82">(2.82)</a> is, in principle,
very straightforward:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> diffeq <span style="color: #666666">=</span> diff(u(t), t, t) <span style="color: #666666">+</span> b<span style="color: #666666">/</span>m<span style="color: #666666">*</span>diff(u(t), t) <span style="color: #666666">+</span> w<span style="color: #666666">**2*</span>u(t)
<span style="color: #666666">&gt;&gt;&gt;</span> s <span style="color: #666666">=</span> dsolve(diffeq, u(t))
<span style="color: #666666">&gt;&gt;&gt;</span> s<span style="color: #666666">.</span>rhs
C1<span style="color: #666666">*</span>exp(t<span style="color: #666666">*</span>(<span style="color: #666666">-</span>b <span style="color: #666666">-</span> sqrt(b <span style="color: #666666">-</span> <span style="color: #666666">2*</span>m<span style="color: #666666">*</span>w)<span style="color: #666666">*</span>sqrt(b <span style="color: #666666">+</span> <span style="color: #666666">2*</span>m<span style="color: #666666">*</span>w))<span style="color: #666666">/</span>(<span style="color: #666666">2*</span>m)) <span style="color: #666666">+</span>
C2<span style="color: #666666">*</span>exp(t<span style="color: #666666">*</span>(<span style="color: #666666">-</span>b <span style="color: #666666">+</span> sqrt(b <span style="color: #666666">-</span> <span style="color: #666666">2*</span>m<span style="color: #666666">*</span>w)<span style="color: #666666">*</span>sqrt(b <span style="color: #666666">+</span> <span style="color: #666666">2*</span>m<span style="color: #666666">*</span>w))<span style="color: #666666">/</span>(<span style="color: #666666">2*</span>m))
</pre></div>
<p>
This is indeed the correct solution, but it is on a complex
exponential function form, valid for all \( b \), \( m \), and \( \omega \). We are
interested in the case with <em>small damping</em>, \( b < 2m\omega \), where the solution
is an exponentially damped sinusoidal function. Rewriting the expression
in the right form is tricky with SymPy commands. Instead, we demonstrate
a common technique when doing symbolic computing: general procedures like
<code>dsolve</code> are replaced by manual steps. That is, we solve the ODE &quot;by hand&quot;,
but use SymPy to assist the calculations.

<p>
The solution is composed of a homogeneous
solution \( u_h \) of \( mu'' + bu' + ku=0 \) and one particular solution \( u_p \)
of the nonhomogeneous equation
\( mu'' + bu' + ku=A\cos(\psi t) \). The homogeneous solution with
damped oscillations (requiring \( b < 2\sqrt{mk} \)) can be
found by the following code. We have divided the differential equation
by \( m \) and introduced \( B=\frac{1}{2}b/m \) and let <code>A1</code> represent
\( A/m \) to simplify expressions and
help SymPy with less symbols in the equation. Without these simplifications,
SymPy stalls in the computations due to too many symbols in the equation.
The problem is actually a solid argument for scaling differential equations
before asking SymPy to solve them since scaling effectively reduces the
number of parameters in the equations!

<p>
The following SymPy steps derives the solution of the homogeneous ODE:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">u <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;u&#39;</span>, cls<span style="color: #666666">=</span>Function)
t, w, B, A, A1, m, psi <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;t w B A A1 m psi&#39;</span>,
                                 positive<span style="color: #666666">=</span><span style="color: #008000">True</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ode</span>(u, homogeneous<span style="color: #666666">=</span><span style="color: #008000">True</span>):
    h <span style="color: #666666">=</span> diff(u, t, t) <span style="color: #666666">+</span> <span style="color: #666666">2*</span>B<span style="color: #666666">*</span>diff(u, t) <span style="color: #666666">+</span> w<span style="color: #666666">**2*</span>u
    f <span style="color: #666666">=</span> A1<span style="color: #666666">*</span>cos(psi<span style="color: #666666">*</span>t)
    <span style="color: #008000; font-weight: bold">return</span> h <span style="color: #008000; font-weight: bold">if</span> homogeneous <span style="color: #008000; font-weight: bold">else</span> h <span style="color: #666666">-</span> f

<span style="color: #408080; font-style: italic"># Find coefficients in polynomial (in r) for exp(r*t) ansatz</span>
r <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;r&#39;</span>)
ansatz <span style="color: #666666">=</span> exp(r<span style="color: #666666">*</span>t)
poly <span style="color: #666666">=</span> simplify(ode(ansatz)<span style="color: #666666">/</span>ansatz)

<span style="color: #408080; font-style: italic"># Convert to polynomial to extract coefficients</span>
poly <span style="color: #666666">=</span> Poly(poly, r)
<span style="color: #408080; font-style: italic"># Extract coefficients in poly: a_*t**2 + b_*t + c_</span>
a_, b_, c_ <span style="color: #666666">=</span> poly<span style="color: #666666">.</span>coeffs()
<span style="color: #408080; font-style: italic"># Assume b_**2 - 4*a_*c_ &lt; 0</span>
d <span style="color: #666666">=</span> <span style="color: #666666">-</span>b_<span style="color: #666666">/</span>(<span style="color: #666666">2*</span>a_)
<span style="color: #008000; font-weight: bold">if</span> a_ <span style="color: #666666">==</span> <span style="color: #666666">1</span>:
    omega <span style="color: #666666">=</span> sqrt(c_ <span style="color: #666666">-</span> (b_<span style="color: #666666">/2</span>)<span style="color: #666666">**2</span>)  <span style="color: #408080; font-style: italic"># nicer formula</span>
<span style="color: #008000; font-weight: bold">else</span>:
    omega <span style="color: #666666">=</span> sqrt(<span style="color: #666666">4*</span>a_<span style="color: #666666">*</span>c_ <span style="color: #666666">-</span> b_<span style="color: #666666">**2</span>)<span style="color: #666666">/</span>(<span style="color: #666666">2*</span>a_)

<span style="color: #408080; font-style: italic"># The homogeneous solution is a linear combination of a</span>
<span style="color: #408080; font-style: italic"># cos term (u1) and a sin term (u2)</span>
u1 <span style="color: #666666">=</span> exp(d<span style="color: #666666">*</span>t)<span style="color: #666666">*</span>cos(omega<span style="color: #666666">*</span>t)
u2 <span style="color: #666666">=</span> exp(d<span style="color: #666666">*</span>t)<span style="color: #666666">*</span>sin(omega<span style="color: #666666">*</span>t)
C1, C2, V, I <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;C1 C2 V I&#39;</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>)
u_h <span style="color: #666666">=</span> simplify(C1<span style="color: #666666">*</span>u1 <span style="color: #666666">+</span> C2<span style="color: #666666">*</span>u2)
<span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;u_h:&#39;</span>, u_h
</pre></div>
<p>
The print out shows

$$ u_h = e^{-Bt}\left(C_1 \cos(\sqrt{\omega^2 - B^2}t) +
C_2 \sin(\sqrt{\omega^2 - B^2}t)\right),$$

where \( C_1 \) and \( C_2 \) must be determined by the initial conditions later.
It is wise to check that \( u_h \) is indeed a solution of the homogeneous
differential equation:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">assert</span> simplify(ode(u_h)) <span style="color: #666666">==</span> <span style="color: #666666">0</span>
</pre></div>
<p>
We have previously just printed the residuals of the ODE and initial
conditions after inserting the solution, but it is better in a code to
let the programming language test that the residuals are symbolically zero.
This is achieved using the <code>assert</code> statement in Python. The argument is
a boolean expression, and if the expression evaluates to <code>False</code>,
an <code>AssertionError</code> is raised and the program aborts (otherwise <code>assert</code>
runs silently for a <code>True</code> boolean expression). Hereafter, we will use
<code>assert</code> for consistency checks in computer code.

<p>
The ansatz for the particular solution \( u_p \) is

$$ u_p= C_3\cos(\psi t) + C_4\sin(\psi t),$$

which inserted in the ODE gives two equations
for \( C_3 \) and \( C_4 \). The relevant SymPy statements are

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># Particular solution</span>
C3, C4 <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;C3 C4&#39;</span>)
u_p <span style="color: #666666">=</span> C3<span style="color: #666666">*</span>cos(psi<span style="color: #666666">*</span>t) <span style="color: #666666">+</span> C4<span style="color: #666666">*</span>sin(psi<span style="color: #666666">*</span>t)
eqs <span style="color: #666666">=</span> simplify(ode(u_p, homogeneous<span style="color: #666666">=</span><span style="color: #008000">False</span>))

<span style="color: #408080; font-style: italic"># Collect cos(omega*t) terms</span>
<span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;eqs:&#39;</span>, eqs
eq_cos <span style="color: #666666">=</span> simplify(eqs<span style="color: #666666">.</span>subs(sin(psi<span style="color: #666666">*</span>t), <span style="color: #666666">0</span>)<span style="color: #666666">.</span>subs(cos(psi<span style="color: #666666">*</span>t), <span style="color: #666666">1</span>))
eq_sin <span style="color: #666666">=</span> simplify(eqs<span style="color: #666666">.</span>subs(cos(psi<span style="color: #666666">*</span>t), <span style="color: #666666">0</span>)<span style="color: #666666">.</span>subs(sin(psi<span style="color: #666666">*</span>t), <span style="color: #666666">1</span>))
s <span style="color: #666666">=</span> solve([eq_cos, eq_sin], [C3, C4])
u_p <span style="color: #666666">=</span> simplify(u_p<span style="color: #666666">.</span>subs(C3, s[C3])<span style="color: #666666">.</span>subs(C4, s[C4]))

<span style="color: #408080; font-style: italic"># Check that the solution is correct</span>
<span style="color: #008000; font-weight: bold">assert</span> simplify(ode(u_p, homogeneous<span style="color: #666666">=</span><span style="color: #008000">False</span>)) <span style="color: #666666">==</span> <span style="color: #666666">0</span>
</pre></div>
<p>
Using the initial conditions for the complete solution \( u=u_h+u_p \)
determines \( C_1 \) and \( C_2 \):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">u_sol <span style="color: #666666">=</span> u_h <span style="color: #666666">+</span> u_p  <span style="color: #408080; font-style: italic"># total solution</span>
<span style="color: #408080; font-style: italic"># Initial conditions</span>
eqs <span style="color: #666666">=</span> [u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I, u_sol<span style="color: #666666">.</span>diff(t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V]
<span style="color: #408080; font-style: italic"># Determine C1 and C2 from the initial conditions</span>
s <span style="color: #666666">=</span> solve(eqs, [C1, C2])
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(C1, s[C1])<span style="color: #666666">.</span>subs(C2, s[C2])
</pre></div>
<p>
Finally, we should check that <code>u_sol</code> is indeed the correct solution:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">checks <span style="color: #666666">=</span> <span style="color: #008000">dict</span>(
    ODE<span style="color: #666666">=</span>simplify(expand(ode(u_sol, homogeneous<span style="color: #666666">=</span><span style="color: #008000">False</span>))),
    IC1<span style="color: #666666">=</span>simplify(u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I),
    IC2<span style="color: #666666">=</span>simplify(diff(u_sol, t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V))
<span style="color: #008000; font-weight: bold">for</span> check <span style="color: #AA22FF; font-weight: bold">in</span> checks:
    msg <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121"> residual: </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (check, checks[check])
    <span style="color: #008000; font-weight: bold">assert</span> checks[check] <span style="color: #666666">==</span> sympify(<span style="color: #666666">0</span>), msg
</pre></div>
<p>
Finally, we may take <code>u_sol = u_sol.subs(A, A/m)</code> to get the right
expression for the solution.
Using <code>latex(u_sol)</code> results in a huge expression, which should be
manually ordered to something like the following:

$$
\begin{align*} u = &
\frac{Am^{-1}}{4 B^{2} \psi^{2} +
\Omega^{2}} \left(2 B \psi
\sin{\left (\psi t \right )} - \Omega\cos{\left (\psi t \right )}\right) + \\ 
&
{e^{-B t}} \biggl(
C_1 \cos{\left( t \sqrt{\omega^{2}- B^{2}}\right)} +
C_2 \sin{\left (t \sqrt{\omega^{2}- B^{2}}\right )}\biggr)\\ 
C_1 &= \frac{Am^{-1} \Omega + 4 I B^{2} \psi^{2} +
I\Omega^2}{
4 B^{2} \psi^{2} + \Omega^2}\\ 
C_2 &=
\frac{- Am^{-1} B\Omega + 4 I B^{3} \psi^{2} +
I B\Omega^2 + 4 V B^{2}\psi^{2} +
V\Omega^2}{
\sqrt{\omega^{2} - B^{2}}
\left(4 B^{2} \psi^{2} + \Omega^2\right)},\\ 
\Omega &= \psi^2 - \omega^2\tp
\end{align*}
$$

<p>
The most important feature of this solution is that there are
two time scales with frequencies \( \psi \) and \( \sqrt{\omega^2 - B^2} \),
respectively,
but the latter appears in terms that decay as \( e^{-Bt} \) in time.
The attention is usually on longer periods of time, so in that
case the solution simplifies to

$$
\begin{align}
u &= \frac{Am^{-1}}{4 B^{2} \psi^{2} +
\Omega^{2}} \left(2 B \psi
\sin{\left (\psi t \right )} - \Omega\cos{\left (\psi t \right )}\right)
\nonumber\\ 
&= \frac{A}{m}\frac{1}{\sqrt{4B^2\psi^2 + \Omega^2}}\cos(\psi t + \phi)
\frac{(\psi\omega)^{-1}}{(\psi\omega)^{-1}}
\nonumber\\ 
& = \frac{A}{k} Q\delta^{-1}\left(1 + Q^2(\delta - \delta^{-1})\right)^{-
\frac{1}{2}}\cos(\psi t + \phi),
\tag{2.84}
\end{align}
$$

where we have introduced the dimensionless numbers

$$ Q = \frac{\omega}{2B},\quad\delta = \frac{\psi}{\omega},$$

and

$$ \phi = \tan^{-1}\left(-\frac{2B}{\omega^2 - \psi^2}\right)
= \tan^{-1}\left(\frac{Q^{-1}}{\delta^2 - 1}\right)\tp$$

\( Q \) is commonly called <em>quality factor</em> and \( \phi \) is the
<em>phase shift</em>. Dividing
<a href="#mjx-eqn-2.84">(2.84)</a> by \( A/k \), which is a common
scale for \( u \), gives the dimensionless relation

$$
\begin{equation}
\frac{u}{A/k} = \frac{Q}{\delta} R(Q,\delta)^{\frac{1}{2}}\cos(\psi t + \phi),
\quad
R(Q,\delta) = \left(1 + Q^2(\delta - \delta^{-1})\right)^{-1}\tp
\tag{2.85}
\end{equation}
$$

<h3 id="___sec87">Choosing scales </h3>

<p>
Much of the discussion about scales in the previous sections are
relevant also when damping is included.  Although the oscillations
with frequency \( \sqrt{\omega^2-B^2} \) die out for \( t\gg B^{-1} \), we
start with using this frequency for the time scale.  A highly relevant
assumption for engineering applications of
<a href="#mjx-eqn-2.82">(2.82)</a> is that the damping is small.
Therefore, \( \sqrt{\omega^2-B^2} \) is close to \( \omega \) and we simply
apply \( t_c=1/\omega \) as before (if not the interest in large \( t \) for
which the oscillations with frequency \( \omega \) has died out).

<p>
The coefficient in front of the \( \bar u' \) term then becomes

$$ \frac{b}{m\omega} = \frac{2B}{\omega} = Q^{-1}\tp$$

The rest of the ODE is given in the previous section, and the particular
formulas depend on the choices of \( t_c \) and \( u_c \).

<h3 id="___sec88">Choice of \( u_c \) at resonance </h3>

<p>
The relevant scale for \( u_c \) at or nearby resonance (\( \psi = \omega \))
becomes different from the previous section, since with damping,
the maximum amplitude is a finite value. For \( t\gg B^{-1} \), when the
\( \sin\psi t \) term is dominating, we have for \( \psi = \omega \):

$$ u = \frac{Am^{-1}2B\psi}{4B^2\psi^2}\sin (\psi t) =
\frac{A}{2Bm\psi}\sin (\psi t) =
\frac{A}{b\psi}\sin (\psi t)
\tp
$$

This motivates the choice

$$ u_c = \frac{A}{b\psi} = \frac{A}{b\omega}\tp$$

(It is wise during computations like this to stop and check the
dimensions: \( A \) must be \( [\hbox{MLT}^{-2}] \) from the original
equation (\( F(t) \) must have the same dimension as \( mu'' \)),
\( bu' \) must also have dimension \( [\hbox{MLT}^{-2}] \), implying that
\( b \) has dimension \( [\hbox{MT}^{-1}] \). \( A/b \) then has dimension
\( LT^{-1} \), and \( A/(b\psi) \) gets dimension \( [L] \), which matches
what we want for \( u_c \).)

<p>
The differential equation on dimensionless form becomes

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + Q^{-1}\frac{d\bar u}{d\bar t} + \bar u =
\gamma
\cos(\delta\bar t),
\quad \bar u(0)=\alpha,\ \bar u'(0)=\beta,
\tag{2.86}
\end{equation}
$$

with

<p>
<!-- \frac{A}{b\omega} -->

$$
\begin{align}
\alpha &= \frac{I}{u_c} = \frac{Ib}{A}\sqrt{\frac{k}{m}},
\tag{2.87}\\ 
\beta  &= \frac{Vt_c}{u_c} = \frac{Vb}{A},
\tag{2.88}\\ 
\gamma &= \frac{t_c^2 A}{mu_c} = \frac{b\omega}{k},
\tag{2.89}\\ 
\delta &= \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega} = 1\tp
\tag{2.90}
\end{align}
$$

<h3 id="___sec89">Choice of \( u_c \) when \( \omega\gg\psi \) </h3>

<p>
In the limit \( \omega\gg\psi \) and \( t\gg B^{-1} \),

$$ u \approx \frac{A}{m\omega^2}\cos\psi t = \frac{A}{k}\cos\psi t,$$

showing that \( u_c=A/k \) is an appropriate displacement scale.
(Alternatively, we get this scale also from demanding \( \gamma=1 \) in the ODE.)
The dimensionless numbers \( \alpha \), \( \beta \), and \( \delta \) are as
for the forced vibrations without damping.

<h3 id="___sec90">Choice of \( u_c \) when \( \omega\ll\psi \) </h3>

<p>
In the limit \( \omega\ll\psi \), we should base \( t_c \) on the rapid
variations in the excitation: \( t_c=1/\psi \).

<h3 id="___sec91">Software </h3>

<p>
It is easy to reuse a solver for a general vibration problem also
in the dimensionless case.
In particular, we may use the <code>solver</code> function in the
file <a href="http://tinyurl.com/o8pb3yy/vib.py" target="_self"><tt>vib.py</tt></a>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">solver</span>(I, V, m, b, s, F, dt, T, damping<span style="color: #666666">=</span><span style="color: #BA2121">&#39;linear&#39;</span>):
</pre></div>
<p>
for solving the ODE problem

$$ mu'' + f(u') + s(u) = F(t),\quad u(0)=I,\ u'(0)=V,\ t\in (0,T],$$

with time steps <code>dt</code>. With <code>damping='linear'</code>, we have \( f(u')=bu' \), while the
other value is <code>'quadratic'</code>, meaning \( f(u')=b|u'|u' \).
Given the dimensionless numbers \( \alpha \), \( \beta \), \( \gamma \), \( \delta \),
and \( Q \),
an appropriate call for solving <a href="#mjx-eqn-2.73">(2.73)</a> is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">u, t <span style="color: #666666">=</span> solver(I<span style="color: #666666">=</span>alpha, V<span style="color: #666666">=</span>beta, m<span style="color: #666666">=1</span>, b<span style="color: #666666">=1.0/</span>Q,
              s<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> u: u, F<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> t: gamma<span style="color: #666666">*</span>cos(delta<span style="color: #666666">*</span>t),
	      dt<span style="color: #666666">=2*</span>pi<span style="color: #666666">/</span>n, T<span style="color: #666666">=2*</span>pi<span style="color: #666666">*</span>P)
</pre></div>
<p>
where <code>n</code> is the number of intervals per period and <code>P</code> is the number
of periods to be simulated.
We way wrap this call in a <code>solver_scaled</code> function and wrap it furthermore
with <code>joblib</code> to avoid repeated calls,
as we explained in
the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:prog">Making software for utilizing the scaled model</a>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">vib</span> <span style="color: #008000; font-weight: bold">import</span> solver <span style="color: #008000; font-weight: bold">as</span> solver_unscaled

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">solver_scaled</span>(alpha, beta, gamma, delta, Q, T, dt):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Solve u&#39;&#39; + (1/Q)*u&#39; + u = gamma*cos(delta*t),</span>
<span style="color: #BA2121; font-style: italic">    u(0)=alpha, u&#39;(1)=beta, for (0,T] with step dt.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Computing the numerical solution&#39;</span>
    <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> cos
    <span style="color: #008000; font-weight: bold">return</span> solver_unscaled(I<span style="color: #666666">=</span>alpha, V<span style="color: #666666">=</span>beta, m<span style="color: #666666">=1</span>, b<span style="color: #666666">=1./</span>Q,
                           s<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> u: u,
                           F<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> t: gamma<span style="color: #666666">*</span>cos(delta<span style="color: #666666">*</span>t),
                           dt<span style="color: #666666">=</span>dt, T<span style="color: #666666">=</span>T, damping<span style="color: #666666">=</span><span style="color: #BA2121">&#39;linear&#39;</span>)

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">joblib</span>
disk_memory <span style="color: #666666">=</span> joblib<span style="color: #666666">.</span>Memory(cachedir<span style="color: #666666">=</span><span style="color: #BA2121">&#39;temp&#39;</span>)
solver_scaled <span style="color: #666666">=</span> disk_memory<span style="color: #666666">.</span>cache(solver_scaled)
</pre></div>
<p>
This code is found in <a href="http://tinyurl.com/o8pb3yy/vib_scaled.py" target="_self"><tt>vib_scaled.py</tt></a>
and features an application for running the scaled problem with
options on the command-line for \( \alpha \), \( \beta \), \( \gamma \), \( \delta \),
\( Q \), number of time steps per period, and number of periods (see
the <code>main</code> function). It is an ideal application for exploring
scaled vibration models.

<h2 id="___sec92">Oscillating electric circuits </h2>

<p>
The differential equation for an oscillating electric circuit is
very similar to the equation for forced, damped,
mechanical vibrations, and their
dimensionless form is identical. This fact will now be demonstrated.

<p>
The current \( I(t) \) in a
circuit having an inductor with inductance \( L \), a capacitor with
capacitance \( C \), and overall resistance \( R \), obeys the equation

$$
\begin{equation}
\ddot I + \frac{R}{L}\dot I + \frac{1}{LC}I =  V(t),
\tag{2.91}
\end{equation}
$$

where \( V(t) \) is the voltage source powering the circuit.
We introduce

$$ \bar I=\frac{I}{I_c},\quad \bar t = \frac{t}{t_c},$$

and get

$$ \frac{d^2\bar I}{d\bar t^2} + \frac{t_c R}{L}\frac{d\bar I}{d\bar t}
+ \frac{t_c^2}{LC}\bar I = \frac{t_c^2V_c}{I_c} \bar V(t)\tp$$

Here, we have scaled \( V(t) \) according to

$$ \bar V(\bar t) = \frac{V(t_c\bar t)}{\max_t V(t)}\tp$$

<p>
The time scale \( t_c \) is chosen to make \( \ddot I \) and \( I/(LC) \) balance,
\( t_c = \sqrt{LC} \).
Choosing \( I_c \) to make the coefficient in the source term of unit size,
means \( I_c = LCV_c \).
With

$$ Q^{-1} = R\sqrt{\frac{C}{L}},$$

we get the scaled equation

$$
\begin{equation}
\frac{d^2\bar I}{d\bar t^2} + Q^{-1}\frac{d\bar I}{d\bar t}
+ \bar I = \bar V(t),
\tag{2.92}
\end{equation}
$$

which is basically the same as we derived for mechanical vibrations.
(Two additional dimensionless variables will arise from the initial
conditions for \( I \), just as in the mechanics cases.)

<h1 id="___sec93">Exercises </h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:US2SI1">Exercise 2.1: Perform unit conversion</h2>

<p>
Density (mass per volume: \( [\hbox{ML}^{-3}] \)) of water is
given as 1.05 ounce per fluid ounce. Use the <code>PhysicalQuantity</code> object
to convert to \( \hbox{kg\,m}^{-3} \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_1_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_1_1">

<p>
Use <code>pydoc PhysicalQuantities</code> to find that <code>floz</code> is the name of
the volume &quot;fluid ounce&quot; and <code>oz</code> is the name of the mass &quot;ounce&quot;.
Here is an interactive session for the conversion:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">PhysicalQuantities</span> <span style="color: #008000; font-weight: bold">import</span> PhysicalQuantity <span style="color: #008000; font-weight: bold">as</span> PQ
<span style="color: #666666">&gt;&gt;&gt;</span> d <span style="color: #666666">=</span> PQ(<span style="color: #BA2121">&#39;1.05 oz/floz&#39;</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> d<span style="color: #666666">.</span>convertToUnit(<span style="color: #BA2121">&#39;kg/m**3&#39;</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> d
<span style="color: #666666">1006.54198946</span> kg<span style="color: #666666">/</span>m<span style="color: #666666">**3</span>
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>density_conversion</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:ball_y">Problem 2.2: Scale a simple formula</h2>

<p>
The height \( y \) of a body thrown up in the air is given by

$$ y = v_0t - \frac{1}{2}gt^2,$$

where \( t \) is time, \( v_0 \) is the initial velocity of the body at \( t=0 \),
and \( g \) is the acceleration of gravity. Scale this formula. Use
two choices of the characteristic time: the time it takes to reach the
maximum \( y \) value and the time it takes to return to \( y=0 \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_2_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_2_1">

<p>
We introduce

$$ \bar y =\frac{y}{y_c},\quad \bar t = \frac{t}{t_c}\tp$$

Inserted in the formula we get

$$ y_c\bar y = v_0t_c\bar t - \frac{1}{2}gt_c^2\bar t^2\tp$$

<p>
1. At the maximum point of \( y \), \( y'=0 \), so \( y'=v_0 - gt=0 \), which means
\( t=v_0/g \) and \( y_{\max}=v_0v0/g - \frac{1}{2}gv_0^2/g^2 = \frac{1}{2}v_0^2/g \).
We choose \( t_c=v_0/g \) and \( y_c=\frac{1}{2}v_0^2/g \).
This gives

$$ \frac{1}{2}\frac{v_0^2}{g}\bar y = \frac{v_0^2}{g}\bar t -
\frac{1}{2}\frac{v_0^2}{g}\bar t^2\quad\Rightarrow\quad
\bar y = 2\bar t - \bar t^2\tp$$

<p>
2. The body is back at \( y=0 \) for \( v_0t - \frac{1}{2}gt^2=0 \), which gives
\( t_c=2v_0/g \) and \( y_c=2y_{\max}=v_0^2/g \). Inserted, we get

$$ \frac{v_0^2}{g}\bar y = 2\frac{v_0^2}{g}\bar t -
\frac{1}{2}4\frac{v_0^2}{g}\bar t^2\quad\Rightarrow\quad
\bar y = 2\bar t(1 - \bar t)\tp$$

Observe that the physical parameters \( v_0 \) and \( g \) are absent in the
scaled formula.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>vertical_motion</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:decay:cooling:osc">Exercise 2.3: Perform alternative scalings</h2>

<p>
The problem in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#scale:cooling:osc">Scaling a cooling problem with time-dependent surroundings</a> applies a
temperature scaling

$$ \bar T = \frac{T-T_0}{T_m-T_0},$$

which is not always suitable.

<p>
<b>a)</b>
Consider the case \( T_0=T_m \) and the fact that \( |T_m-T_0| \) does not
represent the characteristic temperature scale since it
collapses to zero. Formulate a suitable
scaling in this case. The figure below corresponds to \( T_m=25 \) C,
\( T_0=24.9 \) C, and \( a=2.5 \) C. We clearly see that \( \bar T \) is
not of size unity.

<p>
<center><p><img src="fig-scaling/osc_cooling_wrong_scale.png" align="bottom" width=500></p></center>

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_3_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_3_1">

<p>
The typical temperature variations will now be oscillations of amplitude
\( a \) around \( T_m=T_0 \), so \( 2a \) is the typical variation of the
surrounding temperature. If the time scale of \( T_s \) is sufficiently
large (or more precisely, \( \beta \) is small),
the temperature will actually reach amplitudes of size \( a \),
but for fast oscillations in \( T_s \), there will not be enough time to
transfer heat to/from the body, so the amplitudes of \( T \) will be
smaller. Taking \( 2a \) to be the typical temperature range, we can propose
the scaling

$$ \bar T = \frac{T-T_m}{2a}\tp$$

Inserted in the differential equation, we get with \( t_c=1/k \),

$$ k2a\frac{\bar T}{d\bar t} = -k(2a\bar T + T_m - (T_m + a\sin(\omega t))),$$

which simplifies to

$$ \frac{\bar T}{d\bar t} = -(\bar T - \frac{1}{2}\sin(\beta t)),$$

where \( \beta = \omega/k \).
The initial condition becomes

$$ \bar T(0) = -\half\alpha,$$

where \( \alpha = a/(T_m-T_0) \) is the dimensionless number that appeared
in the scaled differential equation in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#scale:cooling:osc">Scaling a cooling problem with time-dependent surroundings</a>.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Consider the case where \( a \) is much larger than \( |T_m-T_0| \).
What is an appropriate scaling of the temperature?

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_3_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_3_2">

<p>
In this case, \( T \) will oscillate around \( T_m \) and at maximum reach the
amplitude \( a \) if \( \beta \) is small, see the figure in a).
This is the same situation as in a),
and we can consequently use the same scaling and obtain the same
scaled problem.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:ball_y_wdrag">Problem 2.4: A nonlinear ODE for vertical motion with air resistance</h2>

<p>
The velocity \( v(t) \)
of a body moving vertically through a fluid in the gravity field,
with fluid drag and buoyancy, is governed by the ODE

$$ mv' = -\frac{1}{2}C_D\varrho A |v|v - mg + \varrho V g,\quad v(0)=v_0,$$

where \( t \) is time, \( m \) is the mass of the body, \( C_D \) is a drag coefficient,
\( \varrho \) is the density of the fluid, \( A \) is the cross-sectional area
perpendicular to the motion, \( g \) is the acceleration of gravity,
and \( V \) is the volume of the body. Scale this ODE.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_4_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_4_1">

<p>
We introduce as usual

$$ \bar v = \frac{v}{v_c},\quad \bar t = \frac{t}{t_c},$$

but the main challenge is to find values for \( v_c \) and \( t_c \).
Inserting the scaled quantities gives

$$ m\frac{v_c}{t_c}\frac{d\bar v}{d\bar t} =
-\frac{1}{2}C_D\varrho A v_c^2 |\bar v|\bar v
- mg + \varrho V g,\quad v_c v(0)=v_0,$$

It is tempting to set \( v_c=v_0 \), but \( v_0=0 \) is a relevant value so
this choice is not good. The motion is of decay type so \( t_c \) and \( v_c \)
should be based on characteristics of the decay. The terminal velocity,
defined by \( v'=0 \), is

$$  v_T =  \sqrt{\frac{2(\varrho V - m)g}{C_D\varrho A}},$$

when \( \varrho V >m \) such that the buoyancy wins over gravity and
the motion is upwards. Otherwise,

$$  v_T =  -\sqrt{\frac{2(m-\varrho V)g}{C_D\varrho A}}\tp$$

The two formulas can be combined to

$$  v_T =  \mbox{sign}(\varrho V - m)\sqrt{\frac{2|\varrho V -m|g}{C_D\varrho A}}\tp$$

<p>
We take \( v_c = |v_T| = \sqrt{\frac{2|\varrho V - m|g}{C_D\varrho A}} \).
This results in

$$
\frac{d\bar v}{d\bar t} =
-t_c\frac{1}{2m}C_D \varrho A \sqrt{\frac{2|\varrho V - m|g}{C_D\varrho A}}
|\bar v|\bar v
- t_c\sqrt{\frac{C_D\varrho g A}{2|\varrho V - m|}}(1- \frac{\varrho V}{m}),
$$

and
$$ v(0)=v_0
\sqrt{\frac{C_D\varrho A}{2g|\varrho V - m|}}\tp$$

<p>
A natural choice is to assume \( d\bar v/d\bar t \) and \( \bar v \) to
be of the same order, which means that coefficient in front of the
nonlinear term \( |\bar v|\bar v \) should be unity. This forces \( t_c \) to be

$$ t_c = \frac{2m}{\sqrt{2g|\varrho V - m|C_D\varrho A}}\tp$$

Introducing the dimensionless numbers

$$ \alpha = \frac{\varrho V}{m}, \quad \beta = v_0\sqrt{\frac{C_D\varrho A}{2g|\varrho V - m|}} = \frac{v_0}{|v_T|},$$

we get the scaled ODE problem

$$
\frac{d\bar v}{d\bar t} =
- |\bar v|\bar v + \mbox{sign}(1-\alpha),\quad
\bar v(0)=\beta\tp
$$

Note that, as usual, the dimensionless numbers have simple
interpretations:
\( \alpha \) is the ratio of the mass of the displaced fluid and
the mass of the body, while \( \beta \) is the ratio of the initial and
terminal velocities.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>vertical_motion_with_drag</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:decay:jump">Exercise 2.5: Solve a decay ODE with discontinuous coefficient</h2>

<p>
Make software for the problem in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:jump">Variable coefficients</a>
so that you can produce Figure <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:jump:fig">4</a>.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_5_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_5_1">

<p>
Follow the ideas for software in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:body">Scaling a generalized problem</a>: use the
<a href="http://tinyurl.com/o8pb3yy/decay_vc.py" target="_self"><tt>decay_vc.py</tt></a> module as computational
engine and modify the
<a href="http://tinyurl.com/o8pb3yy/falling_body.py" target="_self"><tt>falling_body.py</tt></a> code.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_5_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_5_2">

<p>
We use <code>joblib</code> to avoid unnecessary execution of the scaled problem,
as explained in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:prog">Making software for utilizing the scaled model</a>. A potential
complete program is listed below.

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sys</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">os</span>
<span style="color: #408080; font-style: italic"># Enable loading modules in ../src-scaling</span>
sys<span style="color: #666666">.</span>path<span style="color: #666666">.</span>insert(<span style="color: #666666">0</span>, os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>join(os<span style="color: #666666">.</span>pardir, <span style="color: #BA2121">&#39;src-scaling&#39;</span>))
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">decay_vc</span> <span style="color: #008000; font-weight: bold">import</span> solver <span style="color: #008000; font-weight: bold">as</span> solver_unscaled
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> pi
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">solver_scaled</span>(gamma, T, dt, theta<span style="color: #666666">=0.5</span>):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Solve u&#39;=-a*u, u(0)=1 for (0,T] with step dt and theta method.</span>
<span style="color: #BA2121; font-style: italic">    a=1 for t &lt; gamma and 2 for t &gt; gamma.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Computing the numerical solution&#39;</span>
    <span style="color: #008000; font-weight: bold">return</span> solver_unscaled(
        I<span style="color: #666666">=1</span>, a<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> t: <span style="color: #666666">1</span> <span style="color: #008000; font-weight: bold">if</span> t <span style="color: #666666">&lt;</span> gamma <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">5</span>,
        b<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> t: <span style="color: #666666">0</span>, T<span style="color: #666666">=</span>T, dt<span style="color: #666666">=</span>dt, theta<span style="color: #666666">=</span>theta)

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">joblib</span>
disk_memory <span style="color: #666666">=</span> joblib<span style="color: #666666">.</span>Memory(cachedir<span style="color: #666666">=</span><span style="color: #BA2121">&#39;temp&#39;</span>)
solver_scaled <span style="color: #666666">=</span> disk_memory<span style="color: #666666">.</span>cache(solver_scaled)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">unscale</span>(u_scaled, t_scaled, d, I):
    <span style="color: #008000; font-weight: bold">return</span> I<span style="color: #666666">*</span>u_scaled, d<span style="color: #666666">*</span>t_scaled

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">main</span>(d,
         I,
         t_1,
         dt<span style="color: #666666">=0.04</span>, <span style="color: #408080; font-style: italic"># Time step, scaled problem</span>
         T<span style="color: #666666">=4</span>,     <span style="color: #408080; font-style: italic"># Final time, scaled problem</span>
         ):

    legends1 <span style="color: #666666">=</span> []
    legends2 <span style="color: #666666">=</span> []
    plt<span style="color: #666666">.</span>figure(<span style="color: #666666">1</span>)
    plt<span style="color: #666666">.</span>figure(<span style="color: #666666">2</span>)

    gamma <span style="color: #666666">=</span> t_1<span style="color: #666666">*</span>d
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;gamma=</span><span style="color: #BB6688; font-weight: bold">%.3f</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> gamma
    u_scaled, t_scaled <span style="color: #666666">=</span> solver_scaled(gamma, T, dt)

    plt<span style="color: #666666">.</span>figure(<span style="color: #666666">1</span>)
    plt<span style="color: #666666">.</span>plot(t_scaled, u_scaled)
    legends1<span style="color: #666666">.</span>append(<span style="color: #BA2121">&#39;gamma=</span><span style="color: #BB6688; font-weight: bold">%.3f</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> gamma)

    plt<span style="color: #666666">.</span>figure(<span style="color: #666666">2</span>)
    u, t <span style="color: #666666">=</span> unscale(u_scaled, t_scaled, d, I)
    plt<span style="color: #666666">.</span>plot(t, u)
    legends2<span style="color: #666666">.</span>append(<span style="color: #BA2121">&#39;d=</span><span style="color: #BB6688; font-weight: bold">%.2f</span><span style="color: #BA2121"> [1/s], t_1=</span><span style="color: #BB6688; font-weight: bold">%.2f</span><span style="color: #BA2121"> s&#39;</span> <span style="color: #666666">%</span> (d, t_1))
    plt<span style="color: #666666">.</span>figure(<span style="color: #666666">1</span>)
    plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;scaled time&#39;</span>); plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;scaled velocity&#39;</span>)
    plt<span style="color: #666666">.</span>legend(legends1, loc<span style="color: #666666">=</span><span style="color: #BA2121">&#39;upper right&#39;</span>)
    plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp1.png&#39;</span>);  plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp1.pdf&#39;</span>)

    plt<span style="color: #666666">.</span>figure(<span style="color: #666666">2</span>)
    plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;t [s]&#39;</span>);  plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;u&#39;</span>)
    plt<span style="color: #666666">.</span>legend(legends2, loc<span style="color: #666666">=</span><span style="color: #BA2121">&#39;upper right&#39;</span>)
    plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp2.png&#39;</span>);  plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp2.pdf&#39;</span>)
    plt<span style="color: #666666">.</span>show()

<span style="color: #008000; font-weight: bold">if</span> __name__ <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;__main__&#39;</span>:
    main(d<span style="color: #666666">=1/120.</span>, I<span style="color: #666666">=1</span>, t_1<span style="color: #666666">=100</span>)
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>decay_jump</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:decay:cooling">Exercise 2.6: Implement a scaled model for cooling</h2>

<p>
Use software for the unscaled problem <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#mjx-eqn-2.16">(2.16)</a>
to compute the solution of the
scaled problem <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#mjx-eqn-2.23">(2.23)</a>.
Let \( T_s \) be a function of time.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_6_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_6_1">

<p>
You may use the general software <a href="http://tinyurl.com/o8pb3yy/decay_vc.py" target="_self"><tt>decay_vc.py</tt></a>
for computing with the cooling model.
See the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:body">Scaling a generalized problem</a> for more ideas.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_6_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_6_2">

<p>
The problem <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#mjx-eqn-2.16">(2.16)</a> is just a special case
of the general problem \( u'=-au + b \) solved by the
<code>decay_vc</code> module. We can make an implementation of
<a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#mjx-eqn-2.23">(2.23)</a> in terms of the
model \( u'=-au + b \):

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sys</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">os</span>
<span style="color: #408080; font-style: italic"># Enable loading modules in ../src-scaling</span>
sys<span style="color: #666666">.</span>path<span style="color: #666666">.</span>insert(<span style="color: #666666">0</span>, os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>join(os<span style="color: #666666">.</span>pardir, <span style="color: #BA2121">&#39;src-scaling&#39;</span>))
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">decay_vc</span> <span style="color: #008000; font-weight: bold">import</span> solver <span style="color: #008000; font-weight: bold">as</span> solver_unscaled
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> pi
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">solver_scaled</span>(alpha, beta, t_stop, dt, theta<span style="color: #666666">=0.5</span>):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Solve T&#39; = -T + 1 + alha*sin(beta*t), T(0)=0</span>
<span style="color: #BA2121; font-style: italic">    for (0,T] with step dt and theta method.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Computing the numerical solution&#39;</span>
    <span style="color: #008000; font-weight: bold">return</span> solver_unscaled(
        I<span style="color: #666666">=0</span>, a<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> t: <span style="color: #666666">1</span>,
        b<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> t: <span style="color: #666666">1</span> <span style="color: #666666">+</span> alpha<span style="color: #666666">*</span>np<span style="color: #666666">.</span>sin(beta<span style="color: #666666">*</span>t),
        T<span style="color: #666666">=</span>t_stop, dt<span style="color: #666666">=</span>dt, theta<span style="color: #666666">=</span>theta)

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">joblib</span>
disk_memory <span style="color: #666666">=</span> joblib<span style="color: #666666">.</span>Memory(cachedir<span style="color: #666666">=</span><span style="color: #BA2121">&#39;temp&#39;</span>)
solver_scaled <span style="color: #666666">=</span> disk_memory<span style="color: #666666">.</span>cache(solver_scaled)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">main</span>(alpha,
         beta,
         t_stop<span style="color: #666666">=50</span>,
         dt<span style="color: #666666">=0.04</span>
         ):

    T, t <span style="color: #666666">=</span> solver_scaled(alpha, beta, t_stop, dt)
    plt<span style="color: #666666">.</span>plot(t, T)
    plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">r&#39;$\bar t$&#39;</span>);  plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">r&#39;$\bar T$&#39;</span>)
    plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">r&#39;$\alpha=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">,\ \beta=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$&#39;</span> <span style="color: #666666">%</span> (alpha, beta))
    filestem <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;tmp_</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">_</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (alpha, beta)
    plt<span style="color: #666666">.</span>savefig(filestem <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;.png&#39;</span>);  plt<span style="color: #666666">.</span>savefig(filestem <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;.pdf&#39;</span>)
    plt<span style="color: #666666">.</span>show()

<span style="color: #008000; font-weight: bold">if</span> __name__ <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;__main__&#39;</span>:
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sys</span>
    alpha <span style="color: #666666">=</span> <span style="color: #008000">float</span>(sys<span style="color: #666666">.</span>argv[<span style="color: #666666">1</span>])
    beta <span style="color: #666666">=</span> <span style="color: #008000">float</span>(sys<span style="color: #666666">.</span>argv[<span style="color: #666666">2</span>])
    t_stop <span style="color: #666666">=</span> <span style="color: #008000">float</span>(sys<span style="color: #666666">.</span>argv[<span style="color: #666666">3</span>])
    main(alpha, beta, t_stop)
</pre></div>
<p>
Simulations for \( \alpha=1 \) and \( \beta=0.1,1,10 \) as well as for
\( \alpha=0.1 \) and \( \beta=1 \) are shown below.

<p>
<center><p><img src="fig-scaling/cooling1.png" align="bottom" width=800></p></center>

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>cooling1</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:exer:decay:step">Problem 2.7: Decay ODE with discontinuous coefficients</h2>

<p>
The goal of this exercise is to scale the problem
\( u^{\prime}(t) = -a(t)u(t) + b(t) \), \( u(0)=I \), when

$$
a(t) =\left\lbrace\begin{array}{ll}
Q, & t < s,\\ 
Q - A, & t\geq s,\end{array}\right.
\quad b = \left\lbrace\begin{array}{ll}
\epsilon t, & t < s,\\ 
0, & t\geq s,\end{array}\right.
$$

Here, \( Q,A,\epsilon >0 \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_7_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_7_1">

<p>
We start by scaling the known functions \( a \) and \( b \). Since \( Q,A.\epsilon >0 \),
\( \max |a(t)| = Q \) and \( \max |b(t)| = \epsilon s \). Scaled versions of these
functions are then

$$ \bar a = \frac{a}{Q},\quad \bar b = \frac{b}{\epsilon s}\tp$$

<p>
As usual, we scale \( u \) and \( t \) as

$$ \bar u = \frac{u}{u_c},\quad \bar t = \frac{t}{t_c}\tp$$

The scaled ODE reads

$$ \frac{d\bar u}{d\bar t} = -t_c Q\bar a(\bar t) + u_c^{-1}t_c\epsilon s\bar b\tp$$

A natural choice of \( u_c \) is \( u_c=I \). The \( a \) term will reduce \( \bar u \) from 1,
while the \( b \) term may have a growth effect.

<p>
The time scale is best chosen to reflect the dynamics of the process, i.e.,
the decay with strength \( Q \), so we set \( t_c=1/Q \). This choice results in

$$ \frac{d\bar u}{d\bar t} = -\bar a(\bar t) + \alpha\bar b,$$

with

$$ \bar a(\bar t) = \left\lbrace\begin{array}{ll}
1, & \bar t < \gamma,\\ 
1 - \beta, & \bar t\geq \gamma,\end{array}\right.
$$

and

$$ \bar b(\bar t) = \left\lbrace\begin{array}{ll}
\gamma^{-1} \bar t, & \bar t < \gamma,\\ 
0, & \bar t\geq \gamma,\end{array}\right.
$$

The initial condition is \( \bar u(0)=1 \).
We have three dimensionless numbers in the problem:

$$ \alpha = \frac{\epsilon s}{QI},\quad \beta = \frac{A}{Q},
\quad \gamma = Qs\tp$$

We realize that \( \alpha \) measures the ratio of the \( b \) term (\( \epsilon s \))
and the \( au \) term (\( QI \)), \( \beta \) reflects the relative jump in \( a \),
while \( \gamma \) measures the ratio of the
transition point \( t=s \) and the characteristic time scale.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>decay_varcoeff</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:exer:nonlin:logistic2">Exercise 2.8: Alternative scalings of a cooling model</h2>

<p>
Implement the scaled model <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#mjx-eqn-2.29">(2.29)</a>
and produce a plot with curves corresponding to various values of
\( \alpha \) and \( p \) to summarize how \( \bar u(\bar t) \) looks like.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_8_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_8_1">

<p>
A centered Crank-Nicolson-style
scheme for <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#mjx-eqn-2.29">(2.29)</a>
can use an old time value for the nonlinear coefficient:

$$ \frac{\bar u^{n+1} - \bar u^n}{\Delta t} =
(1 - \alpha\bar u^n)^p\frac{1}{2}(\bar u^n + \bar u^{n+1})\tp$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>growth</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:projectile">Exercise 2.9: Projectile motion</h2>

<p>
We have the following mathematical model for the motion of a projectile
in two dimensions:

$$ m\ddot\x + \frac{1}{2}C_D\varrho A|\dot\x|\dot\x
= -mg\jj,\quad \x(0)=\boldsymbol{0},\ \dot\x(0)=v_0\cos\theta\ii +
v_0\sin\theta\jj\tp$$

Here, \( m \) is the mass of the projectile, \( \x=x\ii + y\jj \) is
the position vector of the projectile, \( \ii \) and \( \jj \)
are unit vectors along the \( x \) and \( y \) axes, respectively,
\( \ddot\x \) and \( \dot\x \) is the second- and first-order
time derivative of \( \x(t) \), \( C_D \) is a drag coefficient
depending on the shape of the projectile (can be taken as 0.4 for a sphere),
\( \varrho \) is the density of the air, \( A \) is the cross section area
(can be taken as \( \pi R^2 \) for a sphere of radius \( R \)), \( g \) is gravity,
\( v_0 \) is the initial velocity of the projectile in a direction that makes
the angle \( \theta \) with the ground.

<p>
<b>a)</b>
Neglect the air resistance term proportional to \( \dot\x \) and solve
analytically for \( \x(t) \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_9_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_9_1">

<p>
The vector differential equation reduces to the two component equations

$$ m\ddot x(t) = 0,\quad m\ddot y(t) = -mg\tp$$

Integrating twice yields

$$ x(t) = C_1t + C_2,\quad y(t) = -\frac{1}{2}gt^2 + C_3t + C_4\tp$$

The condition \( \x(0)=\boldsymbol{0} \) forces \( C_2=C_4=0 \). The condition on
the derivative gives \( C_1=v_0\cos\theta \) and \( C_3=v_0\sin\theta \).
The result is therefore

$$ \x(t) = v_0\cos(\theta) t\ii + (v_0\sin(\theta) t - \frac{1}{2}gt^2)\jj\tp$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Make the model for projectile motion with air resistance non-dimensional.
Use the maximum height from the simplification in a) as length scale.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_9_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_9_2">

<p>
We introduce dimensionless quantities:

$$ \bar x = \frac{x}{L},\quad \bar y = \frac{y}{L},\quad\bar t = \frac{t}{t_c},$$

where the scales \( L \) and \( t_c \) must be determined. Inserted in the original
equation:

$$ \frac{mL}{t_c^2}\frac{d^2\bar\x}{d\bar t^2} +
\frac{1}{2} C_D\varrho A\frac{L^2}{t_c^2}\left\vert\frac{d\bar\x}{d\bar t}
\right\vert\frac{d\bar\x}{d\bar t} = -mg\jj\tp$$

Dividing by \( mL/t_c^2 \) gives

$$ \frac{d^2\bar\x}{d\bar t^2} +
\frac{1}{2} C_D\varrho A\frac{L}{m}\left\vert\frac{d\bar\x}{d\bar t}
\right\vert\frac{d\bar\x}{d\bar t} = -\frac{gt_c^2}{L}\jj\tp$$

<p>
It is tempting to determine scales from setting coefficients in this
equation to unity. However, we expect the effect of air resistance
to be (much) smaller than gravity, so the primary balance in the
equation is between the acceleration term and the gravity term.
Setting the coefficient in the gravity term to unity gives
\( L=gt_c^2 \), which provides a relevant length scale. However,
setting the coefficient in the air resistance term to unity gives a
length scale only relevant when air resistance is as important as
gravity and acceleration, and that might be the case for a very
hard kick of a soccer ball, for instance. Otherwise, the coefficient
in front of the air resistance term will be a dimensionless number which
is expected to be small. Of these reasons, we need to determine \( L \)
from the insight in a) when we solved the problem using a balance of
acceleration and gravity only.

<p>
The maximum height \( y_{\max} \) occurs when \( \dot y = 0 \), and from the
solution in a) we get

$$ \dot y = v_0\sin\theta - gt = 0\quad\Rightarrow\quad
t = g^{-1}v_0\sin\theta\tp$$

The corresponding \( y_{\max} \) value is

$$ y_{\max}=g^{-1}v_0^2\sin^2\theta - \frac{1}{2}g^{-1}v_0^2\sin^2\theta =
\frac{1}{2}g^{-1}v_0^2\sin^2\theta\tp$$

We can take \( L=y_{\max} \) and let \( t_c \) be the corresponding \( t \) value:
\( t_c=g^{-1}v_0\sin\theta \). Inserted in the scaled problem:

$$ \frac{d^2\bar\x}{d\bar t^2} +
\frac{1}{2} C_D\varrho A\frac{v_0^2\sin^2\theta}{2mg}
\left\vert\frac{d\bar\x}{d\bar t}
\right\vert\frac{d\bar\x}{d\bar t} = -2\jj\tp$$

We can identify a dimensionless parameter

$$ \alpha = \frac{C_D\varrho A v_0^2\sin^2\theta}{4mg},$$

and write the scaled equation as

$$ \frac{d^2\bar\x}{d\bar t^2} + \alpha \left\vert\frac{d\bar\x}{d\bar t}
\right\vert\frac{d\bar\x}{d\bar t} = -2\jj,$$

with initial conditions

$$ \bar\x(0)=\boldsymbol{0},\quad \frac{d\bar\x}{d\bar t}(0) =
\frac{t_c}{L}(v_0\cos\theta\ii + v_0\sin\theta\jj) =
2\cot\theta\ii + 2\jj\tp$$

<p>
Apart from the factor 4, the \( \alpha \) formula as stated above
is seen to reflect the air resistance
force in the vertical motion (which has velocity \( v_0\sin\theta \)) and
the gravity force. We can compute \( \alpha \) for a soft and a hard kick
of a soccer ball as described in d), and the values are
0.04 and 0.2, respectively, showing that the balance of acceleration
and gravity is relevant - even a hard kick only gives \( \alpha 0.6 \), but
in that regime it would not be wrong to choose \( L \) such that the
coefficient in the air resistance term becomes unity.

<p>
Basing \( t_c \) and \( L \) on the entire flight back to \( y=0 \) means
\( t_c = 2g^{-1}v_0\sin\theta \) and \( L=2y_{\max} \) (the total vertical
distance), removes the factor 2 on the right-hand side and reduces
\( \alpha \) by a factor 2.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Make the model dimensionless again, but this time by demanding that
the scaled initial velocity is unity in \( x \) direction.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_9_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_9_3">

<p>
The scaled initial velocity condition is

$$ \bar x(0) = \frac{t_c}{L}v_0\cos\theta\tp$$

Demanding the scaled velocity to be unity gives

$$ L = t_cv_0\cos\theta\tp$$

The scaled initial velocity in \( y \) direction becomes

$$ \bar y(0) = \tan\theta\tp$$

The scaled ODE becomes

$$ \frac{d^2\bar\x}{d\bar t^2} +
\frac{1}{2} C_D\varrho A\frac{L}{m}\left\vert\frac{d\bar\x}{d\bar t}
\right\vert\frac{d\bar\x}{d\bar t} = -\frac{g t_c}{v_0\cos\theta}\jj\tp$$

We can choose \( t_c \) such that the gravity term is unity and balances
the acceleration term:

$$ t_c = g^{-1}v_0\cos\theta,$$

which makes

$$ L = t_cv_0\cos\theta = g^{-1}v_0^2\cos^2\theta\tp$$

The coefficient in the drag term becomes

$$ \alpha = \frac{C_D\varrho A v_0^2\cos^2\theta}{2mg}\tp$$

To summarize, we get the scaled problem

$$ \frac{d^2\bar\x}{d\bar t^2} + \alpha \left\vert\frac{d\bar\x}{d\bar t}
\right\vert\frac{d\bar\x}{d\bar t} = -\jj,\quad
\bar\x(0)=\boldsymbol{0},\quad \frac{d\bar\x}{d\bar t}(0) =
\ii + \tan\theta\jj\tp$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>d)</b>
A soccer ball has radius 11 cm and mass 0.43 kg, the density of air
is 1.2 \( \hbox{kg}\hbox{m}^{-3} \), a soft kick has velocity 30 km/h,
while a hard kick may have 120 km/h. Estimate the dimensionless parameter
in the scaled problem for a soft and a hard kick with
\( \theta \) corresponding to 45 degrees. Solve the scaled
differential equation for these values and plot the trajectory (\( y \) versus
\( x \)) for the two cases.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_9_4" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_9_4">

<p>
We need to express \( R \), \( v_0 \), and \( \theta \) in standard SI units:
\( A=\pi 0.11^2\hbox{ m}^2 \), \( \theta = 45\cdot \pi/180 \) rad,
\( v_0=30/3.6 \) and
\( 120/3.6 \) m/s.
The formula for \( \alpha \) results in

$$ \alpha_{\hbox{soft}} \approx 0.037,\quad
\alpha_{\hbox{hard}} \approx 0.6\tp$$

<p>
Appropriate computer code appears below
(using <a href="https://github.com/hplgit/odespy" target="_self">Odespy</a>
to solve the ODE system as a first-order system).

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">odespy</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">solver</span>(alpha, ic, T, dt<span style="color: #666666">=0.05</span>):
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(u, t):
        x, vx, y, vy <span style="color: #666666">=</span> u
        v <span style="color: #666666">=</span> np<span style="color: #666666">.</span>sqrt(vx<span style="color: #666666">**2</span> <span style="color: #666666">+</span> vy<span style="color: #666666">**2</span>)  <span style="color: #408080; font-style: italic"># magnitude of velocity</span>
        system <span style="color: #666666">=</span> [
            vx,
            <span style="color: #666666">-</span>alpha<span style="color: #666666">*</span>np<span style="color: #666666">.</span>abs(v)<span style="color: #666666">*</span>vx,
            vy,
            <span style="color: #666666">-2</span> <span style="color: #666666">-</span> alpha<span style="color: #666666">*</span>np<span style="color: #666666">.</span>abs(v)<span style="color: #666666">*</span>vy,
            ]
        <span style="color: #008000; font-weight: bold">return</span> system

    Nt <span style="color: #666666">=</span> <span style="color: #008000">int</span>(<span style="color: #008000">round</span>(T<span style="color: #666666">/</span>dt))
    t_mesh <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, Nt<span style="color: #666666">*</span>dt, Nt<span style="color: #666666">+1</span>)

    solver <span style="color: #666666">=</span> odespy<span style="color: #666666">.</span>RK4(f)
    solver<span style="color: #666666">.</span>set_initial_condition(ic)
    u, t <span style="color: #666666">=</span> solver<span style="color: #666666">.</span>solve(t_mesh,
                        terminate<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> u, t, n: u[n][<span style="color: #666666">2</span>] <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>)
    x <span style="color: #666666">=</span> u[:,<span style="color: #666666">0</span>]
    y<span style="color: #666666">=</span> u[:,<span style="color: #666666">2</span>]
    <span style="color: #008000; font-weight: bold">return</span> x, y, t

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">demo_soccer_ball</span>():
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">math</span>
    theta_degrees <span style="color: #666666">=</span> <span style="color: #666666">45</span>
    theta <span style="color: #666666">=</span> math<span style="color: #666666">.</span>radians(theta_degrees)
    ic <span style="color: #666666">=</span> [<span style="color: #666666">0</span>, <span style="color: #666666">2/</span>math<span style="color: #666666">.</span>tan(theta), <span style="color: #666666">0</span>, <span style="color: #666666">2</span>]
    g <span style="color: #666666">=</span> <span style="color: #666666">9.81</span>
    v0_s <span style="color: #666666">=</span> <span style="color: #666666">8.3</span>    <span style="color: #408080; font-style: italic"># soft kick</span>
    v0_h <span style="color: #666666">=</span> <span style="color: #666666">33.3</span>   <span style="color: #408080; font-style: italic"># hard kick</span>
    <span style="color: #408080; font-style: italic"># Length scales</span>
    L_s <span style="color: #666666">=</span> <span style="color: #666666">0.5*</span>(v0_s<span style="color: #666666">**2/</span>g)<span style="color: #666666">*</span>math<span style="color: #666666">.</span>sin(theta)<span style="color: #666666">**2</span>
    L_h <span style="color: #666666">=</span> <span style="color: #666666">0.5*</span>(v0_h<span style="color: #666666">**2/</span>g)<span style="color: #666666">*</span>math<span style="color: #666666">.</span>sin(theta)<span style="color: #666666">**2</span>
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;L:&#39;</span>, L_s, L_h

    m <span style="color: #666666">=</span> <span style="color: #666666">0.43</span>  <span style="color: #408080; font-style: italic"># kg</span>
    R <span style="color: #666666">=</span> <span style="color: #666666">0.11</span>  <span style="color: #408080; font-style: italic"># m</span>
    A <span style="color: #666666">=</span> math<span style="color: #666666">.</span>pi<span style="color: #666666">*</span>R<span style="color: #666666">**2</span>
    rho <span style="color: #666666">=</span> <span style="color: #666666">1.2</span> <span style="color: #408080; font-style: italic"># kg/m^3</span>
    C_D <span style="color: #666666">=</span> <span style="color: #666666">0.4</span>
    alpha_s <span style="color: #666666">=</span> C_D<span style="color: #666666">*</span>rho<span style="color: #666666">*</span>A<span style="color: #666666">*</span>v0_s<span style="color: #666666">**2*</span>math<span style="color: #666666">.</span>cos(theta)<span style="color: #666666">**2/</span>(<span style="color: #666666">4*</span>m<span style="color: #666666">*</span>g)
    alpha_h <span style="color: #666666">=</span> C_D<span style="color: #666666">*</span>rho<span style="color: #666666">*</span>A<span style="color: #666666">*</span>v0_h<span style="color: #666666">**2*</span>math<span style="color: #666666">.</span>cos(theta)<span style="color: #666666">**2/</span>(<span style="color: #666666">4*</span>m<span style="color: #666666">*</span>g)
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;alpha:&#39;</span>, alpha_s, alpha_h
    x_s, y_s, t <span style="color: #666666">=</span> solver(alpha<span style="color: #666666">=</span>alpha_s, ic<span style="color: #666666">=</span>ic, T<span style="color: #666666">=6</span>, dt<span style="color: #666666">=0.01</span>)
    x_h, y_h, t <span style="color: #666666">=</span> solver(alpha<span style="color: #666666">=</span>alpha_h, ic<span style="color: #666666">=</span>ic, T<span style="color: #666666">=6</span>, dt<span style="color: #666666">=0.01</span>)
    plt<span style="color: #666666">.</span>plot(x_s, y_s, x_h, y_h)
    plt<span style="color: #666666">.</span>legend([<span style="color: #BA2121">&#39;soft, L=</span><span style="color: #BB6688; font-weight: bold">%.2f</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> L_s, <span style="color: #BA2121">&#39;hard, L=</span><span style="color: #BB6688; font-weight: bold">%.2f</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> L_h],
                loc<span style="color: #666666">=</span><span style="color: #BA2121">&#39;upper left&#39;</span>)
    <span style="color: #408080; font-style: italic"># Let the y range be [-0.2,2] so we have space for legends</span>
    plt<span style="color: #666666">.</span>axis([x_s[<span style="color: #666666">0</span>], x_s[<span style="color: #666666">-1</span>], <span style="color: #666666">-0.2</span>, <span style="color: #666666">2</span>])
    plt<span style="color: #666666">.</span>axes()<span style="color: #666666">.</span>set_aspect(<span style="color: #BA2121">&#39;equal&#39;</span>) <span style="color: #408080; font-style: italic"># x and y axis have same scaling</span>
    plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">r&#39;$\theta=</span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">$ degrees&#39;</span> <span style="color: #666666">%</span> theta_degrees)
    plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp.png&#39;</span>)
    plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp.pdf&#39;</span>)
    plt<span style="color: #666666">.</span>show()

demo_soccer_ball()
</pre></div>
<p>
For \( \theta =45 \) degrees we get the plot

<p>
<center><p><img src="fig-scaling/projectile_45.png" align="bottom" width=500></p></center>

<p>
The blue curve is very close to motion without air resistance. We
clearly see how significant air resistance is once the velocity is
large enough.
The total length is approximately 6.3 m for a soft kick and
45 m for a hard kick (multiply the dimensionless lengths in the
plot by the corresponding \( L \)).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>projectile</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:exer:predprey">Problem 2.10: A predator-prey model</h2>

<p>
The evolution of animal populations with a predator and a prey (e.g.,
lynx and hares, or foxes and rabbits) can be described by the
Lotka-Volterra ODE system

$$
\begin{align}
H^{\prime} &= H(a - bL),
\tag{2.93}\\ 
L^{\prime} &= L(dH - c),
\tag{2.94}\\ 
H(0)&=H_0,
\tag{2.95}\\ 
L(0)&=L_0\tp
\tag{2.96}
\end{align}
$$

Here, \( H \) is the number of animals of the prey (say hares)
and \( L \) is the corresponding measure of the predator population (say lynx).
There are six parameters: \( a \), \( b \), \( c \), \( d \), \( H_0 \), and \( L_0 \).

<p>
The terms have the following meanings:

<ul>
 <li> \( aH \) is the exponential
   population growth of \( H \) due to births and deaths and is governed by
   the access to nutrition,</li>
 <li> \( -bHL \) is the loss of preys because they are eaten by predators,</li>
 <li> \( dHL \) is the increase of predators because they eat preys (but only
   a fraction of the eaten preys, \( bHL \), contribute to population growth
   of the predator and therefore \( d < b \)),</li>
 <li> \( -cL \) is the exponential decay in the predator population because of
   deaths (the increase is modeled by \( dHL \)).</li>
</ul>

Dimensionless independent and dependent variables are introduced as usual
by

$$ \bar t = \frac{t}{t_c},\quad
\bar H = \frac{H}{H_c},\quad \bar L = \frac{L}{L_c},
$$

where \( t_c \), \( H_c \), and \( L_c \) are scales to be determined. Inserted
in the ODE problem we arrive at

$$
\begin{align}
\frac{H_0}{t_c}\frac{d\bar H}{d\bar t} &= H_0\bar H(a - bH_0\bar L),
\tag{2.97}\\ 
\frac{H_0}{t_c}\frac{d\bar L}{d\bar t} &= H_0\bar L(dH_0\bar H - c),
\tag{2.98}\\ 
H_c\bar H(0) &= H_0,
\tag{2.99}\\ 
L_c\bar H(0) &= L_0\tp
\tag{2.100}
\end{align}
$$

<p>
<b>a)</b>
Consider first a simple, intuitive scaling of \( H \) and \( L \) based on
initial conditions \( H_c=H_0 \)
and \( L_c=H_c \). This means that \( \bar H \) starts out at unity and \( \bar L \)
starts out as the fraction \( L_0/H_0 \). Find a time scale and identify
dimensionless parameters in the scaled ODE problem.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_10_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_10_1">

<p>
With \( H_c=L_c=H_0 \) in
<a href="#mjx-eqn-2.97">(2.97)</a>-<a href="#mjx-eqn-2.100">(2.100)</a>
we get

$$
\begin{align*}
\frac{d\bar H}{d\bar t} &= \frac{a}{bH_0}\bar H  - \bar L\bar H,
\\ 
\frac{d\bar L}{d\bar t} &= \frac{d}{b}\bar L \bar H - \frac{c}{bH_0}\bar L),
\\ 
\bar H(0) &= 1,\\ 
\bar L(0) &=\frac{L_0}{H_0}\tp
\end{align*}
$$

With the dimensionless parameters

$$ \alpha = \frac{a}{bH_0},\quad\beta = \frac{d}{b},\quad\gamma =
\frac{c}{bH_0},\quad \delta = \frac{H_0}{L_0},$$

we can write the dimensionless problem as

$$
\begin{align*}
\frac{d\bar H}{d\bar t} &= \alpha\bar H  - \bar L\bar H,\\ 
\frac{d\bar L}{d\bar t} &= \beta\bar L \bar H - \gamma\bar L),\\ 
\bar H(0) &= 1,\\ 
\bar L(0) &= \delta \tp
\end{align*}
$$

<p>
The quantity \( bH_0 \) is the number of eaten preys per predator.
Then \( \alpha \) measures the ratio of natural population growth of
the prey, due to nutrition, and the number of eaten preys per predator.
The \( \beta \) parameter measures the fraction of the eaten preys and
the amount of this that actually
leads to population growth of the predator.
The number \( \gamma \) reflects the ratio of
predator deaths and the eaten preys per predator, and \( \delta \) is
the initial fraction of preys and predators.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Try a different scaling where the aim is to adjust the scales such that
the ODEs become as simple as possible, i.e, have as few dimensionless
parameters as possible. Compare with the scaling in a).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_10_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_10_2">

<p>
Dividing by \( H_c \) and \( L_c \) in
<a href="#mjx-eqn-2.97">(2.97)</a> and
<a href="#mjx-eqn-2.100">(2.100)</a>,
respectively,
and multiply by \( t_c \):

$$
\begin{align*}
\frac{d\bar H}{d\bar t} &= t_c\bar H(a - bL_c\bar L),\\ 
\frac{d\bar L}{d\bar t} &= t_c\bar L(dH_c\bar H - c)\tp
\end{align*}
$$

Choosing \( t_c=1/a \) and \( t_c aL_c=1 \), i.e., \( L_c=a/b \), makes the
first equation free of parameters: \( \bar H^{\prime}=\bar H(1-\bar L) \).
Factoring out \( c \) in the equation for \( L \) and choosing
\( H_c d/c=1 \), i.e., \( H_c=c/d \), leaves us with the \( L \) equation
as \( \bar L^{\prime}=(c/a)\bar L(\bar H-1) \). The ratio \( c/a \) is
now called \( \mu \) and equals
\( \gamma/\alpha \) from a).

<p>
The initial conditions lead to \( \bar H(0) = H_0/H_c=H_0d/c =\beta/\gamma = \nu \),
and \( \bar L(0)=L_0/L_c = L_0b/a = \delta/\alpha = \omega \).

<p>
The dimensionless problem is now

$$
\begin{align}
\frac{d\bar H}{d\bar t} &= \bar H(1 - \bar L),
\tag{2.101}\\ 
\frac{d\bar L}{d\bar t} &= \mu \bar L(\bar H - 1) = \gamma\alpha^{-1} \bar L(\bar H - 1),
\tag{2.102}\\ 
\bar H(0) &= \nu = \beta/\gamma,
\tag{2.103}\\ 
\bar L(0) &= \omega = \delta/\alpha,
\tag{2.104}
\end{align}
$$

with

$$ \mu = \frac{c}{a},\quad \nu = H_0\frac{d}{c},\quad \omega = L_0\frac{b}{a}
\tp$$

The unknowns \( \bar H \) and \( \bar L \) now has less intuitive scalings,

$$ \bar H = \frac{Hd}{c},\quad \bar L = \frac{Lb}{a},$$

while time is measured in the units based on the exponential growth
due to births and deaths of preys (\( a \)). The number of dimensionless parameters
is one less since we have one more scale (for \( L_c \)) at our
disposal. Simplicity in one initial conditions in a) is
exchanged with more simplicity in the ODEs, which now have
only one dimensionless parameter.

<p>
Note that \( \nu \) and \( \omega \) must be
different from unity to avoid \( \bar H\neq 0 \) and \( \bar L\neq 0 \) because
of the factors \( 1-L \) and \( H-1 \) in the equations that can make
\( \bar H^{\prime}=0 \) and \( \bar L^{\prime}=0 \).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
A more mathematical approach to determining suitable scales for \( H \) and \( L \)
consists in finding the stationary points \( (H,L) \) of the ODE system,
where \( H^{\prime}=L^{\prime}=0 \), and use such points as characteristic
sizes of the dependent variables. Show that \( H^{\prime}=L^{\prime}=0 \)
implies \( H=L=0 \) or \( L=a/b \) and \( H=c/d \). Use \( H_c=a/b \), \( L_c=c/d \),
and find a time scale. Compare with the result in b).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_10_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_10_3">

<p>
Setting \( H^{\prime}=L^{\prime}=0 \) leads to

$$ H(a-bL)=0,\quad L(dH-c)=0,$$

from which we see that the factors must vanish: \( H=L=0 \),
\( L=a/b \), and \( H=c/d \). With Use \( H_c=a/b \), \( L_c=c/d \), and \( t_c=1/a \)
we get the same scaling as in b), but with a different motivation.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>predator_prey</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:exer:competing_species">Problem 2.11: A model for competing species</h2>

<p>
Let \( N_1(t) \) and \( N_2(t) \) be the number of animals in two
competing species. A generalized Lotka-Volterra model
is based on a logistic growth of each specie and a predator-prey like
interaction (cf. <a href="#scale:exer:predprey">Problem 2.10: A predator-prey model</a>):

$$
\begin{align}
\frac{dN_1}{dt} &= r_1N_1\left( 1 - \frac{N_1}{M_1} - s_{12}\frac{N_2}{M_1}\right),
\tag{2.105}\\ 
\frac{dN_2}{dt} &= r_2N_2\left( 1 - \frac{N_2}{M_2} - s_{21}\frac{N_1}{M_2}\right),
\tag{2.106}
\end{align}
$$

where \( r_1 \), \( r_2 \), \( M_1 \), \( M_2 \), \( s_{12} \), and \( s_{21} \) are given constants.
The initial conditions specify \( N_1 \) and \( N_2 \) at \( t=0 \).
Find suitable scales and derive a dimensionless ODE problem.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_11_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_11_1">

<p>
As always, we can introduce dimensionless variables,
We use ideas from scaling of ODEs for logistic growth, i.e., we use
the carrying capacities \( M_1 \) and \( M_2 \) as characteristic (maximum)
values of \( N_1 \) and \( N_2 \), respectively. Time can be scaled from
the initial exponential growth of \( N_1 \) or \( N_2 \), i.e., \( t_c=1/r_1 \)
or \( t_c=1/r_2 \). We choose the former here. Introducing

$$ \bar t = r_1 t,\quad u_1 = \frac{N_1}{M_1},\quad u_2 = \frac{N_2}{M_2},$$

in the ODE system, leads to

$$
\begin{align*}
\frac{du_1}{d\bar t} &= u_1\left(1 - u_1 - b_{21}\beta\gamma\right),\\ 
\frac{du_2}{d\bar t} &= \alpha u_2\left(1 - u_2 - b_{12}\beta^{-1}\gamma^{-1}\right),\\ 
\end{align*}
$$

where the dimensionless numbers are given by

$$ \alpha = \frac{r_2}{r_1},\quad \beta=\frac{M_2}{M_1},
\quad \gamma = \frac{b_{12}}{b_{21}}\tp$$

We have introduced two separate numbers \( \beta \) and \( \gamma \) since they
are related to different parameters, but only their product matters.
Alternatively, we could introduce the numbers \( \mu = b_{12}\gamma \)
and \( \nu = b_{21}\gamma^{-1} \) in the last term of the first and second
ODE, respectively.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>competing_species</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:exer:sine">Problem 2.12: Find the period of sinusoidal signals</h2>

<p>
This exercise aims at investigating various fundamental
concepts like period, wave length,
and frequency in non-damped and damped sinusoidal signals.

<p>
<b>a)</b>
Plot the function

$$ u(t) = A\sin(\omega t), $$

for \( t\in [0, 8\pi/\omega] \). Choose \( \omega \) and \( A \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_12_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_12_2">

<p>
Appropriate code is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">u</span>(t, A, w, module<span style="color: #666666">=</span>np):
    <span style="color: #008000; font-weight: bold">return</span> A<span style="color: #666666">*</span>module<span style="color: #666666">.</span>sin(w<span style="color: #666666">*</span>t)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">a</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Plot u.&quot;&quot;&quot;</span>
    w <span style="color: #666666">=</span> <span style="color: #666666">2*</span>np<span style="color: #666666">.</span>pi
    A <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
    t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">8*</span>np<span style="color: #666666">.</span>pi<span style="color: #666666">/</span>w, <span style="color: #666666">1001</span>)
    plt<span style="color: #666666">.</span>figure()
    plt<span style="color: #666666">.</span>plot(t, u(t, A, w))
    plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;t&#39;</span>);  plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;u&#39;</span>)
    plt<span style="color: #666666">.</span>axis([t[<span style="color: #666666">0</span>], t[<span style="color: #666666">-1</span>], <span style="color: #666666">-1.1</span>, <span style="color: #666666">1.1</span>])
    plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">r&#39;$u=A\sin (\omega t)$, $A=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$, $\omega = </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$&#39;</span>
              <span style="color: #666666">%</span> (A, w))
    plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp1.png&#39;</span>);  plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp1.pdf&#39;</span>)
</pre></div>
<p>
<center><p><img src="fig-scaling/sine_period_a.png" align="bottom" width=600></p></center>

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
The <em>period</em> \( P \) of \( u \) is the shortest distance between two peaks (where
\( u=A \)). Show mathematically that

$$ P = \frac{2\pi}{\omega}\tp$$

Frequently, \( P \) is also referred to as the <em>wave length</em> of \( u \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_12_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_12_3">

<p>
Since the sine function has period \( 2\pi \), we have that

$$ \sin(\omega t) = \sin(\omega t + 2\pi)\tp$$

The definition of \( P \) is that sine gets its value again after
time \( P \):

$$ \sin(\omega t) = \sin(\omega (t + P))\tp$$

Combing we get that \( \sin(\omega t + 2\pi) = \sin(\omega (t + P)) \),
so the arguments must be equal:

$$ \omega t + 2\pi = \omega (t + P),$$

from which it follows that \( P=2\pi/\omega \).

<p>
An alternative is to find the peaks as the points where \( du/dt=0 \).
Since \( du/dt = \omega\cos (\omega t) \), this function is zero when
\( \omega t = n\pi \) for integer \( n \). If \( n\pi \) corresponds to a maximum,
\( (n+1)\pi \) will correspond to a minimum and \( (n+2)\pi \) to the next
maximum. The period \( P \) is the distance in time between two maxima:

$$ \omega(t + P) - \omega t = (n+2\pi - n\pi\quad\Rightarrow\quad
P = \frac{2\pi}{\omega}\tp
$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Plot the damped signal \( u(t)=e^{-at}\sin (\omega t) \) over four periods
of \( sin(\omega t) \). Choose \( \omega \), \( A \), and \( a \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_12_4" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_12_4">

<p>
Code:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">u_damped</span>(t, A, w, a, module<span style="color: #666666">=</span>np):
    <span style="color: #008000; font-weight: bold">return</span> A<span style="color: #666666">*</span>module<span style="color: #666666">.</span>exp(<span style="color: #666666">-</span>a<span style="color: #666666">*</span>t)<span style="color: #666666">*</span>module<span style="color: #666666">.</span>sin(w<span style="color: #666666">*</span>t)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">c</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Plot damped u.&quot;&quot;&quot;</span>
    w <span style="color: #666666">=</span> <span style="color: #666666">2*</span>np<span style="color: #666666">.</span>pi
    A <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
    a <span style="color: #666666">=</span> <span style="color: #666666">0.5</span>
    t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">8*</span>np<span style="color: #666666">.</span>pi<span style="color: #666666">/</span>w, <span style="color: #666666">100001</span>)
    plt<span style="color: #666666">.</span>figure()
    plt<span style="color: #666666">.</span>plot(t, u_damped(t, A, w, a))
    plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;t&#39;</span>);  plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;u&#39;</span>)
    plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">r&#39;$u=Ae^{-at}\sin (\omega t)$,&#39;</span>
              <span style="color: #BA2121">&#39;$a=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$, $A=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$, $\omega = </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$&#39;</span> <span style="color: #666666">%</span> (a, A, w))
    plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp2.png&#39;</span>);  plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp2.pdf&#39;</span>)

    u_max <span style="color: #666666">=</span> []
    u_ <span style="color: #666666">=</span> u_damped(t, A, w, a)
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>, <span style="color: #008000">len</span>(t)<span style="color: #666666">-1</span>):
        <span style="color: #008000; font-weight: bold">if</span> u_[i<span style="color: #666666">-1</span>] <span style="color: #666666">&lt;</span> u_[i] <span style="color: #666666">&gt;</span> u_[i<span style="color: #666666">+1</span>]:
            u_max<span style="color: #666666">.</span>append((t[i], u_[i]))
    <span style="color: #008000; font-weight: bold">print</span> u_max
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(u_max)<span style="color: #666666">-1</span>):
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;P=&#39;</span>, u_max[i<span style="color: #666666">+1</span>][<span style="color: #666666">0</span>] <span style="color: #666666">-</span> u_max[i][<span style="color: #666666">0</span>]
</pre></div>
<p>
<center><p><img src="fig-scaling/sine_period_c.png" align="bottom" width=600></p></center>

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>d)</b>
What is the period of \( u(t)=e^{-at}\sin (\omega t) \)? We define the
period \( P \) as the shortest distance between two peaks of the signal.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_12_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_12_1">

<p>
Use that \( v = p\cos(\omega t) + q\sin (\omega t) \) can be rewritten
as \( v = B\cos(\omega t - \phi) \) with \( B=\sqrt{p^2 + q^2} \) and
\( \phi = \tan^{-1}(p/q) \). Use such a rewrite of \( u' \) to find the peaks of
\( u \) and then the period.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_12_5" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_12_5">

<p>
Finding the extrema from \( u^{\prime}=0 \) leads to

$$ u^{\prime} = -ae^{-at}\sin(\omega t) + e^{-at}\omega\cos(\omega t) = 0\tp$$

Using the hint to rewrite (\( p=\omega \), \( q=-a \)), we get

$$ u^{\prime} = e^{-at}B\cos(\omega t - \phi)=0,\quad B=\sqrt{\omega^2 + a^2},\ \phi = \tan^{-1}(-\omega/a)\tp$$

Now, \( e^{-at} \) is always positive so only the cosine function can
cross zero, and that happens when the argument is \( n\pi \) for integer \( n \).
However, all the maxima only occurs for \( 2n\pi \) (\( n \) integer).
Demanding the argument to be \( 2n\pi \) we get the distance between two
nearby peaks as

$$ \omega (t + P) - \phi - (\omega t - \phi) = 2(n+1)\pi - 2n\pi,$$

which leads to

$$ \omega P = 2\pi\quad\Rightarrow\quad P = \frac{2\pi}{\omega}\tp$$

The period of the damped signal is the same; only \( \omega \) can alter
the period.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>sine_period</code>.

<p>
<!-- Closing remarks for this Problem -->

<h3 id="___sec106">Remarks </h3>

<p>
The <em>frequency</em> is the number of up and down cycles in one unit time.
Since there is one cycle in a period \( P \), the frequency is \( f =1/P \),
measured in Hz.
The <em>angular frequency</em> \( \omega \) is then \( \omega = 2\pi/P = 2\pi f \).

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:sliding">Problem 2.13: Oscillating mass with sliding friction</h2>

<p>
<center> <!-- figure label: --> <div id="scale:vib:exer:sliding:fig"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 14:  Body sliding on a surface.  <!-- caption label: scale:vib:exer:sliding:fig --> </p></center>
<p><img src="fig-scaling/oscillator_sliding.png" align="bottom" width=500></p>
</center>

<p>
A mass attached to a spring is sliding on a surface and subject to
a friction force, see Figure <a href="#scale:vib:exer:sliding:fig">14</a>.
The spring represents a force \( -ku\ii \), where \( k \) is the spring stiffness.
The friction force is proportional to the normal force on the surface,
\( -mg\jj \), and given by \( -f(\dot u)\ii \), where

$$ f(\dot u) = \left\lbrace\begin{array}{ll}
-\mu mg,& \dot u < 0,\\ 
\mu mg, & \dot u > 0,\\ 
0,      & \dot u=0
\end{array}\right.$$

Here, \( \mu \geq 0 \) is a friction coefficient. With the signum function

$$ \mbox{sign(x)} = \left\lbrace\begin{array}{ll}
-1,& x < 0,\\ 
1, & x > 0,\\ 
0, & x=0
\end{array}\right.$$

we can simply write \( f(\dot u) = \mu mg\,\hbox{sign}(\dot u) \)
(the sign function is implemented by <code>numpy.sign</code>).

<p>
The ODE problem for this one-dimensional oscillatory motion reads

$$
\begin{equation}
m\ddot u + \mu mg\,\hbox{sign}(\dot u) + ku = 0,\quad u(0)=I,\ \dot u(0)=V\tp
\tag{2.107}
\end{equation}
$$

<p>
<b>a)</b>
Scale the problem.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_13_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_13_1">

<p>
Inserting the dimensionless dependent and independent variables,

$$ \bar u = \frac{u}{I},\quad \bar t = \frac{t}{t_c},$$

in the problem gives

$$ \frac{d^2\bar u}{d\bar t^2} + \frac{t_c^2\mu g}{I}\,\hbox{sign}\left(
\frac{d\bar u}{d\bar t}\right) + \frac{t_c^2k}{m}\bar u
= 0,\quad \bar u(0)=1,\ \frac{d\bar u}{d\bar t}(0)=\frac{Vt_c}{I}\tp
$$

As usual, we base the characteristic time on the friction-free
oscillations, which means a balance of the acceleration term and
the spring term. That is, \( t_c^2k/m = 1 \), and consequently
\( t_c = \sqrt{m/k} \).

$$ \frac{d^2\bar u}{d\bar t^2} + \frac{\mu mg}{kI}\,\hbox{sign}\left(
\frac{d\bar u}{d\bar t}\right) + \bar u
= 0,\quad \bar u(0)=1,\ \frac{d\bar u}{d\bar t}(0)=\frac{V\sqrt{mk}}{kI}\tp
$$

Introducing the dimensionless variables

$$ \alpha = \frac{\mu mg}{kI},\quad
\beta = \frac{V\sqrt{mk}}{kI},$$

the scaled problem can then be written

$$ \frac{d^2\bar u}{d\bar t^2} + \alpha\,\hbox{sign}\left(
\frac{d\bar u}{d\bar t}\right) + \bar u
= 0,\quad \bar u(0)=1,\ \frac{d\bar u}{d\bar t}(0)=\beta\tp
$$

The initial set of 6 parameters \( (\mu, m, g, k, I, V) \) are
reduced to 2 dimensionless combinations.

<p>
Let us check that the dimensionless parameters really are dimensionless.
From the original ODE we know that each term has the dimension of
force, i.e., \( [\hbox{MLT}^{-2}] \). Therefore, the friction coefficient
\( \mu \) is dimensionless
since \( mg \) has dimension \( [\hbox{MLT}^{-2}] \), and \( k \) has dimension
\( [\hbox{MT}^{-2}] \) since \( u \) has dimension \( [\hbox{L}] \).
Since \( I \) has the same dimension as \( u \), \( kI \) has the dimension of
\( [\hbox{MLT}^{-2}] \), which is the dimension of \( mg \), and \( \alpha \) is
dimensionless. The \( \beta \) parameter has dimensions
\( [\hbox{LT}^{-1}\hbox{M}^{1/2}\hbox{M}^{-1/2}\hbox{TL}^{-1}=[1] \).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Implement the scaled model. Simulate for \( \alpha = 0, 0.05, 0.1 \)
and \( \beta =0 \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_13_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_13_2">

<p>
We can use the package <a href="https://github.com/hplgit/odespy" target="_self">Odespy</a>
to solve the ODE. This requires rewriting the ODE as a system of two
first-order ODEs:

$$
\begin{align*}
v' &= - \alpha\,\hbox{sign}(v) - \bar u,\\ 
u' &= v,
\end{align*}
$$

with initial conditions \( v(0)=\beta \) and \( u(0)=1 \). Here, \( u(t) \) corresponds
to the previous \( \bar u(\bar t) \), while \( v(t) \) corresponds to
\( d\bar u/\bar t (\bar t) \). Appropriate code is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">simulate</span>(alpha, beta<span style="color: #666666">=0</span>,
             num_periods<span style="color: #666666">=8</span>, time_steps_per_period<span style="color: #666666">=60</span>):
    <span style="color: #408080; font-style: italic"># Use oscillations without friction to set dt and T</span>
    P <span style="color: #666666">=</span> <span style="color: #666666">2*</span>np<span style="color: #666666">.</span>pi
    dt <span style="color: #666666">=</span> P<span style="color: #666666">/</span>time_steps_per_period
    T <span style="color: #666666">=</span> num_periods<span style="color: #666666">*</span>P
    t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, T, time_steps_per_period<span style="color: #666666">*</span>num_periods<span style="color: #666666">+1</span>)
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">odespy</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(u, t, alpha):
        <span style="color: #408080; font-style: italic"># Note the sequence of unknowns: v, u (v=du/dt)</span>
        v, u <span style="color: #666666">=</span> u
        <span style="color: #008000; font-weight: bold">return</span> [<span style="color: #666666">-</span>alpha<span style="color: #666666">*</span>np<span style="color: #666666">.</span>sign(v) <span style="color: #666666">-</span> u, v]

    solver <span style="color: #666666">=</span> odespy<span style="color: #666666">.</span>RK4(f, f_args<span style="color: #666666">=</span>[alpha])
    solver<span style="color: #666666">.</span>set_initial_condition([beta, <span style="color: #666666">1</span>])  <span style="color: #408080; font-style: italic"># sequence must match f</span>
    uv, t <span style="color: #666666">=</span> solver<span style="color: #666666">.</span>solve(t)
    u <span style="color: #666666">=</span> uv[:,<span style="color: #666666">1</span>]  <span style="color: #408080; font-style: italic"># recall sequence in f: v, u</span>
    v <span style="color: #666666">=</span> uv[:,<span style="color: #666666">0</span>]
    <span style="color: #008000; font-weight: bold">return</span> u, t


<span style="color: #008000; font-weight: bold">if</span> __name__ <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;__main__&#39;</span>:
    alpha_values <span style="color: #666666">=</span> [<span style="color: #666666">0</span>, <span style="color: #666666">0.05</span>, <span style="color: #666666">0.1</span>]
    <span style="color: #008000; font-weight: bold">for</span> alpha <span style="color: #AA22FF; font-weight: bold">in</span> alpha_values:
        u, t <span style="color: #666666">=</span> simulate(alpha, <span style="color: #666666">0</span>, <span style="color: #666666">6</span>, <span style="color: #666666">60</span>)
        plt<span style="color: #666666">.</span>plot(t, u)
        plt<span style="color: #666666">.</span>hold(<span style="color: #BA2121">&#39;on&#39;</span>)
    plt<span style="color: #666666">.</span>legend([<span style="color: #BA2121">r&#39;$\alpha=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$&#39;</span> <span style="color: #666666">%</span> alpha <span style="color: #008000; font-weight: bold">for</span> alpha <span style="color: #AA22FF; font-weight: bold">in</span> alpha_values])
    plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">r&#39;$\bar t$&#39;</span>);  plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">r&#39;$\bar u$&#39;</span>)
    plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp.png&#39;</span>);   plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp.pdf&#39;</span>)
    plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
We find that simulating for 6 periods is relevant for \( \alpha=0, 0.05, 0.1 \).

<p>
<center><p><img src="fig-scaling/sliding_box.png" align="bottom" width=600></p></center>

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>sliding_box</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:pendulum">Problem 2.14: Pendulum equations</h2>

<p>
The equation for a so-called simple pendulum with a mass \( m \) at the end is

$$
\begin{equation}
mL\ddot\theta + mg\sin\theta = 0,
\tag{2.108}
\end{equation}
$$

where \( \theta(t) \) is the angle with the vertical, \( L \) is the length of
the pendulum, and \( g \) is the acceleration of gravity.

<p>
A physical pendulum with moment of inertia \( I \) is governed by
a similar equation,

$$
\begin{equation}
I\ddot\theta + mgL\sin\theta = 0\tp
\tag{2.109}
\end{equation}
$$

Both equations have the initial conditions \( \theta(0)=\Theta \) and
\( \theta'(0)=0 \) (start at rest).

<p>
<b>a)</b>
Use \( \theta \) as dimensionless unknown, find a proper time scale,
and scale both differential equations.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_14_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_14_1">

<p>
Introducing \( \bar t=t/t_c \) gives

$$
\begin{align*}
mL\frac{1}{t_c^2}\frac{d^2\theta}{d\bar t^2} + mg\sin\theta &= 0,\\ 
I\frac{1}{t_c^2}\frac{d^2\theta}{d\bar t^2} + mgL\sin\theta &= 0\tp
\end{align*}
$$

or on dimensionless form,

$$
\begin{align*}
\frac{d^2\theta}{d\bar t^2} + \frac{t_c^2g}{L}\sin\theta &= 0,\\ 
\frac{d^2\theta}{d\bar t^2} + \frac{t_c^2mgL}{I}\sin\theta &= 0\tp
\end{align*}
$$

An obvious choice to make the terms equal are \( t_c=\sqrt{L/g} \)
in the first equation and \( t_c=\sqrt{I/(mgL)} \) in the second.
These choices are also compatible with the frequencies if the
angle is small: \( \ddot\theta + g/L\theta = 0 \) has solution
of the type \( \sin(\omega t) \) with \( \omega = \sqrt{g/L} \), and then
\( t_c=1/\omega \) is a natural scale.

<p>
The dimensionless equations become equal in this case:

$$ \frac{d^2\theta}{d\bar t^2} + \sin\theta = 0\tp$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Some may argue that \( \theta \) is not dimensionless since it is measured
in radians. One may introduce a truly dimensionless angle \( \bar\theta
\in [0,1] \). Set up the scaled ODE problem in this case.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_14_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_14_2">

<p>
A \( \bar\theta
\in [0,1] \) is obtained by
\( \bar\theta = \theta/\Theta \).
The resulting equation, keeping the time scale as in a), then becomes

$$ \frac{d^2\bar\theta}{d\bar t^2} + \Theta^{-1}\sin(\Theta\bar\theta) = 0,$$

with boundary condition \( \bar\theta(0)=1 \). That is, the only
parameter \( \Theta \) either
remains in the ODE or in the initial condition.

<p>
There is another line of arguing here too, namely that one should choose
the time scale such that the two terms (acceleration and gravity)
balances. First we get

$$ \frac{d^2\bar\theta}{d\bar t^2} +
\frac{t_c^2g}{L\Theta}\sin(\Theta\bar\theta) = 0\tp$$

Demanding that the coefficient in the second term is also unity, makes
\( \Theta \) part of the time scale:

$$ t_c = \sqrt{\frac{L\Theta}{g}}\tp$$

However, we know that in the limit of small \( \theta \), doubling the initial
condition has no effect on the characteristic time, it only depends on
\( L/g \). Therefore this second line of thought will lead to in an appropriate
variation of \( \bar\theta \) with \( \bar t \). This conclusion can easily
be tested through simulations with the two scalings.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Simulate the problem in b) for \( \Theta = 1,20,45,60 \) measured in degrees.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_14_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_14_3">

<p>
We use <a href="https://github.com/hplgit/odespy" target="_self">Odespy</a>
to solve the ODE, rewritten as a system of first-order ODEs:
\( \bar\omega ' = -\Theta^{-1}\sin(\Theta\bar\theta) \) and
\( \bar\theta' = \bar\omega \). Appropriate code is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">simulate</span>(Theta, num_periods<span style="color: #666666">=8</span>, time_steps_per_period<span style="color: #666666">=60</span>,
             scaling<span style="color: #666666">=1</span>):
    <span style="color: #408080; font-style: italic"># Use oscillations for small Theta to set dt and T</span>
    P <span style="color: #666666">=</span> <span style="color: #666666">2*</span>np<span style="color: #666666">.</span>pi
    dt <span style="color: #666666">=</span> P<span style="color: #666666">/</span>time_steps_per_period
    T <span style="color: #666666">=</span> num_periods<span style="color: #666666">*</span>P
    t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, T, time_steps_per_period<span style="color: #666666">*</span>num_periods<span style="color: #666666">+1</span>)
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">odespy</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(u, t, Theta):
        <span style="color: #408080; font-style: italic"># Note the sequence of unknowns: omega, theta</span>
        <span style="color: #408080; font-style: italic"># omega = d(theta)/dt, angular velocity</span>
        omega, theta <span style="color: #666666">=</span> u
        <span style="color: #008000; font-weight: bold">return</span> [<span style="color: #666666">-</span>Theta<span style="color: #666666">**</span>(<span style="color: #666666">-1</span>)<span style="color: #666666">*</span>np<span style="color: #666666">.</span>sin(Theta<span style="color: #666666">*</span>theta), omega]

    solver <span style="color: #666666">=</span> odespy<span style="color: #666666">.</span>RK4(f, f_args<span style="color: #666666">=</span>[Theta])
    solver<span style="color: #666666">.</span>set_initial_condition([<span style="color: #666666">0</span>, <span style="color: #666666">1</span>]) <span style="color: #408080; font-style: italic"># sequence must match f</span>
    u, t <span style="color: #666666">=</span> solver<span style="color: #666666">.</span>solve(t)
    theta <span style="color: #666666">=</span> u[:,<span style="color: #666666">1</span>]  <span style="color: #408080; font-style: italic"># recall sequence in f: omega, theta</span>
    <span style="color: #008000; font-weight: bold">return</span> theta, t


<span style="color: #008000; font-weight: bold">if</span> __name__ <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;__main__&#39;</span>:
    Theta_values_degrees <span style="color: #666666">=</span> [<span style="color: #666666">1</span>, <span style="color: #666666">20</span>, <span style="color: #666666">45</span>, <span style="color: #666666">60</span>]
    <span style="color: #008000; font-weight: bold">for</span> Theta_degrees <span style="color: #AA22FF; font-weight: bold">in</span> Theta_values_degrees:
        Theta <span style="color: #666666">=</span> Theta_degrees<span style="color: #666666">*</span>np<span style="color: #666666">.</span>pi<span style="color: #666666">/180</span>
        theta, t <span style="color: #666666">=</span> simulate(Theta, <span style="color: #666666">6</span>, <span style="color: #666666">60</span>)
        plt<span style="color: #666666">.</span>plot(t, theta)
        plt<span style="color: #666666">.</span>hold(<span style="color: #BA2121">&#39;on&#39;</span>)
    plt<span style="color: #666666">.</span>legend([<span style="color: #BA2121">r&#39;$\Theta=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$&#39;</span> <span style="color: #666666">%</span> Theta
                <span style="color: #008000; font-weight: bold">for</span> Theta <span style="color: #AA22FF; font-weight: bold">in</span> Theta_values_degrees],
               loc<span style="color: #666666">=</span><span style="color: #BA2121">&#39;lower left&#39;</span>)
    plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">r&#39;$\bar t$&#39;</span>);  plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">r&#39;$\bar\theta$&#39;</span>)
    plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp.png&#39;</span>);   plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp.pdf&#39;</span>)
    plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
<center><p><img src="fig-scaling/pendulum.png" align="bottom" width=600></p></center>

<p>
We clearly see that increasing the amplitude \( \Theta \) increases the period of
the oscillations.

<p>
<b>Remark.</b>
The scaling in b) is more suitable for comparing
graphs than the scaling in a) since all the curves have the
same amplitude, just different frequency/period. With the scaling in
a), we would also get a major difference in amplitudes.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>pendulum</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:binary_star">Exercise 2.15: ODEs for a binary star</h2>

<p>
The equations for a <a href="https://en.wikipedia.org/wiki/Binary_star" target="_self">binary star</a>,
or a planet and a moon, are

$$
\begin{align}
m_A\ddot\x_A &= \F,
\tag{2.110}\\ 
m_B\ddot\x_B &= -\F,
\tag{2.111}
\end{align}
$$

where \( \x_A \) is the position of object (star) A, and \( \x_B \) is the position
object B. The corresponding masses are \( m_A \) and \( m_B \).
The only force is the gravity force

$$ \F = \frac{Gm_Am_B}{||\rpos||^3}\rpos,$$

where

$$ \rpos(t) = \x_B(t) - \x_A(t),$$

and \( G \) is the gravitational constant: \( G=6.674\cdot 10^{-11}\hbox{ Nm}^2/\hbox{kg}^2 \). A problem with these equations is that the parameters are very large
(\( m_A \), \( m_B \), \( ||\rpos|| \)) or very small (\( G \)). The rotation time
for binary stars can be very small and large as well.

<p>
<b>a)</b>
Scale the equations.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_15_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_15_1">

<p>
A natural length scale could be the initial distance between the objects:
\( L=\rpos(0) \). We write the dimensionless quantities as

$$ \bar\x_A = \frac{\x_A}{L},\quad\bar\x_B = \frac{\x_B}{L},\quad
\bar t = \frac{t}{t_c}\tp$$

The gravity force is transformed to

$$ \F = \frac{Gm_Am_B}{L^2||\bar\rpos||^3}\bar\rpos,\quad \bar\rpos = \bar\x_B - \bar\x_A,$$

so the first ODE for \( \x_A \) becomes

$$ \frac{d^2 \bar\x_A}{d\bar t^2} =
\frac{Gm_Bt_c^2}{L^3}\frac{\bar\rpos}{||\bar\rpos||^3}\tp$$

Assuming that quantities with a bar and their derivatives are around unity
in size, it is natural to choose \( t_c \) such that the fraction \( Gm_Bt_c/L^2=1 \):

$$ t_c = \sqrt{\frac{L^3}{Gm_B}}\tp$$

From the other equation for \( \x_B \) we get another candidate for \( t_c \) with
\( m_A \) instead of \( m_B \). Which mass we choose play a role if \( m_A\ll m_B \) or
\( m_B\ll m_A \). One solution is to use the sum of the masses:

$$ t_c = \sqrt{\frac{L^3}{G(m_A+m_B)}}\tp$$

Taking a look at <a href="https://en.wikipedia.org/wiki/Kepler%27s_laws_of_planetary_motion" target="_self">Kepler's laws</a> of planetary motion, the orbital period for a planet around the star is given by the \( t_c \) above, except for a missing factor of \( 2\pi \),
but that means that \( t_c^{-1} \) is just the angular frequency of the motion.
Our characteristic time \( t_c \) is therefore highly relevant.
Introducing the dimensionless number

$$ \alpha = \frac{m_A}{m_B},$$

we can write the dimensionless ODE as

$$
\begin{align}
\frac{d^2 \bar\x_A}{d\bar t^2} &=
\frac{1}{1+\alpha}\frac{\bar\rpos}{||\bar\rpos||^3},
\tag{2.112}\\ 
\frac{d^2 \bar\x_B}{d\bar t^2} &=
\frac{1}{1+\alpha^{-1}}\frac{\bar\rpos}{||\bar\rpos||^3}\tp
\tag{2.113}
\end{align}
$$

<p>
In the limit \( m_A\ll m_B \), i.e., \( \alpha\ll 1 \),
object B stands still, say \( \bar\x_B=0 \), and object
A orbits according to

$$ \frac{d^2 \bar\x_A}{d\bar t^2} = -\frac{\bar\x_A}{||\bar \x_A||^3}\tp$$

To better see the motion, and that our scaling is reasonable,
we introduce polar coordinates \( r \) and \( \theta \):

$$ \bar\x_A = r\cos\theta\ii + r\sin\theta\jj,$$

which means \( \bar\x_A \) can be written as \( \bar\x_A =r\ir \). Since

$$ \frac{d}{dt}\ir = \dot\theta\ith,\quad \frac{d}{dt}\ith = -\dot\theta\ir,$$

we have

$$ \frac{d^2 \bar\x_A}{d\bar t^2} =
(\ddot r - r\dot\theta^2)\ir + (r\ddot\theta + 2\dot r\dot\theta)\ith\tp
$$

The equation of motion for mass A is then

$$
\begin{align*}
\ddot r - r\dot\theta^2 &= -\frac{1}{r^2},\\ 
r\ddot\theta + 2\dot r\dot\theta &= 0\tp
\end{align*}
$$

The special case of circular motion, \( r=1 \), fulfills the equations, since
the latter equation then gives \( \dot\theta =\hbox{const} \) and
the former then gives \( \dot\theta = 1 \), i.e., the motion is
\( r(t)=1 \), \( \theta(t)=t \), with unit angular frequency as expected and
period \( 2\pi \) as expected.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Solve the scaled equations numerically for two cases:

<ol>
<li> a planet around a star:
   \( \alpha = 10^{-3} \), \( \x_A(0)=(1,0) \), \( \dot\x_A(0)=(0,1) \),
   \( \x_B(0)=0 \), \( \dot\x_B(0)=0 \)</li>
<li> two stars:
   \( \alpha = \half \), \( \x_A(0)=(1,0) \), \( \dot\x_A(0)=(0,\half) \),
   \( \x_B(0)=0 \), \( \dot\x_B(0)=(0,-\half) \)</li>
</ol>

An assumption here is that the orbits are co-planar such that they can
be taken to lie in the \( xy \) plane.

<p>
Here is a movie of two rotating stars (point 2 above):

<p>

<div>
<video  loop controls width='640' height='365' preload='none'>
    <source src='mov-scaling/binary_star/movie.mp4'  type='video/mp4;  codecs="avc1.42E01E, mp4a.40.2"'>
    <source src='mov-scaling/binary_star/movie.webm' type='video/webm; codecs="vp8, vorbis"'>
    <source src='mov-scaling/binary_star/movie.ogg'  type='video/ogg;  codecs="theora, vorbis"'>
</video>
</div>
<p><em></em></p>

<!-- Issue warning if in a Safari browser -->
<script language="javascript">
if (!!(window.safari)) {
  document.write("<div style=\"width: 95%%; padding: 10px; border: 1px solid #100; border-radius: 4px;\"><p><font color=\"red\">The above movie will not play in Safari - use Chrome, Firefox, or Opera.</font></p></div>")}
</script>

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_15_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_15_2">

<p>
Here is an appropriate program
(using <a href="https://github.com/hplgit/scitools" target="_self">SciTools</a>
for simpler animation code than required by Matplotlib):

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic">#import matplotlib.pyplot as plt</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">scitools.std</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">odespy</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">solver</span>(alpha, ic, T, dt<span style="color: #666666">=0.05</span>):
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(u, t):
        x_A, vx_A, y_A, vy_A, x_B, vx_B, y_B, vy_B <span style="color: #666666">=</span> u
        distance3 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>sqrt((x_B<span style="color: #666666">-</span>x_A)<span style="color: #666666">**2</span> <span style="color: #666666">+</span> (y_B<span style="color: #666666">-</span>y_A)<span style="color: #666666">**2</span>)<span style="color: #666666">**3</span>
        system <span style="color: #666666">=</span> [
            vx_A,
            <span style="color: #666666">1/</span>(<span style="color: #666666">1.0</span> <span style="color: #666666">+</span> alpha)<span style="color: #666666">*</span>(x_B <span style="color: #666666">-</span> x_A)<span style="color: #666666">/</span>distance3,
            vy_A,
            <span style="color: #666666">1/</span>(<span style="color: #666666">1.0</span> <span style="color: #666666">+</span> alpha)<span style="color: #666666">*</span>(y_B <span style="color: #666666">-</span> y_A)<span style="color: #666666">/</span>distance3,
            vx_B,
            <span style="color: #666666">-1/</span>(<span style="color: #666666">1.0</span> <span style="color: #666666">+</span> alpha<span style="color: #666666">**</span>(<span style="color: #666666">-1</span>))<span style="color: #666666">*</span>(x_B <span style="color: #666666">-</span> x_A)<span style="color: #666666">/</span>distance3,
            vy_B,
            <span style="color: #666666">-1/</span>(<span style="color: #666666">1.0</span> <span style="color: #666666">+</span> alpha<span style="color: #666666">**</span>(<span style="color: #666666">-1</span>))<span style="color: #666666">*</span>(y_B <span style="color: #666666">-</span> y_A)<span style="color: #666666">/</span>distance3,
            ]
        <span style="color: #008000; font-weight: bold">return</span> system

    Nt <span style="color: #666666">=</span> <span style="color: #008000">int</span>(<span style="color: #008000">round</span>(T<span style="color: #666666">/</span>dt))
    t_mesh <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, Nt<span style="color: #666666">*</span>dt, Nt<span style="color: #666666">+1</span>)

    solver <span style="color: #666666">=</span> odespy<span style="color: #666666">.</span>RK4(f)
    solver<span style="color: #666666">.</span>set_initial_condition(ic)
    u, t <span style="color: #666666">=</span> solver<span style="color: #666666">.</span>solve(t_mesh)
    x_A <span style="color: #666666">=</span> u[:,<span style="color: #666666">0</span>]
    x_B <span style="color: #666666">=</span> u[:,<span style="color: #666666">2</span>]
    y_A <span style="color: #666666">=</span> u[:,<span style="color: #666666">4</span>]
    y_B <span style="color: #666666">=</span> u[:,<span style="color: #666666">6</span>]
    <span style="color: #008000; font-weight: bold">return</span> x_A, x_B, y_A, y_B, t

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">demo_circular</span>():
    <span style="color: #408080; font-style: italic"># Mass B is at rest at the origin,</span>
    <span style="color: #408080; font-style: italic"># mass A is at (1, 0) with vel. (0, 1)</span>
    ic <span style="color: #666666">=</span> [<span style="color: #666666">1</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>]
    x_A, x_B, y_A, y_B, t <span style="color: #666666">=</span> solver(
        alpha<span style="color: #666666">=0.001</span>, ic<span style="color: #666666">=</span>ic, T<span style="color: #666666">=2*</span>np<span style="color: #666666">.</span>pi, dt<span style="color: #666666">=0.01</span>)
    plt<span style="color: #666666">.</span>plot(x_A, x_B, <span style="color: #BA2121">&#39;r2-&#39;</span>, y_A, y_B, <span style="color: #BA2121">&#39;b2-&#39;</span>,
             legend<span style="color: #666666">=</span>[<span style="color: #BA2121">&#39;A&#39;</span>, <span style="color: #BA2121">&#39;B&#39;</span>],
             daspectmode<span style="color: #666666">=</span><span style="color: #BA2121">&#39;equal&#39;</span>) <span style="color: #408080; font-style: italic"># x and y axis have same scaling</span>
    plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp_circular.png&#39;</span>)
    plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp_circular.pdf&#39;</span>)
    plt<span style="color: #666666">.</span>show()

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">demo_two_stars</span>(animate<span style="color: #666666">=</span><span style="color: #008000">True</span>):
    <span style="color: #408080; font-style: italic"># Initial condition</span>
    ic <span style="color: #666666">=</span> [<span style="color: #666666">0.6</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">1</span>,   <span style="color: #408080; font-style: italic"># star A: velocity (0,1)</span>
          <span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">-0.5</span>]  <span style="color: #408080; font-style: italic"># star B: velocity (0,-0.5)</span>
    <span style="color: #408080; font-style: italic"># Solve ODEs</span>
    x_A, x_B, y_A, y_B, t <span style="color: #666666">=</span> solver(
        alpha<span style="color: #666666">=0.5</span>, ic<span style="color: #666666">=</span>ic, T<span style="color: #666666">=4*</span>np<span style="color: #666666">.</span>pi, dt<span style="color: #666666">=0.05</span>)
    <span style="color: #008000; font-weight: bold">if</span> animate:
        <span style="color: #408080; font-style: italic"># Animate motion and draw the objects&#39; paths in time</span>
        <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(x_A)):
            plt<span style="color: #666666">.</span>plot(x_A[:i<span style="color: #666666">+1</span>], x_B[:i<span style="color: #666666">+1</span>], <span style="color: #BA2121">&#39;r-&#39;</span>,
                     y_A[:i<span style="color: #666666">+1</span>], y_B[:i<span style="color: #666666">+1</span>], <span style="color: #BA2121">&#39;b-&#39;</span>,
                     [x_A[<span style="color: #666666">0</span>], x_A[i]], [x_B[<span style="color: #666666">0</span>], x_B[i]], <span style="color: #BA2121">&#39;r2o&#39;</span>,
                     [y_A[<span style="color: #666666">0</span>], y_A[i]], [y_B[<span style="color: #666666">0</span>], y_B[i]], <span style="color: #BA2121">&#39;b4o&#39;</span>,
                     daspectmode<span style="color: #666666">=</span><span style="color: #BA2121">&#39;equal&#39;</span>,  <span style="color: #408080; font-style: italic"># axes aspect</span>
                     legend<span style="color: #666666">=</span>[<span style="color: #BA2121">&#39;A&#39;</span>, <span style="color: #BA2121">&#39;B&#39;</span>, <span style="color: #BA2121">&#39;A&#39;</span>, <span style="color: #BA2121">&#39;B&#39;</span>],
                     axis<span style="color: #666666">=</span>[<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>, <span style="color: #666666">-1</span>, <span style="color: #666666">1</span>],
                     savefig<span style="color: #666666">=</span><span style="color: #BA2121">&#39;tmp_</span><span style="color: #BB6688; font-weight: bold">%04d</span><span style="color: #BA2121">.png&#39;</span> <span style="color: #666666">%</span> i,
                     title<span style="color: #666666">=</span><span style="color: #BA2121">&#39;t=</span><span style="color: #BB6688; font-weight: bold">%.2f</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> t[i])
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #408080; font-style: italic"># Make a simple static plot of the solution</span>
        plt<span style="color: #666666">.</span>plot(x_A, x_B, <span style="color: #BA2121">&#39;r-&#39;</span>, y_A, y_B, <span style="color: #BA2121">&#39;b-&#39;</span>,
                 daspectmode<span style="color: #666666">=</span><span style="color: #BA2121">&#39;equal&#39;</span>, legend<span style="color: #666666">=</span>[<span style="color: #BA2121">&#39;A&#39;</span>, <span style="color: #BA2121">&#39;B&#39;</span>],
                 axis<span style="color: #666666">=</span>[<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>, <span style="color: #666666">-1</span>, <span style="color: #666666">1</span>], savefig<span style="color: #666666">=</span><span style="color: #BA2121">&#39;tmp_two_stars.png&#39;</span>)
    <span style="color: #408080; font-style: italic">#plt.axes().set_aspect(&#39;equal&#39;)  # mpl</span>
    plt<span style="color: #666666">.</span>show()

<span style="color: #008000; font-weight: bold">if</span> __name__ <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;__main__&#39;</span>:
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sys</span>
    <span style="color: #008000; font-weight: bold">if</span> sys<span style="color: #666666">.</span>argv[<span style="color: #666666">1</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;circular&#39;</span>:
        demo_circular()
    <span style="color: #008000; font-weight: bold">else</span>:
        demo_two_stars(<span style="color: #008000">True</span>)
    <span style="color: #008000">raw_input</span>()
</pre></div>
<p>
We remark that the sequence of unknowns in <code>u</code> must be different if the
<code>odespy.EulerCromer</code> solver is to be chosen. In that case, the
velocity for each degree of freedom must appear before the position.

<p>
<center>  <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 15:  Planet in circular motion around a star. </p></center>
<p><img src="fig-scaling/planet_circular.png" align="bottom" width=500></p>
</center>

<p>
<center>  <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 16:  Two rotating stars. </p></center>
<p><img src="mov-scaling/binary_star/tmp_0100.png" align="bottom" width=500></p>
</center>

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>binary_star</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:Duffing">Problem 2.16: Duffing's equation</h2>

<p>
Duffing's equation is a vibration equation with linear and cubic
spring terms:

$$ mu'' + k_0u + k_1u^3 = 0,\quad u(0)=U_0,\ u'(0)=0\tp$$

Scale this problem.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_16_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_16_1">

<p>
We introduce \( \bar t = t/t_c \) and \( \bar u = u/u_c \):

$$ mt_c^{-2}u_c\bar u'' + k_0u_c\bar u + k_1u_c^3\bar u^3=,\quad
u_c\bar u(0)=U_0,\ u_c\bar u'(0)=0\tp$$

Choosing \( t_c \) as in a linear vibration problem, \( t_c = \sqrt{m/k_0} \),
and \( u_c=U_0 \), we get

$$ \bar u'' + \bar u + \alpha u^3 = 0,\quad \bar u(0)=1,\ \bar u'(0)=0,$$

where

$$ \alpha = U_0^2\frac{k_1}{k_0},$$

is a dimensionless parameter reflecting the ratio of the
cubic spring term \( k_1U_0^3 \) and the linear spring term \( k_0U_0 \)
at maximum displacement.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>Duffing_eq</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:rocket">Problem 2.17: Vertical motion in a varying gravity field</h2>

<p>
A body (e.g., projectile or rocket) is launched vertically
from the surface of the earth with
velocity \( V \). The body's distance (height) from the earth's surface
at time \( t \) is represented by the function \( h(t) \).
Unless \( h \) is very much smaller than the earth's radius \( R \), the motion
takes place in a varying gravity field. The governing ODE problem for
\( h(t) \) is then

$$
\begin{equation}
h''(t) = -\frac{R^2g}{(h+R)^2},\quad h(0)=0,\ h'(0)=V,\quad t\in (0,T],
\tag{2.114}
\end{equation}
$$

where \( g \) is the acceleration of gravity at the earth's surface.

<p>
The goal is to discuss three scalings of this problem. First we introduce

$$ \bar h = \frac{h}{h_c},\quad \bar t = \frac{t}{t_c},$$

which gives the dimensionless ODE

$$
\frac{d^2\bar h}{d\bar t^2} = -\frac{t_c^2}{h_c}\frac{R^2g}{(h_c\bar h+R)^2}
= -\frac{t_c^2}{h_c^3}\frac{R^2g}{\left(\bar h+ R/h_c\right)^2}
$$

and the dimensionless initial condition

$$ \frac{d\bar h}{d\bar t}(0) = \frac{t_cV}{h_c}\tp$$

The key dimensionless variable in this problem turns out to be

$$ \epsilon = \frac{V}{\sqrt{Rg}}\tp$$

<p>
<b>a)</b>
Assume we study the motion over long distances such that
\( h \) may be of the same size as \( R \). In this case, \( h_c=R \) is a
reasonable choice. Determine \( t_c \) from requiring the initial velocity
to be unity. Set up the dimensionless ODE problem.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_17_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_17_1">

<p>
The suggested requirement leads to

$$ \frac{t_cV}{h_c} = \frac{t_cV}{R} = 1\quad\Rightarrow\quad
t_c = \frac{R}{V}\tp$$

Inserting this \( t_c \) in the ODE gives the scaled ODE problem

$$
\frac{d^2\bar h}{d\bar t^2} =
-\frac{1}{\epsilon^{2}\left(1 + \bar h\right)^2},
\quad \bar h(0)=0,\ \frac{d\bar h}{d\bar t}(0)=1\tp$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
As a), but determine \( t_c \) by demanding both terms in the scaled ODE to
have unit coefficients.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_17_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_17_2">

<p>
We set

$$ \frac{t_c^2}{h_c^3}R^2g = \frac{t_c^2g}{R}=1\quad\Rightarrow\quad
t_c = \sqrt{\frac{R}{g}}\tp$$

The initial condition then becomes

$$ \frac{d\bar h}{d\bar t}(0) = \frac{V}{\sqrt{Rg}} = \epsilon\tp$$

The scaled ODE problem is now

$$ \frac{d^2\bar h}{d\bar t^2} = -\frac{1}{\left(1 + \bar h\right)^2},
\quad \bar h(0)=0,\ \frac{d\bar h}{d\bar t}(0)=\epsilon\tp$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
For small initial velocity \( V \), \( h \) will be small compared to \( R \).
In the limit \( h/R\rightarrow 0 \),
the governing equation simplifies to the well-known motion in a
constant gravity field: \( h''=-g \). Use this model to suggest a time and
length scale, and derive a dimensionless ODE problem.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_17_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_17_3">

<p>
The solution of \( h''=-g \) with \( h(0) \) and \( h'(0)=V \) is easily obtained
by integrating twice: \( h=-\half gt^2 +Vt \). The maximum height reached
by the body is found by setting \( h'(t)=0 \): \( V-gt=0 \), which suggests
a corresponding characteristic time \( t_c = V/g \). The responding maximum height
\( h(t_c)=\half V^2/g \) can be used as characteristic height: \( h_c=\half V^2/g \).
The factor \( \half \) is not important, and the ODE problem looks nicer without
it, so we simply set \( h_c=V^2/g \).
Inserted in the initial condition, we get

$$ \frac{d\bar h}{d\bar t}(0) = \frac{Vt_c}{h_c}= 1\tp$$

The scaled ODE takes the form

$$
\frac{d^2\bar h}{d\bar t^2}
= -\frac{\epsilon^{-4}}{\left(\bar h+2\epsilon^{-2}\right)^2}
= -\frac{1}{\left(1 + \epsilon^2\bar h\right)^2}\tp
$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>d)</b>
Give an interpretation of the dimensionless parameter \( \epsilon \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_17_4" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_17_4">

<p>
We know from c) that the characteristic height in the constant gravity
limit is \( V^2/g \). We can therefore write

$$ \epsilon^2 = \frac{V^2/g}{R},$$

which shows that \( \epsilon^2 \)
is the ratio of the height for small \( V \), i.e., motion in a constant gravity
field, and the earth's radius. A small \( \epsilon \) means that we can
neglect varying gravity.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>e)</b>
Solve numerically for \( \bar h(\bar t) \) in each of the three scalings in
a), b), and c), with \( \epsilon^2 =0.01, 0.1, 0.5, 1, 2 \).
When are the various scalings appropriate? (That is, when are \( \bar t \)
and \( \bar h \) of size unity or at least not very small or big?)

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_17_5" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_17_5">

<p>
For numerical solution we rewrite the ODE as a system of two first-order
ODEs by introducing a new variable \( \bar v \) (velocity): \( \bar h'=\bar v \),
\( \bar v' = ... \).
Here is a code that employs <a href="https://github.com/hplgit/odespy" target="_self">Odespy</a>
to solve the system of first-order ODEs:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">odespy</span><span style="color: #666666">,</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">varying_gravity</span>(epsilon):
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ode_a</span>(u, t):
        h, v <span style="color: #666666">=</span> u
        <span style="color: #008000; font-weight: bold">return</span> [v, <span style="color: #666666">-</span>epsilon<span style="color: #666666">**</span>(<span style="color: #666666">-2</span>)<span style="color: #666666">/</span>(<span style="color: #666666">1</span> <span style="color: #666666">+</span> h)<span style="color: #666666">**2</span>]

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ode_b</span>(u, t):
        h, v <span style="color: #666666">=</span> u
        <span style="color: #008000; font-weight: bold">return</span> [v, <span style="color: #666666">-1.0/</span>(<span style="color: #666666">1</span> <span style="color: #666666">+</span> h)<span style="color: #666666">**2</span>]

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ode_c</span>(u, t):
        h, v <span style="color: #666666">=</span> u
        <span style="color: #008000; font-weight: bold">return</span> [v, <span style="color: #666666">-1.0/</span>(<span style="color: #666666">1</span> <span style="color: #666666">+</span> epsilon<span style="color: #666666">**2*</span>h)<span style="color: #666666">**2</span>]

    problems <span style="color: #666666">=</span> [ode_a, ode_b, ode_c]     <span style="color: #408080; font-style: italic"># right-hand sides</span>
    ics <span style="color: #666666">=</span> [[<span style="color: #666666">0</span>, <span style="color: #666666">1</span>], [<span style="color: #666666">0</span>, epsilon], [<span style="color: #666666">0</span>, <span style="color: #666666">1</span>]] <span style="color: #408080; font-style: italic"># initial conditions</span>
    <span style="color: #008000; font-weight: bold">for</span> problem, ic, legend <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">zip</span>(problems, ics, [<span style="color: #BA2121">&#39;a&#39;</span>, <span style="color: #BA2121">&#39;b&#39;</span>, <span style="color: #BA2121">&#39;c&#39;</span>]):
        solver <span style="color: #666666">=</span> odespy<span style="color: #666666">.</span>RK4(problem)
        solver<span style="color: #666666">.</span>set_initial_condition(ic)
        t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">5</span>, <span style="color: #666666">5001</span>)
        <span style="color: #408080; font-style: italic"># Solve ODE until h &lt; 0 (h is in u[:,0])</span>
        u, t <span style="color: #666666">=</span> solver<span style="color: #666666">.</span>solve(t, terminate<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> u, t, n: u[n,<span style="color: #666666">0</span>] <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>)
        h <span style="color: #666666">=</span> u[:,<span style="color: #666666">0</span>]

        plt<span style="color: #666666">.</span>figure()
        plt<span style="color: #666666">.</span>plot(t, h)
        plt<span style="color: #666666">.</span>legend(legend, loc<span style="color: #666666">=</span><span style="color: #BA2121">&#39;upper left&#39;</span>)
        plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">r&#39;$\epsilon^2=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$&#39;</span> <span style="color: #666666">%</span> epsilon<span style="color: #666666">**2</span>)
        plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">r&#39;$\bar t$&#39;</span>);  plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">r&#39;$\bar h(\bar t)$&#39;</span>)
        plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp_</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">.png&#39;</span> <span style="color: #666666">%</span> legend)
        plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp_</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">.pdf&#39;</span> <span style="color: #666666">%</span> legend)
</pre></div>
<p>
Recall from d) that \( \epsilon^2 \) is the ratio of the height reached
in a constant gravity field and the earth's radius.
The figures below show the results for \( \epsilon^2=0.01,0.1,0.5, 1, 2 \),
respectively.

<p>
<center><p><img src="fig-scaling/varying_gravity_0_01.png" align="bottom" width=800></p></center>

<p>
<center><p><img src="fig-scaling/varying_gravity_0_1.png" align="bottom" width=800></p></center>

<p>
<center><p><img src="fig-scaling/varying_gravity_0_5.png" align="bottom" width=800></p></center>

<p>
<center><p><img src="fig-scaling/varying_gravity_1.png" align="bottom" width=800></p></center>

<p>
<center><p><img src="fig-scaling/varying_gravity_2.png" align="bottom" width=800></p></center>

<p>
For \( \epsilon \) small (\( \epsilon^2 =0.01, 0.1 \)), we see that the scaling in
c) is most relevant since the scalings in a) and b) give small
\( \bar h \) and \( \bar t \).  For \( \epsilon=1 \), all
three scalings are equal.  For larger \( \epsilon \), the body does not
return to the earth. The scalings in a) and c) become equal in the
limit \( \epsilon\rightarrow\infty \), but they are already quite similar
for \( \epsilon = \sqrt{2} \) according to the bottom figure above.
The scaling in c) is therefore the most appealing one since it works
for small as well as large \( \epsilon \) and become close to the others
for \( \epsilon \) around unity.

<p>
<b>Remark.</b>
The present problem is one of the few problems that is
discussed at length in the literature, see
Logan <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#Logan_1987">[2]</a> or Lin and Segel <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#Lin_Segel">[8]</a>.
The standard argument is that the scaling in c) is favorable since
it is the only scaling that is valid as \( \epsilon\rightarrow 0 \). However,
that it is robust also for the larger relevant values of \( \epsilon \) is
something that is only clear when we solve the three problems
numerically.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>varying_gravity</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:quantum">Problem 2.18: A simplified Schroedinger equation</h2>

<p>
A simplified stationary
Schroedinger's equation for one electron, assuming radial symmetry, takes
the form

$$
\begin{equation}
-\frac{\hbar^2}{2m}
\frac{1}{r^2}\frac{d}{dr}\left(r^2\frac{d}{dr}\right) R
+ V(r)R = ER,
\tag{2.115}
\end{equation}
$$

where \( r \) is the radial coordinate, \( R \) is the wave function,
\( \hbar \) is Planck's constant, \( m \) is the mass of the electron,
\( V= \) is the force potential, which is here taken as the
Coulomb potential \( V(r) = {e^2}/(8\pi\epsilon_0 r) \)
(where \( e \) is the charge of the electron and \( \epsilon_0 \) is the
permittivity of free space), and \( E \) is
the eigenvalue, for the energy, to be determined along with \( R(r) \).

<p>
Show that the scaled version of <a href="#mjx-eqn-2.115">(2.115)</a> can be written

$$
\begin{equation}
- \left(\frac{1}{\bar r^2}\frac{d}{d\bar r}\bar r^2
\frac{d}{d\bar r}\right)
\bar R + \frac{1}{\bar r}\bar R = \lambda\bar R,
\tag{2.116}
\end{equation}
$$

where \( \lambda \) is a dimensionless eigenvalue

$$ \lambda = \frac{(4\pi)^2\epsilon_0^2\hbar^2E}{me^4}\tp$$

The symbol \( \bar r \) is the scaled coordinate, and \( \bar R \) is a scaled
version of \( R \) (the scaling factor drops out of the equation).
The length scale, which arises naturally, is the
<a href="https://en.wikipedia.org/wiki/Bohr_radius" target="_self">Bohr radius</a>.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_18_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_18_1">

<p>
We introduce

$$ \bar r = \frac{r}{r_c},\quad\bar R = \frac{R}{R_c},$$

and insert these expressions in the differential equation.
Multiplying with \( 2mr_c^2/\hbar^2 \) we get

$$
-\left(\frac{1}{\bar r^2}\frac{d}{d\bar r}\left(\bar r^2\frac{d}{d\bar r}
\right)\right) \bar R
+ \frac{me^2r_c}{4\pi\epsilon_0\hbar^2}\frac{1}{\bar r}\bar R =
\frac{2Emr_c^2}{\hbar^2}R\tp
$$

Note that all the \( R_c \) factors cancel.

<p>
Balance of the two terms on the left-hand side suggests that the
length scale \( r_c \) can be determined from requiring

$$ \frac{me^2r_c}{4\pi\epsilon_0\hbar^2} = 1,$$

i.e.,

$$ r_c = \frac{4\pi\epsilon_0\hbar^2}{me^2},$$

which is actually the Bohr radius,
demonstrating that the balance of the terms on the left-hand side automatically
determines a very relevant length scale.

<p>
A bit of arithmetics in the right-hand side term gives the
given expression for \( \lambda \). We then end up with
<a href="#mjx-eqn-2.116">(2.116)</a>.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>Schroedinger</code>.

<p>
<!-- Closing remarks for this Problem -->

<h3 id="___sec113">Remarks </h3>

<p>
Introducing \( u=\bar r\bar R \) and renaming \( \bar r \) to \( x \),
<a href="#mjx-eqn-2.116">(2.116)</a> can be recast in the simpler form

$$ -u''(x) + \frac{1}{x}u(x) = \lambda u(x),$$

which is a simpler eigenvalue problem to solve numerically (the boundary
conditions are \( u(0)=0 \) and \( \lim_{x\rightarrow\infty}u(x)=0 \)).

<p>
<!-- --- end exercise --- -->

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>


</body>
</html>
    

