<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Scaling of Differential Equations">
<meta name="keywords" content="units,base unit,length,mass,time,dimension of physical quantities,units US,units British,units conversion,units software,multiple software runs,web interface (Parampool),graphical web interface,scaling,non-dimensionalization,dimensionless variable,exponential decay,dimensionless variable,characteristic time,e-folding time,memoize function,dimensionless number,dimensionless number,dimensionless number,logistic equation,dimensionless number,frequency,frequency, angular,period (of oscillations),radians,angular frequency,quality factor $Q$,phase shift,dimensionless number,Peclet number,dimensionless number,Reynolds number,Navier-Stokes equations,dimensionless number,Reynolds number,Reynolds number,low Reynolds number flow,Stokes problem,Stokes' flow,Froude number,creeping flow,Strouhal number,vortex shedding,Euler number,Weber number,forced convection,Peclet number,Reynolds number,free convection,Grashof number,Reynolds number,Peclet number,Eckert number,Nusselt number,Lotka-Volterra, predator-pray model,Lotka-Volterra, competing species model">

<title>Scaling of Differential Equations</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [('Preface', 0, 'ch:preface', 'ch:preface'),
              ('Dimensions and units', 0, 'scale:dimunit', 'scale:dimunit'),
              ('Fundamental concepts', 1, None, '___sec2'),
              ('Base units and dimensions', 2, None, '___sec3'),
              ('Dimensions of common physical quantities',
               2,
               None,
               '___sec4'),
              ('Prefixes for units', 2, None, '___sec5'),
              ('Unit systems', 2, None, '___sec6'),
              ('PhysicalQuantity: object for computing with units',
               2,
               'scale:PQ',
               'scale:PQ'),
              ('Parampool: user interfaces with automatic unit conversion',
               1,
               'scale:parampool',
               'scale:parampool'),
              ('Example application', 3, None, '___sec9'),
              ('Pool of parameters', 2, None, '___sec10'),
              ('Fetching pool data for computing', 2, None, '___sec11'),
              ('Reading command-line options', 2, None, '___sec12'),
              ('Setting default values in a file', 2, None, '___sec13'),
              ('Specifying multiple values of input parameters',
               2,
               None,
               '___sec14'),
              ('Generating a graphical user interface', 2, None, '___sec15'),
              ('ODE models', 0, None, '___sec16'),
              ('Exponential decay problems',
               1,
               'sec:scale:decay',
               'sec:scale:decay'),
              ('Fundamental ideas', 2, None, '___sec18'),
              ('The basic model problem', 2, None, '___sec19'),
              ('Example: Population dynamics', 3, None, '___sec20'),
              ('Example: Decay of pressure with altitude',
               3,
               None,
               '___sec21'),
              ('The technical steps of the scaling procedure',
               2,
               'sec:scale:decay:steps',
               'sec:scale:decay:steps'),
              ('Step 1: Identify independent and dependent variables',
               3,
               None,
               '___sec23'),
              ('Step 2: Make independent and dependent variables dimensionless',
               3,
               None,
               '___sec24'),
              ('Step 3: Derive the model involving only dimensionless variables',
               3,
               None,
               '___sec25'),
              ('Step 4: Make each term dimensionless', 3, None, '___sec26'),
              ('Step 5: Estimate the scales', 3, None, '___sec27'),
              ('Making software utilizing the dimensionless model',
               2,
               'sec:scale:decay:prog',
               'sec:scale:decay:prog'),
              ('Software for the original problem with dimensions',
               3,
               None,
               '___sec29'),
              ('A plain solution', 3, None, '___sec30'),
              ('Simplifying the implementation with joblib',
               3,
               None,
               '___sec31'),
              ('Scaling a generalized problem',
               2,
               'sec:scale:decay:body',
               'sec:scale:decay:body'),
              ('Exact solution', 3, None, '___sec33'),
              ('Theory', 3, None, '___sec34'),
              ('Software', 3, None, '___sec35'),
              ('Variable coefficients',
               2,
               'sec:scale:decay:jump',
               'sec:scale:decay:jump'),
              ('Scaling a cooling problem with constant surroundings',
               2,
               'scale:decay:cooling:const',
               'scale:decay:cooling:const'),
              ('Scaling a cooling problem with time-dependent surroundings',
               2,
               'scale:decay:cooling:osc',
               'scale:decay:cooling:osc'),
              ('Exact solution', 3, None, '___sec39'),
              ('Scaling', 3, None, '___sec40'),
              ('Software', 3, None, '___sec41'),
              ('Discussion of the time scale', 3, None, '___sec42'),
              ('Scaling a nonlinear ODE',
               2,
               'sec:scale:decay:nonlinear',
               'sec:scale:decay:nonlinear'),
              ('ODE systems for spreading of diseases', 2, None, '___sec44'),
              ('SIR model', 3, None, '___sec45'),
              ('SIRV model with finite immunity', 3, None, '___sec46'),
              ('Michaelis-Menten kinetics for biochemical reactions',
               2,
               'scale:MMK',
               'scale:MMK'),
              ('Classical analysis', 3, None, '___sec48'),
              ('Dimensionless ODE system', 3, None, '___sec49'),
              ('Determining scales', 3, None, '___sec50'),
              ('Analysis of the scaled system', 3, None, '___sec51'),
              ('Vibration problems', 1, 'sec:scale:vib', 'sec:scale:vib'),
              ('Undamped vibrations without forcing',
               2,
               'sec:scale:vib:undamped',
               'sec:scale:vib:undamped'),
              ('The first technical steps of scaling', 3, None, '___sec54'),
              ('The exact solution', 3, None, '___sec55'),
              ('Discussion of the displacement scale', 3, None, '___sec56'),
              ('Discussion of the time scale', 3, None, '___sec57'),
              ('Alternative displacement scale', 3, None, '___sec58'),
              ('About frequency and dimensions', 3, None, '___sec59'),
              ('Undamped vibrations with constant forcing',
               2,
               'sec:scale:vib:undamped:mg',
               'sec:scale:vib:undamped:mg'),
              ('Undamped vibrations with time-dependent forcing',
               2,
               'sec:scale:vib:undamped:F',
               'sec:scale:vib:undamped:F'),
              ('Investigating scales via analytical solutions',
               3,
               None,
               '___sec62'),
              ('The displacement and time scales', 3, None, '___sec63'),
              ('Finding the displacement scale from the differential equation',
               3,
               None,
               '___sec64'),
              ('Scaling with free vibrations as time scale',
               3,
               None,
               '___sec65'),
              ('Software', 3, None, '___sec66'),
              ('Choice of $u_c$ close to resonance', 3, None, '___sec67'),
              ('Unit size of all terms in the ODE', 3, None, '___sec68'),
              ('Choice of $u_c$ when $\\psi\\gg\\omega$',
               3,
               None,
               '___sec69'),
              ('Displacement scale based on $I$', 3, None, '___sec70'),
              ('Damped vibrations with forcing',
               2,
               'sec:scale:vib:damped:F',
               'sec:scale:vib:damped:F'),
              ('The exact solution', 3, None, '___sec72'),
              ('Choosing scales', 3, None, '___sec73'),
              ('Choice of $u_c$ at resonance', 3, None, '___sec74'),
              ('Choice of $u_c$ when $\\omega\\gg\\psi$',
               3,
               None,
               '___sec75'),
              ('Choice of $u_c$ when $\\omega\\ll\\psi$',
               3,
               None,
               '___sec76'),
              ('Oscillating electric circuits', 2, None, '___sec77'),
              ('Basic PDE models', 0, None, '___sec78'),
              ('The wave equation', 1, 'sec:scale:wave', 'sec:scale:wave'),
              ('Simple homogeneous Dirichlet conditions',
               2,
               None,
               '___sec80'),
              ('Implementation of the scaled wave equation',
               2,
               None,
               '___sec81'),
              ('Waves on a string', 3, None, '___sec82'),
              ('Detecting an already computed case', 3, None, '___sec83'),
              ('Time-dependent Dirichlet condition',
               2,
               'scale:wave:pde2',
               'scale:wave:pde2'),
              ('Velocity initial condition',
               2,
               'scale:wave:pde2:Vcond',
               'scale:wave:pde2:Vcond'),
              ('Variable wave velocity and forcing',
               2,
               'scale:wave:pde2:cvar',
               'scale:wave:pde2:cvar'),
              ('Damped wave equation',
               2,
               'scale:wave:pde2:damped',
               'scale:wave:pde2:damped'),
              ('A three-dimensional wave equation problem',
               2,
               None,
               '___sec88'),
              ('The diffusion equation',
               1,
               'sec:scale:diffu',
               'sec:scale:diffu'),
              ('Homogeneous diffusion equation',
               2,
               'sec:scale:diffu:homo1D',
               'sec:scale:diffu:homo1D'),
              ('Simplified 1D PDE', 3, None, '___sec91'),
              ('Generalized PDE', 3, None, '___sec92'),
              ('Jump boundary condition', 2, None, '___sec93'),
              ('Oscillating Dirichlet condition', 2, None, '___sec94'),
              ('Diffusion equation with source term',
               2,
               'sec:scale:diffu:source',
               'sec:scale:diffu:source'),
              ("Fisher's equation",
               2,
               'sec:scale:diffu:Fisher',
               'sec:scale:diffu:Fisher'),
              ('The convection-diffusion equation',
               1,
               'scale:convdiff',
               'scale:convdiff'),
              ('Convection-diffusion without a force term',
               2,
               None,
               '___sec98'),
              ('Stationary PDE', 2, None, '___sec99'),
              ('Convection-diffusion with a force term',
               2,
               'scale:convdiff',
               'scale:convdiff'),
              ('Advanced PDE models', 0, None, '___sec101'),
              ('The equations of linear elasticity', 1, None, '___sec102'),
              ('The Navier-Stokes equations',
               1,
               'sec:scale:ns',
               'sec:scale:ns'),
              ('The momentum equation without body forces',
               2,
               None,
               '___sec104'),
              ('The most common dimensionless form of the Navier-Stokes equations',
               2,
               None,
               '___sec105'),
              ('Scaling of time for low Reynolds numbers',
               2,
               None,
               '___sec106'),
              ('Shear stress as pressure scale', 2, None, '___sec107'),
              ('Including the gravity force', 2, None, '___sec108'),
              ('Oscillating boundary conditions', 2, None, '___sec109'),
              ('The Euler number', 2, None, '___sec110'),
              ('Free surface conditions', 2, None, '___sec111'),
              ('Thermal convection', 1, None, '___sec112'),
              ('Forced convection', 2, None, '___sec113'),
              ('Free convection',
               2,
               'scale:fluid:forced_convection',
               'scale:fluid:forced_convection'),
              ('Governing equations', 3, None, '___sec115'),
              ('Heating by viscous effects', 3, None, '___sec116'),
              ('Relation between density and temperature',
               3,
               None,
               '___sec117'),
              ('Comment on the form of the equation of continuity',
               3,
               None,
               '___sec118'),
              ('The Boussinesq approximation', 3, None, '___sec119'),
              ('Scaling', 3, None, '___sec120'),
              ('The Grashof, Prandtl, and Eckert numbers',
               2,
               None,
               '___sec121'),
              ('Heat transfer at boundaries', 2, None, '___sec122'),
              ('The bidomain model in electrophysiology',
               1,
               'scale:bidomain',
               'scale:bidomain'),
              ('Two-phase porous media flow', 1, None, '___sec124'),
              ('The Euler equations of gas dynamics', 1, None, '___sec125'),
              ('Exercises', 1, None, '___sec126'),
              ('Exercise 1: Perform unit conversion',
               2,
               'sec:scale:exer:US2SI1',
               'sec:scale:exer:US2SI1'),
              ('Problem 2: Scale a simple formula',
               2,
               'sec:scale:exer:ball_y',
               'sec:scale:exer:ball_y'),
              ('Problem 3: Scale a nonlinear ODE',
               2,
               'sec:scale:exer:ball_y_wdrag',
               'sec:scale:exer:ball_y_wdrag'),
              ('Exercise 4: Implement a scaled model with jump',
               2,
               'sec:scale:exer:decay:jump',
               'sec:scale:exer:decay:jump'),
              ('Exercise 5: Implement a scaled model for cooling',
               2,
               'sec:scale:exer:decay:cooling',
               'sec:scale:exer:decay:cooling'),
              ('Problem 6: Scale variable coefficients',
               2,
               'scale:decay:exer:decay:step',
               'scale:decay:exer:decay:step'),
              ('Exercise 7: Alternative scalings of a cooling model',
               2,
               'scale:decay:exer:cooling:Ts',
               'scale:decay:exer:cooling:Ts'),
              ('Exercise 8: Alternative scalings of a cooling model',
               2,
               'scale:decay:exer:nonlin:logistic2',
               'scale:decay:exer:nonlin:logistic2'),
              ('Exercise 9: Scale projectile motion',
               2,
               'scale:vib:exer:projectile',
               'scale:vib:exer:projectile'),
              ('Problem 10: Scale a predator-pray model',
               2,
               'scale:decay:exer:predpray',
               'scale:decay:exer:predpray'),
              ('Problem 11: Scale a model for competing species',
               2,
               'scale:decay:exer:competing_species',
               'scale:decay:exer:competing_species'),
              ('Problem 12: Find the period of sinusoidal signals',
               2,
               'scale:decay:exer:sine',
               'scale:decay:exer:sine'),
              ('Remarks', 3, None, '___sec139'),
              ('Problem 13: Scale the pendulum equation',
               2,
               'sec:scale:exer:pendulum',
               'sec:scale:exer:pendulum'),
              ("Problem 14: Scale Duffing's equation",
               2,
               'scale:vib:exer:Duffing',
               'scale:vib:exer:Duffing'),
              ('Problem 15: Scale a stationary Couette flow',
               2,
               'scale:vib:exer:stationary_Couette',
               'scale:vib:exer:stationary_Couette'),
              ('Remarks', 3, None, '___sec143'),
              ('Problem 16: Scale a starting Couette flow',
               2,
               'scale:vib:exer:starting_Couette',
               'scale:vib:exer:starting_Couette'),
              ('Exercise 17: Scale Couette flow with pressure gradient',
               2,
               'scale:vib:exer:Couette_wpressure',
               'scale:vib:exer:Couette_wpressure'),
              ('Exercise 18: Suggestions...',
               2,
               'scale::exer:suggest',
               'scale::exer:suggest'),
              ('References', 1, None, '___sec147')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\half}{\frac{1}{2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\x}{\boldsymbol{x}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href=".trash82dee82e1274a586571086dca04d00308d3a0d86.html">Scaling of Differential Equations</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#ch:preface" style="font-size: 80%;">Preface</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#scale:dimunit" style="font-size: 80%;">Dimensions and units</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec16" style="font-size: 80%;">ODE models</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec78" style="font-size: 80%;">Basic PDE models</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86010.html#___sec101" style="font-size: 80%;">Advanced PDE models</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0006"></a>
<!-- !split -->

<h1 id="sec:scale:vib">Vibration problems</h1>

<p>
We shall address a range of different second-order ODEs for mechanical
vibrations and demonstrate how to reason about the scaling in
different physical scenarios.

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 2</b>: Include more figures.)</font>
<!-- end inline comment -->

<h2 id="sec:scale:vib:undamped">Undamped vibrations without forcing</h2>

<p>
The simplest differential equation model for mechanical vibrations
reads

$$
\begin{equation}
mu'' + ku = 0,\quad u(0)=I,\ u'(0)=V\tp
\tag{52}
\end{equation}
$$

This is a common model for a vibrating body  with mass \( m \) attached
to a linear spring with spring constant \( k \) (and force \( -ku \)).
The quantity \( u(t) \) measures the displacement of the body.

<h3 id="___sec54">The first technical steps of scaling </h3>

<p>
The problem <a href="#mjx-eqn-52">(52)</a> has one independent
variable \( t \) and one dependent variable \( u \). We introduce dimensionless
versions of these variables:

$$ \bar u =\frac{u}{u_c},\quad\bar t = \frac{t}{t_c},$$

where \( u_c \) and \( t_c \) are characteristic values of \( u \) and \( t \).
Inserted in <a href="#mjx-eqn-52">(52)</a>, we get

$$ m\frac{u_c}{t_c^2}\frac{d^2\bar u}{d\bar t^2} + ku_c\bar u = 0,
\quad u_c\bar u(0)=I,\quad \frac{u_c}{t_c}\frac{d\bar u}{d\bar t}(0)=V,$$

resulting in

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c^2 k}{m}\bar u = 0,
\quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}\tp
\tag{53}
\end{equation}
$$

<h3 id="___sec55">The exact solution </h3>

<p>
What is an appropriate displacement scale \( u_c \)? The initial condition
\( u(0)=I \) is a candidate, i.e., \( u_c=I \). We also have analytical insight
into this problem, because the exact solution of
<a href="#mjx-eqn-52">(52)</a> is quite straightforward to compute.
Let us demonstrate the steps in a SymPy session:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
u <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;u&#39;</span>, cls<span style="color: #666666">=</span>Function)
w <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;w&#39;</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>, positive<span style="color: #666666">=</span><span style="color: #008000">True</span>)
I, V, C1, C2 <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;I V C1 C2&#39;</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>)
<span style="color: #408080; font-style: italic"># Define differential equation: u&#39;&#39; + w**2*u = 0</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ode</span>(u):
    <span style="color: #008000; font-weight: bold">return</span> diff(u, t, t) <span style="color: #666666">+</span> w<span style="color: #666666">**2*</span>u

diffeq <span style="color: #666666">=</span> ode(u(t))
<span style="color: #408080; font-style: italic"># Solve differential equation with dsolve</span>
s <span style="color: #666666">=</span> dsolve(diffeq, u(t))
<span style="color: #408080; font-style: italic"># s is an u(t) == expression (Eq obj.), s.rhs grabs the expression</span>
u_sol <span style="color: #666666">=</span> s<span style="color: #666666">.</span>rhs
<span style="color: #408080; font-style: italic"># The solution contains integration constants C1 and C2</span>
<span style="color: #408080; font-style: italic"># but these are not symbols, substitute them by symbols</span>
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(<span style="color: #BA2121">&#39;C1&#39;</span>, C1)<span style="color: #666666">.</span>subs(<span style="color: #BA2121">&#39;C2&#39;</span>, C2)
<span style="color: #408080; font-style: italic"># Determine C1 and C2 from the initial conditions</span>
ic <span style="color: #666666">=</span> [u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I, u_sol<span style="color: #666666">.</span>diff(t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V]
<span style="color: #008000; font-weight: bold">print</span> ic
s <span style="color: #666666">=</span> solve(ic, [C1, C2])
<span style="color: #408080; font-style: italic"># s is now a dictionary, substitute solution back in u_sol</span>
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(C1, s[C1])<span style="color: #666666">.</span>subs(C2, s[C2])
<span style="color: #008000; font-weight: bold">print</span> u_sol

<span style="color: #408080; font-style: italic"># Check that the solution fulfills the ODE and init.cond.</span>
<span style="color: #008000; font-weight: bold">print</span> simplify(ode(u_sol)),
<span style="color: #008000; font-weight: bold">print</span> u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I, diff(u_sol, t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V
</pre></div>
<p>
The output is <code>I*cos(t*w) + V*sin(t*w)/w</code>, so we have found that

$$ u(t) = I\cos(\omega t) + \frac{V}{\omega}\sin(\omega t),\quad \omega = \sqrt{\frac{k}{m}}\tp$$

More insight arises from rewriting such an expression in the form
\( A\cos(wt - \phi) \):

$$ u(t) = \sqrt{I^2 + \frac{V^2}{\omega^2}}\cos(wt - \phi),\quad
\phi = \tan^{-1}(V/(\omega I))\tp
$$

Now we see that the \( u \) corresponds to cosine oscillations with a
phase shift \( \phi \) and amplitude \( \sqrt{I^2 + (V/\omega)^2} \).

<h3 id="___sec56">Discussion of the displacement scale </h3>

<p>
The amplitude of \( u \) is \( \sqrt{I^2 + V^2/\omega^2} \), and this
expression is obviously a candidate for \( u_c \).  However, the simpler
choice \( u_c=\max (I, V/\omega) \) is also relevant and more attractive
than the square root expression (but potentially a factor 1.4 wrong
compared to the exact amplitude).  It is not very important to have
\( |u|\leq 1 \), the point is to avoid \( |u| \) very small or large.

<h3 id="___sec57">Discussion of the time scale </h3>

<p>
What is an appropriate time scale? Looking at
<a href="#mjx-eqn-53">(53)</a> and arguing that
\( \bar u'' \) and \( \bar u \) both should be around unity in size, the
coefficient \( t_c^2k/m \) must equal unity, implying that \( t_c=\sqrt{m/k} \).
Also from the analytical solution we see that it goes like
sine or cosine of \( \omega t \) so \( 1/\omega = \sqrt{m/k} \) can be a characteristic
time scale. Likewise, one period of the oscillations, \( P=2\pi/\omega \) can
be the characteristic time, leading to \( t_c=2\pi/\omega \).

<p>
With \( u_c=I \) and \( t_c=\sqrt{m/k} \) we get the scaled model

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \bar u = 0,
\quad \bar u(0)=1,\ \bar u'(0)=\alpha,
\tag{54}
\end{equation}
$$

where \( \alpha \) is a dimensionless parameter:

$$ \alpha = \frac{V}{I}\sqrt{\frac{m}{k}}\tp$$

Note that in case \( V=0 \), we have &quot;scaled away&quot; all physical parameters.
The universal solution without physical parameters is then
\( \bar u(\bar t)=\cos\bar t \).

<p>
The unscaled solution is recovered as

$$
\begin{equation}
u(t) = I\bar u(\sqrt{k/m}\bar t)\tp
\end{equation}
$$

This expressions shows that the scaling is simply a matter of
<em>stretching or shrinking the axes</em>.

<h3 id="___sec58">Alternative displacement scale </h3>

<p>
Using \( u_c = V/\omega \), the equation
is not changed, but the initial conditions become

$$ \bar u(0) = \frac{I}{u_c} = \frac{I\omega}{V} =\frac{I}{V}\sqrt{\frac{k}{m}} = \alpha^{-1},\quad \bar u'(0)=1\tp$$

<p>
With \( u_c=V/\omega \) and one period as time scale,
\( t_c=2\pi\sqrt{m/k} \),
we get the alternative model

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + 4\pi^2 \bar u = 0,
\quad \bar u(0)=\alpha^{-1},\ \bar u'(0)=2\pi\tp
\tag{55}
\end{equation}
$$

The unscaled solution is in this case recovered by

$$
\begin{equation}
u(t) = V\sqrt{\frac{m}{k}}\bar u(2\pi\sqrt{k/m}\bar t)\tp
\end{equation}
$$

<h3 id="___sec59">About frequency and dimensions </h3>

<p>
The solution goes like \( \cos\omega t \), where \( \omega =\sqrt{m/k} \)
must have dimension 1/s. Actually, \( \omega \) has dimension <em>radians
per second</em>: rad/s. A radian is dimensionless since it is arc (length)
divided by radius (length), but still regarded as a unit.
The period \( P \) of vibrations is a more intuitive quantity than the frequency
\( \omega \). The relation between \( P \) and \( \omega \) is \( P=2\pi/\omega \).
The number of oscillation cycles per period, \( f \), is a more intuitive
measurement of frequency and also known as <em>frequency</em>. Therefore, to be
precise, \( \omega \) should be named <em>angular frequency</em>. The relation between
\( f \) and \( T \) is \( f=1/T \), so \( f=2\pi\omega \) and measured in Hz (1/s), which is
the unit for counts per unit time.

<h2 id="sec:scale:vib:undamped:mg">Undamped vibrations with constant forcing</h2>

<p>
For vertical vibrations in the gravity field, the model
<a href="#mjx-eqn-52">(52)</a> must also take the gravity force
\( -mg \) into account: \( mu'' + ku = -mg \). How does this term influence
the scaling? We observe that if there is no movement of the body,
\( u''=0 \), and the spring elongation matches the gravity force:
\( ku = -mg \), leading to a steady displacement \( u=-mg/k \). We can then
have oscillations around this equilibrium point. A natural scaling
for \( u \) is therefore

$$ \bar u = \frac{u - (-mg/k)}{u_c}=\frac{uk + mg}{ku_c}\tp$$

<!-- u = - mg/k + u_c\bar u -->
The scaled differential equation with the same time scale as before
(gravity does not influence the oscillations) reads

$$ \frac{d^2\bar u}{d\bar t^2} + \bar u - \frac{t_c^2}{u_c}g
= -\frac{t_c^2}{u_c}g,$$

leading to

$$ \frac{d^2\bar u}{d\bar t^2} + \bar u = 0\tp$$

<h2 id="sec:scale:vib:undamped:F">Undamped vibrations with time-dependent forcing</h2>

<p>
Now we add a transient forcing term \( F(t) \) to the model
<a href="#mjx-eqn-52">(52)</a>:

$$
\begin{equation}
mu'' + ku = F(t),\quad u(0)=I,\ u'(0)=V\tp
\tag{56}
\end{equation}
$$

Take the forcing to be oscillating

$$ F(t) = A\cos(\psi t)\tp$$

The technical steps of the scaling are still the same,

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c^2 k}{m}\bar u =
\frac{t_c^2}{mu_c}A\cos(\psi t_c\bar t),
\quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}\tp
\tag{57}
\end{equation}
$$

What are typical displacement and time scales? This is not so obvious
without knowing the details of the solution, because there are
three parameters (\( I \), \( V \), and \( A \)) that influence the magnitude of \( u \).
Moreover, there are two time scales, one for the free vibrations of
the systems and one for the forced vibrations \( F(t) \).

<h3 id="___sec62">Investigating scales via analytical solutions </h3>

<p>
We may look into the exact solution to see what the scales are.  We
continue the SymPy session from the previous section and perform much
of the same steps. Note that we use <code>w</code> for \( \omega = \sqrt{k/m} \).
SymPy may get confused when coefficients in differential equations
contain several symbols. We therefore rewrite the equation with
at most one symbol in each coefficient.
The amplitude \( A/m \) in the forcing term is of this reason
replaced by the symbol <code>A1</code>.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">A, A1, m, psi <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;A A1 m psi&#39;</span>, positive<span style="color: #666666">=</span><span style="color: #008000">True</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>)
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ode</span>(u):
    <span style="color: #008000; font-weight: bold">return</span> diff(u, t, t) <span style="color: #666666">+</span> w<span style="color: #666666">**2*</span>u <span style="color: #666666">-</span> A1<span style="color: #666666">*</span>cos(psi<span style="color: #666666">*</span>t)

diffeq <span style="color: #666666">=</span> ode(u(t))
u_sol <span style="color: #666666">=</span> dsolve(diffeq, u(t))
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>rhs

<span style="color: #408080; font-style: italic"># Determine the constants C1 and C2 in u_sol</span>
<span style="color: #408080; font-style: italic"># (first substitute our own declared C1 and C2 symbols,</span>
<span style="color: #408080; font-style: italic"># then use the initial conditions)</span>
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(<span style="color: #BA2121">&#39;C1&#39;</span>, C1)<span style="color: #666666">.</span>subs(<span style="color: #BA2121">&#39;C2&#39;</span>, C2)
eqs <span style="color: #666666">=</span> [u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I, u_sol<span style="color: #666666">.</span>diff(t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V]
s <span style="color: #666666">=</span> solve(eqs, [C1, C2])
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(C1, s[C1])<span style="color: #666666">.</span>subs(C2, s[C2])

<span style="color: #408080; font-style: italic"># Check that the solution fulfills the equation and init.cond.</span>
<span style="color: #008000; font-weight: bold">print</span> simplify(ode(u_sol))
<span style="color: #008000; font-weight: bold">print</span> simplify(u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I)
<span style="color: #008000; font-weight: bold">print</span> simplify(diff(u_sol, t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V)

u_sol <span style="color: #666666">=</span> simplify(expand(u_sol<span style="color: #666666">.</span>subs(A1, A<span style="color: #666666">/</span>m)))
<span style="color: #008000; font-weight: bold">print</span> u_sol
</pre></div>
<p>
The output from the last line is

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">A/m*cos(psi*t)/(-psi**2 + w**2) + V*sin(t*w)/w +
(A/m + I*psi**2 - I*w**2)*cos(t*w)/(psi**2 - w**2)
</pre></div>
<p>
With a bit of rewrite this expressions means

<p>
<!-- Note that the solution becomes a bit simpler of F is cos rather than sin -->

$$ u(t) = \frac{A/m}{\omega^2 - \psi^2}\cos(\psi t) + \frac{V}{\omega}
   \sin(\omega t) +
\left(\frac{A/m}{\psi^2 - \omega^2} + I\right) \cos (\omega t)\tp
$$

Obviously, this expression is only meaningful for \( \psi\neq\omega \). The
case \( \psi = \omega \) gives an infinite amplitude in this model, a
phenomenon known as resonance. The amplitude becomes finite when
damping is included,
see the section <a href="#sec:scale:vib:damped:F">Damped vibrations with forcing</a>.

<p>
For the case the system starts from rest, \( I=V=0 \), and the
forcing is the only driving mechanism, we can simplify:

$$
\begin{align*}
u(t) &= \frac{A}{m(\omega^2 - \psi^2)}\cos(\psi t)
+
\frac{A}{m(\psi^2 - \omega^2)}\cos (\omega t)\\ 
&= \frac{A}{m(\omega^2 - \psi^2)}(\cos(\psi t) - \cos(\omega t))\tp
\end{align*}
$$

To gain more insight, \( \cos(\psi t) - \cos(\omega t) \) can be
rewritten in terms of the mean frequency \( (\psi + \omega)/2 \) and
the difference in frequency \( (\psi - \omega)/2 \):

$$
\begin{equation}
u(t) = \frac{A}{m(\omega^2 - \psi^2)} 2
\sin\left(\frac{\psi - \omega}{2}t\right)
\sin\left(\frac{\psi + \omega}{2}t\right),
\tag{58}
\end{equation}
$$

showing that there is a signal with frequency \( (\psi + \omega)/2 \)
whose amplitude has a (much) slower frequency
\( (\psi - \omega)/2 \). Figure <a href="#sec:scale:vib:fig:envelope">6</a> shows
an example how such a signal might look like.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 6:  Signal with frequency 3.1 and envelope frequency 0.2. <div id="sec:scale:vib:fig:envelope"></div> </p></center>
<p><img src="fig-scale/envelope.png" align="bottom" width=600></p>
</center>

<h3 id="___sec63">The displacement and time scales </h3>

<p>
A characteristic displacement can in the latter special case
be taken as \( u_c= A/(m(\omega^2 - \psi^2)) \). This is also a relevant choice
in the more general case \( I\neq0, V\neq 0 \), unless \( I \) or \( V \)
is so large that it dominates the amplitude
caused by the forcing. With \( u_c= A/(m(\omega^2 - \psi^2)) \) we also
have three special cases: \( \omega \ll \psi \), \( \omega \gg\psi \), and
\( \psi \sim \omega \). In the latter case we need
\( u_c= A/(m(\omega^2 - \psi^2)) \) if we want \( |u|\leq 1 \). When
\( \omega \) and \( \psi \) are significantly different, we may choose one
of them, say \( \omega \), and \( u_c=A/k \). This is also the relevant scale
if \( \omega\gg\psi \). In the opposite case, \( \omega\ll\psi \),
\( u_c=A/(m\psi^2) \).

<p>
The time scale is dominated by the fastest oscillations, which are
of frequency \( \psi \) or \( \omega \) when these are close and the largest
of them when they are distant. In any case, we might choose
\( t_c=1/\max(\psi,\omega) \).

<h3 id="___sec64">Finding the displacement scale from the differential equation </h3>

<p>
Going back to <a href="#mjx-eqn-57">(57)</a>, we
may demand that all the three terms in the differential equation
are of size unity. This leads to \( t_c=\sqrt{m/k} \)
and \( u_c=At_c^2/m = A/k \). The formula for \( u_c \) is a kind of measure
of the ratio of the
forcing and the spring force (the dimensionless number
\( A/(ku_c) \) would be this ratio).

<p>
Looking at <a href="#mjx-eqn-58">(58)</a>, we see
that if \( \psi\ll\omega \), the amplitude can be approximated
by \( A/(m\omega^2)=A/k \), showing that the scale \( u_c=A/k \) is
relevant for small excitation frequency \( \psi \) compared to
the free vibration frequency \( \omega \).

<h3 id="___sec65">Scaling with free vibrations as time scale </h3>

<p>
We first choose the time scale based on the free oscillations
with frequency \( \omega \), i.e., \( t_c=1/\omega \). Inserting the expression in
<a href="#mjx-eqn-57">(57)</a> results in

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \bar u =
\gamma
\cos(\delta\bar t),
\quad \bar u(0)=\alpha,\ \bar u'(0)=\beta\tp
\tag{59}
\end{equation}
$$

Here we have four dimensionless variables

$$
\begin{align}
\alpha &= \frac{I}{u_c},\\ 
\beta  &= \frac{Vt_c}{u_c} = \frac{V}{\omega u_c},\\ 
\gamma &= \frac{t_c^2 A}{mu_c} = frac{A}{ku_c},\\ 
\delta &= \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega}\tp
\end{align}
$$

These dimensionless variables have interpretations as ratios of
physical effects:

<ul>
 <li> \( \alpha \): ratio of the initial displacement and
   the typical displacement \( u_c \),</li>
 <li> \( \beta \): ratio of the initial velocity
   and the typical velocity measure \( u_c/t_c \),</li>
 <li> \( \gamma \): ratio of
   the forcing \( A \) and the mass times acceleration \( mu_c/t_c^2 \) <em>or</em>
   the ratio of the forcing and the spring force \( ku_c \)</li>
 <li> \( \delta \): ratio of the
   frequencies or the time scales of the forcing and the free vibrations.</li>
</ul>

<h3 id="___sec66">Software </h3>

<p>
Any solver for <a href="#mjx-eqn-57">(57)</a>
can be used for <a href="#mjx-eqn-59">(59)</a>.
In particular, we may use the <code>solver</code> function in the
file <a href="http://tinyurl.com/nm5587k/vib/vib.py" target="_self"><tt>vib.py</tt></a>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">solver</span>(I, V, m, b, s, F, dt, T, damping<span style="color: #666666">=</span><span style="color: #BA2121">&#39;linear&#39;</span>):
</pre></div>
<p>
for solving

$$ mu'' + f(u') + s(u) = F(t),\quad u(0)=I,\ u'(0)=V,\ t\in (0,T],$$

with time steps <code>dt</code>. For <code>damping='linear'</code>, we have \( f(u')=bu' \). The
other value is <code>'quadratic'</code>, meaning \( f(u')=b|u'|u' \).
Given \( \alpha \), \( \beta \), \( \gamma \), and \( \delta \),
and appropriate call is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">u, t <span style="color: #666666">=</span> solver(I<span style="color: #666666">=</span>alpha, V<span style="color: #666666">=</span>beta, m<span style="color: #666666">=1</span>, b<span style="color: #666666">=0</span>,
              s<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> u: u, F<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> t: gamma<span style="color: #666666">*</span>cos(delta<span style="color: #666666">*</span>t),
	      dt<span style="color: #666666">=2*</span>pi<span style="color: #666666">/</span>n, T<span style="color: #666666">=2*</span>pi<span style="color: #666666">*</span>P)
</pre></div>
<p>
where <code>n</code> is the number intervals per period and <code>P</code> is the number
of periods to be simulated.

<p>
We way wrap this call in a <code>solver_scaled</code> function as we did in
the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:decay:prog">Making software utilizing the dimensionless model</a>, but this is done in
the section <a href="#sec:scale:vib:damped:F">Damped vibrations with forcing</a>.

<h3 id="___sec67">Choice of \( u_c \) close to resonance </h3>

<p>
We have chosen not to specify \( u_c \) in the formulas above. Now we shall
discuss various choices of \( u_c \).
Close to resonance, when \( \psi\sim\omega \), we may set
\( u_c=A/(m(\omega^2 - \psi^2)) \). The dimensionless numbers
become in this case

$$
\begin{align*}
\alpha &= \frac{I}{u_c} = \frac{I}{A/k}(1-\delta^2),\\ 
\beta  &= \frac{V}{\omega u_c} = \frac{V\sqrt{km}}{A}(1-\delta^2),\\ 
\gamma &= \frac{A}{ku_c} = 1-\delta^2,\\ 
\delta &= \frac{\psi}{\omega}\tp
\end{align*}
$$

With \( \psi = 0.99\omega \), \( \delta =0.99 \), \( V=0 \),
\( \alpha = \gamma = 1-\delta^2 = 0.02 \), we have the problem

$$
\frac{d^2\bar u}{d\bar t^2} + \bar u =
0.02 \cos(0.99\bar t),
\quad \bar u(0)=0.02,\ \bar u'(0)=0\tp
$$

This is a problem with a very small initial condition and a very small
forcing, but the state close to resonance brings the amplitude up to
about unity, see the result of numerical simulations with \( \delta=0.99 \) in
Figure <a href="#sec:scale:vib:fig:Fcos_b0:1">7</a>.
Neglecting \( \alpha \),
the solution is given by <a href="#mjx-eqn-58">(58)</a>,
which here means \( A=1-\delta^2 \), \( m=1 \), \( \omega=1 \), \( \psi=\delta \):

$$ \bar u(\bar t) = 2\sin(-0.005\bar t)\sin(0.995\bar t)\tp $$

Note that this is a problem which demands very high accuracy in the
numerical calculations. Using 20 time steps per period gives a
significant phase error and an amplitude of about 1.4. We used
160 steps per period for the results in
Figure <a href="#sec:scale:vib:fig:Fcos_b0:1">7</a>.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 7:  Forced undamped vibrations close to resonance. <div id="sec:scale:vib:fig:Fcos_b0:1"></div> </p></center>
<p><img src="fig-scale/vib_delta099_b0_Fcos.png" align="bottom" width=600></p>
</center>

<h3 id="___sec68">Unit size of all terms in the ODE </h3>

<p>
Using the displacement scale \( u_c=A/k \) leads to
<a href="#mjx-eqn-59">(59)</a> with

$$
\begin{align*}
\alpha &= \frac{I}{u_c} = \frac{I}{A/k},\\ 
\beta  &= \frac{V}{\omega u_c} = \frac{V k}{A\omega},\\ 
\gamma &= \frac{A}{ku_c} = 1,\\ 
\delta &= \frac{\psi}{\omega}\tp
\end{align*}
$$

Simulating a case with \( \delta=0.5 \), \( \alpha=1 \), and \( \beta=0 \) gives
the oscillations in Figure <a href="#sec:scale:vib:fig:Fcos_b0:2">8</a>, which is
a case away from resonance, and the amplitude is about unity. However,
choosing \( \delta =0.99 \) (close to resonance) results in a figure
similar to Figure <a href="#sec:scale:vib:fig:Fcos_b0:1">7</a>, except that the
amplitude is about \( 10^2 \) because of the moderate size of \( u_c \).
The present scaling is therefore most suitable away from resonance,
and when the terms containing \( \cos\omega t \) and \( \sin\omega t \)
are important (e.g., \( \omega\gg\psi \)).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 8:  Forced undamped vibrations away from resonance. <div id="sec:scale:vib:fig:Fcos_b0:2"></div> </p></center>
<p><img src="fig-scale/vib_delta05_b0_Fcos.png" align="bottom" width=600></p>
</center>

<h3 id="___sec69">Choice of \( u_c \) when \( \psi\gg\omega \) </h3>

<p>
Finally, we may look at the case where \( \psi\gg\omega \) such that
\( u_c=A/(m\psi^2) \) is a relevant scale (i.e., omitting \( \omega^2 \) compared to
\( \psi^2 \) in the denominator), but in this case we should
use \( t_c=1/\psi \) since the variations in the force are much greater
than in the free vibrations of the system.
This choice of \( t_c \) changes the scaled ODE to

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \delta^{-2}\bar u =
\gamma
\cos(\bar t),
\quad \bar u(0)=\alpha,\ \bar u'(0)=\beta,
\tag{60}
\end{equation}
$$

where

$$
\begin{align*}
\alpha &= \frac{I}{u_c} = \frac{I}{A/k}\delta^2,\\ 
\beta  &= \frac{Vt_c}{u_c} = \frac{V\sqrt{km}}{A}\delta,\\ 
\gamma &= \frac{t_c^2 A}{mu_c} = 1,\\ 
\delta &= \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega}\tp
\end{align*}
$$

In the regime \( \psi\gg\omega \), \( \delta\gg 1 \), thus making \( \alpha \) and
\( \beta \) large.
However, if \( \alpha \) and/or \( \beta \) is large,
the initial condition dominates over the forcing, and will also dominate
the amplitude of \( u \), thereby making the scaling of \( u \) inappropriate.
In case \( I=V=0 \) so that \( \alpha=\beta= \),
<a href="#mjx-eqn-58">(58)</a> predicts
(\( A=m=1 \), \( \omega=\delta^{-1} \), \( \psi=1 \))

$$ \bar u(\bar t) = (\delta^{-2}-1)^{-1}2
\sin\left(\frac{1}{2}(1 -\delta^{-1})\bar t\right)
\sin\left(\frac{1}{2}(1 +\delta^{-1})\bar t\right),
$$

which has an amplitude about \( 2 \) for \( \delta\gg 1 \), i.e.,
very small amplitude. Figure <a href="#sec:scale:vib:fig:Fcos_b0:3">9</a> shows
numerical simulations with 160 time steps per period of \( F(t) \).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 9:  Forced undamped vibrations with rapid forcing. <div id="sec:scale:vib:fig:Fcos_b0:3"></div> </p></center>
<p><img src="fig-scale/vib_delta10_b0_Fcos.png" align="bottom" width=600></p>
</center>

<p>
With \( \alpha=0.05\delta^2=5 \), we get a significant contribution from
the free vibrations (the homogeneous solution of the ODE) as
shown in Figure <a href="#sec:scale:vib:fig:Fcos_b0:4">10</a>. For larger \( \alpha \)
values, one must base

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 10:  Forced undamped vibrations with rapid forcing and initial displacement of 5. <div id="sec:scale:vib:fig:Fcos_b0:4"></div> </p></center>
<p><img src="fig-scale/vib_delta10_b0_a5_Fcos.png" align="bottom" width=600></p>
</center>

<h3 id="___sec70">Displacement scale based on \( I \) </h3>

<p>
Choosing \( u_c=I \) gives

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \bar u =
\gamma\cos(\delta\bar t),
\quad \bar u(0)=1,\ \bar u'(0)=\beta,
\tag{61}
\end{equation}
$$

with

$$
\begin{align}
\beta  &= \frac{V}{I}\sqrt\frac{{m}{k}} = \frac{Vt_c}{u_c},
\gamma & = \frac{A}{kI} = \frac{tc^2A}{mu_c} = \frac{A}{ku_c}\tp
\end{align}
$$

This scaling is not relevant close to resonance since then \( u_c\gg I \).

<h2 id="sec:scale:vib:damped:F">Damped vibrations with forcing</h2>

<p>
We now introduce a linear damping force \( bu'(t) \) in the equation of motion:

$$
\begin{equation}
mu'' + bu' + ku = A\cos(\psi t),\quad u(0)=I,\ u'(0)=V\tp
\tag{62}
\end{equation}
$$

Scaling results in

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c b}{m}\frac{d\bar u}{d\bar t}
+ \frac{t_c^2 k}{m}\bar u =
\frac{t_c^2}{mu_c}A\cos(\psi t_c\bar t),
\quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}\tp
\tag{63}
\end{equation}
$$

<h3 id="___sec72">The exact solution </h3>

<p>
To choose scales, it is a great advantage to look into exact solutions.
Using SymPy to solve <a href="#mjx-eqn-62">(62)</a> turns out
to be difficult, because with damping, we have three solutions
of <a href="#mjx-eqn-62">(62)</a>, and for vibrations we are
only interested in one of them, the one with damped oscillations.
So we have to drop <code>dsolve</code> and perform manual steps, either by
hand or with the aid of SymPy. The solution is composed of a homogeneous
solution \( u_h \) of \( mu'' + bu' + ku=0 \) and one particular solution \( u_p \)
of the nonhomogeneous equation
\( mu'' + bu' + ku=A\cos(\psi t) \). The homogeneous solution with
damped oscillations (requiring \( b < 2\sqrt{mk} \)) can be
found by the following code. We have divided the differential equation
by \( m \) and introduced \( B=\frac{1}{2}b/m \) and let <code>A1</code> represent
\( A/m \) to simplify expressions and
help SymPy with less symbols in the equation. Without these simplifications,
SymPy stalls in the computations due to too many symbols in the equation.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">u <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;u&#39;</span>, cls<span style="color: #666666">=</span>Function)
t, w, B, A, A1, m, psi <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;t w B A A1 m psi&#39;</span>,
                                 positive<span style="color: #666666">=</span><span style="color: #008000">True</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ode</span>(u, homogeneous<span style="color: #666666">=</span><span style="color: #008000">True</span>):
    h <span style="color: #666666">=</span> diff(u, t, t) <span style="color: #666666">+</span> <span style="color: #666666">2*</span>B<span style="color: #666666">*</span>diff(u, t) <span style="color: #666666">+</span> w<span style="color: #666666">**2*</span>u
    f <span style="color: #666666">=</span> A1<span style="color: #666666">*</span>cos(psi<span style="color: #666666">*</span>t)
    <span style="color: #008000; font-weight: bold">return</span> h <span style="color: #008000; font-weight: bold">if</span> homogeneous <span style="color: #008000; font-weight: bold">else</span> h <span style="color: #666666">-</span> f

<span style="color: #408080; font-style: italic"># Find coefficients in polynomial (in r) for exp(r*t) ansatz</span>
r <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;r&#39;</span>)
ansatz <span style="color: #666666">=</span> exp(r<span style="color: #666666">*</span>t)
poly <span style="color: #666666">=</span> simplify(ode(ansatz)<span style="color: #666666">/</span>ansatz)

<span style="color: #408080; font-style: italic"># Convert to polynomial to extract coefficients</span>
poly <span style="color: #666666">=</span> Poly(poly, r)
<span style="color: #408080; font-style: italic"># Extract coefficients in poly: a_*t**2 + b_*t + c_</span>
a_, b_, c_ <span style="color: #666666">=</span> poly<span style="color: #666666">.</span>coeffs()
<span style="color: #408080; font-style: italic"># Assume b_**2 - 4*a_*c_ &lt; 0</span>
d <span style="color: #666666">=</span> <span style="color: #666666">-</span>b_<span style="color: #666666">/</span>(<span style="color: #666666">2*</span>a_)
<span style="color: #008000; font-weight: bold">if</span> a_ <span style="color: #666666">==</span> <span style="color: #666666">1</span>:
    omega <span style="color: #666666">=</span> sqrt(c_ <span style="color: #666666">-</span> (b_<span style="color: #666666">/2</span>)<span style="color: #666666">**2</span>)  <span style="color: #408080; font-style: italic"># nicer formula</span>
<span style="color: #008000; font-weight: bold">else</span>:
    omega <span style="color: #666666">=</span> sqrt(<span style="color: #666666">4*</span>a_<span style="color: #666666">*</span>c_ <span style="color: #666666">-</span> b_<span style="color: #666666">**2</span>)<span style="color: #666666">/</span>(<span style="color: #666666">2*</span>a_)

<span style="color: #408080; font-style: italic"># The homogeneous solution is a linear combination of a</span>
<span style="color: #408080; font-style: italic"># cos term (u1) and a sin term (u2)</span>
u1 <span style="color: #666666">=</span> exp(d<span style="color: #666666">*</span>t)<span style="color: #666666">*</span>cos(omega<span style="color: #666666">*</span>t)
u2 <span style="color: #666666">=</span> exp(d<span style="color: #666666">*</span>t)<span style="color: #666666">*</span>sin(omega<span style="color: #666666">*</span>t)
C1, C2, V, I <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;C1 C2 V I&#39;</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>)
u_h <span style="color: #666666">=</span> simplify(C1<span style="color: #666666">*</span>u1 <span style="color: #666666">+</span> C2<span style="color: #666666">*</span>u2)
<span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;u_h:&#39;</span>, u_h
</pre></div>
<p>
The print out shows

$$ u_h = e^{-Bt}\left(C_1 \cos(\sqrt{\omega^2 - B^2}t) +
C_2 \sin(\sqrt{\omega^2 - B^2}t)\right),$$

where \( C_1 \) and \( C_2 \) must be determined by the initial conditions later.
It is wise to check that \( u_h \) is indeed a solution of the homogeneous
differential equation:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">assert</span> simplify(ode(u_h)) <span style="color: #666666">==</span> <span style="color: #666666">0</span>
</pre></div>
<p>
The ansatz for the particular solution \( u_p \) is

$$ u_p= C_3\cos(\psi t) + C_4\sin(\psi t),$$

which inserted in the ODE gives two equations
for \( C_3 \) and \( C_4 \). The relevant SymPy statements are

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># Particular solution</span>
C3, C4 <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;C3 C4&#39;</span>)
u_p <span style="color: #666666">=</span> C3<span style="color: #666666">*</span>cos(psi<span style="color: #666666">*</span>t) <span style="color: #666666">+</span> C4<span style="color: #666666">*</span>sin(psi<span style="color: #666666">*</span>t)
eqs <span style="color: #666666">=</span> simplify(ode(u_p, homogeneous<span style="color: #666666">=</span><span style="color: #008000">False</span>))

<span style="color: #408080; font-style: italic"># Collect cos(omega*t) terms</span>
<span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;eqs:&#39;</span>, eqs
eq_cos <span style="color: #666666">=</span> simplify(eqs<span style="color: #666666">.</span>subs(sin(psi<span style="color: #666666">*</span>t), <span style="color: #666666">0</span>)<span style="color: #666666">.</span>subs(cos(psi<span style="color: #666666">*</span>t), <span style="color: #666666">1</span>))
eq_sin <span style="color: #666666">=</span> simplify(eqs<span style="color: #666666">.</span>subs(cos(psi<span style="color: #666666">*</span>t), <span style="color: #666666">0</span>)<span style="color: #666666">.</span>subs(sin(psi<span style="color: #666666">*</span>t), <span style="color: #666666">1</span>))
s <span style="color: #666666">=</span> solve([eq_cos, eq_sin], [C3, C4])
u_p <span style="color: #666666">=</span> simplify(u_p<span style="color: #666666">.</span>subs(C3, s[C3])<span style="color: #666666">.</span>subs(C4, s[C4]))

<span style="color: #408080; font-style: italic"># Check that the solution is correct</span>
<span style="color: #008000; font-weight: bold">assert</span> simplify(ode(u_p, homogeneous<span style="color: #666666">=</span><span style="color: #008000">False</span>)) <span style="color: #666666">==</span> <span style="color: #666666">0</span>
</pre></div>
<p>
Using the initial conditions for the complete solution \( u=u_h+u_p \)
determines \( C_1 \) and \( C_2 \):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">u_sol <span style="color: #666666">=</span> u_h <span style="color: #666666">+</span> u_p  <span style="color: #408080; font-style: italic"># total solution</span>
<span style="color: #408080; font-style: italic"># Initial conditions</span>
eqs <span style="color: #666666">=</span> [u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I, u_sol<span style="color: #666666">.</span>diff(t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V]
<span style="color: #408080; font-style: italic"># Determine C1 and C2 from the initial conditions</span>
s <span style="color: #666666">=</span> solve(eqs, [C1, C2])
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(C1, s[C1])<span style="color: #666666">.</span>subs(C2, s[C2])
</pre></div>
<p>
Finally, we should check that <code>u_sol</code> is indeed the correct solution:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">checks <span style="color: #666666">=</span> <span style="color: #008000">dict</span>(
    ODE<span style="color: #666666">=</span>simplify(expand(ode(u_sol, homogeneous<span style="color: #666666">=</span><span style="color: #008000">False</span>))),
    IC1<span style="color: #666666">=</span>simplify(u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I),
    IC2<span style="color: #666666">=</span>simplify(diff(u_sol, t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V))
<span style="color: #008000; font-weight: bold">for</span> check <span style="color: #AA22FF; font-weight: bold">in</span> checks:
    msg <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121"> residual: </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (check, checks[check])
    <span style="color: #008000; font-weight: bold">assert</span> checks[check] <span style="color: #666666">==</span> sympify(<span style="color: #666666">0</span>), msg
</pre></div>
<p>
Finally, we may take <code>u_sol = u_sol.subs(A, A/m)</code> to get the right
expression for the solution.
Using <code>latex(u_sol)</code> results in a huge expression, which should be
manually ordered to something like the following:

$$
\begin{align*} u = &
\frac{Am^{-1}}{4 B^{2} \psi^{2} +
\Omega^{2}} \left(2 B \psi
\sin{\left (\psi t \right )} - \Omega\cos{\left (\psi t \right )}\right) + \\ 
&
{e^{-B t}} \biggl(
C_1 \cos{\left( t \sqrt{\omega^{2}- B^{2}}\right)} +
C_2 \sin{\left (t \sqrt{\omega^{2}- B^{2}}\right )}\biggr)\\ 
C_1 &= \frac{Am^{-1} \Omega + 4 I B^{2} \psi^{2} +
I\Omega^2}{
4 B^{2} \psi^{2} + \Omega^2}\\ 
C_2 &=
\frac{- Am^{-1} B\Omega + 4 I B^{3} \psi^{2} +
I B\Omega^2 + 4 V B^{2}\psi^{2} +
V\Omega^2}{
\sqrt{\omega^{2} - B^{2}}
\left(4 B^{2} \psi^{2} + \Omega^2\right)},\\ 
\Omega &= \psi^2 - \omega^2\tp
\end{align*}
$$

<p>
The most important feature of this solution is that there are
two time scales with frequencies \( \psi \) and \( \sqrt{\omega^2 - B^2} \),
but the latter appears in terms that decay as \( e^{Bt} \) in time.
The attention is usually on longer periods of time, so in that
case the solution simplifies to

$$
\begin{align}
u &= \frac{Am^{-1}}{4 B^{2} \psi^{2} +
\Omega^{2}} \left(2 B \psi
\sin{\left (\psi t \right )} - \Omega\cos{\left (\psi t \right )}\right)
\nonumber\\ 
&= \frac{A}{m}\frac{1}{\sqrt{4B^2\psi^2 + \Omega^2}}\cos(\psi t + \phi)
\frac{(\psi\omega)^{-1}}{(\psi\omega)^{-1}}
\nonumber\\ 
& = \frac{A}{k} Q\delta^{-1}\left(1 + Q^2(\delta - \delta^{-1})\right)^{-
\frac{1}{2}}\cos(\psi t + \phi),
\tag{64}
\end{align}
$$

where we have introduced the dimensionless numbers

$$ Q = \frac{\omega}{2B},\quad\delta = \frac{\psi}{\omega},$$

and

$$ \phi = \tan^{-1}\left(-\frac{2B}{\omega^2 - \psi^2}\right)
= \tan^{-1}\left(\frac{Q^{-1}}{\delta^2 - 1}\right)\tp$$

\( Q \) is commonly called <em>quality factor</em> and \( \phi \) is the
<em>phase shift</em>. Dividing
<a href="#mjx-eqn-64">(64)</a> by \( A/k \), which is a common
scale for \( u \), gives the dimensionless relation

$$
\begin{equation}
\frac{u}{A/k} = \frac{Q}{\delta} R(Q,\delta)^{\frac{1}{2}}\cos(\psi t + \phi),
\quad
R(Q,\delta) = \left(1 + Q^2(\delta - \delta^{-1})\right)^{-1}\tp
\tag{65}
\end{equation}
$$

<h3 id="___sec73">Choosing scales </h3>

<p>
Much of the discussion about scales in the previous sections are
relevant also with damping is included.
Although the oscillations with frequency \( \sqrt{\omega^2-B^2} \)
die out for \( t\gg B^{-1} \), we start with using this frequency for
the time scale.
A highly relevant assumption for engineering applications of
<a href="#mjx-eqn-62">(62)</a> is that the damping is small.
Therefore, \( \sqrt{\omega^2-B^2} \) is close to \( \omega \) and we
simply apply \( t_c=1/\omega \) as before.

<p>
The coefficient in front of the \( \bar u' \) term then becomes

$$ \frac{b}{m\omega} = \frac{2B}{\omega} = Q^{-1}\tp$$

<h3 id="___sec74">Choice of \( u_c \) at resonance </h3>

<p>
The relevant scale for \( u_c \) at or nearby resonance (\( \psi = \omega \))
becomes different from the previous section, since with damping,
the maximum amplitude a finite value. For \( t\gg 1/B \) when the
\( \sin\psi t \) term is dominating, we have for \( \psi = \omega \):

$$ u = \frac{Am^{-1}2B\psi}{4B^2\psi^2}\sin (\psi t) =
\frac{A}{2Bm\psi}\sin (\psi t) =
\frac{A}{b\psi}\sin (\psi t)
\tp
$$

This motivates the choice

$$ u_c = \frac{A}{b\psi} = \frac{A}{b\omega}\tp$$

(It is wise during computations like this to stop and check the
dimensions: \( A \) must be \( [\hbox{MLT}^{-2}] \) from the original
equation (\( F(t) \) must have same dimension as \( mu'' \)),
\( bu' \) also has dimension \( [\hbox{MLT}^{-2}] \), implying that
\( b \) has dimension \( [\hbox{MT}^{-1}] \). \( A/b \) then has dimension
\( LT^{-1} \), and \( A/(b\psi) \) gets dimension \( [L] \), which matches
what we want for \( u_c \).)

<p>
The differential equation on dimensionless form becomes

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + Q^{-1}\frac{d\bar u}{d\bar t} + \bar u =
\gamma
\cos(\delta\bar t),
\quad \bar u(0)=\alpha,\ \bar u'(0)=\beta,
\tag{66}
\end{equation}
$$

with

<p>
<!-- \frac{A}{b\omega} -->

$$
\begin{align}
\alpha &= \frac{I}{u_c} = \frac{Ib}{A}\sqrt{\frac{k}{m}},\\ 
\beta  &= \frac{Vt_c}{u_c} = \frac{Vb}{A},\\ 
\gamma &= \frac{t_c^2 A}{mu_c} = \frac{b\omega}{k},\\ 
\delta &= \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega} = 1\tp
\end{align}
$$

<h3 id="___sec75">Choice of \( u_c \) when \( \omega\gg\psi \) </h3>

<p>
In the limit \( \omega\gg\psi \) and \( t\gg 1/B \),

$$ u \approx \frac{A}{m\omega^2}\cos\psi t = \frac{A}{k}\cos\psi t,$$

showing that \( u_c=A/k \) is an appropriate displacement scale.
(Alternatively, we get this scale also from \( \gamma=1 \) in the ODE.)
The dimensionless numbers \( \alpha \), \( \beta \), and \( \delta \) are as
for the forced vibrations without damping.

<h3 id="___sec76">Choice of \( u_c \) when \( \omega\ll\psi \) </h3>

<p>
In the limit \( \omega\ll\psi \), we should base \( t_c \) on the rapid
variations in the excitation, \( t_c=1/\psi \).

<h2 id="___sec77">Oscillating electric circuits </h2>

<p>
The differential equation for an oscillating electric circuit is
very similar to the equation for forced, damped,
mechanical vibrations, and their
dimensionless form is identical.
The current \( I(t) \) in a
circuit with an inductor with inductance \( L \), a capacitor with
capacitance \( C \), and overall resistance \( R \), obeys the equation

$$
\begin{equation}
\ddot I + \frac{R}{L}\dot I + \frac{1}{LC}I = \dot V(t),
\end{equation}
$$

where \( V(t) \) is the voltage source powering the circuit.
We introduce

$$ \bar I=\frac{I}{I_c},\quad \bar t = \frac{t}{t_c},$$

and get

$$ \frac{d^2\bar I}{d\bar t^2} + \frac{t_c R}{L}\frac{d\bar I}{d\bar t}
+ \frac{t_c^2}{LC}\bar I = \frac{t_c^2V_c}{I_c} \bar V(t)\tp$$

Here, we have scaled \( V(t) \) according to

$$ \bar V(bar t) = \frac{V(t_c\bar t)}{\max_t V(t)}\tp$$

<p>
The time scale \( t_c \) is chosen to make \( \ddot I \) and \( I/(LC) \) balance,
\( t_c = \sqrt{LC} \).
Choosing \( I_c \) to make the coefficient in the source term of unit size,
means \( I_c = LCV_c \).
With

$$ \alpha = \frac{R}{2}\sqrt{\frac{C}{L}},$$

we get the scaled equation

$$
\begin{equation}
\frac{d^2\bar I}{d\bar t^2} + 2\alpha\frac{d\bar I}{d\bar t}
+ \bar I = \bar V(t)\tp
\end{equation}
$$

Two additional dimensionless variables will arise from the initial
conditions for \( I \).

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright --> &copy; 2015, Hans Petter Langtangen. Released under CC Attribution 4.0 license
</center>


</body>
</html>
    

