<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Scaling of Differential Equations">
<meta name="keywords" content="units,base unit,length,mass,time,dimension of physical quantities,units US,units British,units conversion,units software,multiple software runs,web interface (Parampool),graphical web interface,scaling,non-dimensionalization,dimensionless variable,exponential decay,dimensionless variable,characteristic time,e-folding time,memoize function,dimensionless number,dimensionless number,dimensionless number,logistic equation,dimensionless number,frequency,frequency, angular,period (of oscillations),radians,angular frequency,quality factor $Q$,phase shift,dimensionless number,Peclet number,dimensionless number,Reynolds number,thermo-elasticity,Navier-Stokes equations,dimensionless number,Reynolds number,Reynolds number,low Reynolds number flow,Stokes problem,Stokes' flow,Froude number,creeping flow,Strouhal number,vortex shedding,Euler number,Weber number,forced convection,Peclet number,Reynolds number,free convection,Grashof number,Reynolds number,Peclet number,Eckert number,Nusselt number,Lotka-Volterra, predator-prey model,Lotka-Volterra, competing species model">

<title>Scaling of Differential Equations</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [('Preface', 0, 'ch:preface', 'ch:preface'),
              ('Dimensions and units', 0, 'scale:dimunit', 'scale:dimunit'),
              ('Fundamental concepts', 1, None, '___sec2'),
              ('Base units and dimensions', 2, None, '___sec3'),
              ('Dimensions of common physical quantities',
               2,
               'scale:dimunit:tables',
               'scale:dimunit:tables'),
              ('Prefixes for units', 3, None, '___sec5'),
              ('Absolute errors, relative errors, and units',
               2,
               None,
               '___sec6'),
              ('Units and computers', 2, None, '___sec7'),
              ('Unit systems', 2, None, '___sec8'),
              ('PhysicalQuantity: object for computing with units',
               2,
               'scale:PQ',
               'scale:PQ'),
              ('Parampool: user interfaces with automatic unit conversion',
               1,
               'scale:parampool',
               'scale:parampool'),
              ('Example application', 3, None, '___sec11'),
              ('Pool of parameters', 2, None, '___sec12'),
              ('Fetching pool data for computing', 2, None, '___sec13'),
              ('Reading command-line options', 2, None, '___sec14'),
              ('Setting default values in a file', 2, None, '___sec15'),
              ('Specifying multiple values of input parameters',
               2,
               None,
               '___sec16'),
              ('Generating a graphical user interface', 2, None, '___sec17'),
              ('ODE models', 0, None, '___sec18'),
              ('Exponential decay problems',
               1,
               'sec:scale:decay',
               'sec:scale:decay'),
              ('Fundamental ideas', 2, None, '___sec20'),
              ('The basic model problem', 2, None, '___sec21'),
              ('Example: Population dynamics', 3, None, '___sec22'),
              ('Example: Decay of pressure with altitude',
               3,
               None,
               '___sec23'),
              ('The technical steps of the scaling procedure',
               2,
               'sec:scale:decay:steps',
               'sec:scale:decay:steps'),
              ('Step 1: Identify independent and dependent variables',
               3,
               None,
               '___sec25'),
              ('Step 2: Make independent and dependent variables dimensionless',
               3,
               None,
               '___sec26'),
              ('Step 3: Derive the model involving only dimensionless variables',
               3,
               None,
               '___sec27'),
              ('Step 4: Make each term dimensionless', 3, None, '___sec28'),
              ('Step 5: Estimate the scales', 3, None, '___sec29'),
              ('Making software for utilizing the scaled model',
               2,
               'sec:scale:decay:prog',
               'sec:scale:decay:prog'),
              ('Software for the original problem with dimensions',
               3,
               None,
               '___sec31'),
              ('Avoiding unnecessary computations', 3, None, '___sec32'),
              ('Implementation with joblib', 3, None, '___sec33'),
              ('Scaling a generalized problem',
               2,
               'sec:scale:decay:body',
               'sec:scale:decay:body'),
              ('Exact solution', 3, None, '___sec35'),
              ('Theory', 3, None, '___sec36'),
              ('Software', 3, None, '___sec37'),
              ('Variable coefficients',
               2,
               'sec:scale:decay:jump',
               'sec:scale:decay:jump'),
              ('Scaling a cooling problem with constant surroundings',
               2,
               'scale:decay:cooling:const',
               'scale:decay:cooling:const'),
              ('Exact solution', 3, None, '___sec40'),
              ('Scaling', 3, None, '___sec41'),
              ('Software', 3, None, '___sec42'),
              ('Alternative scaling', 3, None, '___sec43'),
              ('Scaling a cooling problem with time-dependent surroundings',
               2,
               'scale:decay:cooling:osc',
               'scale:decay:cooling:osc'),
              ('Exact solution', 3, None, '___sec45'),
              ('Scaling', 3, None, '___sec46'),
              ('Software', 3, None, '___sec47'),
              ('Discussion of the time scale', 3, None, '___sec48'),
              ('Scaling a nonlinear ODE',
               2,
               'sec:scale:decay:nonlinear',
               'sec:scale:decay:nonlinear'),
              ('Scaling', 3, None, '___sec50'),
              ('Alternative scaling', 3, None, '___sec51'),
              ('SIR ODE system for spreading of diseases',
               2,
               None,
               '___sec52'),
              ('Scaling', 3, None, '___sec53'),
              ('Software', 3, None, '___sec54'),
              ('Alternative scaling', 3, None, '___sec55'),
              ('SIRV model with finite immunity', 2, None, '___sec56'),
              ('Michaelis-Menten kinetics for biochemical reactions',
               2,
               'scale:MMK',
               'scale:MMK'),
              ('Classical analysis', 3, None, '___sec58'),
              ('Dimensionless ODE system', 3, None, '___sec59'),
              ('Determining scales', 3, None, '___sec60'),
              ('Analysis of the scaled system', 3, None, '___sec61'),
              ('Vibration problems', 1, 'sec:scale:vib', 'sec:scale:vib'),
              ('Undamped vibrations without forcing',
               2,
               'sec:scale:vib:undamped',
               'sec:scale:vib:undamped'),
              ('The first technical steps of scaling', 3, None, '___sec64'),
              ('The exact solution', 3, None, '___sec65'),
              ('Discussion of the displacement scale', 3, None, '___sec66'),
              ('Discussion of the time scale', 3, None, '___sec67'),
              ('The dimensionless solution', 3, None, '___sec68'),
              ('Alternative displacement scale', 3, None, '___sec69'),
              ('About frequency and dimensions', 3, None, '___sec70'),
              ('Undamped vibrations with constant forcing',
               2,
               'sec:scale:vib:undamped:mg',
               'sec:scale:vib:undamped:mg'),
              ('Undamped vibrations with time-dependent forcing',
               2,
               'sec:scale:vib:undamped:F',
               'sec:scale:vib:undamped:F'),
              ('Investigating scales via analytical solutions',
               3,
               None,
               '___sec73'),
              ('The displacement and time scales', 3, None, '___sec74'),
              ('Finding the displacement scale from the differential equation',
               3,
               None,
               '___sec75'),
              ('Scaling with free vibrations as time scale',
               3,
               None,
               '___sec76'),
              ('Software', 3, None, '___sec77'),
              ('Choice of $u_c$ close to resonance', 3, None, '___sec78'),
              ('Unit size of all terms in the ODE', 3, None, '___sec79'),
              ('Choice of $u_c$ when $\\psi\\gg\\omega$',
               3,
               None,
               '___sec80'),
              ('Displacement scale based on $I$', 3, None, '___sec81'),
              ('Damped vibrations with forcing',
               2,
               'sec:scale:vib:damped:F',
               'sec:scale:vib:damped:F'),
              ('The exact solution', 3, None, '___sec83'),
              ('Choosing scales', 3, None, '___sec84'),
              ('Choice of $u_c$ at resonance', 3, None, '___sec85'),
              ('Choice of $u_c$ when $\\omega\\gg\\psi$',
               3,
               None,
               '___sec86'),
              ('Choice of $u_c$ when $\\omega\\ll\\psi$',
               3,
               None,
               '___sec87'),
              ('Software', 3, None, '___sec88'),
              ('Oscillating electric circuits', 2, None, '___sec89'),
              ('Basic PDE models', 0, None, '___sec90'),
              ('The wave equation', 1, 'sec:scale:wave', 'sec:scale:wave'),
              ('Simple homogeneous Dirichlet conditions',
               2,
               None,
               '___sec92'),
              ('Implementation of the scaled wave equation',
               2,
               None,
               '___sec93'),
              ('Waves on a string', 3, None, '___sec94'),
              ('Detecting an already computed case', 3, None, '___sec95'),
              ('Time-dependent Dirichlet condition',
               2,
               'scale:wave:pde2',
               'scale:wave:pde2'),
              ('Scaling', 3, None, '___sec97'),
              ('Software', 3, None, '___sec98'),
              ('Specific case', 3, None, '___sec99'),
              ('Velocity initial condition',
               2,
               'scale:wave:pde2:Vcond',
               'scale:wave:pde2:Vcond'),
              ('Analytical insight', 3, None, '___sec101'),
              ('Scaling', 3, None, '___sec102'),
              ('Nonzero initial shape', 3, None, '___sec103'),
              ('Variable wave velocity and forcing',
               2,
               'scale:wave:pde2:cvar',
               'scale:wave:pde2:cvar'),
              ('Non-dimensionalization', 3, None, '___sec105'),
              ('Choosing the time scale', 3, None, '___sec106'),
              ('Choosing the spatial scale', 3, None, '___sec107'),
              ('Scaling the velocity initial condition',
               3,
               None,
               '___sec108'),
              ('Damped wave equation',
               2,
               'scale:wave:pde2:damped',
               'scale:wave:pde2:damped'),
              ('A three-dimensional wave equation problem',
               2,
               None,
               '___sec110'),
              ('The diffusion equation',
               1,
               'sec:scale:diffu',
               'sec:scale:diffu'),
              ('Homogeneous 1D diffusion equation',
               2,
               'sec:scale:diffu:homo1D',
               'sec:scale:diffu:homo1D'),
              ('Generalized diffusion PDE', 2, None, '___sec113'),
              ('Jump boundary condition', 2, None, '___sec114'),
              ('Oscillating Dirichlet condition', 2, None, '___sec115'),
              ('Scaling', 3, None, '___sec116'),
              ('Reaction-diffusion equations',
               1,
               'sec:scale:diffu:Fisher',
               'sec:scale:diffu:Fisher'),
              ("Fisher's equation", 2, None, '___sec118'),
              ('Balance of all terms', 3, None, '___sec119'),
              ('Fixed length scale', 3, None, '___sec120'),
              ('Nonlinear reaction-diffusion PDE', 2, None, '___sec121'),
              ('The convection-diffusion equation',
               1,
               'scale:convdiff',
               'scale:convdiff'),
              ('Convection-diffusion without a force term',
               2,
               None,
               '___sec123'),
              ('Stationary PDE', 2, None, '___sec124'),
              ('Convection-diffusion with a force term',
               2,
               'scale:convdiff:f',
               'scale:convdiff:f'),
              ('Advanced PDE models', 0, None, '___sec126'),
              ('The equations of linear elasticity',
               1,
               'scale:elasticity',
               'scale:elasticity'),
              ('The general time-dependent elasticity problem',
               2,
               'scale:elasticity:timedep',
               'scale:elasticity:timedep'),
              ('Software', 3, None, '___sec129'),
              ('Dimensionless stress tensor',
               2,
               'scale:elasticity:PDE1:stress',
               'scale:elasticity:PDE1:stress'),
              ('When can the acceleration term be neglected?',
               2,
               'scale:elasticity:waves',
               'scale:elasticity:waves'),
              ('S waves', 3, None, '___sec132'),
              ('P waves', 3, None, '___sec133'),
              ('Time-varying load', 3, None, '___sec134'),
              ('The stationary elasticity problem', 2, None, '___sec135'),
              ('Scaling of the PDE', 3, None, '___sec136'),
              ('Scaling of displacement boundary conditions',
               3,
               None,
               '___sec137'),
              ('Scaling of traction boundary conditions',
               3,
               None,
               '___sec138'),
              ('Quasi-static thermo-elasticity',
               2,
               'scale:elasticity:thermo',
               'scale:elasticity:thermo'),
              ('The Navier-Stokes equations',
               1,
               'sec:scale:ns',
               'sec:scale:ns'),
              ('The momentum equation without body forces',
               2,
               None,
               '___sec141'),
              ('Scaling', 3, None, '___sec142'),
              ('Dimensonless PDEs and the Reynolds number',
               3,
               None,
               '___sec143'),
              ('Scaling of time for low Reynolds numbers',
               2,
               None,
               '___sec144'),
              ('Shear stress as pressure scale', 2, None, '___sec145'),
              ('Gravity force and the Froude number', 2, None, '___sec146'),
              ('Oscillating boundary conditions and the Strouhal number',
               2,
               None,
               '___sec147'),
              ('Cavitation and the Euler number', 2, None, '___sec148'),
              ('Free surface conditions and the Weber number',
               2,
               None,
               '___sec149'),
              ('Thermal convection', 1, None, '___sec150'),
              ('Forced convection', 2, None, '___sec151'),
              ('Free convection',
               2,
               'scale:fluid:forced_convection',
               'scale:fluid:forced_convection'),
              ('Governing equations', 3, None, '___sec153'),
              ('Heating by viscous effects', 3, None, '___sec154'),
              ('Relation between density and temperature',
               3,
               None,
               '___sec155'),
              ('Comment on the form of the equation of continuity',
               3,
               None,
               '___sec156'),
              ('The Boussinesq approximation', 3, None, '___sec157'),
              ('Scaling', 3, None, '___sec158'),
              ('The Grashof, Prandtl, and Eckert numbers',
               2,
               None,
               '___sec159'),
              ('Interpretations of the Grashof number', 3, None, '___sec160'),
              ('Heat transfer at boundaries and the Nusselt number',
               2,
               None,
               '___sec161'),
              ('The bidomain model in electrophysiology',
               1,
               'scale:bidomain',
               'scale:bidomain'),
              ('Two-phase porous media flow', 1, None, '___sec163'),
              ('The Euler equations of gas dynamics',
               1,
               'scale:Euler_eqs',
               'scale:Euler_eqs'),
              ('Scaling', 3, None, '___sec165'),
              ('Exercises', 1, None, '___sec166'),
              ('Exercise 1: Perform unit conversion',
               2,
               'sec:scale:exer:US2SI1',
               'sec:scale:exer:US2SI1'),
              ('Problem 2: Scale a simple formula',
               2,
               'sec:scale:exer:ball_y',
               'sec:scale:exer:ball_y'),
              ('Exercise 3: Perform alternative scalings',
               2,
               'sec:scale:exer:decay:cooling:osc',
               'sec:scale:exer:decay:cooling:osc'),
              ('Problem 4: Scale a nonlinear ODE',
               2,
               'sec:scale:exer:ball_y_wdrag',
               'sec:scale:exer:ball_y_wdrag'),
              ('Exercise 5: Implement a scaled model with jump',
               2,
               'sec:scale:exer:decay:jump',
               'sec:scale:exer:decay:jump'),
              ('Exercise 6: Implement a scaled model for cooling',
               2,
               'sec:scale:exer:decay:cooling',
               'sec:scale:exer:decay:cooling'),
              ('Problem 7: Scale variable coefficients',
               2,
               'scale:decay:exer:decay:step',
               'scale:decay:exer:decay:step'),
              ('Exercise 8: Alternative scalings of a cooling model',
               2,
               'scale:decay:exer:cooling:Ts',
               'scale:decay:exer:cooling:Ts'),
              ('Exercise 9: Alternative scalings of a cooling model',
               2,
               'scale:decay:exer:nonlin:logistic2',
               'scale:decay:exer:nonlin:logistic2'),
              ('Exercise 10: Scale projectile motion',
               2,
               'scale:vib:exer:projectile',
               'scale:vib:exer:projectile'),
              ('Problem 11: Scale a predator-prey model',
               2,
               'scale:decay:exer:predpray',
               'scale:decay:exer:predpray'),
              ('Problem 12: Scale a model for competing species',
               2,
               'scale:decay:exer:competing_species',
               'scale:decay:exer:competing_species'),
              ('Problem 13: Find the period of sinusoidal signals',
               2,
               'scale:decay:exer:sine',
               'scale:decay:exer:sine'),
              ('Remarks', 3, None, '___sec180'),
              ('Problem 14: Scale the pendulum equation',
               2,
               'sec:scale:exer:pendulum',
               'sec:scale:exer:pendulum'),
              ('Exercise 15: Scale the ODEs for a binary star',
               2,
               'sec:scale:exer:binary_star',
               'sec:scale:exer:binary_star'),
              ("Problem 16: Scale Duffing's equation",
               2,
               'scale:vib:exer:Duffing',
               'scale:vib:exer:Duffing'),
              ('Problem 17: Scale a stationary Couette flow',
               2,
               'scale:vib:exer:stationary_Couette',
               'scale:vib:exer:stationary_Couette'),
              ('Remarks', 3, None, '___sec185'),
              ('Problem 18: Scale a starting Couette flow',
               2,
               'scale:vib:exer:starting_Couette',
               'scale:vib:exer:starting_Couette'),
              ('Exercise 19: Scale Couette flow with pressure gradient',
               2,
               'scale:vib:exer:Couette_wpressure',
               'scale:vib:exer:Couette_wpressure'),
              ('Exercise 20: Scale pulsatile pipeflow',
               2,
               'scale:exer:pipeflow:pulsatile',
               'scale:exer:pipeflow:pulsatile'),
              ('Exercise 21: Scale the linear cable equation',
               2,
               'scale:exer:cable_eq',
               'scale:exer:cable_eq'),
              ('Exercise 22: Comparison of vibration models for elastic structures',
               2,
               'scale::exer:elasticity:vibmodels',
               'scale::exer:elasticity:vibmodels'),
              ('Exercise 23: Scale the equations of quasi-static poro-elasticity',
               2,
               'scale:exer:poroelasticity',
               'scale:exer:poroelasticity'),
              ('Exercise 24: Suggestions...',
               2,
               'scale::exer:suggest',
               'scale::exer:suggest'),
              ('References', 1, None, '___sec193')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\half}{\frac{1}{2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\x}{\boldsymbol{x}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\rpos}{\boldsymbol{r}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\stress}{\boldsymbol{\sigma}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\U}{\boldsymbol{U}}
\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href=".trash82dee82e1274a586571086dca04d00308d3a0d86.html">Scaling of Differential Equations</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86001.html#ch:preface" style="font-size: 80%;">Preface</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#scale:dimunit" style="font-size: 80%;">Dimensions and units</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#___sec18" style="font-size: 80%;">ODE models</a></li>
     <!-- navigation toc: --> <li><a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86007.html#___sec90" style="font-size: 80%;">Basic PDE models</a></li>
     <!-- navigation toc: --> <li><a href="#___sec126" style="font-size: 80%;">Advanced PDE models</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0010"></a>
<!-- !split -->

<center><h1 id="___sec126">Advanced PDE models </h1></center> <!-- chapter heading -->

<p>
This final chapter addresses more complicated PDE models, including
linear elasticity, viscous flow, heat transfer, porous media flow,
gas dynamics, and electrophysiology. A range of
classical dimensionless numbers are discussed in terms of the scaling.

<h1 id="scale:elasticity">The equations of linear elasticity</h1>

<p>
To the best of the authors' knowledge, it seems that mathematical
models in elasticity and structural analysis are almost never
non-dimensionalized. This is probably due to tradition, but the
following sections will demonstrate the usefulness of scaling also in
this scientific field.

<h2 id="scale:elasticity:timedep">The general time-dependent elasticity problem</h2>

<p>
The following vector PDE governs deformation and stress in purely elastic
materials, under the assumption of small displacement gradients:

$$
\begin{equation}
\varrho\frac{\partial^2\u}{\partial t^2} =
\nabla ((\lambda + \mu)\nabla\cdot\u) + \nabla\cdot(\mu\nabla\u) +
\varrho\f\tp
\tag{170}
\end{equation}
$$

Here, \( \u \) is the displacement vector,
\( \varrho \) is the density of the material, \( \lambda \) and \( \mu \) are
the Lame elasticity parameters, and \( \f \) is a body force (gravity,
centrifugal force, or similar).

<p>
We introduce dimensionless variables:

$$ \bar\u = u_c^{-1}\u,\quad \bar x = \frac{x}{L},\quad \bar t = \frac{f}{t_c},$$

where \( L \) is some length scale we used to scale \( y \) and \( z \) as well.
Also the elasticity parameters and the density can be scaled, if they
are not constants,

$$ \bar\lambda = \frac{\lambda}{\lambda_c},\quad
\bar\mu = \frac{\mu}{\mu_c},\quad
\bar\varrho = \frac{\varrho}{\varrho_c},$$

where the characteristic quantities are typically spatial maximum values of
the functions:

$$ \lambda_c = \max_{x,y,z}\lambda,\quad
\mu_c = \max_{x,y,z}\mu,\quad
\varrho_c = \max_{x,y,z}\varrho\tp$$

Finally, we scale \( \f \) too (if not constant):

$$ \bar\f = f_c^{-1}\f,\quad f_c = \max_{x,y,z,t}||\f||\tp$$

<p>
Inserting the dimensionless quantities in the governing vector PDE results in

$$
\frac{\varrho_c u_c}{t_c^2}
\frac{\partial^2\bar \u}{\partial \bar t^2} =
L^{-2}u_c\bar \nabla ((\lambda_c\bar\lambda +
\mu_c\bar\mu)\bar \nabla\cdot\bar \u) +
L^{-2}u_c\mu_c\bar \nabla\cdot(\bar \mu\bar \nabla\bar \u) +
\varrho_cf_c\bar\varrho\bar\f\tp
$$

Making the terms non-dimensional gives the equation

$$
\begin{equation}
\bar\varrho\frac{\partial^2\bar \u}{\partial \bar t^2} =
\frac{t_c^2\lambda_c}{L^2\varrho_c}
\bar \nabla (\bar\lambda\bar\nabla\cdot\bar u) +
\frac{t_c^2\mu_c}{L^2\varrho_c}
\bar\nabla(\bar\mu \bar\nabla\cdot\bar \u) +
\frac{t_c^2\mu_c}{L^2\varrho_c}\bar \nabla\cdot(\bar \mu\bar \nabla\bar \u) +
\frac{t_c^2f_c}{u_c}\bar\varrho\bar\f\tp
\tag{171}
\end{equation}
$$

We may choose \( t_c \) to make the coefficient in front of any of the spatial
derivative terms equal unity. Here we choose the \( \mu \) term, which implies

$$ t_c = L\sqrt{\frac{\varrho_c}{\mu_c}}\tp$$

The scale for \( \u \) can be chosen from an initial displacement or by
making the coefficient in front of the \( \bar\f \) term unity. The latter
means

$$ u_c = \mu_c^{-1}f_cL^2\varrho_c\tp$$

The resulting dimensionless PDE becomes

$$
\begin{equation}
\bar\varrho\frac{\partial^2\bar \u}{\partial \bar t^2} =
\bar \nabla ((\beta\bar\lambda + \bar\mu)\bar\nabla\cdot\bar u) +
\bar \nabla\cdot(\bar \mu\bar \nabla\bar \u) +
\bar\varrho\bar\f\tp
\tag{172}
\end{equation}
$$

The only dimensionless parameter is

$$ \beta = \frac{\lambda_c}{\mu_c}\tp$$

If the source term is absent, we must use the initial condition or
a known boundary displacement to
determine \( u_c \).

<h3 id="___sec129">Software </h3>

<p>
Given software for <a href="#mjx-eqn-170">(170)</a>,
we can simulate the dimensionless problem by setting \( \varrho =\bar\varrho \),
\( \lambda =\beta\bar\lambda \), and \( \mu = \bar\mu \).

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 22</b>: What about setting boundary conditions?)</font>
<!-- end inline comment -->

<h2 id="scale:elasticity:PDE1:stress">Dimensionless stress tensor</h2>

<p>
The stress tensor \( \stress \) is a key quantity in elasticity and is given by

$$ \stress = \lambda\nabla\cdot\u\I + \mu(\nabla\u + (\nabla\u)^T)\tp$$

This \( \stress \) can be computed as soon as the PDE problem for \( \u \)
has been solved.
Inserting dimensionless variables on the right-hand side of the above
relation gives

$$
\begin{align*}
\stress &= \lambda_cu_cL^{-2}\bar\lambda\bar\nabla\cdot\bar\u
+ \mu_cu_cL^{-1}\bar\mu(\bar\nabla\bar\u + (\bar\nabla\bar\u)^T)\\ 
&= \mu_c u_cL^{-1}\left(\beta\bar\lambda\bar\nabla\cdot\bar\u +
\bar\mu(\bar\nabla\bar\u + (\bar\nabla\bar\u)^T)\right)\tp
\end{align*}
$$

The coefficient on the right-hand side, \( \mu_c u_cL^{-1} \), has dimension
of stress, since (according to the second table in
the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86004.html#scale:dimunit:tables">Dimensions of common physical quantities</a>) \( [\hbox{M}\hbox{T}^{-2}\hbox{L}^{-1})(\hbox{L})(\hbox{L}^{-1})]
=[\hbox{M}\hbox{T}^{-2}\hbox{L}^{-1}] \), which is the dimension of stress.
The quantity \( \mu_c u_cL^{-1} \) is therefore the natural scale of the
stress tensor:

$$ \bar\stress = \frac{\stress}{\sigma_c},\quad \sigma_c = \mu_c u_c L^{-1},$$

and we have the dimensionless stress-displacement relation

$$
\begin{equation}
\bar\stress =
\beta\bar\lambda\bar\nabla\cdot\bar\u +
\bar\mu(\bar\nabla\bar\u + (\bar\nabla\bar\u)^T)\tp
\tag{173}
\end{equation}
$$

<h2 id="scale:elasticity:waves">When can the acceleration term be neglected?</h2>

<p>
A lot of applications of the elasticity equation involves static or
quasi-static deformations where the acceleration term
\( \varrho\u_{tt} \) is neglected. Now we shall see under which conditions
the quasi-static approximation holds.

<p>
The further discussion will need to look into the time scales of
elastic waves, because it turns out that the chosen \( t_c \) above is
closely linked to the propagation speed of elastic waves in a
homogeneous body without body forces.  A relevant model for
such waves has constant
\( \varrho \), \( \lambda \), and \( \mu \), and no force term:

$$
\begin{equation}
\varrho\frac{\partial^2\u}{\partial t^2} =
(\lambda + \mu)\nabla \nabla\cdot\u + \mu\nabla^2\u\tp
\tag{174}
\end{equation}
$$

<h3 id="___sec132">S waves </h3>

<p>
Let us take the curl of this PDE and notice
that the curl of a  gradient vanishes. The result is

$$\frac{\partial^2}{\partial t^2}\nabla\times\u = c_S^2\nabla^2\nabla\times\u,$$

i.e., a wave equation for \( \nabla\times\u \). The wave velocity is

$$ c_S = \sqrt{\frac{\mu}{\varrho}}\tp$$

The corresponding waves are called
<a href="https://en.wikipedia.org/wiki/S-wave" target="_self">S waves</a>. The curl of a
displacement field is closely related to rotation of continuum elements.

<p>
The divergence of a displacement field can be interpreted as the
volume change of continuum elements. Suppose this volume change vanishes,
\( \nabla\cdot\u = 0 \), which means that the material is incompressible.
The elasticity equation then simplifies to

$$\frac{\partial^2 \u}{\partial t^2} = c_S^2\nabla^2\u,$$

so each component of
the displacement field in this case also propagates as a wave
with speed \( c_S^2 \).
The time it takes for such a wave to travel one characteristic length
\( L \) is \( L/c_S \), i.e., \( L\sqrt{\varrho/\mu} \), which is nothing but
our characteristic time \( t_c \).

<h3 id="___sec133">P waves </h3>

<p>
We may take the divergence of the PDE instead and notice that \( \nabla\cdot\nabla
=\nabla^2 \) so

$$\frac{\partial^2}{\partial t^2}\nabla\cdot\u = c_P^2\nabla^2\nabla\cdot\u,$$

with wave velocity

$$ c_P = \sqrt{\frac{\lambda +2\mu}{\varrho}}\tp$$

That is, the volume change propagates as a wave with speed \( c_P \).
These type of waves are called <a href="https://en.wikipedia.org/wiki/P-wave" target="_self">P waves</a>.

<p>
Suppose now that \( \nabla\times\u =0 \), i.e., there is no rotation (&quot;shear&quot;) of
continuum elements. Mathematically this condition implies that
\( \nabla^2\u = \nabla(\nabla\cdot\u) \) (see any book on vector calculus
or <a href="https://en.wikipedia.org/wiki/Vector_calculus_identities" target="_self">Wikipedia</a>).
Our model equation <a href="#mjx-eqn-174">(174)</a> then reduces to

$$ \frac{\partial^2\u}{\partial t^2} = c_P^2\nabla^2\u,$$

which is nothing but a wave equation for each component of the
displacement field.

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 23</b>: Think about the suitability of &quot;no shear&quot; as characteristic for curl-free \( \u \).)</font>
<!-- end inline comment -->

<h3 id="___sec134">Time-varying load </h3>

<p>
Suppose we have some time-varying boundary condition on \( \u \) or the
stress vector (traction) that has time scale \( \omega \) (some
oscillating movement that goes like \( \sin\omega t \) is an example). We
choose \( t_c=1/\omega \).  The scaling now leads to

$$
\gamma
\frac{\partial^2\bar \u}{\partial \bar t^2} =
\bar \nabla ((\beta\bar\lambda +
\bar\mu)\bar \nabla\cdot\bar \u) +
\bar \nabla\cdot(\bar \mu\bar \nabla\bar \u) +
\bar\varrho\bar\f\tp
$$

where we have set

$$ u_c = \mu_c^{-1}f_cL^2\varrho_c,$$

as before, and \( \gamma \) is a new dimensionless number,

$$ \gamma = \frac{\varrho_cL^2 \omega^2}{\mu_c} =
\left(\frac{L\sqrt{\varrho_c/\mu_c}}{1/\omega}\right)^2\tp$$

The last rewrite shows that \( \sqrt{\gamma} \) is the ratio of
the time scale for S waves and the time scale for the forced
movement on the boundary. The acceleration term can therefore
be neglected when \( \gamma\ll 1 \), i.e., when the time scale
for movement on the boundary is much larger than the time it
takes for the S waves to travel through the domain.
Since the velocity of S waves in solids is very large and
the time scale correspondingly small, \( \gamma\ll 1 \)
is very often the case in applications involving structural analysis.
<a href="#scale::exer:elasticity:vibmodels">Exercise 22: Comparison of vibration models for elastic structures</a> explores related
models and asks for comparisons of time scales for waves and
mechanical vibrations in structures.

<h2 id="___sec135">The stationary elasticity problem </h2>

<h3 id="___sec136">Scaling of the PDE </h3>

<p>
We now look at the stationary version of
<a href="#mjx-eqn-170">(170)</a> where the \( \varrho\u_{tt} \) term is
removed. The first step in the scaling is just inserting the
dimensionless variables:

$$
0 =
L^{-2}u_c\bar \nabla ((\lambda_c\bar\lambda +
\mu_c\bar\mu)\bar \nabla\cdot\bar \u) +
L^{-2}u_c\mu_c\bar \nabla\cdot(\bar \mu\bar \nabla\bar \u) +
\varrho_cf_c\bar\varrho\bar\f\tp
$$

Dividing by \( L^2u_c\mu_c \) gives

$$
0 =
\bar \nabla ((\beta\bar\lambda +
\bar\mu)\bar \nabla\cdot\bar \u) +
\bar \nabla\cdot(\bar \mu\bar \nabla\bar \u) +
\frac{L^2\varrho_cf_c}{u_c\mu_c}\bar\varrho\bar\f\tp
$$

Choosing \( u_c = \varrho L^2f_c/\mu_c \) as before leads to

$$
\begin{equation}
\bar \nabla ((\beta\bar\lambda +
\bar\mu)\bar \nabla\cdot\bar \u) +
\bar \nabla\cdot(\bar \mu\bar \nabla\bar \u) +
\bar\varrho\bar\f = 0\tp
\tag{175}
\end{equation}
$$

<p>
A homogeneous material with constant \( \lambda \), \( \mu \), and \( \varrho \)
is an interesting case (this corresponds to \( \mu_c=\mu \), \( \lambda_c=\lambda \),
\( \varrho_c=\varrho \), \( \bar\varrho=\bar\lambda=\bar\mu=1 \)):

$$
\begin{equation}
(1+\beta)\bar \nabla(\bar \nabla\cdot\bar \u) +
\bar \nabla^2\bar \u) +
\bar\f = 0\tp
\tag{176}
\end{equation}
$$

Now \( \beta \) is defined as

$$ \beta = \frac{\lambda}{\mu} = \left(\frac{c_p}{c_s}\right)^2 - 2\tp$$

It shows that in standard, stationary elasticity, \( \lambda/\mu \) is the
only significant physical parameter.

<h3 id="___sec137">Scaling of displacement boundary conditions </h3>

<p>
A typical boundary condition on a part of the boundary is a prescribed
displacement. For simplicity we set \( \u = \U_0 \) for a constant vector
\( \U_0 \) as boundary condition. With \( u_c=\varrho L^2f_c/\mu \), we get
the dimensionless condition

$$ \bar\u = \frac{\U_0}{u_c} = \frac{\mu \U_0}{\varrho L^2f_c}\tp$$

In the absence of body forces, the expression for \( u_c \) has no
meaning (\( f_c=0 \)), so then \( u_c = |\U_0| \) is a better choice.
This gives the dimensionless boundary condition

$$ \bar u = \frac{\U_0}{|\U_0|},$$

which is the unit vector in the direction of \( \U_0 \). The new \( u_c \)
changes the coefficient in front of the body force term, if that term
is present, to the dimensionless number

$$ \delta = \frac{L^2\varrho f_c}{\mu |\U_0|}\tp$$

<h3 id="___sec138">Scaling of traction boundary conditions </h3>

<p>
The other type of common boundary condition in elasticity is a
prescribed traction (stress vector) on a part of the boundary:

$$ \stress\cdot\normalvec = \boldsymbol{T}_0,$$

where for simplicity we take \( \boldsymbol{T}_0 \) as a constant vector.
From the section <a href="#scale:elasticity:PDE1:stress">Dimensionless stress tensor</a> we have a stress scale
\( \sigma_c = \mu u_c/L \), but we may alternatively use \( |\boldsymbol{T}_0| \)
as stress scale. In that case,

$$ \bar\stress\cdot\normalvec = \frac{\boldsymbol{T}_0}{|\boldsymbol{T}_0|},$$

which is a unit vector in the direction of \( \boldsymbol{T}_0 \).
Many applications involve large traction free areas on the boundary, on
which we simply have \( \bar\stress\cdot\normalvec = 0 \).

<h2 id="scale:elasticity:thermo">Quasi-static thermo-elasticity</h2>

<p>
Heating solids give rise to expansion, i.e., strains, which may cause
stress if displacements are constrained. The time scale of temperature
changes are usually much larger than the time scales of elastic waves,
so the stationary equations of elasticity can be used, but a term
depends on the temperature, so the equations must be coupled to
a PDE for heat transfer in solids. The resulting system of PDE is
known as the equations of <em>thermo-elasticity</em> and reads

$$
\begin{align}
\nabla((\lambda + \mu)\nabla\cdot\u) + \nabla\cdot(\mu\nabla\u) &= \alpha\nabla T -\varrho\f,
\tag{177}\\ 
\varrho c \frac{\partial T}{\partial t} &= \nabla\cdot(\kappa\nabla T) + \varrho \f_T,
\tag{178}
\end{align}
$$

where \( T \) is the temperature, \( \alpha \) is a coefficient of thermal expansion,
\( c \) is a heat capacity, \( \kappa \) is the heat conduction coefficient,
and \( \f_T \) is some heat source. Most thermo-elasticity applications have
\( \f_T=0 \) so we drop this term. Most applications also involve some heating
from a temperature level \( T_0 \) to some level \( T_0 +\Delta T \).
A suitable scaling for \( T \) is therefore

$$ \bar T = \frac{T-T_0}{\Delta T},$$

so that \( \bar T\in [0,1] \). The elasticity equation has already been scaled
and so has the diffusion equation for \( T \). We base the time scale on
the diffusion, i.e., the thermal conduction process:

$$ t_c = \varrho c L^2/\kappa_c\tp$$

We imagine that \( \kappa \) is scaled as \( \bar\kappa = \kappa/\kappa_c \).
The dimensionless PDE system then becomes

$$
\begin{align}
\bar \nabla((1+\beta)\bar\mu\bar\nabla\cdot\bar\u) + \bar\nabla\cdot(\bar\mu\bar\nabla\bar\u) &= \bar\nabla\bar T
-\epsilon\bar\varrho\bar\f,
\tag{179}\\ 
\frac{\partial \bar T}{\partial \bar t} &= \bar \nabla\cdot(\bar\kappa\bar\nabla\bar T)\tp
\tag{180}
\end{align}
$$

Here we have chosen \( u_c \) such that
the &quot;heating source term&quot; has a unit coefficient, acknowledging that
this thermal expansion balances the stress terms with \( \bar\u \). The
corresponding displacement scale is

$$ u_c = \frac{\alpha L\Delta T}{\mu_c}\tp$$

The dimensionless number in the body force term is therefore

$$ \epsilon = \frac{L\varrho_c f_c}{\alpha \Delta T},$$

which measures the ratio of the body force term and the &quot;heating source
term&quot;.

<p>
A homogeneous body with constant \( \varrho \), \( \lambda \), \( \mu \), \( c \), and \( \kappa \)
is common. The PDE system reduces in this case to

$$
\begin{align}
\bar \nabla((1+\beta)\bar\nabla\cdot\bar\u) + \bar\nabla^2\bar\u) &= \bar\nabla\bar T -\epsilon\bar\f,
\tag{181}\\ 
\frac{\partial \bar T}{\partial \bar t} &= \bar \nabla^2\bar T\tp
\tag{182}
\end{align}
$$

In the absence of body forces, \( \beta \) is again the key parameter.

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 24</b>: Any need to mention boundary conditions?)</font>
<!-- end inline comment -->

<h1 id="sec:scale:ns">The Navier-Stokes equations</h1>

<p>
This section presents scalings of various versions of the
equations governing incompressible viscous fluid flow. We start
with the plain Navier-Stokes equations without body forces and
progress with adding the gravity force and a free surface. We
also look at scaling low Reynolds number flow and oscillating flows.

<h2 id="___sec141">The momentum equation without body forces </h2>

<p>
The Navier-Stokes equations for incompressible viscous fluid flow
without body forces take the form

$$
\begin{align}
\varrho\left(\frac{\partial \u}{\partial t} + \u\cdot\nabla\u\right)
&= -\nabla p + \mu\nabla^2\u,
\tag{183}\\ 
\nabla\cdot\u & = 0\tp
\tag{184}
\end{align}
$$

The primary unknowns are the
velocity \( \u \) and the pressure \( p \). Moreover,
\( \varrho \) is the fluid density, and \( \mu \) is the dynamic viscosity.

<h3 id="___sec142">Scaling </h3>

<p>
We introduce as usual dimensionless independent and dependent variables:

$$ \bar x = \frac{x}{L},\quad \bar y = \frac{y}{L},\quad
\bar z= \frac{z}{L},\quad \bar t = \frac{t}{t_c},\quad
\bar\u = \frac{\u}{u_c},\quad \bar p = \frac{p}{p_c},$$

where \( L \) is some characteristic distance,
\( t_c \) is some characteristic time, \( u_c \) is a characteristic
velocity, and \( p_c \) is a characteristic pressure.
Inserted in the equations,

$$
\begin{align}
\varrho\left(\frac{u_c}{t_c}\frac{\partial \bar\u}{\partial \bar t} + \frac{u_c^2}{L}\bar\u\cdot\bar\nabla\bar\u\right)
&= -\frac{p_c}{L}\bar\nabla\bar p + \frac{u_c}{L^2}\mu\bar \nabla^2\bar\u,
\tag{185}\\ 
\frac{u_c}{L}\bar\nabla\cdot\bar\u & = 0\tp
\tag{186}
\end{align}
$$

For the velocity it is common to just introduce some \( U \) for
\( u_c \). This \( U \) is normally implied by the problem description.
For example, in the flow configuration below, with flow over a bump,
we have some incoming
flow with a profile \( v(y) \) and \( U \) can typically be chosen as
\( U=\max_y v(y) \).

<p>
<br />
<br />

<p>
<center><p><img src="fig-scaling/flow_over_gaussian.png" align="bottom" width=500></p></center>

<p>
<br />
<br />

<p>
For flow in a channel or tube, we also have some inlet profile, e.g.,
\( v(r) \) in a tube, where \( r \) is the radial coordinate, and a natural
choice of characteristic velocity is \( U=v(0) \) or the average flow

$$ U = \frac{1}{R}\int_0^R v(r)dr,$$

if \( R \) is the radius of the tube. Other examples may be flow around
a body, where there is some distant constant inlet flow \( \u = U_0\ii \),
for instance, and \( U=U_0 \) is an obvious choice. We therefore
assume that the flow problem comes with a natural candidate for \( U \).

<p>
Having a characteristic distance \( L \) and velocity \( U \), an obvious
time measure is \( L/U \) so we set \( t_c=L/U \). Dividing by the
coefficient in front of the time derivative term, creates a pressure
term

$$ \frac{p_c}{\varrho U^2}\bar\nabla\bar p\tp$$

The coefficient suggest a choice \( p_c=\varrho U^2 \) if the pressure
gradient term is to have the same size as the acceleration terms.
This \( p_c \) is a very common pressure scale in fluid mechanics.

<h3 id="___sec143">Dimensonless PDEs and the Reynolds number </h3>

<p>
The discussions so far results in the following dimensionless form of
<a href="#mjx-eqn-183">(183)</a> and <a href="#mjx-eqn-184">(184)</a>:
$$
\begin{align}
\frac{\partial \bar\u}{\partial \bar t} +
\bar\u\cdot\bar\nabla\bar\u
&= -\bar\nabla\bar p + \hbox{Re}^{-1}\nabla^2\u,
\tag{187}\\ 
\bar\nabla\cdot \bar\u &= 0,
\tag{188}
\end{align}
$$

where Re is the famous <em>Reynolds number</em>,

$$ \hbox{Re}= \frac{\varrho UL}{\mu} = \frac{UL}{\nu}\tp$$

The latter expression makes use of the kinematic viscosity \( \nu = \mu/\varrho \).
For viscous fluid flows without body forces there is hence only one
dimensionless number, Re.

<p>
The Reynolds number can be interpreted as the ratio of convection and
viscosity:

$$ \frac{\hbox{convection}}{\hbox{viscosity}} =
\frac{|\varrho\u\cdot\nabla\u|}{|\mu\nabla^2\u|}\sim
\frac{\varrho U^2/L}{\mu U/L^2} =
\frac{UL}{\nu} = \hbox{Re}\tp$$

(We have here used that \( \nabla\u \) goes like \( U/L \) and \( \nabla^2\u \)
goes like \( U/L^2 \).)

<h2 id="___sec144">Scaling of time for low Reynolds numbers </h2>

<p>
As we discussed in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#scale:convdiff">The convection-diffusion equation</a> for the convection-diffusion
equation, there is not just one scaling that fits all problems.
Above, we used \( t_c=L/U \), which is appropriate if convection is
a dominating physical effect. In case the convection term
\( \varrho\u\cdot\nabla\u \)
is much smaller
than the viscosity term \( \mu\nabla^2\u \), i.e., the Reynolds number
is small, the viscosity term is dominating. However,
if the scaling is suitable, the other terms are of order unity, and
\( \hbox{Re}^{-1}\nabla^2\bar\u \) must then also be of unit size,
implying that \( \nabla^2\bar\u \) is small, but then the scaling is
not suitable. In the low-Reynolds number regime, the diffusion effect
of \( \nabla^2\bar\u \) is dominating, and we should use a time scale
based on diffusion rather than convection. Such a time scale is
\( t_c = L^2/(\mu/\varrho) = L^2/\nu \).
With this time scale, the dimensionless Navier-Stokes equations look like

$$
\begin{align}
\frac{\partial \bar\u}{\partial \bar t} +
\hbox{Re}\,\bar\u\cdot\bar\nabla\bar\u
&= -\bar\nabla p + \nabla^2\u,
\tag{189}\\ 
\bar\nabla\cdot\bar\u &= 0\tp
\tag{190}
\end{align}
$$

As stated in the box in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#scale:convdiff">The convection-diffusion equation</a>, <a href="#mjx-eqn-189">(189)</a> is the appropriate PDE for very low Reynolds number flow and
suggests neglecting the convection term.
If the flow is also steady, the time derivative term can be neglected,
and we end up with the so-called <em>Stokes problem</em> for steady, slow, viscous
flow:

$$
\begin{align}
-\bar\nabla p + \nabla^2\u &= 0,
\tag{191}\\ 
\bar\nabla\cdot\bar\u &= 0\tp
\tag{192}
\end{align}
$$

This flow regime is also known as <em>Stokes' flow</em> or <em>creeping flow</em>.

<h2 id="___sec145">Shear stress as pressure scale </h2>

<p>
Instead of using the kinetic energy \( \varrho U^2 \) as pressure scale,
one can use the shear stress \( \mu U/L \) (\( U/L \) reflects the spatial
derivative of the velocity, which enters the shear stress expression
\( \mu\partial u/\partial y \)). Using \( U \) as velocity scale, \( L/U \) as
time scale, and \( \mu U/L \) as pressure scale, results in

$$
\begin{equation}
\hbox{Re}\left(\frac{\partial \bar\u}{\partial \bar t} +
\bar\u\cdot\bar\nabla\bar\u\right)
= -\bar\nabla\bar p + \nabla^2\bar\u\tp
\tag{193}
\end{equation}
$$

Low Reynolds number flow now suggests neglecting both acceleration terms.

<h2 id="___sec146">Gravity force and the Froude number </h2>

<p>
We now add a gravity force to the momentum equation
<a href="#mjx-eqn-183">(183)</a>:

$$
\begin{equation}
\varrho\left(\frac{\partial \u}{\partial t} + \u\cdot\nabla\u\right)
= -\nabla p + \mu\nabla^2\u - \varrho g\kk,
\tag{194}
\end{equation}
$$

where \( g \) is the acceleration of gravity, and \( \kk \) is a unit
vector in the opposite direction of gravity. The new term
takes the following form after non-dimensionalization:

$$ \frac{t_c}{\varrho  u_c}\varrho g \kk =  \frac{Lg}{U^2}\kk
= \hbox{Fr}^{-2}\kk,$$

where Fr is the dimensionless Froude number,

$$ \hbox{Fr} = \frac{U}{\sqrt{Lg}}\tp$$

<h2 id="___sec147">Oscillating boundary conditions and the Strouhal number </h2>

<p>
Many flows have an oscillating nature, often arising from some
oscillating boundary condition. Suppose such a condition at some
boundary \( x=\hbox{const} \) takes the specific form

$$ \u = U\sin(\omega t)\ii\tp$$

The dimensionless counterpart becomes

$$ U\bar\u = U\sin(\omega \frac{L}{U}\bar t)\ii,$$

if \( t_c=L/U \) is the appropriate time scale. This condition can be
written

$$
\begin{equation}
\bar\u = \sin(\hbox{St}\,\bar t),
\tag{195}
\end{equation}
$$

where St is the <em>Strouhal number</em>,

$$
\begin{equation}
\hbox{St} = \frac{\omega L}{U}\tp
\tag{196}
\end{equation}
$$

The two important dimensionless parameters in oscillating flows are
then the Reynolds and Strouhal numbers.

<p>
Even if the boundary conditions
are of steady type, as for flow around a sphere or cylinder,
the flow may at certain Reynolds numbers get unsteady and oscillating.
For \( 10^2 < \hbox{Re} < 10^7 \), steady inflow towards a cylinder will
cause vortex shedding: an array of vortices are periodically shedded
from the cylinder, producing an oscillating flow pattern and force
on the cylinder. The Strouhal number is used to characterize the
frequency of oscillations. The phenomenon, known as <em>von Karman
vortex street</em>, is particularly important if the frequency
of the force on the cylinder hits the free vibration frequency
of the cylinder such that resonance occurs. The result can be large
displacements of the cylinder and structural failure. A famous
case in engineering is the failure of the <a href="https://en.wikipedia.org/wiki/Tacoma_Narrows_Bridge_(1940)" target="_self">Tacoma Narrows suspension
bridge</a>
in 1940, when wind-induced vortex shedding caused resonance
with the free torsional vibrations of the bridge.

<h2 id="___sec148">Cavitation and the Euler number </h2>

<p>
The dimensionless pressure in <a href="#mjx-eqn-187">(187)</a>
made use of the pressure scale \( p_c=\varrho U^2 \). This is an
appropriate scale if the pressure level is not of importance, which
is very often the case since only the pressure <em>gradient</em> enters
the flow equation and drives the flow. However, there are circumstances
where the pressure level is of importance. For example, in some flows
the pressure may become so low that the vapor pressure of the liquid
is reached and that vapor cavities form (a phenomenon known as
<em>cavitation</em>). A more appropriate pressure scale is then
\( p_c = p_{\infty} - p_v \), where \( p_\infty \) is a characteristic
pressure level far from vapor cavities and \( p_v \) is the vapor pressure.
The coefficient in front of the dimensionless pressure gradient is then

$$ \frac{p_{\infty} - p_v}{\varrho U^2}\tp $$

Inspired by Bernoulli's equation \( p + \frac{1}{2}\varrho U^2 = \hbox{const} \)
in fluid mechanics, a factor \( \frac{1}{2} \) is often inserted in the
denominator, and the corresponding dimensionless number,

$$
\begin{equation}
\hbox{Eu} = \frac{p_{\infty} - p_v}{\frac{1}{2}\varrho U^2},
\tag{197}
\end{equation}
$$

is called the <em>Euler number</em>. The pressure gradient term now reads
\( \frac{1}{2}\hbox{Eu}\,\bar\nabla\bar p \). The Euler number
expresses the ratio of pressure differences and the kinetic
energy of the flow.

<h2 id="___sec149">Free surface conditions and the Weber number </h2>

<p>
At a free surface, \( z=\eta(x,y,t) \), the boundary conditions are

$$
\begin{align}
w &= \frac{\partial\eta}{\partial t} + \u\cdot\nabla\eta,
\tag{198}\\ 
p - p_0 &=  - \sigma\left(R_x^{-1} + R_y^{-1}\right)\approx
-\sigma\left(\frac{\partial^2\eta}{\partial x^2} +
\frac{\partial^2\eta}{\partial y^2}\right),
\tag{199}
\end{align}
$$

where \( w \) is the velocity component in the \( z \) direction,
\( p_0 \) is the atmospheric air pressure at the surface,
\( \sigma \) represents the surface tension,
while \( R_x \) and \( R_y \) are radii of curvature of the surface \( z=\eta \),
which for small surface deformations can be approximated by second-order
derivatives of \( \eta \) as indicated.

<p>
The dimensionless form of these conditions starts with inserting the
dimensionless quantities in the equations:

$$
\begin{align*}
u_c\bar w &= \frac{L}{t_c}
\frac{\partial\bar\eta}{\partial\bar t} +
u_c\bar\u\cdot\bar\nabla\bar\eta,\\ 
p_c \bar p &\approx
-\frac{1}{L}\sigma\left(\frac{\partial^2\bar\eta}{\partial \bar x^2} +
\frac{\partial^2\bar\eta}{\partial \bar y^2}\right)\tp
\end{align*}
$$

The characteristic length \( L \) is usually taken as the depth of the fluid
when the surface is flat. We have used
\( \bar p = (p - p_0)/p_c \) for making the pressure dimensionless.
Using \( u_c=U \), \( t_c=L/U \), and \( p_c = \varrho U^2 \), results in

$$
\begin{align}
\bar w &= \frac{\partial\bar\eta}{\partial\bar t} +
\bar\u\cdot\bar\nabla\bar\eta,
\tag{200}\\ 
\bar p &\approx
- \hbox{We}^{-1}\left(\frac{\partial^2\bar\eta}{\partial \bar x^2} +
\frac{\partial^2\bar\eta}{\partial \bar y^2}\right),
\tag{201}
\end{align}
$$

where We is the <em>Weber number</em>,

$$
\begin{equation}
\hbox{We} = \frac{\varrho U^2L}{\sigma}\tp
\label{}
\end{equation}
$$

The Weber number measures the importance of surface tension effects and
is the ratio of the pressure scale \( \varrho U^2 \) and the surface
tension force per area, typically \( \sigma/R_x \) in a 2D problem, which
has size \( \sigma/L \).

<h1 id="___sec150">Thermal convection </h1>

<p>
Temperature differences in fluid flow cause density differences, and since
cold fluid is heavier than hot fluid, the gravity force will induce
flow due to density differences. This effect is called free thermal
convection. Forced convection refers to the case where there is no
feedback from the temperature field to the motion, i.e., temperature
differences do not create motion, and the temperature distribution
is only dependent on a given velocity field.

<h2 id="___sec151">Forced convection </h2>

<p>
The model governing forced convection consists of the Navier-Stokes
equation and the energy equation for the temperature:

$$
\begin{align}
\varrho\left(\frac{\partial \u}{\partial t} + \u\cdot\nabla\u\right)
&= -\nabla p + \mu\nabla^2\u - \varrho g\kk,
\tag{202}\\ 
\nabla\cdot\u & = 0,
\tag{203}\\ 
\varrho c\left(\frac{\partial T}{\partial t} + \u\cdot\nabla T\right)
&= \kappa\nabla^2 T - p\nabla\cdot\u\tp
\tag{204}\\ 
\tag{205}
\end{align}
$$

The symbol \( T \) is the temperature, \( c \) is a heat capacity, and \( \kappa \)
is the heat conduction coefficient for the fluid. The term
\( p\nabla\cdot\u \) in <a href="#mjx-eqn-204">(204)</a>
is usually neglected for liquids, but can be important for gases. We
shall omit it here.

<p>
Despite the fact that \( \varrho \) depends on \( T \), we treat \( \varrho \)
as a constant \( \varrho_0 \). The major effect of the \( \varrho(T) \)
dependence is through the
buoyancy effect caused by the gravity term \( -\varrho(T)g\kk \). We drop this
term, and assume the momentum and continuity equations to be
independent of the temperature. The flow is driven by boundary
conditions, from which we can find a characteristic velocity \( U \).

<p>
We introduce dimensionless parameters according to

$$ \bar x = \frac{x}{L},
\ t_c = \frac{L}{U},\ 
\bar\u = \frac{\u}{U},\ \bar p = \frac{p}{\varrho_0 U^2},\ 
\bar T = \frac{T-T_0}{T_c}\tp$$

Other coordinates are also scaled by \( L \).
The characteristic temperature \( T_c \) is chosen as some range \( \Delta T \),
which depends on the problem and is often given by the
thermal initial and/or
boundary conditions. The reference temperature \( T_0 \) is also
implied by prescribed conditions.
Inserted in the equations, we get

$$
\begin{align*}
\varrho_0\frac{U^2}{L}\frac{\partial \bar\u}{\partial \bar t} +
\varrho_0\frac{U^2}{L}\bar \u\cdot\bar \nabla\bar\u
&= -\frac{\varrho_0 U^2}{L}\bar\nabla \bar p + \frac{\mu U}{L^2}
\bar \nabla^2\bar \u,
\\ 
\frac{U}{L}\bar\nabla\cdot\bar\u & = 0,
\\ 
\varrho_0 c\left(\frac{T_c U}{L}
\frac{\partial \bar T}{\partial \bar t} +
\frac{UT_c}{L}\bar\u\cdot\bar\nabla \bar T\right)
&= \frac{\kappa T_c}{L^2}
\bar \nabla^2 \bar T \tp
\end{align*}
$$

Making each term in each equation dimensionless reduces the system to

$$
\begin{align}
\frac{\partial \bar\u}{\partial \bar t} +
\bar \u\cdot\bar \nabla\bar\u
&= -\bar\nabla \bar p + \hbox{Re}^{-1}\bar \nabla^2\bar \u,
\tag{206}\\ 
\bar\nabla\cdot\bar\u & = 0,
\tag{207}\\ 
\frac{\partial \bar T}{\partial \bar t} +
\bar\u\cdot\bar\nabla \bar T
&= \hbox{Pe}^{-1}
\bar \nabla^2 \bar T\tp
\tag{208}
\end{align}
$$

<p>
The two dimensionless numbers in this system are given by
$$
\hbox{Pe} = \frac{\varrho_0 c UL}{\kappa },\quad
\hbox{Re} = \frac{UL}{\nu}\quad (\nu = \frac{\mu}{\varrho_0})\tp
$$

The Peclet number is here defined as the ratio of the
convection term for heat \( \varrho_0 c U\Delta T/L \) and the
heat conduction term \( \kappa U/L^2 \). The fraction
\( \kappa/(\varrho_0 c) \) is known as the thermal diffusivity,
and if this quantity is given a symbol \( \dfc \), we realize the
relation to the Peclet number defined in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html#scale:convdiff">The convection-diffusion equation</a>.

<h2 id="scale:fluid:forced_convection">Free convection</h2>

<h3 id="___sec153">Governing equations </h3>

<p>
The mathematical model for free thermal convection
consists of the Navier-Stokes equations
coupled to an energy equation governing the temperature:

$$
\begin{align}
\varrho\left(\frac{\partial \u}{\partial t} + \u\cdot\nabla\u\right)
&= -\nabla p + \mu\nabla^2\u - \varrho g\kk,
\tag{209}\\ 
\nabla\cdot\u & = 0,
\tag{210}\\ 
\varrho c\left(\frac{\partial T}{\partial t} + \u\cdot\nabla T\right)
&= \kappa\nabla^2 T + 2\mu\varepsilon_{ij}\varepsilon_{ij} -p\nabla\cdot\u\tp
\tag{211}\\ 
\tag{212}
\end{align}
$$

The symbol \( T \) is the temperature, \( c \) is a heat capacity, \( \kappa \)
is the heat conduction coefficient for the fluid. In free convection,
the gravity term \( -\varrho(T) g\kk \) is essential since the flow is driven
by temperature differences and the fact that hot fluid rises while
cold fluid falls.

<p>
The term \( p\nabla\cdot\u \) in <a href="#mjx-eqn-211">(211)</a>
will be left out for simplicity, although it may be significant for
free convection in gases.

<h3 id="___sec154">Heating by viscous effects </h3>

<p>
We have also included heating of the fluid due to the work of viscous forces,
represented by the term \( 2\mu\varepsilon_{ij}\varepsilon_{ij} \), where
\( \varepsilon_{ij} \) is the strain-rate tensor in the flow, defined by

$$ \varepsilon_{ij} = \frac{1}{2}\left(\frac{\partial u_i}{\partial x_j}
+ \frac{\partial u_j}{\partial x_i}\right) = \frac{1}{2}(\nabla\u + (\nabla\u)^T),$$

where \( u_i \) is the velocity in direction of \( x_i \) (\( i=1,2,3 \) measures the
space directions). The term \( 2\mu\varepsilon_{ij}\varepsilon_{ij} \)
is written with Einstein's summation convention in mind such that
there is an implicit sum over \( i \) and \( j \).
This term is actually much more relevant
for forced convection, but was left out in the section <a href="#scale:fluid:forced_convection">Free convection</a> for mathematical simplicity.
Heating by the work of viscous forces is often a very
small effect and can be neglected, although it plays a major role in
forging and extrusion of metals where the viscosity is very large,
and those processes requires large external forces to drive the flow.
The reason to include the work by viscous forces under the heading of
free convection is more that we want to scale a more complete, general
mathematical model for mixed force and free convection, and arrive
at dimensionless numbers that can tell with this extra term is
important and not.

<h3 id="___sec155">Relation between density and temperature </h3>

<p>
The equations <a href="#mjx-eqn-209">(209)</a> and
<a href="#mjx-eqn-210">(210)</a> has already been made dimensionless
in the previous section. The major difference is now that \( \varrho \)
is no longer a constant, but a function of \( T \).
The relationship between \( \varrho \) and \( T \) is often taken as
linear,

$$ \varrho = \varrho_0 -\varrho_0 \beta (T-T_0),$$

where

$$ \beta = -\frac{1}{\varrho}\left(\frac{\partial\varrho}{\partial t}
\right)_p,$$

is known as the thermal expansion coefficient of the fluid,
and \( \varrho_0 \) is a reference density when the temperature is at \( T_0 \).

<h3 id="___sec156">Comment on the form of the equation of continuity </h3>

<p>
It might look strange that the equation of continuity (from the mass
conservation principle) is \( \nabla\cdot\u =0 \)
when there are density variations in the flow. The rationale for using
this version of the continuity equation is the assumption that
the density of each fluid particle remains constant. Consequently,
from the general equation of continuity,

$$ \frac{\partial\varrho}{\partial t} + \nabla\cdot (\varrho \u) =
\frac{D\varrho}{dt} + \varrho \nabla\cdot\u = 0,$$

it follows that if \( \varrho \) is constant for a particle,
the material derivative \( D\varrho/dt = \varrho_{t} + \v\cdot\nabla\varrho = 0 \),
and the equation reduces to \( \nabla\cdot\u = 0 \).

<h3 id="___sec157">The Boussinesq approximation </h3>

<p>
A very common approximation, called the <em>Boussinesq approximation</em>, is
to neglect the density variations in all terms except the gravity term.
This is a good approximation unless the change is \( \varrho \) is large.
With the linear \( \varrho(T) \) formula and the Boussinesq approximation,
<a href="#mjx-eqn-209">(209)</a>-<a href="#mjx-eqn-211">(211)</a>
take the form

$$
\begin{align}
\varrho_0\left(\frac{\partial \u}{\partial t} + \u\cdot\nabla\u\right)
&= -\nabla p + \mu\nabla^2\u - (\varrho_0 - \varrho_0\beta(T-T_0))g\kk,
\tag{213}\\ 
\nabla\cdot\u & = 0,
\tag{214}\\ 
\varrho_0 c\left(\frac{\partial T}{\partial t} + \u\cdot\nabla T\right)
&= \kappa\nabla^2 T + 2\mu\varepsilon_{ij}\varepsilon_{ij}\tp
\tag{215}\\ 
\tag{216}
\end{align}
$$

A good justification of the Boussinesq approximation is provided
by Tritton <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#Tritton">[9]</a> (Ch. 13).

<h3 id="___sec158">Scaling </h3>

<p>
Dimensionless variables are introduced as

$$ \bar x = \frac{x}{L},\ \ t_c = \frac{L}{U},\ 
\bar\u = \frac{\u}{U},\ \bar p = \frac{p}{\varrho U^2},\ 
\bar T = \frac{T-T_0}{\Delta T}\tp$$

The dimensionless \( y \) and \( z \) coordinates also make use of \( L \) as scale.
As in forced convection, we assume the characteristic temperature
level \( T_0 \) and the scale \( \Delta T \) are given by thermal boundary and/or
initial conditions.
Contrary to the sections <a href="#sec:scale:ns">The Navier-Stokes equations</a> and <a href="#scale:fluid:forced_convection">Free convection</a>,
\( U \) is now not given by the problem description, but implied by
\( \Delta T \).

<p>
Replacing quantities with dimensions by their dimensionless counterparts
results in

$$
\begin{align*}
\varrho_0\frac{U^2}{L}\frac{\partial \bar\u}{\partial \bar t} +
\varrho_0\frac{U^2}{L}\bar \u\cdot\bar \nabla\bar\u
&= -\frac{p_c}{L}\bar\nabla \bar p + \frac{\mu U}{L^2}
\bar \nabla^2\bar \u - \varrho_0g\kk + \varrho_0\beta T_c\bar T g\kk,
\\ 
\frac{U}{L}\bar\nabla\cdot\bar\u & = 0,
\\ 
\varrho_0 c\left(\frac{T_c U}{L}
\frac{\partial \bar T}{\partial \bar t} +
\frac{UT_c}{L}\bar\u\cdot\bar\nabla \bar T\right)
&= \frac{\kappa T_c}{L^2}
\bar \nabla^2 \bar T + 2\frac{\mu U}{L}
\bar\varepsilon_{ij}\bar\varepsilon_{ij}\tp
\end{align*}
$$

These equations reduce to

$$
\begin{align}
\frac{\partial \bar\u}{\partial \bar t} +
\bar \u\cdot\bar \nabla\bar\u
&= -\bar\nabla \bar p + \hbox{Re}^{-1}\bar \nabla^2\bar \u
- \hbox{Fr}^{-2}\kk  + \gamma \bar T\kk,
\tag{217}\\ 
\bar\nabla\cdot\bar\u & = 0,
\tag{218}\\ 
\frac{\partial \bar T}{\partial \bar t} +
\bar\u\cdot\bar\nabla \bar T
&= \hbox{Pe}^{-1}\bar \nabla^2 \bar T + 2\delta
\bar\varepsilon_{ij}\bar\varepsilon_{ij}\tp
\tag{219}
\end{align}
$$

<p>
The dimensionless numbers, in addition to Re and Fr, are
$$
\gamma = \frac{g\beta L\Delta T }{U^2},\quad
\hbox{Pe}^{-1} = \frac{\kappa }{\varrho_0 c UL},\quad
\delta = \frac{\mu U}{L\varrho_0 c \Delta T}\tp
$$

The Peclet number is here defined as the ratio of the
convection term for heat \( \varrho_0 c U\Delta T/L \) and the
heat conduction term \( \kappa U/L^2 \).
The \( \gamma \) number measures the ratio of thermal buoyancy and
the convection term:

$$ \gamma = \frac{\varrho_0 g\beta \Delta T }{\varrho_0 U^2/L}
= \frac{g\beta L\Delta T }{U^2}\tp$$

The Pe parameter is the fraction of the convection term
and the thermal diffusion term:

$$ \frac{|\varrho_0\u\cdot\nabla T|}{|\kappa\nabla^2 T|}\sim
\frac{\varrho_0 c U \Delta T L^{-1}}{\kappa L^{-2}\Delta T}
= \frac{\varrho c UL}{\kappa } = \hbox{Pe}\tp$$

The \( \delta \) parameter is the ratio of the viscous dissipation term
and the convection term:

$$ \frac{|\mu\nabla^2\u|}{|\varrho_0c\u\cdot\nabla T|}\sim
\frac{\mu U^2/L^2}{\varrho_0 c U \Delta T/L} =
\frac{\mu U}{L\varrho_0 c \Delta T} = \delta\tp
$$

<h2 id="___sec159">The Grashof, Prandtl, and Eckert numbers </h2>

<p>
The problem with the above dimensionless numbers is that they involve
\( U \), but \( U \) is implied by \( \Delta T \). Assuming that the convection
term is much bigger than the viscous diffusion term, the momentum
equation features a balance between the buoyancy term and the convection
term:

$$ |\varrho_0 \u\cdot\nabla\u| \sim \varrho_0 g \beta\Delta T\tp$$

Translating this similarity to scales,

$$ \varrho_0 U^2/L \sim \varrho_0 g \beta\Delta T,$$

gives an \( U \) of in terms of \( \Delta T \) :

$$ U = \sqrt{\beta L \Delta T}\tp$$

The Reynolds number with this \( U \) now becomes

$$ \hbox{Re}_T = \frac{UL}{\nu} = \frac{\sqrt{g\beta L^3 \Delta T}}{\nu^2}
= \hbox{Gr}^{1/2},$$

where Gr is the Grashof number in free thermal convection:

$$ \hbox{Ga} = \hbox{Re}_T^2 =  \frac{g\beta L^3 \Delta T}{\nu^2}\tp$$

The Grashof number replaces the Reynolds number in the scaled equations
of free thermal convection. We shall soon look at its interpretations,
which are not as straightforward as for the Reynolds and Peclet numbers.

<p>
The above
choice of \( U \) in terms of \( \Delta T \) results in \( \gamma \) equal to unity:

$$ \gamma = \frac{g\beta L\Delta T }{U^2} =
\frac{g\beta L\Delta T }{g\beta L \Delta T} = 1\tp$$

<p>
The Peclet number can also be rewritten as

$$ \hbox{Pe}= \frac{\varrho c UL}{\kappa } = \frac{\mu c}{\kappa}
\frac{\varrho UL}{\mu}
= \hbox{Pr}\hbox{Re}^{-1} = \hbox{Pr}\hbox{Re}_T^{-1},$$

where Pr is the Prandtl number, defined as

$$ \hbox{Pr} = \frac{\mu c}{\kappa}\tp$$

<p>
The Prandtl number is the ratio of the momentum diffusivity (kinematic
viscosity) and the thermal diffusivity. Actually, more detailed
analysis shows that Pr reflects the ratio of the thickness of the
thermal and velocity boundary layers: when \( \hbox{Pr}=1 \), these layers
coincide, while \( \hbox{Pr}\ll 1 \) implies that the thermal layer is
much thicker than the velocity boundary layer, and vice versa for
\( \hbox{Pr}\gg 1 \).

<p>
The \( \delta \) parameter is in free convection replaced by a combination
of the Eckert number (Ec) and the Reynolds number. We have that

$$ \hbox{Ec} = \frac{U^2}{c\Delta T} = \delta\hbox{Re}_T,$$

and consequently

$$ \delta = \hbox{Ec}\hbox{Re}_T^{-1} = \hbox{Ec}\hbox{Gr}^{-1/2}\tp$$

Writing

$$ \hbox{Ec} = \frac{\varrho_0U^2}{\varrho_0c\Delta T},$$

shows that the Eckert number can be interpreted as the ratio of
the kinetic energy of the flow and the thermal energy.

<p>
We use Ga instead of \( \hbox{Re}_T \) in the momentum equations and also
instead of Pe in the energy equation (recall that \( \hbox{Pe} =
\hbox{Pr}\hbox{Re} =
\hbox{Pr}\hbox{Re}_T=\hbox{Pr}\hbox{Gr}^{-1/2} \)). The resulting scaled
system becomes

$$
\begin{align}
\frac{\partial \bar\u}{\partial \bar t} +
\bar \u\cdot\bar \nabla\bar\u
&= -\bar\nabla \bar p + \hbox{Gr}^{-1/2}\bar \nabla^2\bar \u
- \hbox{Fr}^{-2}\kk  + \bar T \kk,
\tag{220}\\ 
\bar\nabla\cdot\bar\u & = 0,
\tag{221}\\ 
\hbox{Gr}^{1/2}\left(\frac{\partial \bar T}{\partial \bar t} +
\bar\u\cdot\bar\nabla \bar T\right)
&= \hbox{Pr}^{-1}
\bar \nabla^2 \bar T + 2\hbox{Ec}\hbox{Gr}^{-1/2}
\bar\varepsilon_{ij}\bar\varepsilon_{ij}\tp
\tag{222}
\end{align}
$$

<p>
We realize that in free convection, the Grashof number plays the same
role as the Reynolds number in the momentum equation. In particular,
it turns out that Gr governs the transition between laminar and
turbulent flow.  For example, the transition to turbulence occurs in
the range \( 10^8 < \hbox{Gr} < 10^9 \) for free convection from vertical
flat plates.  Gr is normally interpreted as a dimensionless number
expressing the ratio of buoyancy forces and viscous forces.

<h3 id="___sec160">Interpretations of the Grashof number </h3>

<p>
Recall that the scaling leading to the Grashof number is based on an
estimate of \( U \) from a balance of the convective and the buoyancy
terms. When the viscous term dominates over convection, we need a
different estimate of \( U \), since in this case, the viscous force
balances the buoyancy force:

$$ \mu\nabla^2\u \sim \varrho_0g\beta\Delta T\quad
\Rightarrow\quad \mu U/L^2 \sim \varrho_0g\beta\Delta T,$$

This similarity suggests the scale

$$ U = \frac{g\beta L^2 \Delta T}{\nu}\tp$$

Now,

$$ \frac{|\varrho_0\u\cdot\nabla\u|}{|\mu\nabla^2\u|} \sim \frac{UL}{\nu}
= \frac{g\beta L^3 \Delta T}{\nu} = \hbox{Gr}\tp$$

The result means that \( \hbox{Gr}^{1/2} \) measures the ratio of convection and
viscous forces when convection dominates, but Gr measures this ratio when
viscous forces dominate.

<p>
The product of Gr and Pr is the Rayleigh number,

$$
\hbox{Ra} = \frac{g\beta L^3\Delta T\varrho_0 c}{\nu\kappa},
$$

since

$$
\hbox{Gr} \hbox{Pr} = \hbox{Re}_T^2\hbox{Pr} =
\frac{g\beta L^3 \Delta T}{\nu^2}\frac{\mu c}{\kappa} =
\frac{g\beta L^3 \Delta T\varrho_0 c}{\nu\kappa} =
\hbox{Ra}\tp
$$

The Rayleigh number is the preferred dimensionless number when studying
free convection in horizontal layers <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#Drazin_Reid">[10]</a> <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html#Tritton">[9]</a>. Otherwise,
Gr and Pr are dominate.

<h2 id="___sec161">Heat transfer at boundaries and the Nusselt number </h2>

<p>
A common boundary condition, modeling heat transfer to/from the
surroundings is

$$
\begin{equation}
-\kappa\frac{\partial T}{\partial n} = h_T(T - T_s),
\tag{223}
\end{equation}
$$

where \( \partial/\partial n \) means the derivative in the normal direction
(\( \normalvec\cdot\nabla \)), \( h_T \) is an experimentally determined
heat transfer coefficient, and \( T_s \) is the temperature of
the surroundings. Scaling <a href="#mjx-eqn-223">(223)</a>
leads to

$$ -\frac{\kappa\Delta t}{L}\frac{\partial \bar T}{\partial \bar n} = h_T(\Delta T \bar T + T_0 - T_s),$$

and further to

$$ \frac{\partial \bar T}{\partial \bar n} =
\frac{h_TL}{\kappa}(\bar T + \frac{T_s - T_0}{\Delta T})
= \hbox{Nu}(\bar T - \bar T_s),
$$

where the Nusselt number is defined by

$$ \hbox{Nu} = \frac{h_TL}{\kappa},$$

and \( \bar T_s \) is simply the dimensionless surrounding temperature,

$$ \bar T_s = \frac{T_s - T_0}{\Delta T}\tp$$

<p>
Heat transfer is a huge engineering
field with lots of experimental investigations
that are summarized by curves relating various dimensionless numbers
such as Gr, Pr, and Nu.

<h1 id="scale:bidomain">The bidomain model in electrophysiology</h1>

<p>
The mechanical functioning of the heart is crucially dependent on
correct electric signal propagation through the heart tissue.
A widely used mathematical
model for the electric signal propagation is the bidomain equations:

$$
\begin{align}
\chi C_m\frac{\partial v}{\partial t} &=
\nabla\cdot( M_i\nabla v) + \nabla\cdot (M_i\nabla u_e) - \chi I_{\rm{ion}}
- \chi I_{\rm{app}},
\tag{224}\\ 
0 &= \nabla\cdot( M_i\nabla v) + \nabla\cdot ((M_i + M_e)\nabla u_e)\tp
\tag{225}
\end{align}
$$

These PDEs are posed in a spatial domain \( H \) for \( t\in (0, T] \). The boundary
conditions are of Neumann type, and we drop these from the discussion.
The initial condition is typically \( u_e=v=0 \).

<p>
The symbols in these PDEs have the following meaning:
\( u_e \) is the extracellular electric potential,
\( v \) is the transmembrane potential (difference between the extracellular
and intracellular potential),
\( C_m \) is the capacitance of the cell membrane,
\( \chi \) is a membrane area to cell volume ratio,
\( M_i \) is a electric conductivity tensor for the intracellular space,
\( M_e \) is a electric conductivity tensor for the extracellular space,
\( I_{\rm{ion}} \) is the ionic current across the cell membrane, and
\( I_{\rm{app}} \) is an externally applied current.

<p>
The PDE system is driven by \( I_{\rm{ion}} + I_{\rm{app}} \), and models
for these source terms consist of a system of ODEs at each point
in the domain. The simplest relevant ODE system is the FitzHugh-Nagumo
model:

$$
\begin{align}
C_m\frac{dv}{dt} & = - I_{\rm{ion}} - I_{\rm{app}},
\tag{226}\\ 
I_{\rm{ion}} &= A(v-v_r)(v - v_m)(v - v_p) + Bw,
\tag{227}\\ 
\frac{dw}{dt} &= -c_1w + c_2v + c_3,
\tag{228}
\end{align}
$$

where \( A \), \( v_m \), \( v_r \), \( v_p \),
\( B \), \( c_1 \), \( c_2 \), and \( c_3 \) are specified constants.

<!-- begin inline comment -->
<font color="red">(<b>hpl 25</b>: Keyner and Sneyd have a constant in the equation for \( w \), in both the unscaled and scaled versions, while The Bible has not.)</font>
<!-- end inline comment -->

More complicated ODE systems for the cell dynamics may have up to a
hundred unknowns
and a correspondingly large collection of parameters.

<p>
Dimensionless independent variables are introduced by

$$ \bar x = \frac{x}{L},\quad
\bar y = \frac{y}{L},\quad \bar z = \frac{z}{L},\quad
\bar t = \frac{t}{t_c},$$

where \( L \) is the characteristic length scale, and \( t_c \) is the
characteristic time scale. Dimensionless dependent variables are
expressed as

$$ \bar v = \frac{v-v_r}{v_p-v_r},\quad \bar u = \frac{u_e}{u_c}, \quad \bar w =
\frac{w}{w_c}\tp$$

Here, \( v_r \) is the resting potential, and \( v_p \) is the peak potential.
The scaling of \( v \) ensures \( \bar v\in [0,1] \). We introduce the symbol
\( \Delta v = v_p-v_r \) to save space in the formulas: \( \bar v = (v-v_r)/\Delta v \).
The scale for \( u_e \) is \( u_c \), and \( w_c \) is a scale for \( w \), both to be
determined either from simplicity of the equations or from available analysis of
their magnitudes.

<p>
The variable tensor coefficients \( M_i \) and \( M_e \) depend on the spatial
coordinates and are also scaled:

$$ \bar M_i = \frac{M_i}{M_c},\quad \bar M_e = \frac{M_e}{M_c}\tp$$

For simplicity, we have chosen a common scale \( M_c \), but the two tensors
may employ difference scales. One typically chooses \( M_c \) as a norm of
\( M_i + M_e \), e.g., the maximum value.

<p>
Inserting the dimensionless variables in the equations, the system
of governing equations becomes

$$
\begin{align*}
\frac{\Delta v}{t_c}\chi C_m\frac{\partial \bar v}{\partial \bar t} &=
\frac{M_c\Delta v }{L^2}\nabla\cdot( \bar M_i\bar\nabla\bar v) +
\frac{M_c u_c}{L^2}\nabla\cdot (\bar M_i\bar \nabla \bar u) -\\ 
&\quad
\chi A
\Delta v \bar v
(v_r  - v_m + \Delta v \bar v)
(v_r - v_p + \Delta v \bar v)-\\ 
&\quad Bw_c\bar w
- \chi I_{\rm{app}},
\\ 
0 &= \frac{M_c\Delta v }{L^2}\bar \nabla\cdot( \bar M_i\bar \nabla \bar v) + \frac{M_cu_c}{L^2}\nabla\cdot ((\bar M_i + \bar M_e)\bar \nabla \bar u),\\ 
\frac{\Delta v}{t_c}C_m\frac{d\bar v}{d\bar t} & = -
A
\Delta v \bar v
(v_r  - v_m + \Delta v \bar v)
(v_r - v_p + \Delta v \bar v)-\\ 
&\quad Bw_c\bar w - I_{\rm{app}},
\\ 
\frac{w_c}{t_c}\frac{d\bar w}{d\bar t} &= -c_1w_c\bar w +
c_2(v_r + \Delta v \bar v) + c_3\tp
\end{align*}
$$

Multiplying the equations by appropriate factors leads to equations with
dimensionless terms only:

$$
\begin{align*}
\frac{\partial \bar v}{\partial \bar t} &=
\frac{t_cM_c}{\chi C_mL^2}\nabla\cdot( \bar M_i\bar\nabla\bar v) +
\frac{t_cM_c u_c}{\Delta v \chi C_mL^2}\nabla\cdot (\bar M_i\bar \nabla \bar u) -\\ 
&\quad
\frac{t_cA}{C_m\Delta v }
\Delta v \bar v
(v_r  - v_m + \Delta v \bar v)
\Delta v(\bar v - 1)-\\ 
&\quad \frac{t_cBw_c}{\chi C_m\Delta v }\bar w
- \frac{t_c I_{\rm{app}}}{C_m\Delta v },
\\ 
0 &= \bar \nabla\cdot( \bar M_i\bar \nabla \bar v) + \frac{u_c}{\Delta v}\nabla\cdot ((\bar M_i + \bar M_e)\bar \nabla \bar u),\\ 
\frac{d\bar v}{d\bar t} & = -
\frac{t_c A}{C_m\Delta v }
\Delta v \bar v
(v_r  - v_m + \Delta v \bar v)
\Delta v(\bar v - 1)-\\ 
&\quad \frac{t_c Bw_c}{C_m\Delta v }\bar w
- \frac{t_c}{C_m\Delta v }I_{\rm{app}},
\\ 
\frac{d\bar w}{d\bar t} &= -t_cc_1\bar w +
\frac{t_cc_2}{w_c}(v_r + \Delta v \bar v) + \frac{t_cc_3}{w_c}\tp
\end{align*}
$$

<p>
A natural length scale could the size of the domain, in this case the
diameter of the heart, but we could also base the length and time scales on
equal balance of the time-derivative term, the diffusion terms, and the
reaction term in the PDE. For now we let \( L \) be the length scale.

<p>
The time scale is not so obvious to choose.
The PDEs are of diffusion nature, and the relevant time scale is related
to the time it takes to diffuse the signal. On the other hand, the ODE
system, in general, may feature many different time scales. Which time
scale to choose for \( t_c \) depends on whether one is interested in
fast time scales for some components in the ODE system or in the
(anticipated) slower diffusion scale of the PDEs. For now we choose
the time scale based on diffusion. From previous examples in
the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86008.html#sec:scale:diffu:homo1D">Homogeneous 1D diffusion equation</a>, we therefore
set the coefficient in front of the diffusion term to unity, here

$$ \frac{t_cM_c}{\chi C_mL^2} = 1\quad\Rightarrow\quad t_c = \frac{\chi C_mL^2}{M_c}\tp$$

A natural dimensionless variable then arises from the second diffusion
term:

$$ \alpha = \frac{u_c}{\Delta v}\tp$$

The choice \( u_c=\Delta v \) will of course remove the need for this dimensionless
variable, but we include the freedom to have \( u_c \) as
some specified characteristic size of \( u_e \).

<p>
The final dimensionless system becomes

$$
\begin{align}
\frac{\partial \bar v}{\partial \bar t} &=
\nabla\cdot( \bar M_i\bar\nabla\bar v) +
\alpha\nabla\cdot (\bar M_i\bar \nabla \bar u) -
\tag{229}\\ 
&\quad
\beta
\bar v
(J_1 +  \bar v)
(\bar v - 1) - \gamma\bar w - \delta,
\tag{230}\\ 
0 &= \bar \nabla\cdot( \bar M_i\bar \nabla \bar v) +
\alpha\nabla\cdot ((\bar M_i + \bar M_e)\bar \nabla \bar u),
\tag{231}\\ 
\frac{d\bar v}{d\bar t} & = -
\beta
\bar v
(J_1 +  \bar v)
(\bar v -1)- \gamma\bar w - \delta,
\tag{232}\\ 
\frac{d\bar w}{d\bar t} &= -K_1\bar w +
K_2\bar v + K_3\tp
\tag{233}
\end{align}
$$

There are eight dimensionless variables in the above equations:

$$
\begin{align}
\alpha &= \frac{u_c}{\Delta v},
\tag{234}\\ 
\beta & = \frac{\chi AL^2\Delta v^2}{M_c},
\tag{235}\\ 
\gamma &= \frac{Bw_cL^2}{M_c\Delta v },
\tag{236}\\ 
\delta &= \frac{\chi L^2 I_{\rm{app}}}{M_c\Delta v },
\tag{237}\\ 
J_1 &= \frac{v_r-v_m}{\Delta v},
\tag{238}\\ 
J_2 &= \frac{v_r}{\Delta v},
\tag{239}\\ 
K_1 &= \frac{\chi C_m L^2c_1}{M_c},
\tag{240}\\ 
K_2 & = \frac{\chi C_m L^2\Delta v^2c_2}{M_c w_c},
\tag{241}\\ 
K_3 &= \frac{\chi C_mL^2(c_3 + c_2 v_r\Delta v)}{M_cw_c}\tp
\tag{242}
\end{align}
$$

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 26</b>: Compute the size of \( \beta \). Inspired by scaling of the cable equation, it could happen that \( \beta \) is very large if \( L \) is the diameter of the heart, and in that case we can demand \( \beta =1 \) to set \( L \). Then there is equal balance between the three main terms in the PDE.)</font>
<!-- end inline comment -->

<p>
Since \( w \) is just a help variable without any physiological interpretation,
we can choose its scale \( w_c \) freely to simplify the expressions.
For example, we can fit \( w_c \) to make \( K_2=1 \), \( K_3=1 \), or \( \gamma=1 \).

<p>
Some of these dimensionless numbers have straightforward
interpretations: \( \alpha \) is the ratio of the span in the two electric
potentials; \( \delta \) is ratio of the source term and the
time-derivative term of \( v \), or the source term and the diffusion term
in \( v \).  The rest have fixed values: \( J_1 \) and \( J_2 \) have
well-established values from measurements, while \( \beta \), \( \gamma \),
\( K_1 \), \( K_2 \), and \( K_3 \) contain empirically fitted constants with
known values, combined with known scales and other known physical
parameters.

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 27</b>: It is unclear what the gain really is, besides having primary variables of unit size. Since there are so many empirical constants, the number of dimensionlesss variables blows up, and instead of gettting more insight into the dynamics through these variables, they are just fixed numbers.)</font>
<!-- end inline comment -->

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 28</b>: Here is a comment on the scaling above versus Keener and Sneyd's scaling of the cable equation. Not meant to be part of the text, just some thoughts while we are working on the proper scaling of the bidomain equations.)</font>
<!-- end inline comment -->

<p>
The cable equation from Keener and Sneyd is
$$ pC_m\frac{\partial V}{\partial t} + pI_{\rm ion}(V) = \frac{1}{r_i+r_e}
\frac{\partial^2 V}{\partial x^2},$$

see (8.11). The standard way of scaling this equation is to introduce
a time scale \( t_c \), a length scale \( x_c \), a \( V \) scale \( v_c \), and
a scale \( I_c \) for \( I_{\rm ion} \) (typically \( I_c = \max |I_{\rm ion}| \)):

$$ \frac{\partial \bar V}{\partial\bar t} +
\frac{t_c I_c}{C_m v_c}\bar I_{\rm ion}(v_c\bar V) =
\frac{t_c}{pC_m(r_i+r_e)x_c^2} \frac{\partial^2 \bar V}{\partial \bar x^2}\tp$$

Balance of the time derivative and the diffusion term determines the
time scale:

$$ t_c = pC_m(r_i+r_e)x_c^2\tp$$

We need to have a look at units. In the derivation of the cable equation,
\( I_{\rm ion} \) is current per unit length, i.e., it has dimension A/m,
and all terms have this dimension. The \( r_i \) and \( r_e \) quantities
have unit V/(Am) (V is volt, A is ampere).

<!-- begin inline comment -->
<font color="red">(<b>hpl 29</b>: Keener and Sneyd say \( r_i \) is Ohm per length, and since Ohm is V/A, it is the same.)</font>
<!-- end inline comment -->

The \( p \) parameter is a perimeter
and measured in m.
The term \( pC_m\partial V/\partial t \) must have
the unit of A/m, so \( C_m \) is measured in \( \hbox{As}\hbox{V}^{-1}\hbox{m}^{-2} \).
Since \( x_c^2 \) has unit \( \hbox{m}^2 \), \( t_c \) gets the right unit s.

<p>
Normally,
\( x_c \) is based on domain length, but here we have the freedom to
choose it to have other values. Demanding that the coefficient in
the source term is unity determines \( v_c \):

$$ v_c = \frac{t_cI_c}{C_m} = I_Cp(r_i+r_e)x_c^2\tp$$

The resulting dimensionless equation is

$$ \frac{\partial \bar V}{\partial\bar t} +
\bar I_{\rm ion}(v_c\bar V) =
\frac{\partial^2 \bar V}{\partial \bar x^2}\tp$$

It remains to find a proper length scale \( x_c \) if not the domain length
is chosen.

<p>
Keener and Sneyd do things differently. First, they introduce
\( 1/R_m = dI_{rm ion}/dV \) without motivation and multiply the
cable equation by \( R_m \) and divide by \( p \):

$$ R_mC_m\frac{\partial V}{\partial t} + R_mI_{\rm ion}(V) = \frac{R_m}{p(r_i+r_e)}\frac{\partial^2 V}{\partial x^2}\tp$$

The \( R_m \) quantity is, according to the definition, measured in
Vm/A. Then Keener and Sneyd introduce a length scale

$$ \lambda_m = \sqrt{\frac{R_m}{p(r_i+r_2)}},$$

but this has dimension \( \hbox{m}^{\half} \), not m. They introduce the
time scale

$$ \tau_m = R_mC_m,$$

which gets the dimension s/m, not s. Furthermore, they do not scale
\( V \) at all, it remains in volt. The resulting equation is not
dimensionless. As far as I can see, each term has dimension V/m.

<h1 id="___sec163">Two-phase porous media flow </h1>

<p>
We consider the flow of two incompressible, immiscible fluids in
a porous medium with porosity \( \phi (\x) \). The two fluids are referred to
as the <a href="https://en.wikipedia.org/wiki/Wetting" target="_self">wetting</a> and
non-wetting fluid. In an oil-water mixture, water is usually the
wetting fluid. The fraction of the pore volume occupied by the
wetting fluid is denoted by \( S(\x,t) \). The non-wetting fluid then occupies
\( 1-S \) of the pore volume (or \( (1-S)\phi \) of the total volume).
The variable \( P(\x,t) \) represents the pressure in the non-wetting fluid.
It is related to the pressure \( P_n \) in the non-wetting fluid through
the capillary pressure \( p_c=P_n-P \), which is an empirically determined
function of \( S \).

<p>
From mass conservation of the two fluids and from Darcy's law for
each fluid, one can derive the following system of PDEs and
algebraic relations that govern the two primary unknowns \( S \) and \( P \):

$$
\begin{align}
\nabla\cdot\v_t &= -(Q_n + Q_w),
\tag{243}\\ 
\v_t &= -\lambda_t\nabla P + \lambda_wp_c'(S)\nabla S + (\lambda_w\varrho_w
+ \lambda_n\varrho_n)g\kk,
\tag{244}\\ 
\phi\frac{\partial S}{\partial t} + f_w'(S)\v_t\cdot\nabla S &=
\nabla\cdot(h_w(S)p_c'(S)\nabla S) + \nonumber\\ 
&\qquad\qquad g\frac{\partial G_w}{\partial z} + f_w(Q_n+Q_w) - Q_w,
\tag{245}\\ 
Q_w &= \frac{q_w}{\varrho_w},
\tag{246}\\ 
Q_n &= \frac{q_n}{\varrho_n},
\tag{247}\\ 
\lambda_w(S) &= \frac{K}{\mu_w}k_{rw}(S),
\tag{248}\\ 
\lambda_n(S) &= \frac{K}{\mu_n}k_{rn}(S),
\tag{249}\\ 
\lambda_t(S) &= \lambda_w(S) + \lambda_n(S),
\tag{250}\\ 
k_{rw}(S) &= K_{wm}\left\lbrack\frac{S-S_{wr}}{1-S_{nr}-S_{wr}}\right\rbrack^a,
\tag{251}\\ 
k_{rn}(S) &= K_{nm}\left\lbrack\frac{1-S-S_{nr}}{1-S_{nr}-S_{wr}}\right\rbrack^b,
\tag{252}\\ 
f_w(S) &= \frac{\lambda_w}{\lambda_t},
\tag{253}\\ 
G_w(S) &= h_w(S)(\varrho_n - \varrho_w),
\tag{254}\\ 
h_w(S) &= -\lambda_n(S)f_w(S),
\tag{255}\tp
\end{align}
$$

<p>
The permeability of the porous medium is \( K \)
(usually a tensor, but here taken as a
scalar for simplicity); \( \mu_w \) and \( \mu_n \) are the dynamic viscosities
of the wetting and non-wetting fluid, respectively;
\( \varrho_w \) and \( \varrho_n \) are the densities
of the wetting and non-wetting fluid, respectively;
\( q_w \) and \( q_n \) are the injection rates of the wetting and non-wetting
fluid through wells, respectively;
\( S_{wr} \) is the irreducible saturation of
the wetting fluid (i.e., \( S\geq S_{wr} \)); \( S_{nr} \) is the corresponding
irreducible saturation of the non-wetting fluid (i.e., \( (1-S)\geq S_{nr} \)),
\( K_{wn} \) and \( K_{nr} \) are the maximum values of the
relative permeabilities \( k_{rw} \) and \( k_{rn} \), respectively, and
\( a \) and \( b \) are given (Corey) exponents in the expressions for the
relative permeabilities.

<p>
The two PDEs are of elliptic and hyperbolic/parabolic nature:
<a href="#mjx-eqn-243">(243)</a> is elliptic since it is the divergence of a
vector field, while <a href="#mjx-eqn-245">(245)</a> is parabolic (\( h_w\geq 0 \)
because \( p_c'(S)\geq 0 \) and \( \lambda_n \) as well as \( f_w \) are positive
since \( k_{rn}>0 \) and \( k_{rw}>0 \)). Very often, \( p_c' \) is small so
<a href="#mjx-eqn-245">(245)</a> is of hyperbolic nature, and \( S \) features very
steep gradients that become shocks in the limit \( p_c'\rightarrow 0 \)
and <a href="#mjx-eqn-245">(245)</a> is purely hyperbolic.
A popular solution technique is based on operator splitting:
<a href="#mjx-eqn-243">(243)</a> is solved with respect to \( P \), given \( S \), and
<a href="#mjx-eqn-245">(245)</a> is solved with respect to \( S \), given \( P \).

<p>
The saturation \( S \) is a non-dimensional quantity, and so are \( \phi \),
\( k_{rw} \), \( k_{rn} \), \( K_{wm} \), \( K_{nm} \), \( f_w \), and \( f_w' \).
The quantity \( \v_t \) is the total filtration velocity, i.e., the
sum of the velocities of the wetting and non-wetting fluid.
An associated velocity scale \( v_c \) is convenient to define.
It is also convenient to introduce dimensionless fractions of
wetting and non-wetting fluid properties:

$$
\begin{align*}
\varrho &\equiv \varrho_w,\\ 
\varrho_n &= \varrho\alpha,\quad \alpha = \frac{\varrho_n}{\varrho_w},\\ 
\mu &\equiv\mu_w,\\ 
\mu_n &= \mu\beta,\quad \beta = \frac{\mu_n}{\mu_w},\\ 
Q &\equiv Q_w = \frac{q_w}{\varrho},\\ 
Q_n &= Q\frac{\gamma}{\alpha},\quad \gamma = \frac{q_n}{q_w}\tp
\end{align*}
$$

We will benefit from making \( \lambda_w \), \( \lambda_n \), and \( \lambda_t \)
dimensionless:

$$
\begin{align*}
\lambda_w(S) &= \frac{K}{\mu}k_{rw}(S) = \lambda_c\bar\lambda_w,\quad
\lambda_c=\frac{K}{\mu},\quad \bar\lambda_w = k_{rw},\\ 
\lambda_n(S) &= \frac{K}{\mu}\beta^{-1}k_{rn}(S) = \lambda_c\beta^{-1}\bar\lambda_n,
\quad\bar\lambda_n = k_{rn},\\ 
\lambda_t(S) &= \lambda_w(S) + \lambda_n(S) = \lambda_c\bar\lambda_t,\quad
\bar\lambda_t = \bar \lambda_w +
\beta^{-1}\bar\lambda_n\tp
\end{align*}
$$

As we see, \( \lambda_c \) is the characteristic size of any &quot;lambda&quot;
quantity, and a bar indicates as always a dimensionless variable.
The above formulas imply

$$ h_w(S) = -\lambda_c\beta^{-1}\bar\lambda_n(S)f_w(S),\quad
G_w(S) = h_w(S)\varrho(\alpha - 1)\tp$$

Furthermore, we introduce dimensionless quantities by

$$ \bar\x = \frac{\x}{L},\quad \bar\v_t = \frac{\v_t}{v_c},\quad
\bar P = \frac{P}{P_c},\quad\bar p_c = \frac{p_c}{P_c}\tp$$

Inserting the above scaled quantities in the governing PDEs results in

$$
\begin{align}
\bar\nabla\cdot\bar\v_t &= -\frac{LQ}{v_c}(1 + \alpha^{-1}\gamma),
\tag{256}\\ 
\bar\v_t &= -\frac{P_c\lambda_c}{v_c L}\bar\lambda_t\bar\nabla\bar P +
\frac{\lambda_c P_c}{v_c L}\bar\lambda_w \bar p_c'(S)\bar\nabla S +\nonumber\\ 
&\quad\quad\frac{g\lambda_c\varrho}{v_c}
(\bar\lambda_w + \alpha\beta^{-1}\bar\lambda_n)\kk,
\tag{257}\\ 
\phi\frac{\partial S}{\partial\bar t} + \frac{t_cv_c}{L}f_w'(S)\bar\v_t\cdot
\bar\nabla S &=
\frac{t_c P_c\lambda_c}{L^2}
\bar\nabla\cdot(-\beta^{-1}\bar\lambda_n(S)f_w(S)\bar p_c'(S)\bar\nabla S) + \nonumber\\ 
&\quad\quad \frac{t_c g}{L}\frac{\partial G_w}{\partial\bar z} + t_c f_w Q(1+\alpha^{-1}\gamma) - t_cQ\tp
\tag{258}
\end{align}
$$

As usual, \( L \) is taken as the characteristic length of the spatial domain.
Since \( v_c \) is a velocity scale, a natural time scale is the time it
takes to transport a signal with velocity \( v_c \) through the domain:
\( t_c = L/v_c \). The diffusion term in the equation
<a href="#mjx-eqn-261">(261)</a> then gets
a dimensionless fraction

$$ \frac{L P_c\lambda_c}{v_c L^2}\tp$$

Forcing this fraction to be unity gives

$$ v_c = \lambda_c\frac{P_c}{L}\tp$$

We realize that this is indeed a natural velocity scale if the
velocity is given by the pressure term in Darcy's law. This term
is \( K/\mu \) times the pressure gradient:

$$ \frac{K}{\mu}|\nabla P| \sim \frac{K}{\mu}\frac{P_c}{L} =
\lambda_c\frac{P_c}{L} = v_c\tp$$

We have here dropped the impact of the
relative permeabilities \( \bar\lambda_w \) or
\( \bar\lambda_n \) since these are quantities that are less than or equal
to unity.

<p>
The other term in Darcy's law is the gravity term that goes like
\( \lambda_c \varrho g \) (again dropping relative permeabilities).
The ratio of the gravity term and the pressure gradient term in Darcy's
law is an interesting dimensionless number:

$$ \delta = \frac{\lambda_c \varrho g}{\lambda_c P_c/L} =
\frac{L\varrho g}{P_c}\tp$$

This number naturally arises when we discuss
the term

$$ \frac{t_c g}{L}\frac{\partial G_w}{\partial\bar z} =
-(\alpha -1)\beta^{-1}\delta
(\bar\lambda_n'(S)f_w(S) + \bar\lambda_n(S)f_w'(S))
\frac{\partial S}{\partial\bar z}
$$

Introducing another dimensionless variable,

$$ \epsilon = t_cQ = \frac{L^2Q}{\lambda_cP_c},$$

we can write <a href="#mjx-eqn-256">(256)</a>-<a href="#mjx-eqn-258">(258)</a> in the
final dimensionless form as

$$
\begin{align}
\bar\nabla\cdot\bar\v_t &= -\epsilon(1 + \alpha^{-1}\gamma),
\tag{259}\\ 
\bar\v_t &= -\bar\lambda_t\bar\nabla\bar P +
\bar\lambda_w \bar p_c'(S)\bar\nabla S +
\delta(\bar\lambda_w + \alpha\beta^{-1}\bar\lambda_n)\kk,
\tag{260}\\ 
\phi\frac{\partial S}{\partial\bar t} + f_w'(S)\bar\v_t\cdot
\bar\nabla S &= -
\bar\nabla\cdot(-\beta^{-1}\bar\lambda_n(S)f_w(S)\bar p_c'(S)\bar\nabla S) -
\nonumber\\ 
&\quad\quad (\alpha -1)\beta^{-1}\delta
(\bar\lambda_n'(S)f_w(S) + \bar\lambda_n(S)f_w'(S))
\frac{\partial S}{\partial\bar z} +\nonumber\\ 
&\quad\quad\epsilon f_w (1+\alpha^{-1}\gamma) -
\epsilon\tp
\tag{261}
\end{align}
$$

<p>
The eight input parameters \( L \), \( q_w \), \( q_n \), \( \mu_w \), \( \mu_n \),
\( \varrho_w \), \( \varrho_n \), and \( K \) are reduced to five dimensionless
parameters \( \alpha \), \( \beta \), \( \gamma \), \( \delta \), and \( \epsilon \).
There are six remaining dimensionless numbers to be set: \( K_{wm} \),
\( K_{nm} \), \( S_{wr} \), \( S_{nr} \), \( a \), and \( b \).

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 30</b>: Boundary conditions?)</font>
<!-- end inline comment -->

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 31</b>: Simplifications: skip gravity, sources, capillary pressure, simplify relative permeabilities.)</font>
<!-- end inline comment -->

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 32</b>: Exercises: single-phase flow, with and without thermal effects.)</font>
<!-- end inline comment -->

<h1 id="scale:Euler_eqs">The Euler equations of gas dynamics</h1>

$$
\begin{align}
\frac{\partial\varrho}{\partial t} + \nabla\cdot(\varrho\u) &= 0,
\tag{262}\\ 
\frac{\partial(\varrho\u)}{\partial t} + \nabla\cdot(\varrho\u\u^T) &= -\nabla p + \varrho \f,
\tag{263}\\ 
\frac{\partial E}{\partial t} + \nabla\cdot(\u(E+p)) &= 0,
\tag{264}
\end{align}
$$

where

$$
\begin{equation}
E = \varrho e + \frac{1}{2}\varrho\u\cdot\u\tp
\tag{265}
\end{equation}
$$

In these equations, \( \u \) is the fluid velocity, \( \varrho \) is the density,
\( p \) is the pressure, \( E \) is the total energy per unit volume, composed
of the kinetic energy per unit volume, \( \half\varrho \u\cdot\u \), and the
internal energy per unit volume, \( \varrho e \).

<p>
Assuming the fluid to be an ideal gas implies the following additional
relations:

$$
\begin{align}
e &= c_v T,
\tag{266}\\ 
p &= \varrho RT = \frac{R}{c_v}(E-\half\varrho \u\cdot\u),
\tag{267}
\end{align}
$$

where \( c_v \) is the specific heat capacity at constant volume (for dry air
\( c_v = 717.5 \hbox{J}\hbox{kg}^{-1}\hbox{K}^{-1} \)),
\( R \) is the specific ideal gas constant
(\( R=287.14 \hbox{J}\hbox{kg}^{-1}\hbox{K}^{-1} \)), and \( T \) is the temperature.
The speed of sound is then

$$
\begin{equation}
c = \sqrt{\left(1 + \frac{R}{c_v}\right)\frac{p}{\varrho}}\tp
\tag{268}
\end{equation}
$$

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 33</b>: Tell how the equations are solved and closed.)</font>
<!-- end inline comment -->

<h3 id="___sec165">Scaling </h3>

<p>
We introduce dimensionless independent variables,

$$ \bar x = \frac{x}{L},\quad \bar y = \frac{y}{L},\quad \bar z = \frac{z}{L},
\quad \bar t = \frac{t}{t_c},$$

and dimensionless dependent variables,

$$ \bar\u = \frac{\u}{U},\quad\bar\varrho = \frac{\varrho}{\varrho_c},
\quad\bar p = \frac{p}{p_c},\quad \bar E= \frac{E}{E_c}\tp$$

Inserting these expressions in the governing equations gives

$$
\begin{align*}
\frac{\partial\bar\varrho}{\partial\bar t} + \frac{t_c U}{L}\bar\nabla\cdot(\bar\varrho\bar\u) &= 0,\\ 
\frac{\partial(\bar\varrho\bar\u)}{\partial\bar t} + \frac{t_cU}{L}\bar\nabla\cdot(\bar\varrho\bar\u\bar\u^T) &= -\frac{t_cp_c}{UL\varrho_c}\nabla\bar p + \frac{t_c f_c}{U}\bar\varrho \bar\f,\\ 
\frac{\partial\bar E}{\partial\bar t} + \frac{t_c U}{LE_c }\bar\nabla\cdot(\bar\u(E_c\bar E+p_c\bar p)) &= 0,\\ 
\bar E & = \frac{\varrho_c}{E_c}c_v T_c\bar T + \frac{\varrho_c U^2}{E_c}\frac{1}{2}\bar\varrho\bar u\cdot\bar u\tp
\end{align*}
$$

A natural choice of time scale is \( t_c=L/U \). A common choice of
pressure scale is \( p_c=\varrho_c U^2 \). The energy equation simplifies if
we choose \( E_c=p_c=\varrho_c U^2 \). With these scales we get

$$
\begin{align*}
\frac{\partial\bar\varrho}{\partial\bar t} +
\bar\nabla\cdot(\bar\varrho\bar\u) &= 0,\\ 
\frac{\partial(\bar\varrho\bar\u)}{\partial\bar t} +
\bar\nabla\cdot(\bar\varrho\bar\u\bar\u^T) &=
-\nabla\bar p + \frac{Lf_c}{U^2}\bar\varrho \bar\f,\\ 
\frac{\partial\bar E}{\partial\bar t} +
\bar\nabla\cdot(\bar\u(\bar E+ \bar p)) &= 0,\\ 
\bar E & = \frac{1}{U^2}c_v T_c\bar T +
\frac{1}{2}\bar\varrho\bar u\cdot\bar u\tp
\end{align*}
$$

<h1 id="___sec166">Exercises </h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:US2SI1">Exercise 1: Perform unit conversion</h2>

<p>
Density (mass per volume: \( [\hbox{ML}^{-3}] \)) of water is
given as 1.05 ounce per fluid ounce. Use the <code>PhysicalQuantity</code> object
to convert to \( \hbox{kg\,m}^{-3} \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_1_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_1_1">

<p>
Use <code>pydoc PhysicalQuantities</code> to find that <code>floz</code> is the name of
the volume &quot;fluid ounce&quot; and <code>oz</code> is the name of the mass &quot;ounce&quot;.
Here is an interactive session for the conversion:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">PhysicalQuantities</span> <span style="color: #008000; font-weight: bold">import</span> PhysicalQuantity <span style="color: #008000; font-weight: bold">as</span> PQ
<span style="color: #666666">&gt;&gt;&gt;</span> d <span style="color: #666666">=</span> PQ(<span style="color: #BA2121">&#39;1.05 oz/floz&#39;</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> d<span style="color: #666666">.</span>convertToUnit(<span style="color: #BA2121">&#39;kg/m**3&#39;</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> d
<span style="color: #666666">1006.54198946</span> kg<span style="color: #666666">/</span>m<span style="color: #666666">**3</span>
</pre></div>
<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>density_conversion</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:ball_y">Problem 2: Scale a simple formula</h2>

<p>
The height \( y \) of a body thrown up in the air is given by

$$ y = v_0t - \frac{1}{2}gt^2,$$

where \( t \) is time, \( v_0 \) is the initial velocity of the body at \( t=0 \),
and \( g \) is the acceleration of gravity. Scale this formula. Use
two choices of the characteristic time: the time it takes to reach the
maximum \( y \) value and the time it takes to return to \( y=0 \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_2_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_2_1">

<p>
We introduce

$$ \bar y =\frac{y}{y_c},\quad \bar t = \frac{t}{t_c}\tp$$

Inserted in the formula we get

$$ y_c\bar y = v_0t_c\bar t - \frac{1}{2}gt_c^2\bar t^2\tp$$

<p>
1. At the maximum point of \( y \), \( y'=0 \), so \( y'=v_0 - gt=0 \), which means
\( t=v_0/g \) and \( y_{\max}=v_0v0/g - \frac{1}{2}gv_0^2/g^2 = \frac{1}{2}v_0^2/g \).
We choose \( t_c=v_0/g \) and \( y_c=\frac{1}{2}v_0^2/g \).
This gives

$$ \frac{1}{2}\frac{v_0^2}{g}\bar y = \frac{v_0^2}{g}\bar t -
\frac{1}{2}\frac{v_0^2}{g}\bar t^2\quad\Rightarrow\quad
\bar y = 2\bar t - \bar t^2\tp$$

<p>
2. The body is back at \( y=0 \) for \( v_0t - \frac{1}{2}gt^2=0 \), which gives
\( t_c=2v_0/g \) and \( y_c=2y_{\max}=v_0^2/g \). Inserted, we get

$$ \frac{v_0^2}{g}\bar y = 2\frac{v_0^2}{g}\bar t -
\frac{1}{2}4\frac{v_0^2}{g}\bar t^2\quad\Rightarrow\quad
\bar y = 2\bar t(1 - \bar t)\tp$$

Observe that the physical parameters \( v_0 \) and \( g \) are absent in the
scaled formula.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>scaled_vertical_motion</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:decay:cooling:osc">Exercise 3: Perform alternative scalings</h2>

<p>
The problem in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#scale:decay:cooling:osc">Scaling a cooling problem with time-dependent surroundings</a> applies a
temperature scaling

$$ \bar T = \frac{T-T_0}{T_m-T_0},$$

which is not always suitable.

<p>
<b>a)</b>
Consider the case \( T_0=T_m \) and the fact that \( |T_m-T_0| \) does not
represent the characteristic temperature scale since it
collapses to zero. Formulate a suitable
scaling in this case. The figure below corresponds to \( T_m=25 \) C,
\( T_0=24.9 \) C, and \( a=2.5 \) C. We clearly see that \( \bar T \) is
not of size unity.

<p>
<center><p><img src="fig-scaling/osc_cooling_wrong_scale.png" align="bottom" width=500></p></center>

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_3_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_3_1">

<p>
The typical temperature variations will now be oscillations of amplitude
\( a \) around \( T_m=T_0 \), so \( 2a \) is the typical variation of the
surrounding temperature. If the time scale of \( T_s \) is sufficiently
large (or more precisely, \( \beta \) is small),
the temperature will actually reach amplitudes of size \( a \),
but for fast oscillations in \( T_s \), there will not be enough time to
transfer heat to/from the body, so the amplitudes of \( T \) will be
smaller. Taking \( 2a \) to be the typical temperature range, we can propose
the scaling

$$ \bar T = \frac{T-T_m}{2a}\tp$$

Inserted in the differential equation, we get with \( t_c=1/k \),

$$ k2a\frac{\bar T}{d\bar t} = -k(2a\bar T + T_m - (T_m + a\sin(\omega t))),$$

which simplifies to

$$ \frac{\bar T}{d\bar t} = -(\bar T - \frac{1}{2}\sin(\beta t)),$$

where \( \beta = \omega/k \).
The initial condition becomes

$$ \bar T(0) = -\half\alpha,$$

where \( \alpha = a/(T_m-T_0) \) is the dimensionless number that appeared
in the scaled differential equation in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#scale:decay:cooling:osc">Scaling a cooling problem with time-dependent surroundings</a>.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Consider the case where \( a \) is much larger than \( |T_m-T_0| \).
What is an appropriate scaling of the temperature?

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_3_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_3_2">

<p>
In this case, \( T \) will oscillate around \( T_m \) and at maximum reach the
amplitude \( a \) if \( \beta \) is small, see the figure in a).
This is the same situation as in a),
and we can consequently use the same scaling and obtain the same
scaled problem.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:ball_y_wdrag">Problem 4: Scale a nonlinear ODE</h2>

<p>
The velocity \( v(t) \)
of a body moving vertically through a fluid in the gravity field,
with fluid drag and buoyancy, is governed by ODE

$$ mv' = -\frac{1}{2}C_D\varrho A |v|v - mg + \varrho V g,\quad v(0)=v_0,$$

where \( t \) is time, \( m \) is the mass of the body, \( C_D \) is a drag coefficient,
\( \varrho \) is the density of the fluid, \( A \) is the cross-sectional area
perpendicular to the motion, \( g \) is the acceleration of gravity,
and \( V \) is the volume of the body. Scale this ODE.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_4_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_4_1">

<p>
We introduce as usual

$$ \bar v = \frac{v}{v_c},\quad \bar t = \frac{t}{t_c},$$

but the main challenge is to find values for \( v_c \) and \( t_c \).
Inserting the scaled quantities gives

$$ m\frac{v_c}{t_c}\frac{d\bar v}{d\bar t} =
-\frac{1}{2}C_D\varrho A v_c^2 |\bar v|\bar v
- mg + \varrho V g,\quad v_c v(0)=v_0,$$

It is tempting to set \( v_c=v_0 \), but \( v_0=0 \) is a relevant value so
this choice is not good. The motion is of decay type so \( t_c \) and \( v_c \)
should be based on characteristics of the decay. The terminal velocity,
defined by \( v'=0 \), is

$$  v_T =  \sqrt{\frac{2(\varrho V - m)g}{C_D\varrho A}},$$

when \( \varrho V >m \) such that the buoyancy wins over gravity and
the motion is upwards. Otherwise,

$$  v_T =  -\sqrt{\frac{2(m-\varrho V)g}{C_D\varrho A}}\tp$$

The two formulas can be combined to

$$  v_T =  \mbox{sign}(\varrho V - m)\sqrt{\frac{2|\varrho V -m|g}{C_D\varrho A}}\tp$$

<p>
We take \( v_c = |v_T| = \sqrt{\frac{2|\varrho V - m|g}{C_D\varrho A}} \).
This results in

$$
\frac{d\bar v}{d\bar t} =
-t_c\frac{1}{2m}C_D \varrho A \sqrt{\frac{2|\varrho V - m|g}{C_D\varrho A}}
|\bar v|\bar v
- t_c\sqrt{\frac{C_D\varrho g A}{2|\varrho V - m|}}(1- \frac{\varrho V}{m}),
$$

and
$$ v(0)=v_0
\sqrt{\frac{C_D\varrho A}{2g|\varrho V - m|}}\tp$$

<p>
A natural choice is to assume \( d\bar v/d\bar t \) and \( \bar v \) to
be of the same order, which means that coefficient in front of the
nonlinear term \( |\bar v|\bar v \) should be unity. This forces \( t_c \) to be

$$ t_c = \frac{2m}{\sqrt{2g|\varrho V - m|C_D\varrho A}}\tp$$

Introducing the dimensionless numbers

$$ \alpha = \frac{\varrho V}{m}, \quad \beta = v_0\sqrt{\frac{C_D\varrho A}{2g|\varrho V - m|}} = \frac{v_0}{|v_T|},$$

we get the scaled ODE problem

$$
\frac{d\bar v}{d\bar t} =
- |\bar v|\bar v + \mbox{sign}(1-\alpha),\quad
\bar v(0)=\beta\tp
$$

Note that, as usual, the dimensionless numbers have simple
interpretations:
\( \alpha \) is the ratio of the mass of the displaced fluid and
the mass of the body, while \( \beta \) is the ratio of the initial and
terminal velocities.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>scaled_vertical_motion_with_drag</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:decay:jump">Exercise 5: Implement a scaled model with jump</h2>

<p>
Make software for the problem in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:decay:jump">Variable coefficients</a>
so that you can produce Figure <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:decay:jump:fig">4</a>.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_5_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_5_1">

<p>
Follow the ideas for software in the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:decay:body">Scaling a generalized problem</a>: use the
<a href="http://tinyurl.com/o8pb3yy/decay_vc.py" target="_self"><tt>decay_vc.py</tt></a> module as computational
engine and modify the
<a href="http://tinyurl.com/o8pb3yy/falling_body.py" target="_self"><tt>falling_body.py</tt></a> code.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>decay_jump</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:decay:cooling">Exercise 6: Implement a scaled model for cooling</h2>

<p>
Make software for the unscaled problem <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#mjx-eqn-17">(17)</a>
where \( T_s \) can be a function of time.
Use this implementation to compute the solution of the
scaled problem <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#mjx-eqn-24">(24)</a>.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_6_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_6_1">

<p>
You may use the general software <a href="http://tinyurl.com/o8pb3yy/decay_vc.py" target="_self"><tt>decay_vc.py</tt></a>
for computing with the cooling model.
See the section <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#sec:scale:decay:body">Scaling a generalized problem</a> for more ideas.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>decay_cooling1</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:decay:exer:decay:step">Problem 7: Scale variable coefficients</h2>

<p>
The goal of this exercise is to scale the problem
\( u^{\prime}(t) = -a(t)u(t) + b(t) \), \( u(0)=I \), when

$$
a(t) =\left\lbrace\begin{array}{ll}
Q, & t < s,\\ 
Q - A, & t\geq s,\end{array}\right.
\quad b = \left\lbrace\begin{array}{ll}
\gamma t, & t < s,\\ 
0, & t\geq s,\end{array}\right.
$$

Here, \( Q,A,\gamma >0 \).
Filename: <code>decay_varcoeff</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:decay:exer:cooling:Ts">Exercise 8: Alternative scalings of a cooling model</h2>

<p>
Scale the model <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#mjx-eqn-17">(17)</a>, with \( T_s \)
given as in <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#mjx-eqn-23">(23)</a>, using two alternative
scalings of \( T \): <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#mjx-eqn-21">(21)</a> and
the simpler \( \bar T = T/T_0 \). Does the type of scaling impact how
many dimensionless parameters we end up with?
Filename: <code>decay_cooling2</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:decay:exer:nonlin:logistic2">Exercise 9: Alternative scalings of a cooling model</h2>

<p>
Implement the scaled model <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#mjx-eqn-30">(30)</a>
and produce a plot with curves corresponding to various values of
\( \alpha \) and \( p \) to summarize how \( \bar u(\bar t) \) look like.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_9_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_9_1">

<p>
A centered Crank-Nicolson-style
scheme for <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86005.html#mjx-eqn-30">(30)</a>
can use an old time value for the nonlinear coefficient:

$$ \frac{\bar u^{n+1} - \bar u^n}{\Delta t} =
(1 - \alpha\bar u^n)^p\frac{1}{2}(\bar u^n + \bar u^{n+1})\tp$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>growth</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:projectile">Exercise 10: Scale projectile motion</h2>

<p>
We have the following mathematical model for the motion of a projectile
in two dimensions:

$$ m\ddot\x + \frac{1}{2}C_D\varrho A|\dot\x|\dot\x
= -mg\jj,\quad \x(0)=\boldsymbol{0},\ \dot\x(0)=v_0\cos\theta\ii +
v_0\sin\theta\jj\tp$$

Here, \( m \) is the mass of the projectile, \( \x=x\ii + y\jj \) is
the position vector of the projectile, \( \ii \) and \( \jj \)
are unit vectors along the \( x \) and \( y \) axes, respectively,
\( \ddot\x \) and \( \dot\x \) is the second- and first-order
time derivative of \( \x(t) \), \( C_D \) is a drag coefficient
depending on the shape of the projectile (can be taken as 0.4 for a sphere),
\( \varrho \) is the density of the air, \( A \) is the cross section area
(can be taken as \( \pi R^2 \) for a sphere of radius \( R \)), \( g \) is gravity,
\( v_0 \) is the initial velocity of the projectile in a direction that makes
the angle \( \theta \) with the ground.

<p>
<b>a)</b>
Neglect the air resistance term proportional to \( \dot\x \) and solve
analytically for \( \x(t) \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_10_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_10_1">

<p>
The vector differential equation reduces to the two component equations

$$ m\ddot x(t) = 0,\quad m\ddot y(t) = -mg\tp$$

Integrating twice yields

$$ x(t) = C_1t + C_2,\quad y(t) = -\frac{1}{2}gt^2 + C_3t + C_4\tp$$

The condition \( \x(0)=\boldsymbol{0} \) forces \( C_2=C_4=0 \). The condition on
the derivative gives \( C_1=v_0\cos\theta \) and \( C_3=v_0\sin\theta \).
The result is therefore

$$ \x(t) = v_0\cos(\theta) t\ii + (v_0\sin(\theta) t - \frac{1}{2}gt^2)\jj\tp$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Make the model for projectile motion with air resistance non-dimensional.
Use the maximum height from the simplification in a) as length scale.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_10_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_10_2">

<p>
We introduce dimensionless quantities:

$$ \bar x = \frac{x}{L},\quad \bar y = \frac{y}{L},\quad\bar t = \frac{t}{t_c},$$

where the scales \( L \) and \( t_c \) must be determined. Inserted in the original
equation:

$$ \frac{mL}{t_c^2}\frac{d^2\bar\x}{d\bar t^2} +
\frac{1}{2} C_D\varrho A\frac{L^2}{t_c^2}\left\vert\frac{d\bar\x}{d\bar t}
\right\vert = -mg\jj\tp$$

Dividing by \( mL/t_c^2 \) gives

$$ \frac{d^2\bar\x}{d\bar t^2} +
\frac{1}{2} C_D\varrho A\frac{L}{m}\left\vert\frac{d\bar\x}{d\bar t}
\right\vert = -\frac{gt_c^2}{L}\jj\tp$$

<p>
The maximum height \( y_{\max} \) occurs when \( \dot y = 0 \):

$$ \dot y = v_0\sin\theta - gt = 0\quad\Rightarrow\quad
t = g^{-1}v_0\sin\theta\tp$$

The corresponding value is

$$ y_{\max}=g^{-1}v_0^2\sin^2\theta - \frac{1}{2}g^{-1}v_0^2\sin^2\theta =
\frac{1}{2}g^{-1}v_0^2\sin^2\theta\tp$$

We can take \( L=y_{\max} \) and let \( t_c \) be the corresponding \( t \) value:
\( t_c=g^{-1}v_0\sin\theta \). Inserted in the scaled problem:

$$ \frac{d^2\bar\x}{d\bar t^2} +
\frac{1}{2} C_D\varrho A\frac{v_0^2\sin^2\theta}{2mg}
\left\vert\frac{d\bar\x}{d\bar t}
\right\vert = -\jj\tp$$

We can identify a dimensionless parameter

$$ \alpha = \frac{1}{4} m^{-1}g^{-1} C_D\varrho A v_0^2\sin^2\theta,$$

and write the scaled equation as

$$ \frac{d^2\bar\x}{d\bar t^2} + \alpha \left\vert\frac{d\bar\x}{d\bar t}
\right\vert = -\jj,$$

with initial conditions

$$ \bar\x(0)=\boldsymbol{0},\quad \frac{d\bar x}{d\bar t}(0) =
\frac{t_c}{L}(v_0\cos\theta\ii + v_0\sin\theta\jj) =
2\cot\theta\ii + 2\jj\tp$$

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 34</b>: Check that \( \alpha \) is dimensionless. Easy: \( \varrho \) goes like \( m/L^3 \), \( A \) cancels \( L^2 \), \( v_0^2 \) cancels the remaining dimensions... seems to be correct...)</font>
<!-- end inline comment -->


<!-- begin inline comment -->
<font color="red">(<b>hpl 35</b>: Need to check the final problem. Solve scaled problem without drag.)</font>
<!-- end inline comment -->

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Make the model dimensionless again, but this time by demanding that
the scaled initial velocity is unity in \( x \) direction.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_10_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_10_3">

<p>
The scaled initial velocity condition is

$$ \bar x(0) = \frac{t_c}{L}v_0\cos\theta\tp$$

Demanding the scaled velocity to be unity gives

$$ L = t_cv_0\cos\theta\tp$$

The scaled initial velocity in \( y \) direction becomes

$$ \bar y(0) = \tan\theta\tp$$

The scaled ODE becomes

$$ \frac{d^2\bar\x}{d\bar t^2} +
\frac{1}{2} C_D\varrho A\frac{L}{m}\left\vert\frac{d\bar\x}{d\bar t}
\right\vert = -\frac{g t_c}{v_0\cos\theta}\jj\tp$$

We can choose \( t_c \) such that the source term is unity:

$$ t_c = g^{-1}v_0\cos\theta,$$

which makes

$$ L = t_cv_0\cos\theta = g^{-1}v_0^2\cos^2\theta\tp$$

The coefficient in the drag term becomes

$$ \alpha = \frac{1}{2}m^{-1}g^{-1}C_D\varrho A v_0^2\cos^2\theta\tp$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>d)</b>
A soccer ball has diameter \( R=11 \) cm and mass 0.43 kg, the density of air
is 1.2 \( \hbox{kg}\hbox{m}^{-3} \), a soft kick has velocity 10 km/h,
while a hard kick may have 120 km/h. Estimate the dimensionless parameter
in the scaled problem for a soft and a hard kick with
\( \theta \) corresponding to 30 degrees. Solve the scaled
differential equation for these values and plot the trajectory (\( y \) versus
\( x \)) for the two cases.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_10_4" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_10_4">

<p>
We need to express \( R \), \( v_0 \), and \( \theta \) in standard SI units:
\( R=0.11 \) m, \( \theta = 30\cdot pi/180 \approx 0.52 \),
\( v_0 = 10/3.6 \approx 2.8 \) m/s for a soft kick, and
\( v_0=120/3.6\approx 33.33 \) m/s for a hard kick.
Using \( \alpha \) from b), we ...

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 36</b>: Need to fill in more after \( \alpha \) is checked - and solve the ODE with Odespy.)</font>
<!-- end inline comment -->

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>projectile</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:decay:exer:predpray">Problem 11: Scale a predator-prey model</h2>

<p>
The evolution of animal populations with a predator and a prey (e.g.,
lynx and hares, or foxes and rabbits) can be described by the
Lotka-Volterra ODE system

$$
\begin{align}
H^{\prime} &= H(a - bL),
\tag{269}\\ 
L^{\prime} &= L(dH - c),
\tag{270}\\ 
H(0)&=H_0,
\tag{271}\\ 
L(0)&=L_0\tp
\tag{272}
\end{align}
$$

Here, \( H \) is the number of animals of the prey (say hares)
and \( L \) is the corresponding measure of the predator population (say lynx).
There are six parameters: \( a \), \( b \), \( c \), \( d \), \( H_0 \), and \( L_0 \).

<p>
The terms has the following meanings:

<ul>
 <li> \( aH \) is the exponential
   population growth of \( H \) due to births and deaths and is governed by
   the access to nutrition,</li>
 <li> \( -bHL \) is the loss of preys because they are eaten by predators,</li>
 <li> \( dHL \) is the increase of preys because they eat predators (but only
   a fraction of the eaten preys, \( bHL \), contribute to population growth
   of the predator and therefore \( d < b \)),</li>
 <li> \( -cL \) is the exponential decay in the predator population because of
   deaths (the increase is modeled by \( dHL \)).</li>
</ul>

Dimensionless independent and dependent variables are introduced as usual
by

$$ \bar t = \frac{t}{t_c},\quad
\bar H = \frac{H}{H_c},\quad \bar L = \frac{L}{L_c},
$$

where \( t_c \), \( H_c \), and \( L_c \) are scales to be determined. Inserted
in the ODE problem we arrive at

$$
\begin{align}
\frac{H_0}{t_c}\frac{d\bar H}{d\bar t} &= H_0\bar H(a - bH_0\bar L),
\tag{273}\\ 
\frac{H_0}{t_c}\frac{d\bar L}{d\bar t} &= H_0\bar L(dH_0\bar H - c),
\tag{274}\\ 
H_c\bar H(0) &= H_0,
\tag{275}\\ 
L_c\bar H(0) &= L_0\tp
\tag{276}
\end{align}
$$

<p>
<b>a)</b>
Consider first a simple, intuitive scaling of \( H \) and \( L \) based on
initial conditions \( H_c=H_0 \)
and \( L_c=H_c \). This means that \( \bar H \) starts out at unity and \( \bar L \)
starts out as the fraction \( L_0/H_0 \). Find a time scale and identify
dimensionless parameters in the scaled ODE problem.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_11_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_11_1">

<p>
With \( H_c=L_c=H_0 \) in
<a href="#mjx-eqn-273">(273)</a>-<a href="#mjx-eqn-276">(276)</a>
we get

$$
\begin{align*}
\frac{d\bar H}{d\bar t} &= \frac{a}{bH_0}\bar H  - \bar L\bar H,
\\ 
\frac{d\bar L}{d\bar t} &= \frac{d}{b}\bar L \bar H - \frac{c}{bH_0}\bar L),
\\ 
\bar H(0) &= 1,\\ 
\bar L(0) &=\frac{L_0}{H_0}\tp
\end{align*}
$$

With the dimensionless parameters

$$ \alpha = \frac{a}{bH_0},\quad\beta = \frac{d}{b},\quad\gamma =
\frac{c}{bH_0},\quad \delta = \frac{H_0}{L_0},$$

we can write the dimensionless problem as

$$
\begin{align*}
\frac{d\bar H}{d\bar t} &= \alpha\bar H  - \bar L\bar H,\\ 
\frac{d\bar L}{d\bar t} &= \beta\bar L \bar H - \gamma\bar L),\\ 
\bar H(0) &= 1,\\ 
\bar L(0) &= \delta \tp
\end{align*}
$$

<p>
The quantity \( bH_0 \) is the number of eaten preys per predator.
Then \( \alpha \) measures the ratio of natural population growth of
the prey, due to nutrition, and the number of eaten preys per predator.
The \( \beta \) parameter measures the fraction of the eaten preys and
the amount of this that actually
leads to population growth of the predator.
The number \( \gamma \) reflects the ratio of
predator deaths and the eaten preys per predator, and \( \delta \) is
the initial fraction of preys and predators.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Try a different scaling where the aim is to adjust the scales such that
the ODEs become as simple as possible, i.e, have as few dimensionless
parameters as possible. Compare with the scaling in a).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_11_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_11_2">

<p>
Dividing by \( H_c \) and \( L_c \) in
<a href="#mjx-eqn-273">(273)</a> and
<a href="#mjx-eqn-276">(276)</a>,
respectively,
and multiply by \( t_c \):

$$
\begin{align*}
\frac{d\bar H}{d\bar t} &= t_c\bar H(a - bL_c\bar L),\\ 
\frac{d\bar L}{d\bar t} &= t_c\bar L(dH_c\bar H - c)\tp
\end{align*}
$$

Choosing \( t_c=1/a \) and \( t_c aL_c=1 \), i.e., \( L_c=a/b \), makes the
first equation free of parameters: \( \bar H^{\prime}=\bar H(1-\bar L) \).
Factoring out \( c \) in the equation for \( L \) and choosing
\( H_c d/c=1 \), i.e., \( H_c=c/d \), leaves us with the \( L \) equation
as \( \bar L^{\prime}=(c/a)\bar L(\bar H-1) \). The ratio \( c/a \) is
now called \( \mu \) and equals
\( \gamma/\alpha \) from a).

<p>
The initial conditions lead to \( \bar H(0) = H_0/H_c=H_0d/c =\beta/\gamma = \nu \),
and \( \bar L(0)=L_0/L_c = L_0b/a = \delta/\alpha = \omega \).

<p>
The dimensionless problem is now

$$
\begin{align}
\frac{d\bar H}{d\bar t} &= \bar H(1 - \bar L),
\tag{277}\\ 
\frac{d\bar L}{d\bar t} &= \mu \bar L(\bar H - 1) = \gamma\alpha^{-1} \bar L(\bar H - 1),
\tag{278}\\ 
\bar H(0) &= \nu = \beta/\gamma,
\tag{279}\\ 
\bar L(0) &= \omega = \delta/\alpha,
\tag{280}
\end{align}
$$

with

$$ \mu = \frac{c}{a},\quad \nu = H_0\frac{d}{c},\quad \omega = L_0\frac{b}{a}
\tp$$

The unknowns \( \bar H \) and \( \bar L \) now has less intuitive scalings,

$$ \bar H = \frac{Hd}{c},\quad \bar L = \frac{Lb}{a},$$

while time is measured in the units based on the exponential growth
due to births and deaths of preys (\( a \)). The number of dimensionless parameters
is one less since we have one more scale (for \( L_c \)) at our
disposal. Simplicity in one initial conditions in a) is
exchanged with more simplicity in the ODEs, which now have
only one dimensionless parameter.

<p>
Note that \( \nu \) and \( \omega \) must be
different from unity to avoid \( \bar H\neq 0 \) and \( \bar L\neq 0 \) because
of the factors \( 1-L \) and \( H-1 \) in the equations that can make
\( \bar H^{\prime}=0 \) and \( \bar L^{\prime}=0 \).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
A more mathematical approach to determining suitable scales for \( H \) and \( L \)
consists in finding the stationary points \( (H,L) \) of the ODE system,
where \( H^{\prime}=L^{\prime}=0 \), and use such points as characteristic
sizes of the dependent variables. Show that \( H^{\prime}=L^{\prime}=0 \)
implies \( H=L=0 \) or \( L=a/b \) and \( H=c/d \). Use \( H_c=a/b \), \( L_c=c/d \),
and find a time scale. Compare with the result in b).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_11_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_11_3">

<p>
Setting \( H^{\prime}=L^{\prime}=0 \) leads to

$$ H(a-bL)=0,\quad L(dH-c)=0,$$

from which we see that the factors must vanish: \( H=L=0 \),
\( L=a/b \), and \( H=c/d \). With Use \( H_c=a/b \), \( L_c=c/d \), and \( t_c=1/a \)
we get the same scaling as in b), but with a different motivation.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>predator_prey</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:decay:exer:competing_species">Problem 12: Scale a model for competing species</h2>

<p>
Let \( N_1(t) \) and \( N_2(t) \) be the number of animals in two
competing species. A generalized Lotka-Volterra model
is based on a logistic growth of each specie and a predator-prey like
interaction (cf.&nbsp;ref{scale:decay:exer:predprey}):

$$
\begin{align}
\frac{dN_1}{dt} &= r_1N_1\left( 1 - \frac{N_1}{M_1} - s_{12}\frac{N_2}{M_1}\right),
\tag{281}\\ 
\frac{dN_2}{dt} &= r_2N_2\left( 1 - \frac{N_2}{M_2} - s_{21}\frac{N_1}{M_2}\right),
\tag{282}
\end{align}
$$

where \( r_1 \), \( r_2 \), \( M_1 \), \( M_2 \), \( s_{12} \), and \( s_{21} \) are given constants.
The initial conditions specify \( N_1 \) and \( N_2 \) at \( t=0 \).
Find suitable scales and derive a dimensionless ODE problem.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_12_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_12_1">

<p>
As always, we can introduce dimensionless variables,
We use ideas from scaling of ODEs for logistic growth, i.e., we use
the carrying capacities \( M_1 \) and \( M_2 \) as characteristic (maximum)
values of \( N_1 \) and \( N_2 \), respectively. Time can be scaled from
the initial exponential growth of \( N_1 \) or \( N_2 \), i.e., \( t_c=1/r_1 \)
or \( t_c=1/r_2 \). We choose the former here. Introducing

$$ \bar t = r_1 t,\quad u_1 = \frac{N_1}{M_1},\quad u_2 = \frac{N_2}{M_2},$$

in the ODE system, leads to

$$
\begin{align*}
\frac{du_1}{d\bar t} &= u_1\left(1 - u_1 - b_{21}\beta\gamma\right),\\ 
\frac{du_2}{d\bar t} &= \alpha u_2\left(1 - u_2 - b_{12}\beta^{-1}\gamma^{-1}\right),\\ 
\end{align*}
$$

where the dimensionless numbers are given by

$$ \alpha = \frac{r_2}{r_1},\quad \beta=\frac{M_2}{M_1},
\quad \gamma = \frac{b_{12}}{b_{21}}\tp$$

We have introduced to separate numbers \( \beta \) and \( \gamma \) since they
related to different parameters, but only their product matters.
Alternatively, we could introduce the numbers \( \mu = b_{12}\gamma \)
and \( \nu = b_{21}\gamma^{-1} \) in the last term of the first and second
ODE, respectively.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>competing_species</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:decay:exer:sine">Problem 13: Find the period of sinusoidal signals</h2>

<p>
<b>a)</b>
Plot the function

$$ u(t) = A\sin(\omega t), $$

for \( t\in [0, 8\pi/\omega] \). Choose \( \omega \) and \( A \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_13_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_13_2">

<p>
Appropriate code is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">u</span>(t, A, w, module<span style="color: #666666">=</span>np):
    <span style="color: #008000; font-weight: bold">return</span> A<span style="color: #666666">*</span>module<span style="color: #666666">.</span>sin(w<span style="color: #666666">*</span>t)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">a</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Plot u.&quot;&quot;&quot;</span>
    w <span style="color: #666666">=</span> <span style="color: #666666">2*</span>np<span style="color: #666666">.</span>pi
    A <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
    t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">8*</span>np<span style="color: #666666">.</span>pi<span style="color: #666666">/</span>w, <span style="color: #666666">1001</span>)
    plt<span style="color: #666666">.</span>figure()
    plt<span style="color: #666666">.</span>plot(t, u(t, A, w))
    plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;t&#39;</span>);  plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;u&#39;</span>)
    plt<span style="color: #666666">.</span>axis([t[<span style="color: #666666">0</span>], t[<span style="color: #666666">-1</span>], <span style="color: #666666">-1.1</span>, <span style="color: #666666">1.1</span>])
    plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">r&#39;$u=A\sin (\omega t)$, $A=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$, $\omega = </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$&#39;</span>
              <span style="color: #666666">%</span> (A, w))
    plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp1.png&#39;</span>);  plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp1.pdf&#39;</span>)
</pre></div>
<p>
<center><p><img src="fig-scaling/sine_period_a.png" align="bottom" width=600></p></center>

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
The <em>period</em> \( P \) of \( u \) is the shortest distance between two peaks (where
\( u=A \)). Show mathematically that

$$ P = \frac{2\pi}{\omega}\tp$$

Frequently, \( P \) is also referred to as the <em>wave length</em> of \( u \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_13_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_13_3">

<p>
Since the sine function has period \( 2\pi \), we have that

$$ \sin(\omega t) = \sin(\omega t + 2\pi)\tp$$

The definition of \( P \) is that sine gets its value again after
time \( P \):

$$ \sin(\omega t) = \sin(\omega (t + P))\tp$$

Combing we get that \( \sin(\omega t + 2\pi) = \sin(\omega (t + P)) \),
so the arguments must be equal:

$$ \omega t + 2\pi = \omega (t + P),$$

from which it follows that \( P=2\pi/\omega \).

<p>
An alternative is to find the peaks as the points where \( du/dt=0 \).
Since \( du/dt = \omega\cos (\omega t) \), this function is zero when
\( \omega t = n\pi \) for integer \( n \). If \( n\pi \) corresponds to a maximum,
\( (n+1)\pi \) will correspond to a minimum and \( (n+2)\pi \) to the next
maximum. The period \( P \) is the distance in time between two maxima:

$$ \omega(t + P) - \omega t = (n+2\pi - n\pi\quad\Rightarrow\quad
P = \frac{2\pi}{\omega}\tp
$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Plot the damped signal \( u(t)=e^{-at}\sin (\omega t) \) over four periods
of \( sin(\omega t) \). Choose \( \omega \), \( A \), and \( a \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_13_4" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_13_4">

<p>
Code:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">u_damped</span>(t, A, w, a, module<span style="color: #666666">=</span>np):
    <span style="color: #008000; font-weight: bold">return</span> A<span style="color: #666666">*</span>module<span style="color: #666666">.</span>exp(<span style="color: #666666">-</span>a<span style="color: #666666">*</span>t)<span style="color: #666666">*</span>module<span style="color: #666666">.</span>sin(w<span style="color: #666666">*</span>t)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">c</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Plot damped u.&quot;&quot;&quot;</span>
    w <span style="color: #666666">=</span> <span style="color: #666666">2*</span>np<span style="color: #666666">.</span>pi
    A <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
    a <span style="color: #666666">=</span> <span style="color: #666666">0.5</span>
    t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">8*</span>np<span style="color: #666666">.</span>pi<span style="color: #666666">/</span>w, <span style="color: #666666">100001</span>)
    plt<span style="color: #666666">.</span>figure()
    plt<span style="color: #666666">.</span>plot(t, u_damped(t, A, w, a))
    plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&#39;t&#39;</span>);  plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&#39;u&#39;</span>)
    plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">r&#39;$u=Ae^{-at}\sin (\omega t)$,&#39;</span>
              <span style="color: #BA2121">&#39;$a=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$, $A=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$, $\omega = </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">$&#39;</span> <span style="color: #666666">%</span> (a, A, w))
    plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp2.png&#39;</span>);  plt<span style="color: #666666">.</span>savefig(<span style="color: #BA2121">&#39;tmp2.pdf&#39;</span>)

    u_max <span style="color: #666666">=</span> []
    u_ <span style="color: #666666">=</span> u_damped(t, A, w, a)
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>, <span style="color: #008000">len</span>(t)<span style="color: #666666">-1</span>):
        <span style="color: #008000; font-weight: bold">if</span> u_[i<span style="color: #666666">-1</span>] <span style="color: #666666">&lt;</span> u_[i] <span style="color: #666666">&gt;</span> u_[i<span style="color: #666666">+1</span>]:
            u_max<span style="color: #666666">.</span>append((t[i], u_[i]))
    <span style="color: #008000; font-weight: bold">print</span> u_max
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(u_max)<span style="color: #666666">-1</span>):
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;P=&#39;</span>, u_max[i<span style="color: #666666">+1</span>][<span style="color: #666666">0</span>] <span style="color: #666666">-</span> u_max[i][<span style="color: #666666">0</span>]
</pre></div>
<p>
<center><p><img src="fig-scaling/sine_period_c.png" align="bottom" width=600></p></center>

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>d)</b>
What is the period of \( u(t)=e^{-at}\sin (\omega t) \)? We define the
period \( P \) as the shortest distance between two peaks of the signal.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_13_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_13_1">

<p>
Use that \( v = p\cos(\omega t) + q\sin (\omega t) \) can be rewritten
as \( v = B\cos(\omega t - \phi) \) with \( B=\sqrt{p^2 + q^2} \) and
\( \phi = \tan^{-1}(p/q) \). Use such a rewrite of \( u' \) to find the peaks of
\( u \) and then the period.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_13_5" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_13_5">

<p>
Finding the extrema from \( u^{\prime}=0 \) leads to

$$ u^{\prime} = -ae^{-at}\sin(\omega t) + e^{-at}\omega\cos(\omega t) = 0\tp$$

Using the hint to rewrite (\( p=\omega \), \( q=-a \)), we get

$$ u^{\prime} = e^{-at}B\cos(\omega t - \phi)=0,\quad B=\sqrt{\omega^2 + a^2},\ \phi = \tan^{-1}(-\omega/a)\tp$$

Now, \( e^{-at} \) is always positive so only the cosine function can
cross zero, and that happens when the argument is \( n\pi \) for integer \( n \).
However, all the maxima only occurs for \( 2n\pi \) (\( n \) integer).
Demanding the argument to be \( 2n\pi \) we get the distance between two
nearby peaks as

$$ \omega (t + P) - \phi - (\omega t - \phi) = 2(n+1)\pi - 2n\pi,$$

which leads to

$$ \omega P = 2\pi\quad\Rightarrow\quad P = \frac{2\pi}{\omega}\tp$$

The period of the damped signal is the same; only \( \omega \) can alter
the period.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>sine_period</code>.

<p>
<!-- Closing remarks for this Problem -->

<h3 id="___sec180">Remarks </h3>

<p>
The <em>frequency</em> is the number of up and down cycles in one unit time.
Since there is one cycle in a period \( P \), the frequency is \( f =1/P \),
measured in Hz.
The <em>angular frequency</em> \( \omega \) is then \( \omega = 2\pi/P = 2\pi f \).

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:pendulum">Problem 14: Scale the pendulum equation</h2>

<p>
The equation for a so-called simple pendulum with a mass \( m \) at the end is

$$
\begin{equation}
mL\ddot\theta + mg\sin\theta = 0,
\tag{283}
\end{equation}
$$

where \( \theta(t) \) is the angle with the vertical, \( L \) is the length of
the pendulum, and \( g \) is the acceleration of gravity.

<p>
A physical pendulum with moment of inertia \( I \) is governed by
a similar equation,

$$
\begin{equation}
I\ddot\theta + mgL\sin\theta = 0\tp
\tag{284}
\end{equation}
$$

Both equations have the initial conditions \( \theta(0)=\Theta \) and
\( \theta'(0)=0 \) (start at rest).

<p>
Use \( \theta \) as dimensionless unknown, find a proper time scale,
and scale both differential equations.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_14_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_14_1">

<p>
Introducing \( \bar t=t/t_c \) gives

$$
\begin{align*}
mL\frac{1}{t_c^2}\frac{d^2\theta}{d\bar t^2} + mg\sin\theta &= 0,\\ 
I\frac{1}{t_c^2}\frac{d^2\theta}{d\bar t^2} + mgL\sin\theta &= 0\tp
\end{align*}
$$

or on dimensionless form,

$$
\begin{align*}
\frac{d^2\theta}{d\bar t^2} + \frac{t_c^2g}{L}\sin\theta &= 0,\\ 
\frac{d^2\theta}{d\bar t^2} + \frac{t_c^2mgL}{I}\sin\theta &= 0\tp
\end{align*}
$$

An obvious choice to make the terms equal are \( t_c=\sqrt{L/g} \)
in the first equation and \( t_c=\sqrt{I/(mgL)} \) in the second.
These choices are also compatible with the frequencies if the
angle is small: \( \ddot\theta + g/L\theta = 0 \) has solution
of the type \( \sin(\omega t) \) with \( \omega = \sqrt{g/L} \), and then
\( t_c=1/\omega \) is a natural scale.

<p>
The dimensionless equations become equal in this case:

$$ \frac{d^2\theta}{d\bar t^2} + \sin\theta = 0\tp$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>pendulum</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:binary_star">Exercise 15: Scale the ODEs for a binary star</h2>

<p>
The equations for a <a href="https://en.wikipedia.org/wiki/Binary_star" target="_self">binary star</a>,
or a planet and a moon, are

$$
\begin{align}
m_A\ddot\x_A &= \F,
\tag{285}\\ 
m_B\ddot\x_B &= -F,
\tag{286}
\end{align}
$$

where \( \x_A \) is the position of object (star) A, and \( \x_B \) is the position
object B. The corresponding masses are \( m_A \) and \( m_B \).
The only force is the gravity force

$$ \F = \frac{Gm_Am_B}{||\rpos||^3}\rpos,$$

where

$$ \rpos(t) = \x_A(t) - \x_B(t),$$

and \( G \) is the gravitational constant: \( G=6.674\cdot 10^{-11}\hbox{ Nm}^2/\hbox{kg}^2 \). A problem with these equations is that the parameters are very large
(\( m_A \), \( m_B \), \( ||\rpos|| \)) or very small (\( G \)). The rotation time
for binary starts can be very small or large as well.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_15_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_15_1">

<p>
A natural length scale could be the initial distance between the objects:
\( L=\rpos(0) \). We write the dimensionless quantities as

$$ \bar\x_A = \frac{\x_A}{L},\quad\bar\x_B = \frac{\x_B}{L},\quad
\bar t = \frac{t}{t_c}\tp$$

The gravity force is transformed to

$$ \F = \frac{Gm_Am_B}{L^2||\bar\rpos||^3}\bar\rpos,\quad \bar\rpos = \bar\x_A - \bar\x_B,$$

so the first ODE for \( \x_A \) becomes

$$ \frac{d^2 \bar\x_A}{d\bar t^2} =
\frac{Gm_Bt_c^2}{L^3}\frac{\bar\rpos}{||\bar\rpos||^3}\tp$$

Assuming that quantities with a bar and their derivatives are around unity
in size, it is natural to choose \( t_c \) such that the fraction \( Gm_Bt_c/L^2=1 \):

$$ t_c = \sqrt{\frac{L^3}{Gm_B}}\tp$$

From the other equation for \( \x_B \) we get another candidate for \( t_c \) with
\( m_A \) instead of \( m_B \). Which mass we choose play a role if \( m_A\ll m_B \) or
\( m_B\ll m_A \). One solution is to use the sum of the masses:

$$ t_c = \sqrt{\frac{L^3}{G(m_A+m_B)}}\tp$$

Taking a look at <a href="https://en.wikipedia.org/wiki/Kepler%27s_laws_of_planetary_motion" target="_self">Kepler's laws</a> of planetary motion, the orbital period for a planet around the star is given by the \( t_c \) above, except for a missing factor of \( 2\pi \).
Our characteristic time \( t_c \) is therefore highly relevant.

$$
\begin{align}
\frac{d^2 \bar\x_A}{d\bar t^2} &=
\frac{m_B}{m_A+m_B}\frac{\bar\rpos}{||\bar\rpos||^3},
\tag{287}\\ 
\frac{d^2 \bar\x_B}{d\bar t^2} &=
\frac{m_A}{m_A+m_B}\frac{\bar\rpos}{||\bar\rpos||^3}\tp
\tag{288}
\end{align}
$$

<p>
In the limit \( m_A\ll m_B \), object B stands still, say \( \bar\x_B=0 \), and object
A orbits according to

$$ \frac{d^2 \bar\x_A}{d\bar t^2} = \frac{\bar\x_A}{||\bar \x_A||^3}\tp$$

Switch to polar coordinates?

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>binary_star</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:Duffing">Problem 16: Scale Duffing's equation</h2>

<p>
Duffing's equation is a vibration equation with linear and cubic
spring terms:

$$ mu'' + k_0u + k_1u^3 = 0,\quad u(0)=U_0,\ u'(0)=0\tp$$

Scale this problem.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_16_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_16_1">

<p>
We introduce \( \bar t = t/t_c \) and \( \bar u = u/u_c \):

$$ mt_c^{-2}u_c\bar u'' + k_0u_c\bar u + k_1u_c^3\bar u^3=,\quad
u_c\bar u(0)=U_0,\ u_c\bar u'(0)=0\tp$$

Choosing \( t_c \) as in a linear vibration problem, \( t_c = \sqrt{m/k_0} \),
and \( u_c=U_0 \), we get

$$ 'bar u'' + \bar u + \alpha u^3 = 0,\quad \bar u(0)=1,\ \bar u'(0)=0,$$

where

$$ \alpha = U_0^2\frac{k_1}{k_0},$$

is a dimensionless parameter reflecting the ratio of the
cubic spring term \( k_1U_0^3 \) and the linear spring term \( k_0U_0 \)
at maximum displacement.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>Duffing_eq</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:stationary_Couette">Problem 17: Scale a stationary Couette flow</h2>

<p>
A fluid flows between two flat plates, with one plate at rest while
the other moves with velocity \( U_0 \). This classical flow case is known as
stationary Couette flow.

<p>
<b>a)</b>
Directing the \( x \) axis in the flow direction and letting \( y \) be
a coordinate perpendicular to the walls, one can assume that
the velocity field simplifies to \( \u = u(y)\ii \).
Show from the Navier-Stokes equations that the boundary-value problem
for \( u(y) \) is

$$ u^{\prime\prime}(u) = 0,\quad u(0)=0,\ u(H)=U_0\tp$$

We have here assumed at \( y=0 \) corresponds to the plate at rest and
that \( y=H \) represents the plate that moves. There are no pressure
gradients present in the flow.

<p>
<b>b)</b>
Scale the problem in a) and show that the result has no physical parameters
left in the model:

$$ \frac{d^2\bar u}{d\bar y^2} = 0,\quad \bar u(0)=0,\ \bar u(1)=1\tp$$

<p>
<b>c)</b>
We can compute \( \bar u(\bar y) \) from one numerical simulation (or a
straightforward integration of the differential equation). Set up
the formula that finds \( u(y; H, u_0) \) from \( \bar u(\bar y) \) for any
values of \( H \) and \( U_0 \).

<p>
Filename: <code>stationary_Couette</code>.

<p>
<!-- Closing remarks for this Problem -->

<h3 id="___sec185">Remarks </h3>

<p>
The problem for \( u \) is a classical two-point boundary-value problem
in applied mathematics and arises in a number of applications, where
Couette flow is just one example. Heat conduction is another
example: \( u \) is temperature, and the heat conduction equation for
an insulated rod reduces to \( u^{\prime\prime}=0 \) under stationary
conditions and no heat source.
Controlling the end \( x=0 \) at 0 degrees Celsius the other end \( x=L \)
at \( U_0 \) degrees
Celsius, gives the same boundary conditions as in the above flow problem.
The scaled problem is of course the same whether we have flow of
fluid or heat.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:starting_Couette">Problem 18: Scale a starting Couette flow</h2>

<p>
A fluid is confined in a channel with two planar walls \( z=0 \) and \( z=H \).
The fluid is at rest. At time \( t=0 \) the upper wall is suddenly set in
motion with a velocity \( U\ii \). We assume that the velocity is
directed along the \( x \) axis: \( \u = u(x,z,t)\ii \). From the equation of continuity, \( \nabla\cdot\u =0 \), we get that \( \partial u/\partial x = 0 \) such
that \( \u = u(z,t)\ii \). The boundary conditions are \( \u=0 \) at the lower
wall \( z=0 \) and \( \u = U\ii \) at the upper wall \( z=H \). Assume that the
pressure is constant everywhere and that there are no body forces.

<p>
<b>a)</b>
Start with the incompressible Navier-Stokes equations and the
assumption \( \u = u(z,t)\ii \). Derive an initial-boundary value problem
for \( u(z,t) \). Scale the problem.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_18_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_18_1">

<p>
Inserting the simplified velocity in the original Navier-Stokes equations
makes the convection term \( \u\cdot\nabla\u \) vanish and \( \nabla p \) vanishes
since \( p \) is assumed constant (only the upper wall drives the flow).
The result becomes

$$ \varrho \frac{\partial u}{\partial t} = \mu
\frac{\partial^2 u}{\partial z},$$

or using \( \mu/\varrho =\nu \),

$$ \frac{\partial u}{\partial t} = \nu
\frac{\partial^2 u}{\partial z},$$

with \( u(z,0)=0 \), \( u(0,t)=0 \) and \( u(H,t)=U \). This is a standard
diffusion problem. The natural length scale is \( H \), so
\( \bar z = z/H \). Using the well-established time scale \( t_c= H^2/\nu \)
and the velocity scale \( u_c=U \), we get the dimensionless problem

$$ \frac{\partial \bar u}{\partial \bar t} =
\frac{\partial^2\bar u}{\partial \bar z},$$

with \( \bar u(\bar z,0)=0 \), \( u(0,\bar t)=0 \), \( u(1,t)=1 \).
There are no physical parameters. Having computed \( \bar u(\bar z, \bar t) \),
the physical solution can be retrieved as

$$ u(z,t) = U\bar u(\bar zH, \bar t H^2/\nu)\tp$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Start with the dimensionless Navier-Stokes equations and use
the assumption \( \bar\u = \bar u(\bar z,\bar t)\ii \) to reduce
the problem. The resulting equation now contains a Reynolds
number, i.e., one more physical parameter than in a).
Why is this an inferior approach to scaling the problem?

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_18_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_18_2">

<p>
Inserting the simplified velocity in the scaled Navier-Stokes
equations leads to

$$ \frac{\partial \bar u}{\partial \bar t} = \frac{1}{\hbox{Re}}
\frac{\partial^2\bar u}{\partial \bar z}\tp$$

Here we have the Reynolds number as parameter.

<p>
The major difference is the scaling used in time: \( t_c=H/U \)
(length scale is \( H \) here) versus \( t_c = H^2/\nu \). The latter
is much more suitable as it is based on a diffusion problem and
the present problem is indeed a diffusion problem.
Normally, \( \nu \) is very small, so \( t_c \) based on diffusion is usually much
larger than \( H/U \). With an inappropriate time scale,
\( \partial \bar u/\partial\bar t \) is not of unit size, and we need a
dimensionless number on the right-hand side to adjust the
spatial derivative term to a non-unity size. The wrong scaling
thereby introduces an extra (unnecessary) parameter.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>c)</b>
Can you construct a heat conduction problem that has the same solution
\( \bar u(\bar z,\bar t) \) as in a)?

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_18_3" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_18_3">

<p>
Consider a long rod with length \( H \) aligned with the \( z \) axis.
The rod is isolated on the curved circular surface and kept
at fixed temperatures \( U_0 \) and \( U_H \) at the ends \( z=0 \) and \( z=H \),
respectively. The initial temperature is \( U_0 \).
Because of the insulated curved surface, heat can only propagate in
the \( z \) direction, and a one-dimensional
heat conduction equation is appropriate:

$$ \frac{\partial u}{\partial t} = \dfc
\frac{\partial^2 u}{\partial z},$$

with \( u(z,0)=U_0 \), \( u(0,t)=U_0 \), and \( u(H,t)=U_H \).
We introduce a dimensionless temperature

$$ \bar u = \frac{u - U_0}{U_H - U_0},$$

such that \( \bar u\in [0,1] \). The standard time scale \( t_c=H^2/\dfc \)
is used, notifying that the length scale is \( H \). Inserting the
dimensionless variables in the governing equation results in
the same problem as in a). It means that we from one solution
\( \bar u(\bar z,\bar t) \) can get solutions for heat conduction
in rods of all lengths and materials, and with all boundary temperatures,
as well as flow of any fluid
between two walls with any gap and any velocity of the upper wall.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>d)</b>
Describe how the scaled problem in this exercise can be solved
by a program that solves the following diffusion problem with dimensions:

$$
\begin{align*}
\frac{\partial u}{\partial t} &=
\dfc \frac{\partial^2 u}{\partial z} + f(x,t),\\ 
u(x,0) &= I(x),\\ 
u(0,t) & =U_0(t),\\ 
u(L,t) & =U_L(t)\tp
\end{align*}
$$

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_18_4" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_18_4">

<p>
Let \( z \) be named \( x \). Set \( \dfc = 1 \), \( f=0 \), \( L=1 \), \( I(x)=0 \),
\( U_0(t)=0 \), \( U_L(t)=1 \). The resulting problem is our scaled problem from a).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
Filename: <code>starting_Couette</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:Couette_wpressure">Exercise 19: Scale Couette flow with pressure gradient</h2>

<p>
Viscous fluid flow between two infinite flat plates \( z=0 \) and \( z=H \)
is governed by

$$
\begin{align}
\mu u''(z) &= -\beta
\tag{289}\\ 
u(0) &= 0,
\tag{290}\\ 
u(H) &= U_0\tp
\tag{291}
\end{align}
$$

Here, \( u(z) \) is the fluid velocity in \( x \) direction (perpendicular to the
\( z \) axis), \( \mu \) is the dynamic viscosity of the fluid, \( \beta \) is
a positive constant pressure gradient, and \( U_0 \) is the
constant velocity of the upper
plate \( z=H \) in \( x \) direction.

<p>
<b>a)</b>
Find the exact solution \( u(z) \). Point out how \( \beta \) and \( U_0 \)
influence the magnitude of \( u \).

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_19_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_19_1">

<p>
SymPy can integrate the differential equation twice and fit the
integration constants to the boundary conditions:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">sym</span>
mu, beta, z, H <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>symbols(<span style="color: #BA2121">&#39;mu beta z H&#39;</span>,
                             real<span style="color: #666666">=</span><span style="color: #008000">True</span>, positive<span style="color: #666666">=</span><span style="color: #008000">True</span>)
U0, C1, C2 <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>symbols(<span style="color: #BA2121">&#39;U0 C1 C2&#39;</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>)

<span style="color: #408080; font-style: italic"># Integrate u&#39;&#39;(z) = -beta/mu twice and add integration constants</span>
u <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>integrate(sym<span style="color: #666666">.</span>integrate(<span style="color: #666666">-</span>beta<span style="color: #666666">/</span>mu, z) <span style="color: #666666">+</span> C1, z) <span style="color: #666666">+</span> C2

<span style="color: #408080; font-style: italic"># Use the boundary conditions</span>
eq <span style="color: #666666">=</span> [sym<span style="color: #666666">.</span>Eq(u<span style="color: #666666">.</span>subs(z, <span style="color: #666666">0</span>), <span style="color: #666666">0</span>),
      sym<span style="color: #666666">.</span>Eq(u<span style="color: #666666">.</span>subs(z, H), U0)]
s <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>solve(eq, [C1, C2])
<span style="color: #008000; font-weight: bold">print</span> s
u <span style="color: #666666">=</span> u<span style="color: #666666">.</span>subs(C1, s[C1])<span style="color: #666666">.</span>subs(C2, s[C2])
u <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>simplify(sym<span style="color: #666666">.</span>expand(u))
</pre></div>
<p>
The result becomes

$$ u(z) =
\frac{z}{2 H \mu} \left(H \beta \left(H - z\right) + 2 U_{0} \mu\right)\tp $$

<p>
The maximum value of \( u \) is found by

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># Find max u</span>
dudz <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>diff(u, z)
s <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>solve(dudz, z)
<span style="color: #008000; font-weight: bold">print</span> s
umax <span style="color: #666666">=</span> u<span style="color: #666666">.</span>subs(z, s[<span style="color: #666666">0</span>])
umax <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>simplify(sym<span style="color: #666666">.</span>expand(umax))
</pre></div>
<p>
and reads

$$ \max_z u =
\frac{H^{2} \beta}{8 \mu} + \frac{U_{0}}{2} +
\frac{U_{0}^{2} \mu}{2 H^{2} \beta}\tp
$$

If the pressure gradient is the domining driving force, we can neglect
the \( U_0 \) terms: \( \max_z u = H^2\beta/(8\mu) \). In case the movement
of the upper plate is much more important than the pressure gradient
for driving the flow, we can neglect the \( \beta \) terms. However, we must
then resort to the \( u(z) \) expression for \( \beta=0 \), \( u(z)=zU_0/H \),
and realize that the maximum then is obtained at the boundary for
\( z=H \): \( \max_z h=U_0 \) (as intuitively obvious).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Scale the problem.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_19_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_19_2">

<p>
Introducing

$$ \bar z = \frac{z}{z_c}, \quad \bar u (\bar z) = \frac{u(z_c\bar z)}{u_c},$$

in the equation gives

$$ \frac{d^2\bar u}{d\bar z^2} = -\frac{z_c^2\beta}{\mu u_c}\tp$$

The natural scale for \( z_c \) is \( H \) since that makes \( \bar z\in [0,1] \).
For the two terms in the differential equation to be of order unity
(with a correct scaling, the left-hand side should be of order unity),
we must have

$$ u_c = \frac{H^2\beta}{\mu}\tp$$

The boundary value problem is

$$
\begin{align}
\frac{d^2\bar u}{d\bar z^2} &= -1,\quad &\bar z\in (0,1),
\tag{292}\\ 
\bar u(0) &= 0,
\tag{293}\\ 
\bar u(1) &= \alpha,
\tag{294}
\end{align}
$$

where \( \alpha \) is a dimensionless number

$$ \alpha = \frac{\mu U_0}{H^2\beta}\tp$$

This is meaningful only for \( \beta\neq 0 \).

<p>
Looking at the exact solution, we see that \( \max_z u =
H^2\beta/(8\mu) \), and with this \( \max_z u \) as \( u_c \) we get a
differential equation \( \bar u'' = -8 \) instead, and \( \bar u\in [0,1] \)
(if \( U_0=0 \)). However, the factor \( 1 \) or \( 8 \) on the right-hand side is
not significant, neither if \( \bar u\in [0,1] \) or \( \bar u\in [0,8] \).

<p>
The scale \( u_c \) used above is relevant if the pressure gradient is the
dominating force. If \( U_0 \) is more important than \( \beta \), or \( \beta =0 \),
we choose \( u_c=U_0 \) and get instead

$$
\begin{align}
\frac{d^2\bar u}{d\bar z^2} &= -\alpha^{-1},\quad &\bar z\in (0,1),
\tag{295}\\ 
\bar u(0) &= 0,
\tag{296}\\ 
\bar u(1) &= 1\tp
\tag{297}
\end{align}
$$

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 37</b>: Could extend to time-dependent case, but this will involve three time scales...)</font>
<!-- end inline comment -->

<p>
Filename: <code>Couette_wpressure</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:exer:pipeflow:pulsatile">Exercise 20: Scale pulsatile pipeflow</h2>

<p>
The flow of a viscous fluid in a straight pipe with circular
cross section with radius \( R \) is governed by

$$
\begin{align}
\varrho\frac{\partial u}{\partial t} &= \frac{\mu}{r}\frac{\partial}{\partial r}
\left(r\frac{\partial u}{\partial r}\right) - P(t), & r\in (0,R),\ t\in (0,T],
\tag{298}\\ 
\frac{\partial u}{\partial r}(0,t) &= 0, & t\in (0,T],
\tag{299}\\ 
u(R,t) &= 0, & t\in (0,T],
\tag{300}\\ 
u(r,0) &= 0, & r\in [0,R].
\tag{301}
\end{align}
$$

The quantity \( u(r,t) \) is the fluid velocity, \( P(t) \) is a given
pressure gradient, \( \varrho \) is the fluid density, and \( \mu \) is the
dynamic viscosity.

<p>
Assume \( P(t) = A\cos\omega t \). Scale the problem and identify
appropriate dimensionless numbers. The assume \( P(t) \) is a more
complicated function, but still period with period \( p \).
Discuss how the scaling can be extended to this case.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_20_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_20_1">

<p>
We introduce dimensionless quantities:

$$ \bar r = \frac{r}{R},\quad \bar t = \frac{t}{t_c},\quad \bar u = \frac{u}{u_c}\tp$$

The function \( P(t) \) can be scaled as

$$ \bar P(\bar t) = \frac{P(t_c\bar t)}{A} = \sin (t_c\omega \bar t)\tp$$

Inserted in the PDE, we get

$$ \frac{\partial\bar u}{\partial\bar t} = \frac{t_c \nu }{R^2}\frac{1}{\bar r}\frac{\partial}{\partial\bar r}
\left(\bar r\frac{\partial\bar u}{\partial\bar r}\right) - \frac{t_c A}{\varrho u_c}\sin (t_c\omega\bar t),$$

where \( \mu = \mu/\varrho \).

<p>
The scale for \( u \) can be explored by seeking an analytical solution
of the problem. Such solutions do exist, they are typically series
expansions of Bessel functions, and it is not so easy to extract
a simple expression for the maximum value of \( |u(r,t)| \).
A simpler approach is to estimate \( u_c \) be demanding the coefficient
in the pressure term to be of unit size:

$$ u_c = \frac{t_cA}{\varrho}\tp$$

There are two choices of time scales: the pressure time scale \( t_c=1/\omega \)
and the viscosity (or diffusion) time scale \( t_c=R^2/nu \). With the latter
we get \( u_c = R^2 A/\mu \) and

$$ \frac{\partial\bar u}{\partial\bar t} = \frac{1}{\bar r}\frac{\partial}{\partial\bar r}
\left(\bar r\frac{\partial\bar u}{\partial\bar r}\right) - \sin (\alpha\bar t),$$

where

$$ \alpha = \frac{R^2\omega}{\nu} = \frac{R^2/\nu}{1/\omega},$$

showing that \( \alpha \) is the ratio of the viscosity time scale and
the pressure oscillation time scale.

<p>
With the pressure time scale we have

$$ u_c = \frac{\varrho A}{\omega},$$

and the scaled PDE becomes

$$ \frac{\partial\bar u}{\partial\bar t} = \alpha^{-1}\frac{1}{\bar r}\frac{\partial}{\partial\bar r}
\left(\bar r\frac{\partial\bar u}{\partial\bar r}\right) - \sin (\bar t)\tp$$

In both cases the scaled boundary conditions become

$$ \frac{\partial\bar u}{\partial\bar t} = 0,\quad
\bar u(1,\bar t) = 0,$$

for \( t\in (0,T/t_c] \), and \( \bar u(\bar r, 0)=0 \) for \( \bar r\in [0,1] \).

<p>
If \( P(t) \) is not sinusoidal but periodic with period \( p \), we have that
\( P \) is a function of \( \omega t \) as above, with \( \omega = 2\pi/p \).
Everything in the scaling remains the same, just the \( \sin \) term changes
to \( P(\alpha\bar t) \) if the time scale is based on viscosity (diffusion),
and \( P(\bar t) \) if the time scale is based on the pressure oscillations.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>pipeflow</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:exer:cable_eq">Exercise 21: Scale the linear cable equation</h2>

<p>
A key PDE in neuroscience is the <a href="https://en.wikipedia.org/wiki/Cable_theory" target="_self">cable equation</a>, here given in its simplest linear form:

$$
\begin{equation}
\tau\frac{\partial u}{\partial t} = \lambda^2\frac{\partial^2 u}{\partial t^2}
-u\tp
\tag{302}
\end{equation}
$$

The unknown \( u \) is the voltage (measured in volt) associated with
an electric current along one-dimensional dendrites (&quot;cables&quot;)
in neural networks, while \( \tau \) and \( \lambda \) are given parameters.

<p>
Scale ref{scale:exer:cable_eq:PDE} in three ways: 1) let all terms in
the scaled equation have unit coefficients, 2) use the domain size
\( L \) as spatial scale and base the time scale on diffusion, 3) use the
domain size \( L \) as spatial scale and base the time scale on
reaction, i.e., the \( -u \) term.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_21_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_21_1">

<p>
Straightforward scaling, with scales \( u_c \), \( t_c \), and \( x_c \),
leads in the first step to

$$ \frac{\partial\bar u}{\partial\bar t} =
\frac{t_c\lambda^2}{\tau x_c^2}\frac{\partial^2\bar u}{\partial\bar t^2}
- \frac{t_c}{\tau}\bar u\tp$$

Assuming that all terms are equally important and of unit size
in the scaled PDE, we get a uniquely determined length and space scale:

$$ t_c = \tau,\quad x_c = \lambda\tp$$

The scaled cable equation is then

$$
\frac{\partial\bar u}{\partial\bar t} =
\frac{\partial^2\bar u}{\partial\bar t^2}
- \bar u\tp
$$

<p>
Let now the spatial scale be fixed as \( x_c=L \).
Basing \( t_c \) on
diffusion means \( t_c = \tau (L/\lambda)^2 \), and the scaled PDE becomes

$$ \frac{\partial\bar u}{\partial\bar t} =
\frac{\partial^2\bar u}{\partial\bar t^2}
- \beta\bar u,$$

where

$$ \beta = \left(\frac{L}{\lambda}\right)^2\tp$$

<p>
Basing
\( t_c \) on the reaction scale, i.e., the
balance of the time derivative and the reaction term, gives
\( t_c=\tau \) and the scaled PDE

$$ \frac{\partial\bar u}{\partial\bar t} =
\beta^{-1}\frac{\partial^2\bar u}{\partial\bar t^2}
- \bar u\tp$$

<p>
In neuroscience applications of the cable equation to dendrites, it
appears that \( \lambda \) is about 1 mm and of the same order of
magnitude as the cable length, so \( \beta \) is around 1 in size.
Then there are not big differences in these scalings, and the first
one is to be preferred. The two others are more suitable when
\( \beta \) is small or large such that the term with \( \beta \) can be
left out of the PDE.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->
Filename: <code>cable_eq</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale::exer:elasticity:vibmodels">Exercise 22: Comparison of vibration models for elastic structures</h2>

<p>
The time scale for displacement in elastic structures is,
according to the section <a href="#scale:elasticity:timedep">The general time-dependent elasticity problem</a>, \( t_c=L\sqrt{\varrho/\mu} \)
if we assume constant density \( \varrho \) and constant shear modulus
\( \mu \) for the structure. The purpose of this exercise is to compare
this time scale with the time scales of related models.

<p>
<b>a)</b>
Longitudinal waves in a bar can be modeled approximately by the PDE

$$ \varrho\frac{\partial^2 u}{\partial t^2} + E\frac{\partial^2 u}{\partial x^2} = 0,$$

where \( u(x,t) \) is the displacement along the bar, and \( E \) is Young's modulus,
related to the shear modulus \( \mu \) through

$$ E = 2\mu (1+\nu),$$

where \( \nu\in (0,0.5] \) is Poisson's ratio.
Find the time scale for the longitudinal waves and compare with the \( t_c \)
for displacements in a three-dimensional body.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_22_1" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_22_1">

<p>
Introducing dimensionless dependent and independent variables the
usual way gives us

$$ \frac{\partial^2 \bar u}{\partial \bar t^2} +
\frac{t_c^2 E}{\varrho L^2}\frac{\partial^2 \bar u}{\partial \bar x^2} = 0,$$

where \( L \) is the length scale, typically the length of the bar.
The natural choice of \( t_c \) is to make the coefficient unity,

$$ t_c = L\sqrt{\frac{\varrho}{E}} = L\sqrt{\frac{\varrho}{\mu}}
\frac{1}{\sqrt{2(1+\nu)}}\approx 0.6 L\sqrt{\frac{\varrho}{\mu}},$$

if we take \( \nu = 0.3 \) as a typical value.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<b>b)</b>
Vertical vibrations of a beam are governed by the PDE

$$ \rho\frac{\partial^2 u}{\partial t^2} + EI\frac{\partial^4 u}{\partial x^4} = 0,$$

where \( u(x,t) \) is the vertical displacement along the beam,
\( \rho \) is the mass per length of the beam,
\( E \) is Young's modulus, and \( I \) is the moment of inertia. For a
rectangular cross section of with \( b \) and height \( h \), \( I=\frac{1}{12}bh^3 \).
Compare the time scale for these vibrations with the time scale \( t_c \)
for three-dimensional elasticity.

<p>
<!-- --- begin solution of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_22_2" style="font-size: 80%;"></a>
<b>Solution.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_22_2">

<p>
The dimensionless equation becomes

$$ \frac{\partial^2 \bar u}{\partial \bar t^2} + \frac{t_c^2EI}{\rho L^4}
\frac{\partial^4 \bar u}{\partial \bar x^4} = 0\tp$$

The natural choice of \( t_c \) is

$$ t_c = L^2\sqrt{\frac{\rho}{EI}} = L\sqrt{\frac{\varrho}{\mu}} L \sqrt{
\frac{12}{2h^2(1+\nu)}} \approx 2\frac{L}{h} L\sqrt{\frac{\varrho}{\mu}},$$

where we have set \( \nu = 0.3 \) and used that \( \rho = \varrho bh \) for
a rectangular cross section. For a beam, \( L\gg h \), so the time scale
for vertical vibrations of a beam is much larger than the time scale
for elastic waves in a three-dimensional body.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end solution of exercise --- -->

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:exer:poroelasticity">Exercise 23: Scale the equations of quasi-static poro-elasticity</h2>

<p>
Flow through a porous elastic medium may induce stress and deformation.
This process is known as poro-elasticity and is governed by the
following equations for a homogeneous medium:

$$
\begin{align}
(\lambda + \mu)\nabla (\nabla\cdot\u) + \mu\nabla^2\u &= -\alpha\nabla p -
\varrho\f,
\tag{303}\\ 
S\frac{\partial p}{\partial t} &= \frac{K}{\mu_f}\nabla^2 p +
\alpha \frac{\partial}{\partial t}\nabla\cdot\u,
\tag{304}
\end{align}
$$

where \( \u(\x,t) \) is the displacement field, \( \lambda \) and \( \mu \) are
Lame's elasticity parameters, \( \alpha\in [0,1] \), \( \f \) is the body
force, here assumed constant (usually gravity, \( \f = -g\kk \),
\( S \) is a so-called storage coefficient, \( p(\x,t) \) is the fluid pressure,
\( K \) is the medium's permeability, \( \mu_f \) is the dynamic viscosity of
the fluid, and \( \varrho \) is the density of the fluid-solid mixture:

$$ \varrho = (1-\phi) \varrho_s + \phi\varrho_f, $$

with \( \varrho_f \) being the density of the fluid, \( \varrho_s \) the density
of the solid, and \( \phi \) the porosity of the elastic medium.
The equations are known as Biot's equations of poro-elasticity and written
here in a quasi-static form where elastic waves are neglected.

<p>
Scale this partial differential equation model, assuming that
\( \lambda \), \( \mu \), \( \alpha \), \( \f \), \( \varrho \), \( \phi \), \( \varrho_s \),
\( \varrho_f \), \( S \), \( \mu_f \), and \( K \) are all constants.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_23_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_23_1">

<p>
The model is very similar to the equations of thermo-elasticity in
the section <a href="#scale:elasticity:thermo">Quasi-static thermo-elasticity</a>.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>poroelasticity</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale::exer:suggest">Exercise 24: Suggestions...</h2>

<p>
Projects:

<ul>
 <li> Poisson problem, membrane, see Nayfeh chapter 1, stationary and time</li>
 <li> diffusion with oscillating \( f(x,t) \),
   oscillating pressure in tube (channel first)</li>
 <li> Helmholtz</li>
 <li> two metal pieces in contact</li>
 <li> boundary layer fluid flow problem, with/without thermal effects</li>
 <li> Vertical motion in the gravity field, two time scales, discuss</li>
 <li> sliding box, see <code>vib</code> exercise</li>
</ul>

<!-- --- end exercise --- -->

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86009.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._.trash82dee82e1274a586571086dca04d00308d3a0d86011.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>


</body>
</html>
    

