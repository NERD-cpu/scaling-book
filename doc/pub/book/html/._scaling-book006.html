<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Scaling of Differential Equations">
<meta name="keywords" content="units,base unit,length,mass,time,dimension of physical quantities,Pi theorem,Buckingham Pi theorem,units US,units British,units conversion,units software,multiple software runs,web interface (Parampool),graphical web interface,scaling,non-dimensionalization,dimensionless variable,exponential decay,dimensionless variable,characteristic time,e-folding time,memoize function,dimensionless number,dimensionless number,dimensionless number,logistic equation,dimensionless number,frequency,frequency, angular,period (of oscillations),radians,angular frequency,quality factor $Q$,phase shift,dimensionless number,Peclet number,dimensionless number,Reynolds number,thermo-elasticity,Navier-Stokes equations,dimensionless number,Reynolds number,Bernoulli's equation,Reynolds number,low Reynolds number flow,Stokes problem,Stokes' flow,Froude number,creeping flow,Strouhal number,vortex shedding,Euler number,Weber number,forced convection,Peclet number,Reynolds number,free convection,Grashof number,Reynolds number,Peclet number,Eckert number,Nusselt number,Biot number,Mach number">

<title>Scaling of Differential Equations</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [(u'Preface', 0, u'ch:preface', u'ch:preface'),
              (u'Dimensions and units',
               0,
               u'scale:dimunit',
               u'scale:dimunit'),
              (u'Fundamental concepts', 1, None, '___sec2'),
              (u'Base units and dimensions', 2, None, '___sec3'),
              (u'Dimensions of common physical quantities',
               2,
               u'scale:dimunit:tables',
               u'scale:dimunit:tables'),
              (u'Prefixes for units', 3, None, '___sec5'),
              (u'The Buckingham Pi theorem',
               2,
               u'scale:dimunit:Pi',
               u'scale:dimunit:Pi'),
              (u'Absolute errors, relative errors, and units',
               2,
               None,
               '___sec7'),
              (u'Units and computers', 2, None, '___sec8'),
              (u'Unit systems', 2, None, '___sec9'),
              (u'Example on challenges arising from unit systems',
               2,
               None,
               '___sec10'),
              (u'PhysicalQuantity: a tool for computing with units',
               2,
               u'scale:PQ',
               u'scale:PQ'),
              (u'Parampool: user interfaces with automatic unit conversion',
               1,
               u'scale:parampool',
               u'scale:parampool'),
              (u'Example application', 3, None, '___sec13'),
              (u'Pool of parameters', 2, None, '___sec14'),
              (u'Fetching pool data for computing', 2, None, '___sec15'),
              (u'Reading command-line options', 2, None, '___sec16'),
              (u'Setting default values in a file', 2, None, '___sec17'),
              (u'Specifying multiple values of input parameters',
               2,
               None,
               '___sec18'),
              (u'Generating a graphical user interface', 2, None, '___sec19'),
              (u'Ordinary differential equation models', 0, None, '___sec20'),
              (u'Exponential decay problems',
               1,
               u'sec:scale:decay',
               u'sec:scale:decay'),
              (u'Fundamental ideas of scaling', 2, None, '___sec22'),
              (u'The basic model problem', 2, None, '___sec23'),
              (u'Example: Population dynamics', 3, None, '___sec24'),
              (u'Example: Decay of pressure with altitude',
               3,
               None,
               '___sec25'),
              (u'The technical steps of the scaling procedure',
               2,
               u'sec:scale:steps',
               u'sec:scale:steps'),
              (u'Step 1: Identify independent and dependent variables',
               3,
               None,
               '___sec27'),
              (u'Step 2: Make independent and dependent variables dimensionless',
               3,
               None,
               '___sec28'),
              (u'Step 3: Derive the model involving only dimensionless variables',
               3,
               None,
               '___sec29'),
              (u'Step 4: Make each term dimensionless', 3, None, '___sec30'),
              (u'Step 5: Estimate the scales', 3, None, '___sec31'),
              (u'Making software for utilizing the scaled model',
               2,
               u'sec:scale:prog',
               u'sec:scale:prog'),
              (u'Software for the original unscaled problem',
               3,
               None,
               '___sec33'),
              (u'Software for the scaled problem', 3, None, '___sec34'),
              (u'Implementation with joblib', 3, None, '___sec35'),
              (u'Scaling a generalized problem',
               2,
               u'sec:scale:body',
               u'sec:scale:body'),
              (u'Exact solution', 3, None, '___sec37'),
              (u'Theory', 3, None, '___sec38'),
              (u'Software', 3, None, '___sec39'),
              (u'Variable coefficients',
               2,
               u'sec:scale:jump',
               u'sec:scale:jump'),
              (u'Scaling a cooling problem with constant temperature in the surroundings',
               2,
               u'scale:cooling:const',
               u'scale:cooling:const'),
              (u'Exact solution', 3, None, '___sec42'),
              (u'Scaling', 3, None, '___sec43'),
              (u'Software', 3, None, '___sec44'),
              (u'Alternative scaling', 3, None, '___sec45'),
              (u'Scaling a cooling problem with time-dependent surroundings',
               2,
               u'scale:cooling:osc',
               u'scale:cooling:osc'),
              (u'Exact solution', 3, None, '___sec47'),
              (u'Scaling', 3, None, '___sec48'),
              (u'Software', 3, None, '___sec49'),
              (u'Discussion of the time scale', 3, None, '___sec50'),
              (u'Scaling a nonlinear ODE',
               2,
               u'sec:scale:nonlinear',
               u'sec:scale:nonlinear'),
              (u'Scaling', 3, None, '___sec52'),
              (u'Alternative scaling', 3, None, '___sec53'),
              (u'SIR ODE system for spreading of diseases',
               2,
               None,
               '___sec54'),
              (u'Scaling', 3, None, '___sec55'),
              (u'Software', 3, None, '___sec56'),
              (u'Alternative scaling', 3, None, '___sec57'),
              (u'SIRV model with finite immunity', 2, None, '___sec58'),
              (u'Michaelis-Menten kinetics for biochemical reactions',
               2,
               u'scale:MMK',
               u'scale:MMK'),
              (u'Classical analysis', 3, None, '___sec60'),
              (u'Dimensionless ODE system', 3, None, '___sec61'),
              (u'Determining scales', 3, None, '___sec62'),
              (u'Conservation equations', 3, None, '___sec63'),
              (u'Analysis of the scaled system', 3, None, '___sec64'),
              (u'Vibration problems', 1, u'sec:scale:vib', u'sec:scale:vib'),
              (u'Undamped vibrations without forcing',
               2,
               u'sec:scale:vib:undamped',
               u'sec:scale:vib:undamped'),
              (u'The first technical steps of scaling', 3, None, '___sec67'),
              (u'The exact solution', 3, None, '___sec68'),
              (u'Discussion of the displacement scale', 3, None, '___sec69'),
              (u'Discussion of the time scale', 3, None, '___sec70'),
              (u'The dimensionless solution', 3, None, '___sec71'),
              (u'Alternative displacement scale', 3, None, '___sec72'),
              (u'About frequency and dimensions', 3, None, '___sec73'),
              (u'Undamped vibrations with constant forcing',
               2,
               u'sec:scale:vib:undamped:mg',
               u'sec:scale:vib:undamped:mg'),
              (u'Undamped vibrations with time-dependent forcing',
               2,
               u'sec:scale:vib:undamped:F',
               u'sec:scale:vib:undamped:F'),
              (u'Investigating scales via analytical solutions',
               3,
               None,
               '___sec76'),
              (u'The displacement and time scales', 3, None, '___sec77'),
              (u'Finding the displacement scale from the differential equation',
               3,
               None,
               '___sec78'),
              (u'Scaling with free vibrations as time scale',
               3,
               None,
               '___sec79'),
              (u'Software', 3, None, '___sec80'),
              (u'Choice of $u_c$ close to resonance', 3, None, '___sec81'),
              (u'Unit size of all terms in the ODE', 3, None, '___sec82'),
              (u'Choice of $u_c$ when $\\psi\\gg\\omega$',
               3,
               None,
               '___sec83'),
              (u'Displacement scale based on $I$', 3, None, '___sec84'),
              (u'Damped vibrations with forcing',
               2,
               u'sec:scale:vib:damped:F',
               u'sec:scale:vib:damped:F'),
              (u'The exact solution', 3, None, '___sec86'),
              (u'Choosing scales', 3, None, '___sec87'),
              (u'Choice of $u_c$ at resonance', 3, None, '___sec88'),
              (u'Choice of $u_c$ when $\\omega\\gg\\psi$',
               3,
               None,
               '___sec89'),
              (u'Choice of $u_c$ when $\\omega\\ll\\psi$',
               3,
               None,
               '___sec90'),
              (u'Software', 3, None, '___sec91'),
              (u'Oscillating electric circuits', 2, None, '___sec92'),
              (u'Basic partial differential equation models',
               0,
               None,
               '___sec93'),
              (u'The wave equation', 1, u'sec:scale:wave', u'sec:scale:wave'),
              (u'Homogeneous Dirichlet conditions in 1D',
               2,
               u'sec:scale:wave:bc_u0',
               u'sec:scale:wave:bc_u0'),
              (u'Implementation of the scaled wave equation',
               2,
               u'sec:scale:wave:impl',
               u'sec:scale:wave:impl'),
              (u'Waves on a string', 3, None, '___sec97'),
              (u'Detecting an already computed case', 3, None, '___sec98'),
              (u'Time-dependent Dirichlet condition',
               2,
               u'scale:wave:pde2',
               u'scale:wave:pde2'),
              (u'Scaling', 3, None, '___sec100'),
              (u'Software', 3, None, '___sec101'),
              (u'Specific case', 3, None, '___sec102'),
              (u'Velocity initial condition',
               2,
               u'scale:wave:pde2:Vcond',
               u'scale:wave:pde2:Vcond'),
              (u'Analytical insight', 3, None, '___sec104'),
              (u'Scaling', 3, None, '___sec105'),
              (u'Nonzero initial shape', 3, None, '___sec106'),
              (u'Variable wave velocity and forcing',
               2,
               u'scale:wave:pde2:cvar',
               u'scale:wave:pde2:cvar'),
              (u'Non-dimensionalization', 3, None, '___sec108'),
              (u'Choosing the time scale', 3, None, '___sec109'),
              (u'Choosing the spatial scale', 3, None, '___sec110'),
              (u'Scaling the velocity initial condition',
               3,
               None,
               '___sec111'),
              (u'Damped wave equation',
               2,
               u'scale:wave:pde2:damped',
               u'scale:wave:pde2:damped'),
              (u'A three-dimensional wave equation problem',
               2,
               None,
               '___sec113'),
              (u'The diffusion equation',
               1,
               u'sec:scale:diffu',
               u'sec:scale:diffu'),
              (u'Homogeneous 1D diffusion equation',
               2,
               u'sec:scale:diffu:homo1D',
               u'sec:scale:diffu:homo1D'),
              (u'Choosing the time scale', 3, None, '___sec116'),
              (u'Analytical insight', 3, None, '___sec117'),
              (u'Choosing other scales', 3, None, '___sec118'),
              (u'Generalized diffusion PDE', 2, None, '___sec119'),
              (u'Jump boundary condition', 2, None, '___sec120'),
              (u'Oscillating Dirichlet condition', 2, None, '___sec121'),
              (u'Scaling issues', 3, None, '___sec122'),
              (u'Exact solution', 3, None, '___sec123'),
              (u'Time and length scales', 3, None, '___sec124'),
              (u'The scaled problem', 3, None, '___sec125'),
              (u'Simulations', 3, None, '___sec126'),
              (u'Reaction-diffusion equations',
               1,
               u'sec:scale:diffu:Fisher',
               u'sec:scale:diffu:Fisher'),
              (u"Fisher's equation", 2, None, '___sec128'),
              (u'Balance of all terms', 3, None, '___sec129'),
              (u'Fixed length scale', 3, None, '___sec130'),
              (u'Nonlinear reaction-diffusion PDE', 2, None, '___sec131'),
              (u'The convection-diffusion equation',
               1,
               u'scale:convdiff',
               u'scale:convdiff'),
              (u'Convection-diffusion without a force term',
               2,
               None,
               '___sec133'),
              (u'Stationary PDE', 2, None, '___sec134'),
              (u'Convection-diffusion with a source term',
               2,
               u'scale:convdiff:f',
               u'scale:convdiff:f'),
              (u'Advanced partial differential equation models',
               0,
               None,
               '___sec136'),
              (u'The equations of linear elasticity',
               1,
               u'scale:elasticity',
               u'scale:elasticity'),
              (u'The general time-dependent elasticity problem',
               2,
               u'scale:elasticity:timedep',
               u'scale:elasticity:timedep'),
              (u'Software', 3, None, '___sec139'),
              (u'Dimensionless stress tensor',
               2,
               u'scale:elasticity:PDE1:stress',
               u'scale:elasticity:PDE1:stress'),
              (u'When can the acceleration term be neglected?',
               2,
               u'scale:elasticity:waves',
               u'scale:elasticity:waves'),
              (u'S waves', 3, None, '___sec142'),
              (u'P waves', 3, None, '___sec143'),
              (u'Time-varying load', 3, None, '___sec144'),
              (u'The stationary elasticity problem',
               2,
               u'scale:elasticity:stationary',
               u'scale:elasticity:stationary'),
              (u'Scaling of the PDE', 3, None, '___sec146'),
              (u'Scaling of displacement boundary conditions',
               3,
               None,
               '___sec147'),
              (u'Scaling of traction boundary conditions',
               3,
               None,
               '___sec148'),
              (u'Quasi-static thermo-elasticity',
               2,
               u'scale:elasticity:thermo',
               u'scale:elasticity:thermo'),
              (u'The Navier-Stokes equations',
               1,
               u'sec:scale:ns',
               u'sec:scale:ns'),
              (u'The momentum equation without body forces',
               2,
               None,
               '___sec151'),
              (u'Scaling', 3, None, '___sec152'),
              (u'Dimensonless PDEs and the Reynolds number',
               3,
               None,
               '___sec153'),
              (u'Scaling of time for low Reynolds numbers',
               2,
               None,
               '___sec154'),
              (u'Shear stress as pressure scale', 2, None, '___sec155'),
              (u'Gravity force and the Froude number', 2, None, '___sec156'),
              (u'Oscillating boundary conditions and the Strouhal number',
               2,
               None,
               '___sec157'),
              (u'Cavitation and the Euler number', 2, None, '___sec158'),
              (u'Free surface conditions and the Weber number',
               2,
               u'freesurface:Weber',
               u'freesurface:Weber'),
              (u'Thermal convection', 1, None, '___sec160'),
              (u'Forced convection', 2, None, '___sec161'),
              (u'Free convection',
               2,
               u'scale:fluid:forced_convection',
               u'scale:fluid:forced_convection'),
              (u'Governing equations', 3, None, '___sec163'),
              (u'Heating by viscous effects', 3, None, '___sec164'),
              (u'Relation between density and temperature',
               3,
               None,
               '___sec165'),
              (u'The Boussinesq approximation', 3, None, '___sec166'),
              (u'Scaling', 3, None, '___sec167'),
              (u'The Grashof, Prandtl, and Eckert numbers',
               2,
               None,
               '___sec168'),
              (u'Interpretations of the Grashof number',
               3,
               None,
               '___sec169'),
              (u'Heat transfer at boundaries and the Nusselt and Biot numbers',
               2,
               None,
               '___sec170'),
              (u'Compressible gas dynamics',
               1,
               u'scale:gasdyn',
               u'scale:gasdyn'),
              (u'The Euler equations of gas dynamics',
               2,
               u'scale:Euler_eqs',
               u'scale:Euler_eqs'),
              (u'General isentropic flow', 2, None, '___sec173'),
              (u'Elimination of the pressure', 3, None, '___sec174'),
              (u'The acoustic approximation for sound waves',
               2,
               u'scale:gas:acoustic',
               u'scale:gas:acoustic'),
              (u'Wave nature of isentropic flow with small perturbations',
               3,
               None,
               '___sec176'),
              (u'Basic scaling for small wave perturbations',
               3,
               None,
               '___sec177'),
              (u'Water surface waves driven by gravity',
               1,
               u'scale:surfacewaves',
               u'scale:surfacewaves'),
              (u'The mathematical model',
               2,
               u'scale:surfacewaves:Eulereq',
               u'scale:surfacewaves:Eulereq'),
              (u'Scaling', 2, None, '___sec180'),
              (u'Waves in deep  water', 2, None, '___sec181'),
              (u'Long waves in shallow water', 2, None, '___sec182'),
              (u'Two-phase porous media flow', 1, None, '___sec183'),
              (u'References', 1, None, '___sec184')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\half}{\frac{1}{2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\x}{\boldsymbol{x}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\w}{\boldsymbol{w}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\stress}{\boldsymbol{\sigma}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\U}{\boldsymbol{U}}
\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\kk}{\boldsymbol{k}}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="scaling-book.html">Scaling of Differential Equations</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._scaling-book001.html#ch:preface" style="font-size: 80%;"><b>Preface</b></a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#scale:dimunit" style="font-size: 80%;"><b>Dimensions and units</b></a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#___sec2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Fundamental concepts</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#___sec3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Base units and dimensions</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#scale:dimunit:tables" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dimensions of common physical quantities</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#___sec5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Prefixes for units</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#scale:dimunit:Pi" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Buckingham Pi theorem</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#___sec7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Absolute errors, relative errors, and units</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#___sec8" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Units and computers</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#___sec9" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unit systems</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#___sec10" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example on challenges arising from unit systems</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#scale:PQ" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PhysicalQuantity: a tool for computing with units</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#scale:parampool" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Parampool: user interfaces with automatic unit conversion</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#___sec13" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example application</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#___sec14" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pool of parameters</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#___sec15" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fetching pool data for computing</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#___sec16" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reading command-line options</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#___sec17" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setting default values in a file</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#___sec18" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specifying multiple values of input parameters</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book004.html#___sec19" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generating a graphical user interface</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec20" style="font-size: 80%;"><b>Ordinary differential equation models</b></a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#sec:scale:decay" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exponential decay problems</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec22" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fundamental ideas of scaling</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec23" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The basic model problem</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec24" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Population dynamics</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec25" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Decay of pressure with altitude</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#sec:scale:steps" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The technical steps of the scaling procedure</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec27" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 1: Identify independent and dependent variables</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 2: Make independent and dependent variables dimensionless</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec29" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 3: Derive the model involving only dimensionless variables</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec30" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 4: Make each term dimensionless</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec31" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Step 5: Estimate the scales</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#sec:scale:prog" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making software for utilizing the scaled model</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec33" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software for the original unscaled problem</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec34" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software for the scaled problem</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec35" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation with joblib</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#sec:scale:body" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling a generalized problem</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec37" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec38" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Theory</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec39" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#sec:scale:jump" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variable coefficients</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#scale:cooling:const" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling a cooling problem with constant temperature in the surroundings</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec42" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec43" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec44" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec45" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative scaling</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#scale:cooling:osc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling a cooling problem with time-dependent surroundings</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec47" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec48" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec49" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec50" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discussion of the time scale</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#sec:scale:nonlinear" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling a nonlinear ODE</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec52" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec53" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative scaling</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec54" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIR ODE system for spreading of diseases</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec55" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec56" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec57" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative scaling</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec58" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIRV model with finite immunity</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#scale:MMK" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Michaelis-Menten kinetics for biochemical reactions</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec60" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Classical analysis</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec61" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dimensionless ODE system</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec62" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Determining scales</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec63" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Conservation equations</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book005.html#___sec64" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analysis of the scaled system</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:vib" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vibration problems</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:vib:undamped" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Undamped vibrations without forcing</a></li>
     <!-- navigation toc: --> <li><a href="#___sec67" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The first technical steps of scaling</a></li>
     <!-- navigation toc: --> <li><a href="#___sec68" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The exact solution</a></li>
     <!-- navigation toc: --> <li><a href="#___sec69" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discussion of the displacement scale</a></li>
     <!-- navigation toc: --> <li><a href="#___sec70" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Discussion of the time scale</a></li>
     <!-- navigation toc: --> <li><a href="#___sec71" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The dimensionless solution</a></li>
     <!-- navigation toc: --> <li><a href="#___sec72" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alternative displacement scale</a></li>
     <!-- navigation toc: --> <li><a href="#___sec73" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;About frequency and dimensions</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:vib:undamped:mg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Undamped vibrations with constant forcing</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:vib:undamped:F" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Undamped vibrations with time-dependent forcing</a></li>
     <!-- navigation toc: --> <li><a href="#___sec76" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Investigating scales via analytical solutions</a></li>
     <!-- navigation toc: --> <li><a href="#___sec77" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The displacement and time scales</a></li>
     <!-- navigation toc: --> <li><a href="#___sec78" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finding the displacement scale from the differential equation</a></li>
     <!-- navigation toc: --> <li><a href="#___sec79" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling with free vibrations as time scale</a></li>
     <!-- navigation toc: --> <li><a href="#___sec80" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="#___sec81" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) close to resonance</a></li>
     <!-- navigation toc: --> <li><a href="#___sec82" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unit size of all terms in the ODE</a></li>
     <!-- navigation toc: --> <li><a href="#___sec83" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) when \( \psi\gg\omega \)</a></li>
     <!-- navigation toc: --> <li><a href="#___sec84" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Displacement scale based on \( I \)</a></li>
     <!-- navigation toc: --> <li><a href="#sec:scale:vib:damped:F" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Damped vibrations with forcing</a></li>
     <!-- navigation toc: --> <li><a href="#___sec86" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The exact solution</a></li>
     <!-- navigation toc: --> <li><a href="#___sec87" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing scales</a></li>
     <!-- navigation toc: --> <li><a href="#___sec88" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) at resonance</a></li>
     <!-- navigation toc: --> <li><a href="#___sec89" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) when \( \omega\gg\psi \)</a></li>
     <!-- navigation toc: --> <li><a href="#___sec90" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choice of \( u_c \) when \( \omega\ll\psi \)</a></li>
     <!-- navigation toc: --> <li><a href="#___sec91" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="#___sec92" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oscillating electric circuits</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#___sec93" style="font-size: 80%;"><b>Basic partial differential equation models</b></a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#sec:scale:wave" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The wave equation</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#sec:scale:wave:bc_u0" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Homogeneous Dirichlet conditions in 1D</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#sec:scale:wave:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation of the scaled wave equation</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#___sec97" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Waves on a string</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#___sec98" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Detecting an already computed case</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#scale:wave:pde2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time-dependent Dirichlet condition</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#___sec100" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#___sec101" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#___sec102" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specific case</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#scale:wave:pde2:Vcond" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Velocity initial condition</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#___sec104" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analytical insight</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#___sec105" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#___sec106" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nonzero initial shape</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#scale:wave:pde2:cvar" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variable wave velocity and forcing</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#___sec108" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Non-dimensionalization</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#___sec109" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing the time scale</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#___sec110" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing the spatial scale</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#___sec111" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling the velocity initial condition</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#scale:wave:pde2:damped" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Damped wave equation</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book007.html#___sec113" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A three-dimensional wave equation problem</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#sec:scale:diffu" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#sec:scale:diffu:homo1D" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Homogeneous 1D diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec116" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing the time scale</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec117" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Analytical insight</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec118" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choosing other scales</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec119" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generalized diffusion PDE</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec120" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jump boundary condition</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec121" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oscillating Dirichlet condition</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec122" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling issues</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec123" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exact solution</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec124" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time and length scales</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec125" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The scaled problem</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec126" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Simulations</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#sec:scale:diffu:Fisher" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Reaction-diffusion equations</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec128" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fisher's equation</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec129" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Balance of all terms</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec130" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fixed length scale</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book008.html#___sec131" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nonlinear reaction-diffusion PDE</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book009.html#scale:convdiff" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The convection-diffusion equation</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book009.html#___sec133" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Convection-diffusion without a force term</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book009.html#___sec134" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stationary PDE</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book009.html#scale:convdiff:f" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Convection-diffusion with a source term</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec136" style="font-size: 80%;"><b>Advanced partial differential equation models</b></a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#scale:elasticity" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The equations of linear elasticity</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#scale:elasticity:timedep" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The general time-dependent elasticity problem</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec139" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Software</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#scale:elasticity:PDE1:stress" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dimensionless stress tensor</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#scale:elasticity:waves" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When can the acceleration term be neglected?</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec142" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S waves</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec143" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P waves</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec144" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time-varying load</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#scale:elasticity:stationary" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The stationary elasticity problem</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec146" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling of the PDE</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec147" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling of displacement boundary conditions</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec148" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling of traction boundary conditions</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#scale:elasticity:thermo" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Quasi-static thermo-elasticity</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#sec:scale:ns" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The Navier-Stokes equations</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec151" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The momentum equation without body forces</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec152" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec153" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dimensonless PDEs and the Reynolds number</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec154" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling of time for low Reynolds numbers</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec155" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shear stress as pressure scale</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec156" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gravity force and the Froude number</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec157" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oscillating boundary conditions and the Strouhal number</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec158" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cavitation and the Euler number</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#freesurface:Weber" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Free surface conditions and the Weber number</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec160" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Thermal convection</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec161" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Forced convection</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#scale:fluid:forced_convection" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Free convection</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec163" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Governing equations</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec164" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Heating by viscous effects</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec165" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relation between density and temperature</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec166" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Boussinesq approximation</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec167" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec168" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Grashof, Prandtl, and Eckert numbers</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec169" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interpretations of the Grashof number</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec170" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Heat transfer at boundaries and the Nusselt and Biot numbers</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#scale:gasdyn" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Compressible gas dynamics</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#scale:Euler_eqs" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Euler equations of gas dynamics</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec173" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;General isentropic flow</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec174" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Elimination of the pressure</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#scale:gas:acoustic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The acoustic approximation for sound waves</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec176" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wave nature of isentropic flow with small perturbations</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec177" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic scaling for small wave perturbations</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#scale:surfacewaves" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Water surface waves driven by gravity</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#scale:surfacewaves:Eulereq" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The mathematical model</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec180" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec181" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Waves in deep  water</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec182" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Long waves in shallow water</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book010.html#___sec183" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Two-phase porous media flow</a></li>
     <!-- navigation toc: --> <li><a href="._scaling-book011.html#___sec184" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;References</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0006"></a>
<!-- !split -->

<h1 id="sec:scale:vib">Vibration problems</h1>

<p>
We shall in this section
address a range of different second-order ODEs for mechanical
vibrations and demonstrate how to reason about the scaling in
different physical scenarios.

<h2 id="sec:scale:vib:undamped">Undamped vibrations without forcing</h2>

<p>
The simplest differential equation model for mechanical vibrations
reads

$$
\begin{equation}
mu'' + ku = 0,\quad u(0)=I,\ u'(0)=V,
\tag{2.64}
\end{equation}
$$

where unknown \( u(t) \) measures the displacement of the body,
This is a common model for a vibrating body  with mass \( m \) attached
to a linear spring with spring constant \( k \) (and force \( -ku \)).
Figure <a href="#sec:scale:vib:undamped:sketch">7</a> shows a typical mechanical
sketch of such a system: some mass can move horizontally without friction
and is connected to a spring that exerts a force \( -ku \) on the body.

<p>
<center> <!-- figure label: --> <div id="sec:scale:vib:undamped:sketch"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 7:  Oscillating body attached to a spring.  <!-- caption label: sec:scale:vib:undamped:sketch --> </p></center>
<p><img src="fig-scaling/oscillator_spring.png" align="bottom" width=500></p>
</center>

<h3 id="___sec67">The first technical steps of scaling </h3>

<p>
The problem <a href="#mjx-eqn-2.64">(2.64)</a> has one independent
variable \( t \) and one dependent variable \( u \). We introduce dimensionless
versions of these variables:

$$ \bar u =\frac{u}{u_c},\quad\bar t = \frac{t}{t_c},$$

where \( u_c \) and \( t_c \) are characteristic values of \( u \) and \( t \).
Inserted in <a href="#mjx-eqn-2.64">(2.64)</a>, we get

$$ m\frac{u_c}{t_c^2}\frac{d^2\bar u}{d\bar t^2} + ku_c\bar u = 0,
\quad u_c\bar u(0)=I,\quad \frac{u_c}{t_c}\frac{d\bar u}{d\bar t}(0)=V,$$

resulting in

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c^2 k}{m}\bar u = 0,
\quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}\tp
\tag{2.65}
\end{equation}
$$

<p>
What is an appropriate displacement scale \( u_c \)? The initial condition
\( u(0)=I \) is a candidate, i.e., \( u_c=I \). But how to choose the time scale?
Making the coefficient in front of the \( \bar u \) unity, such that
both terms balance and are of size unity, is a candidate.

<h3 id="___sec68">The exact solution </h3>

<p>
To better see what the proper scales of \( u \) and \( t \) are, we can look
into the analytical solution of this problem.
Although the exact solution of
<a href="#mjx-eqn-2.64">(2.64)</a> is quite straightforward to calculate
by hand, we take the opportunity to make use of SymPy to
find \( u(t) \). The use of SymPy can later be generalized to vibration
ODEs that are harder to solve by hand.

<p>
SymPy requires all mathematical symbols to be explicitly created:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
u <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;u&#39;</span>, cls<span style="color: #666666">=</span>Function)
w <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;w&#39;</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>, positive<span style="color: #666666">=</span><span style="color: #008000">True</span>)
I, V, C1, C2 <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;I V C1 C2&#39;</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>)
</pre></div>
<p>
To specify the ODE to be solved, we can make a Python function returning
all the terms in the ODE:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># Define differential equation: u&#39;&#39; + w**2*u = 0</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ode</span>(u):
    <span style="color: #008000; font-weight: bold">return</span> diff(u, t, t) <span style="color: #666666">+</span> w<span style="color: #666666">**2*</span>u

diffeq <span style="color: #666666">=</span> ode(u(t))
</pre></div>
<p>
The <code>diffeq</code> variable, defining the ODE, can be passed to the SymPy
function <code>dsolve</code> to find the symbolic solution of the ODE:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">s <span style="color: #666666">=</span> dsolve(diffeq, u(t))
<span style="color: #408080; font-style: italic"># s is an u(t) == expression (Eq obj.), s.rhs grabs the expression</span>
u_sol <span style="color: #666666">=</span> s<span style="color: #666666">.</span>rhs
<span style="color: #008000; font-weight: bold">print</span> u_sol
</pre></div>
<p>
The solution that gets printed is <code>C1*sin(t*w) + C2*cos(t*w)</code>, indicating
that there are two integration constants <code>C1</code> and <code>C2</code> to be determined
by the initial conditions. The result of applying these conditions is
a \( 2\times 2 \) linear system of algebraic equations that SymPy can solve
by the <code>solve</code> function. The code goes as follows:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># The solution u_sol contains integration constants C1 and C2</span>
<span style="color: #408080; font-style: italic"># but these are not symbols, substitute them by symbols</span>
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(<span style="color: #BA2121">&#39;C1&#39;</span>, C1)<span style="color: #666666">.</span>subs(<span style="color: #BA2121">&#39;C2&#39;</span>, C2)

<span style="color: #408080; font-style: italic"># Determine C1 and C2 from the initial conditions</span>
ic <span style="color: #666666">=</span> [u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I, u_sol<span style="color: #666666">.</span>diff(t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V]
<span style="color: #008000; font-weight: bold">print</span> ic   <span style="color: #408080; font-style: italic"># 2x2 algebraic system for C1 and C2</span>
s <span style="color: #666666">=</span> solve(ic, [C1, C2])
<span style="color: #408080; font-style: italic"># s is now a dictionary: {C2: I, C1: V/w}</span>
<span style="color: #408080; font-style: italic"># substitute solution back in u_sol</span>
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(C1, s[C1])<span style="color: #666666">.</span>subs(C2, s[C2])
<span style="color: #008000; font-weight: bold">print</span> u_sol
</pre></div>
<p>
The <code>u_sol</code> variable is now <code>I*cos(t*w) + V*sin(t*w)/w</code>.
Since symbolic software is far from bug-free and can give wrong results,
we should always check the answer. Here, we insert the solution in the ODE
to see if the result is zero, and we insert the solution in the initial
conditions to see that these are fulfilled:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># Check that the solution fulfills the ODE and init.cond.</span>
<span style="color: #008000; font-weight: bold">print</span> simplify(ode(u_sol)),
<span style="color: #008000; font-weight: bold">print</span> u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I, diff(u_sol, t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V
</pre></div>
<p>
There will be many more examples on using SymPy to find exact solutions
of differential equation problems.

<p>
The solution of the ODE in mathematical notation is

$$ u(t) = I\cos(\omega t) + \frac{V}{\omega}\sin(\omega t),\quad \omega = \sqrt{\frac{k}{m}}\tp$$

More insight arises from rewriting such an expression in the form
\( A\cos(wt - \phi) \):

$$ u(t) = \sqrt{I^2 + \frac{V^2}{\omega^2}}\cos(wt - \phi),\quad
\phi = \tan^{-1}(V/(\omega I))\tp
$$

Now we see that the \( u \) corresponds to cosine oscillations with a
frequency shift \( \phi \) and amplitude \( \sqrt{I^2 + (V/\omega)^2} \).

<h3 id="___sec69">Discussion of the displacement scale </h3>

<p>
The amplitude of \( u \) is \( \sqrt{I^2 + V^2/\omega^2} \), and this
expression is obviously a candidate for \( u_c \).  However, the simpler
choice \( u_c=\max (I, V/\omega) \) is also relevant and more attractive
than the square root expression (but potentially a factor 1.4 wrong
compared to the exact amplitude).  It is not very important to have
\( |u|\leq 1 \), the point is to avoid \( |u| \) very small or large.

<h3 id="___sec70">Discussion of the time scale </h3>

<p>
What is an appropriate time scale? Looking at
<a href="#mjx-eqn-2.65">(2.65)</a> and arguing that
\( \bar u'' \) and \( \bar u \) both should be around unity in size, the
coefficient \( t_c^2k/m \) must equal unity, implying that \( t_c=\sqrt{m/k} \).
Also from the analytical solution we see that the solution goes like the
sine or cosine of \( \omega t \), so \( 1/\omega = \sqrt{m/k} \) can be a characteristic
time scale. Likewise, one period of the oscillations, \( P=2\pi/\omega \), can
be the characteristic time, leading to \( t_c=2\pi/\omega \).

<h3 id="___sec71">The dimensionless solution </h3>

<p>
With \( u_c=I \) and \( t_c=\sqrt{m/k} \) we get the scaled model

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \bar u = 0,
\quad \bar u(0)=1,\ \bar u'(0)=\alpha,
\tag{2.66}
\end{equation}
$$

where \( \alpha \) is a dimensionless parameter:

$$ \alpha = \frac{V}{I}\sqrt{\frac{m}{k}}\tp$$

Note that in case \( V=0 \), we have &quot;scaled away&quot; all physical parameters.
The universal solution without physical parameters is then
\( \bar u(\bar t)=\cos\bar t \).

<p>
The unscaled solution is recovered as

$$
\begin{equation}
u(t) = I\bar u(\sqrt{k/m}\bar t)\tp
\tag{2.67}
\end{equation}
$$

This expressions shows that the scaling is simply a matter of
<em>stretching or shrinking the axes</em>.

<h3 id="___sec72">Alternative displacement scale </h3>

<p>
Using \( u_c = V/\omega \), the equation
is not changed, but the initial conditions become

$$ \bar u(0) = \frac{I}{u_c} = \frac{I\omega}{V} =\frac{I}{V}\sqrt{\frac{k}{m}} = \alpha^{-1},\quad \bar u'(0)=1\tp$$

<p>
With \( u_c=V/\omega \) and one period as time scale,
\( t_c=2\pi\sqrt{m/k} \),
we get the alternative model

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + 4\pi^2 \bar u = 0,
\quad \bar u(0)=\alpha^{-1},\ \bar u'(0)=2\pi\tp
\tag{2.68}
\end{equation}
$$

The unscaled solution is in this case recovered by

$$
\begin{equation}
u(t) = V\sqrt{\frac{m}{k}}\bar u(2\pi\sqrt{k/m}\bar t)\tp
\tag{2.69}
\end{equation}
$$

<h3 id="___sec73">About frequency and dimensions </h3>

<p>
The solution goes like \( \cos\omega t \), where \( \omega =\sqrt{m/k} \)
must have dimension 1/s. Actually, \( \omega \) has dimension <em>radians
per second</em>: rad/s. A radian is dimensionless since it is arc (length)
divided by radius (length), but still regarded as a unit.
The period \( P \) of vibrations is a more intuitive quantity than the frequency
\( \omega \). The relation between \( P \) and \( \omega \) is \( P=2\pi/\omega \).
The number of oscillation cycles per period, \( f \), is a more intuitive
measurement of frequency and also known as <em>frequency</em>. Therefore, to be
precise, \( \omega \) should be named <em>angular frequency</em>. The relation between
\( f \) and \( T \) is \( f=1/T \), so \( f=2\pi\omega \) and measured in Hz (1/s), which is
the unit for counts per unit time.

<h2 id="sec:scale:vib:undamped:mg">Undamped vibrations with constant forcing</h2>

<p>
For vertical vibrations in the gravity field, the model
<a href="#mjx-eqn-2.64">(2.64)</a> must also take the gravity force
\( -mg \) into account:

$$ mu'' + ku = -mg\tp$$

How does the new term \( -mg \) influence
the scaling? We observe that if there is no movement of the body,
\( u''=0 \), and the spring elongation matches the gravity force:
\( ku = -mg \), leading to a steady displacement \( u=-mg/k \). We can then
have oscillations around this equilibrium point. A natural scaling
for \( u \) is therefore

$$ \bar u = \frac{u - (-mg/k)}{u_c}=\frac{uk + mg}{ku_c}\tp$$

<!-- u = - mg/k + u_c\bar u -->
The scaled differential equation with the same time scale as before
reads

$$ \frac{d^2\bar u}{d\bar t^2} + \bar u - \frac{t_c^2}{u_c}g
= -\frac{t_c^2}{u_c}g,$$

leading to

$$ \frac{d^2\bar u}{d\bar t^2} + \bar u = 0\tp$$

The initial conditions \( u(0)=I \) and \( u'(0)=V \) become, with \( u_c=I \),

$$ \bar u(0) = 1 + \frac{mg}{kI},\quad \frac{d\bar u}{d\bar t}(0)=\sqrt{\frac{m}{k}}\frac{V}{I}\tp$$

We see that the oscillations around the equilibrium point in the
gravity field are identical to the horizontal oscillations without
gravity, except for an offset \( mg/(kI) \) in the displacement.

<h2 id="sec:scale:vib:undamped:F">Undamped vibrations with time-dependent forcing</h2>

<p>
Now we add a transient forcing term \( F(t) \) to the model
<a href="#mjx-eqn-2.64">(2.64)</a>:

$$
\begin{equation}
mu'' + ku = F(t),\quad u(0)=I,\ u'(0)=V\tp
\tag{2.70}
\end{equation}
$$

Take the forcing to be oscillating:

$$ F(t) = A\cos(\psi t)\tp$$

The technical steps of the scaling are still the same, with the
intermediate result

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c^2 k}{m}\bar u =
\frac{t_c^2}{mu_c}A\cos(\psi t_c\bar t),
\quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}\tp
\tag{2.71}
\end{equation}
$$

What are typical displacement and time scales? This is not so obvious
without knowing the details of the solution, because there are
three parameters (\( I \), \( V \), and \( A \)) that influence the magnitude of \( u \).
Moreover, there are two time scales, one for the free vibrations of
the systems and one for the forced vibrations \( F(t) \).

<h3 id="___sec76">Investigating scales via analytical solutions </h3>

<p>
As we have seen already several times, having access to
an exact solution is very fortunate as it allows us to directly
examine the scales. Also in the present problem it is possible
to derive an exact solution. We
continue the SymPy session from the previous section and perform much
of the same steps. Note that we use <code>w</code> for \( \omega = \sqrt{k/m} \)
in the computer code (to obtain a more direct visual counterpart to
\( \omega \)).
SymPy may get confused when coefficients in differential equations
contain several symbols. We therefore rewrite the equation with
at most one symbol in each coefficient (i.e., symbolic software is
in general
more successful when applied to scaled differential equations than the
unscaled counterparts, but right now our task is to solve the unscaled version).
The amplitude \( A/m \) in the forcing term is of this reason
replaced by the symbol <code>A1</code>.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">A, A1, m, psi <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;A A1 m psi&#39;</span>, positive<span style="color: #666666">=</span><span style="color: #008000">True</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>)
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ode</span>(u):
    <span style="color: #008000; font-weight: bold">return</span> diff(u, t, t) <span style="color: #666666">+</span> w<span style="color: #666666">**2*</span>u <span style="color: #666666">-</span> A1<span style="color: #666666">*</span>cos(psi<span style="color: #666666">*</span>t)

diffeq <span style="color: #666666">=</span> ode(u(t))
u_sol <span style="color: #666666">=</span> dsolve(diffeq, u(t))
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>rhs

<span style="color: #408080; font-style: italic"># Determine the constants C1 and C2 in u_sol</span>
<span style="color: #408080; font-style: italic"># (first substitute our own declared C1 and C2 symbols,</span>
<span style="color: #408080; font-style: italic"># then use the initial conditions)</span>
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(<span style="color: #BA2121">&#39;C1&#39;</span>, C1)<span style="color: #666666">.</span>subs(<span style="color: #BA2121">&#39;C2&#39;</span>, C2)
eqs <span style="color: #666666">=</span> [u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I, u_sol<span style="color: #666666">.</span>diff(t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V]
s <span style="color: #666666">=</span> solve(eqs, [C1, C2])
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(C1, s[C1])<span style="color: #666666">.</span>subs(C2, s[C2])

<span style="color: #408080; font-style: italic"># Check that the solution fulfills the equation and init.cond.</span>
<span style="color: #008000; font-weight: bold">print</span> simplify(ode(u_sol))
<span style="color: #008000; font-weight: bold">print</span> simplify(u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I)
<span style="color: #008000; font-weight: bold">print</span> simplify(diff(u_sol, t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V)

u_sol <span style="color: #666666">=</span> simplify(expand(u_sol<span style="color: #666666">.</span>subs(A1, A<span style="color: #666666">/</span>m)))
<span style="color: #008000; font-weight: bold">print</span> u_sol
</pre></div>
<p>
The output from the last line is

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">A/m*cos(psi*t)/(-psi**2 + w**2) + V*sin(t*w)/w +
(A/m + I*psi**2 - I*w**2)*cos(t*w)/(psi**2 - w**2)
</pre></div>
<p>
With a bit of rewrite this expression becomes

<p>
<!-- Note that the solution becomes a bit simpler of F is cos rather than sin -->

$$ u(t) = \frac{A/m}{\omega^2 - \psi^2}\cos(\psi t) + \frac{V}{\omega}
   \sin(\omega t) +
\left(\frac{A/m}{\psi^2 - \omega^2} + I\right) \cos (\omega t)\tp
$$

Obviously, this expression is only meaningful for \( \psi\neq\omega \). The
case \( \psi = \omega \) gives an infinite amplitude in this model, a
phenomenon known as resonance. The amplitude becomes finite when
damping is included,
see the section <a href="#sec:scale:vib:damped:F">Damped vibrations with forcing</a>.

<p>
When the system starts from rest, \( I=V=0 \), and the
forcing is the only driving mechanism, we can simplify:

$$
\begin{align*}
u(t) &= \frac{A}{m(\omega^2 - \psi^2)}\cos(\psi t)
+
\frac{A}{m(\psi^2 - \omega^2)}\cos (\omega t)\\ 
&= \frac{A}{m(\omega^2 - \psi^2)}(\cos(\psi t) - \cos(\omega t))\tp
\end{align*}
$$

To gain more insight, \( \cos(\psi t) - \cos(\omega t) \) can be
rewritten in terms of the mean frequency \( (\psi + \omega)/2 \) and
the difference in frequency \( (\psi - \omega)/2 \):

$$
\begin{equation}
u(t) = \frac{A}{m(\omega^2 - \psi^2)} 2
\sin\left(\frac{\psi - \omega}{2}t\right)
\sin\left(\frac{\psi + \omega}{2}t\right),
\tag{2.72}
\end{equation}
$$

showing that there is a signal with frequency \( (\psi + \omega)/2 \)
whose amplitude has a (much) slower frequency
\( (\psi - \omega)/2 \). Figure <a href="#sec:scale:vib:fig:envelope">8</a> shows
an example on such a signal.

<p>
<center> <!-- figure label: --> <div id="sec:scale:vib:fig:envelope"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 8:  Signal with frequency 3.1 and envelope frequency 0.2.  <!-- caption label: sec:scale:vib:fig:envelope --> </p></center>
<p><img src="fig-scaling/envelope.png" align="bottom" width=600></p>
</center>

<h3 id="___sec77">The displacement and time scales </h3>

<p>
A characteristic displacement can in the latter special case
be taken as \( u_c= A/(m(\omega^2 - \psi^2)) \). This is also a relevant choice
in the more general case \( I\neq0, V\neq 0 \), unless \( I \) or \( V \)
is so large that it dominates over the amplitude
caused by the forcing. With \( u_c= A/(m(\omega^2 - \psi^2)) \) we also
have three special cases: \( \omega \ll \psi \), \( \omega \gg\psi \), and
\( \psi \sim \omega \). In the latter case we need
\( u_c= A/(m(\omega^2 - \psi^2)) \) if we want \( |u|\leq 1 \). When
\( \omega \) and \( \psi \) are significantly different, we may choose one
of them and neglect the smaller. Choosing \( \omega \) means \( u_c=A/k \),
which is the relevant scale
if \( \omega\gg\psi \). In the opposite case, \( \omega\ll\psi \),
\( u_c=A/(m\psi^2) \).

<p>
The time scale is dominated by the fastest oscillations, which are
of frequency \( \psi \) or \( \omega \) when these are close and the largest
of them when they are distant. In any case, we set
\( t_c=1/\max(\psi,\omega) \).

<h3 id="___sec78">Finding the displacement scale from the differential equation </h3>

<p>
Going back to <a href="#mjx-eqn-2.71">(2.71)</a>, we
may demand that all the three terms in the differential equation
are of size unity. This leads to \( t_c=\sqrt{m/k} \)
and \( u_c=At_c^2/m = A/k \). The formula for \( u_c \) is a kind of measure
of the ratio of the
forcing and the spring force (the dimensionless number
\( A/(ku_c) \) would be this ratio).

<p>
Looking at <a href="#mjx-eqn-2.72">(2.72)</a>, we see
that if \( \psi\ll\omega \), the amplitude can be approximated
by \( A/(m\omega^2)=A/k \), showing that the scale \( u_c=A/k \) is
relevant for an excitation frequency \( \psi \) that is small compared to
the free vibration frequency \( \omega \).

<h3 id="___sec79">Scaling with free vibrations as time scale </h3>

<p>
The next step is to work out the dimensionless ODE for the chosen scales.
We first select the time scale based on the free oscillations
with frequency \( \omega \), i.e., \( t_c=1/\omega \). Inserting the expression in
<a href="#mjx-eqn-2.71">(2.71)</a> results in

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \bar u =
\gamma
\cos(\delta\bar t),
\quad \bar u(0)=\alpha,\ \bar u'(0)=\beta\tp
\tag{2.73}
\end{equation}
$$

Here we have four dimensionless variables

$$
\begin{align}
\alpha &= \frac{I}{u_c},
\tag{2.74}\\ 
\beta  &= \frac{Vt_c}{u_c} = \frac{V}{\omega u_c},
\tag{2.75}\\ 
\gamma &= \frac{t_c^2 A}{mu_c} = \frac{A}{ku_c},
\tag{2.76}\\ 
\delta &= \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega}\tp
\tag{2.77}
\end{align}
$$

We remark that the choice of \( u_c \) has so far not been made. Several
different cases will be considered below, and we will see that certain
choices reduce the number of independent dimensionless variables to
three.

<p>
The four dimensionless variables above have interpretations as ratios of
physical effects:

<ul>
 <li> \( \alpha \): ratio of the initial displacement and
   the characteristic response \( u_c \),</li>
 <li> \( \beta \): ratio of the initial velocity
   and the typical velocity measure \( u_c/t_c \),</li>
 <li> \( \gamma \): ratio of
   the forcing \( A \) and the mass times acceleration \( mu_c/t_c^2 \) <em>or</em>
   the ratio of the forcing and the spring force \( ku_c \)</li>
 <li> \( \delta \): ratio of the
   frequencies or the time scales of the forcing and the free vibrations.</li>
</ul>

<h3 id="___sec80">Software </h3>

<p>
Any solver for <a href="#mjx-eqn-2.71">(2.71)</a>
can be used for <a href="#mjx-eqn-2.73">(2.73)</a>.
More details are provided at the end of
the section <a href="#sec:scale:vib:damped:F">Damped vibrations with forcing</a>.

<h3 id="___sec81">Choice of \( u_c \) close to resonance </h3>

<p>
Now we shall discuss various choices of \( u_c \).
Close to resonance, when \( \psi\sim\omega \), we may set
\( u_c=A/(m(\omega^2 - \psi^2)) \). The dimensionless numbers
become in this case

$$
\begin{align*}
\alpha &= \frac{I}{u_c} = \frac{I}{A/k}(1-\delta^2),\\ 
\beta  &= \frac{V}{\omega u_c} = \frac{V\sqrt{km}}{A}(1-\delta^2),\\ 
\gamma &= \frac{A}{ku_c} = 1-\delta^2,\\ 
\delta &= \frac{\psi}{\omega}\tp
\end{align*}
$$

With \( \psi = 0.99\omega \), \( \delta =0.99 \), \( V=0 \),
\( \alpha = \gamma = 1-\delta^2 = 0.02 \), we have the problem

$$
\frac{d^2\bar u}{d\bar t^2} + \bar u =
0.02 \cos(0.99\bar t),
\quad \bar u(0)=0.02,\ \bar u'(0)=0\tp
$$

This is a problem with a very small initial condition and a very small
forcing, but the state close to resonance brings the amplitude up to
about unity, see the result of numerical simulations with \( \delta=0.99 \) in
Figure <a href="#sec:scale:vib:fig:Fcos_b0:1">9</a>.
Neglecting \( \alpha \),
the solution is given by <a href="#mjx-eqn-2.72">(2.72)</a>,
which here means \( A=1-\delta^2 \), \( m=1 \), \( \omega=1 \), \( \psi=\delta \):

$$ \bar u(\bar t) = 2\sin(-0.005\bar t)\sin(0.995\bar t)\tp $$

Note that this is a problem which demands very high accuracy in the
numerical calculations. Using 20 time steps per period gives a
significant angular frequency error and an amplitude of about 1.4. We used
160 steps per period for the results in
Figure <a href="#sec:scale:vib:fig:Fcos_b0:1">9</a>.

<p>
<center> <!-- figure label: --> <div id="sec:scale:vib:fig:Fcos_b0:1"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 9:  Forced undamped vibrations close to resonance.  <!-- caption label: sec:scale:vib:fig:Fcos_b0:1 --> </p></center>
<p><img src="fig-scaling/vib_delta099_b0_Fcos.png" align="bottom" width=600></p>
</center>

<h3 id="___sec82">Unit size of all terms in the ODE </h3>

<p>
Using the displacement scale \( u_c=A/k \) leads to
<a href="#mjx-eqn-2.73">(2.73)</a> with

$$
\begin{align*}
\alpha &= \frac{I}{u_c} = \frac{I}{A/k},\\ 
\beta  &= \frac{V}{\omega u_c} = \frac{V k}{A\omega},\\ 
\gamma &= \frac{A}{ku_c} = 1,\\ 
\delta &= \frac{\psi}{\omega}\tp
\end{align*}
$$

Simulating a case with \( \delta=0.5 \), \( \alpha=1 \), and \( \beta=0 \) gives
the oscillations in Figure <a href="#sec:scale:vib:fig:Fcos_b0:2">10</a>, which is
a case away from resonance, and the amplitude is about unity. However,
choosing \( \delta =0.99 \) (close to resonance) results in a figure
similar to Figure <a href="#sec:scale:vib:fig:Fcos_b0:1">9</a>, except that the
amplitude is about \( 10^2 \) because of the moderate size of \( u_c \).
The present scaling is therefore most suitable away from resonance,
and when the terms containing \( \cos\omega t \) and \( \sin\omega t \)
are important (e.g., \( \omega\gg\psi \)).

<p>
<center> <!-- figure label: --> <div id="sec:scale:vib:fig:Fcos_b0:2"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 10:  Forced undamped vibrations away from resonance.  <!-- caption label: sec:scale:vib:fig:Fcos_b0:2 --> </p></center>
<p><img src="fig-scaling/vib_delta05_b0_Fcos.png" align="bottom" width=600></p>
</center>

<h3 id="___sec83">Choice of \( u_c \) when \( \psi\gg\omega \) </h3>

<p>
Finally, we may look at the case where \( \psi\gg\omega \) such that
\( u_c=A/(m\psi^2) \) is a relevant scale (i.e., omitting \( \omega^2 \) compared to
\( \psi^2 \) in the denominator), but in this case we should
use \( t_c=1/\psi \) since the force varies much faster than the
free vibrations of the system.
This choice of \( t_c \) changes the scaled ODE to

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \delta^{-2}\bar u =
\gamma
\cos(\bar t),
\quad \bar u(0)=\alpha,\ \bar u'(0)=\beta,
\tag{2.78}
\end{equation}
$$

where

$$
\begin{align*}
\alpha &= \frac{I}{u_c} = \frac{I}{A/k}\delta^2,\\ 
\beta  &= \frac{Vt_c}{u_c} = \frac{V\sqrt{km}}{A}\delta,\\ 
\gamma &= \frac{t_c^2 A}{mu_c} = 1,\\ 
\delta &= \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega}\tp
\end{align*}
$$

In the regime \( \psi\gg\omega \), \( \delta\gg 1 \), thus making \( \alpha \) and
\( \beta \) large.
However, if \( \alpha \) and/or \( \beta \) is large,
the initial condition dominates over the forcing, and will also dominate
the amplitude of \( u \), thereby making the scaling of \( u \) inappropriate.
In case \( I=V=0 \) so that \( \alpha=\beta=0 \),
<a href="#mjx-eqn-2.72">(2.72)</a> predicts
(\( A=m=1 \), \( \omega=\delta^{-1} \), \( \psi=1 \))

$$ \bar u(\bar t) = (\delta^{-2}-1)^{-1}2
\sin\left(\frac{1}{2}(1 -\delta^{-1})\bar t\right)
\sin\left(\frac{1}{2}(1 +\delta^{-1})\bar t\right),
$$

which has an amplitude about \( 2 \) for \( \delta\gg 1 \).
Figure <a href="#sec:scale:vib:fig:Fcos_b0:3">11</a> shows a case.

<p>
<center> <!-- figure label: --> <div id="sec:scale:vib:fig:Fcos_b0:3"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 11:  Forced undamped vibrations with rapid forcing.  <!-- caption label: sec:scale:vib:fig:Fcos_b0:3 --> </p></center>
<p><img src="fig-scaling/vib_delta10_b0_Fcos.png" align="bottom" width=600></p>
</center>

<p>
With \( \alpha=0.05\delta^2=5 \), we get a significant contribution from
the free vibrations (the homogeneous solution of the ODE) as
shown in Figure <a href="#sec:scale:vib:fig:Fcos_b0:4">12</a>. For larger \( \alpha \)
values, one must base \( u_c \) on \( I \) instead.
(The graphs in Figure <a href="#sec:scale:vib:fig:Fcos_b0:3">11</a> and
<a href="#sec:scale:vib:fig:Fcos_b0:4">12</a> were
produced by
numerical simulations with 160 time steps per period of the forcing.)

<p>
<center> <!-- figure label: --> <div id="sec:scale:vib:fig:Fcos_b0:4"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 12:  Forced undamped vibrations with rapid forcing and initial displacement of 5.  <!-- caption label: sec:scale:vib:fig:Fcos_b0:4 --> </p></center>
<p><img src="fig-scaling/vib_delta10_b0_a5_Fcos.png" align="bottom" width=600></p>
</center>

<h3 id="___sec84">Displacement scale based on \( I \) </h3>

<p>
Choosing \( u_c=I \) gives

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \bar u =
\gamma\cos(\delta\bar t),
\quad \bar u(0)=1,\ \bar u'(0)=\beta,
\tag{2.79}
\end{equation}
$$

with

$$
\begin{align}
\beta  &= \frac{Vt_c}{u_c} = \frac{V}{I}\sqrt{\frac{m}{k}},
\tag{2.80}\\ 
\gamma & = \frac{tc^2A}{mu_c} = \frac{A}{ku_c} = \frac{A}{kI} \tp
\tag{2.81}
\end{align}
$$

This scaling is not relevant close to resonance since then \( u_c\gg I \).

<h2 id="sec:scale:vib:damped:F">Damped vibrations with forcing</h2>

<p>
We now introduce a linear damping force \( bu'(t) \) in the equation of motion:

$$
\begin{equation}
mu'' + bu' + ku = A\cos(\psi t),\quad u(0)=I,\ u'(0)=V\tp
\tag{2.82}
\end{equation}
$$

Figure <a href="#sec:scale:vib:damped:sketch">13</a> shows a typical
one-degree-of-freedom mechanical system with a linear dashpot, representing
the damper (\( bu' \)), a linear spring (\( ku \)), and an external force (\( F \)).

<p>
<center> <!-- figure label: --> <div id="sec:scale:vib:damped:sketch"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 13:  Oscillating body with external force, attached to a spring and damper.  <!-- caption label: sec:scale:vib:damped:sketch --> </p></center>
<p><img src="fig-scaling/oscillator.png" align="bottom" width=500></p>
</center>

<p>
The standard scaling procedure results in

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c b}{m}\frac{d\bar u}{d\bar t}
+ \frac{t_c^2 k}{m}\bar u =
\frac{t_c^2}{mu_c}A\cos(\psi t_c\bar t),
\quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}\tp
\tag{2.83}
\end{equation}
$$

<h3 id="___sec86">The exact solution </h3>

<p>
As always, it is
a great advantage to look into exact solutions for controlling our
choice of scales.
Using SymPy to solve <a href="#mjx-eqn-2.82">(2.82)</a> is, in principle,
very straightforward:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> diffeq <span style="color: #666666">=</span> diff(u(t), t, t) <span style="color: #666666">+</span> b<span style="color: #666666">/</span>m<span style="color: #666666">*</span>diff(u(t), t) <span style="color: #666666">+</span> w<span style="color: #666666">**2*</span>u(t)
<span style="color: #666666">&gt;&gt;&gt;</span> s <span style="color: #666666">=</span> dsolve(diffeq, u(t))
<span style="color: #666666">&gt;&gt;&gt;</span> s<span style="color: #666666">.</span>rhs
C1<span style="color: #666666">*</span>exp(t<span style="color: #666666">*</span>(<span style="color: #666666">-</span>b <span style="color: #666666">-</span> sqrt(b <span style="color: #666666">-</span> <span style="color: #666666">2*</span>m<span style="color: #666666">*</span>w)<span style="color: #666666">*</span>sqrt(b <span style="color: #666666">+</span> <span style="color: #666666">2*</span>m<span style="color: #666666">*</span>w))<span style="color: #666666">/</span>(<span style="color: #666666">2*</span>m)) <span style="color: #666666">+</span>
C2<span style="color: #666666">*</span>exp(t<span style="color: #666666">*</span>(<span style="color: #666666">-</span>b <span style="color: #666666">+</span> sqrt(b <span style="color: #666666">-</span> <span style="color: #666666">2*</span>m<span style="color: #666666">*</span>w)<span style="color: #666666">*</span>sqrt(b <span style="color: #666666">+</span> <span style="color: #666666">2*</span>m<span style="color: #666666">*</span>w))<span style="color: #666666">/</span>(<span style="color: #666666">2*</span>m))
</pre></div>
<p>
This is indeed the correct solution, but it is on a complex
exponential function form, valid for all \( b \), \( m \), and \( \omega \). We are
interested in the case with <em>small damping</em>, \( b < 2m\omega \), where the solution
is an exponentially damped sinusoidal function. Rewriting the expression
in the right form is tricky with SymPy commands. Instead, we demonstrate
a common technique when doing symbolic computing: general procedures like
<code>dsolve</code> are replaced by manual steps. That is, we solve the ODE &quot;by hand&quot;,
but use SymPy to assist the calculations.

<p>
The solution is composed of a homogeneous
solution \( u_h \) of \( mu'' + bu' + ku=0 \) and one particular solution \( u_p \)
of the nonhomogeneous equation
\( mu'' + bu' + ku=A\cos(\psi t) \). The homogeneous solution with
damped oscillations (requiring \( b < 2\sqrt{mk} \)) can be
found by the following code. We have divided the differential equation
by \( m \) and introduced \( B=\frac{1}{2}b/m \) and let <code>A1</code> represent
\( A/m \) to simplify expressions and
help SymPy with less symbols in the equation. Without these simplifications,
SymPy stalls in the computations due to too many symbols in the equation.
The problem is actually a solid argument for scaling differential equations
before asking SymPy to solve them since scaling effectively reduces the
number of parameters in the equations!

<p>
The following SymPy steps derives the solution of the homogeneous ODE:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">u <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;u&#39;</span>, cls<span style="color: #666666">=</span>Function)
t, w, B, A, A1, m, psi <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;t w B A A1 m psi&#39;</span>,
                                 positive<span style="color: #666666">=</span><span style="color: #008000">True</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ode</span>(u, homogeneous<span style="color: #666666">=</span><span style="color: #008000">True</span>):
    h <span style="color: #666666">=</span> diff(u, t, t) <span style="color: #666666">+</span> <span style="color: #666666">2*</span>B<span style="color: #666666">*</span>diff(u, t) <span style="color: #666666">+</span> w<span style="color: #666666">**2*</span>u
    f <span style="color: #666666">=</span> A1<span style="color: #666666">*</span>cos(psi<span style="color: #666666">*</span>t)
    <span style="color: #008000; font-weight: bold">return</span> h <span style="color: #008000; font-weight: bold">if</span> homogeneous <span style="color: #008000; font-weight: bold">else</span> h <span style="color: #666666">-</span> f

<span style="color: #408080; font-style: italic"># Find coefficients in polynomial (in r) for exp(r*t) ansatz</span>
r <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;r&#39;</span>)
ansatz <span style="color: #666666">=</span> exp(r<span style="color: #666666">*</span>t)
poly <span style="color: #666666">=</span> simplify(ode(ansatz)<span style="color: #666666">/</span>ansatz)

<span style="color: #408080; font-style: italic"># Convert to polynomial to extract coefficients</span>
poly <span style="color: #666666">=</span> Poly(poly, r)
<span style="color: #408080; font-style: italic"># Extract coefficients in poly: a_*t**2 + b_*t + c_</span>
a_, b_, c_ <span style="color: #666666">=</span> poly<span style="color: #666666">.</span>coeffs()
<span style="color: #408080; font-style: italic"># Assume b_**2 - 4*a_*c_ &lt; 0</span>
d <span style="color: #666666">=</span> <span style="color: #666666">-</span>b_<span style="color: #666666">/</span>(<span style="color: #666666">2*</span>a_)
<span style="color: #008000; font-weight: bold">if</span> a_ <span style="color: #666666">==</span> <span style="color: #666666">1</span>:
    omega <span style="color: #666666">=</span> sqrt(c_ <span style="color: #666666">-</span> (b_<span style="color: #666666">/2</span>)<span style="color: #666666">**2</span>)  <span style="color: #408080; font-style: italic"># nicer formula</span>
<span style="color: #008000; font-weight: bold">else</span>:
    omega <span style="color: #666666">=</span> sqrt(<span style="color: #666666">4*</span>a_<span style="color: #666666">*</span>c_ <span style="color: #666666">-</span> b_<span style="color: #666666">**2</span>)<span style="color: #666666">/</span>(<span style="color: #666666">2*</span>a_)

<span style="color: #408080; font-style: italic"># The homogeneous solution is a linear combination of a</span>
<span style="color: #408080; font-style: italic"># cos term (u1) and a sin term (u2)</span>
u1 <span style="color: #666666">=</span> exp(d<span style="color: #666666">*</span>t)<span style="color: #666666">*</span>cos(omega<span style="color: #666666">*</span>t)
u2 <span style="color: #666666">=</span> exp(d<span style="color: #666666">*</span>t)<span style="color: #666666">*</span>sin(omega<span style="color: #666666">*</span>t)
C1, C2, V, I <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;C1 C2 V I&#39;</span>, real<span style="color: #666666">=</span><span style="color: #008000">True</span>)
u_h <span style="color: #666666">=</span> simplify(C1<span style="color: #666666">*</span>u1 <span style="color: #666666">+</span> C2<span style="color: #666666">*</span>u2)
<span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;u_h:&#39;</span>, u_h
</pre></div>
<p>
The print out shows

$$ u_h = e^{-Bt}\left(C_1 \cos(\sqrt{\omega^2 - B^2}t) +
C_2 \sin(\sqrt{\omega^2 - B^2}t)\right),$$

where \( C_1 \) and \( C_2 \) must be determined by the initial conditions later.
It is wise to check that \( u_h \) is indeed a solution of the homogeneous
differential equation:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">assert</span> simplify(ode(u_h)) <span style="color: #666666">==</span> <span style="color: #666666">0</span>
</pre></div>
<p>
We have previously just printed the residuals of the ODE and initial
conditions after inserting the solution, but it is better in a code to
let the programming language test that the residuals are symbolically zero.
This is achieved using the <code>assert</code> statement in Python. The argument is
a boolean expression, and if the expression evaluates to <code>False</code>,
an <code>AssertionError</code> is raised and the program aborts (otherwise <code>assert</code>
runs silently for a <code>True</code> boolean expression). Hereafter, we will use
<code>assert</code> for consistency checks in computer code.

<p>
The ansatz for the particular solution \( u_p \) is

$$ u_p= C_3\cos(\psi t) + C_4\sin(\psi t),$$

which inserted in the ODE gives two equations
for \( C_3 \) and \( C_4 \). The relevant SymPy statements are

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># Particular solution</span>
C3, C4 <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;C3 C4&#39;</span>)
u_p <span style="color: #666666">=</span> C3<span style="color: #666666">*</span>cos(psi<span style="color: #666666">*</span>t) <span style="color: #666666">+</span> C4<span style="color: #666666">*</span>sin(psi<span style="color: #666666">*</span>t)
eqs <span style="color: #666666">=</span> simplify(ode(u_p, homogeneous<span style="color: #666666">=</span><span style="color: #008000">False</span>))

<span style="color: #408080; font-style: italic"># Collect cos(omega*t) terms</span>
<span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;eqs:&#39;</span>, eqs
eq_cos <span style="color: #666666">=</span> simplify(eqs<span style="color: #666666">.</span>subs(sin(psi<span style="color: #666666">*</span>t), <span style="color: #666666">0</span>)<span style="color: #666666">.</span>subs(cos(psi<span style="color: #666666">*</span>t), <span style="color: #666666">1</span>))
eq_sin <span style="color: #666666">=</span> simplify(eqs<span style="color: #666666">.</span>subs(cos(psi<span style="color: #666666">*</span>t), <span style="color: #666666">0</span>)<span style="color: #666666">.</span>subs(sin(psi<span style="color: #666666">*</span>t), <span style="color: #666666">1</span>))
s <span style="color: #666666">=</span> solve([eq_cos, eq_sin], [C3, C4])
u_p <span style="color: #666666">=</span> simplify(u_p<span style="color: #666666">.</span>subs(C3, s[C3])<span style="color: #666666">.</span>subs(C4, s[C4]))

<span style="color: #408080; font-style: italic"># Check that the solution is correct</span>
<span style="color: #008000; font-weight: bold">assert</span> simplify(ode(u_p, homogeneous<span style="color: #666666">=</span><span style="color: #008000">False</span>)) <span style="color: #666666">==</span> <span style="color: #666666">0</span>
</pre></div>
<p>
Using the initial conditions for the complete solution \( u=u_h+u_p \)
determines \( C_1 \) and \( C_2 \):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">u_sol <span style="color: #666666">=</span> u_h <span style="color: #666666">+</span> u_p  <span style="color: #408080; font-style: italic"># total solution</span>
<span style="color: #408080; font-style: italic"># Initial conditions</span>
eqs <span style="color: #666666">=</span> [u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I, u_sol<span style="color: #666666">.</span>diff(t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V]
<span style="color: #408080; font-style: italic"># Determine C1 and C2 from the initial conditions</span>
s <span style="color: #666666">=</span> solve(eqs, [C1, C2])
u_sol <span style="color: #666666">=</span> u_sol<span style="color: #666666">.</span>subs(C1, s[C1])<span style="color: #666666">.</span>subs(C2, s[C2])
</pre></div>
<p>
Finally, we should check that <code>u_sol</code> is indeed the correct solution:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">checks <span style="color: #666666">=</span> <span style="color: #008000">dict</span>(
    ODE<span style="color: #666666">=</span>simplify(expand(ode(u_sol, homogeneous<span style="color: #666666">=</span><span style="color: #008000">False</span>))),
    IC1<span style="color: #666666">=</span>simplify(u_sol<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> I),
    IC2<span style="color: #666666">=</span>simplify(diff(u_sol, t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>) <span style="color: #666666">-</span> V))
<span style="color: #008000; font-weight: bold">for</span> check <span style="color: #AA22FF; font-weight: bold">in</span> checks:
    msg <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121"> residual: </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (check, checks[check])
    <span style="color: #008000; font-weight: bold">assert</span> checks[check] <span style="color: #666666">==</span> sympify(<span style="color: #666666">0</span>), msg
</pre></div>
<p>
Finally, we may take <code>u_sol = u_sol.subs(A, A/m)</code> to get the right
expression for the solution.
Using <code>latex(u_sol)</code> results in a huge expression, which should be
manually ordered to something like the following:

$$
\begin{align*} u = &
\frac{Am^{-1}}{4 B^{2} \psi^{2} +
\Omega^{2}} \left(2 B \psi
\sin{\left (\psi t \right )} - \Omega\cos{\left (\psi t \right )}\right) + \\ 
&
{e^{-B t}} \biggl(
C_1 \cos{\left( t \sqrt{\omega^{2}- B^{2}}\right)} +
C_2 \sin{\left (t \sqrt{\omega^{2}- B^{2}}\right )}\biggr)\\ 
C_1 &= \frac{Am^{-1} \Omega + 4 I B^{2} \psi^{2} +
I\Omega^2}{
4 B^{2} \psi^{2} + \Omega^2}\\ 
C_2 &=
\frac{- Am^{-1} B\Omega + 4 I B^{3} \psi^{2} +
I B\Omega^2 + 4 V B^{2}\psi^{2} +
V\Omega^2}{
\sqrt{\omega^{2} - B^{2}}
\left(4 B^{2} \psi^{2} + \Omega^2\right)},\\ 
\Omega &= \psi^2 - \omega^2\tp
\end{align*}
$$

<p>
The most important feature of this solution is that there are
two time scales with frequencies \( \psi \) and \( \sqrt{\omega^2 - B^2} \),
respectively,
but the latter appears in terms that decay as \( e^{-Bt} \) in time.
The attention is usually on longer periods of time, so in that
case the solution simplifies to

$$
\begin{align}
u &= \frac{Am^{-1}}{4 B^{2} \psi^{2} +
\Omega^{2}} \left(2 B \psi
\sin{\left (\psi t \right )} - \Omega\cos{\left (\psi t \right )}\right)
\nonumber\\ 
&= \frac{A}{m}\frac{1}{\sqrt{4B^2\psi^2 + \Omega^2}}\cos(\psi t + \phi)
\frac{(\psi\omega)^{-1}}{(\psi\omega)^{-1}}
\nonumber\\ 
& = \frac{A}{k} Q\delta^{-1}\left(1 + Q^2(\delta - \delta^{-1})\right)^{-
\frac{1}{2}}\cos(\psi t + \phi),
\tag{2.84}
\end{align}
$$

where we have introduced the dimensionless numbers

$$ Q = \frac{\omega}{2B},\quad\delta = \frac{\psi}{\omega},$$

and

$$ \phi = \tan^{-1}\left(-\frac{2B}{\omega^2 - \psi^2}\right)
= \tan^{-1}\left(\frac{Q^{-1}}{\delta^2 - 1}\right)\tp$$

\( Q \) is commonly called <em>quality factor</em> and \( \phi \) is the
<em>phase shift</em>. Dividing
<a href="#mjx-eqn-2.84">(2.84)</a> by \( A/k \), which is a common
scale for \( u \), gives the dimensionless relation

$$
\begin{equation}
\frac{u}{A/k} = \frac{Q}{\delta} R(Q,\delta)^{\frac{1}{2}}\cos(\psi t + \phi),
\quad
R(Q,\delta) = \left(1 + Q^2(\delta - \delta^{-1})\right)^{-1}\tp
\tag{2.85}
\end{equation}
$$

<h3 id="___sec87">Choosing scales </h3>

<p>
Much of the discussion about scales in the previous sections are
relevant also when damping is included.  Although the oscillations
with frequency \( \sqrt{\omega^2-B^2} \) die out for \( t\gg B^{-1} \), we
start with using this frequency for the time scale.  A highly relevant
assumption for engineering applications of
<a href="#mjx-eqn-2.82">(2.82)</a> is that the damping is small.
Therefore, \( \sqrt{\omega^2-B^2} \) is close to \( \omega \) and we simply
apply \( t_c=1/\omega \) as before (if not the interest in large \( t \) for
which the oscillations with frequency \( \omega \) has died out).

<p>
The coefficient in front of the \( \bar u' \) term then becomes

$$ \frac{b}{m\omega} = \frac{2B}{\omega} = Q^{-1}\tp$$

The rest of the ODE is given in the previous section, and the particular
formulas depend on the choices of \( t_c \) and \( u_c \).

<h3 id="___sec88">Choice of \( u_c \) at resonance </h3>

<p>
The relevant scale for \( u_c \) at or nearby resonance (\( \psi = \omega \))
becomes different from the previous section, since with damping,
the maximum amplitude is a finite value. For \( t\gg B^{-1} \), when the
\( \sin\psi t \) term is dominating, we have for \( \psi = \omega \):

$$ u = \frac{Am^{-1}2B\psi}{4B^2\psi^2}\sin (\psi t) =
\frac{A}{2Bm\psi}\sin (\psi t) =
\frac{A}{b\psi}\sin (\psi t)
\tp
$$

This motivates the choice

$$ u_c = \frac{A}{b\psi} = \frac{A}{b\omega}\tp$$

(It is wise during computations like this to stop and check the
dimensions: \( A \) must be \( [\hbox{MLT}^{-2}] \) from the original
equation (\( F(t) \) must have the same dimension as \( mu'' \)),
\( bu' \) must also have dimension \( [\hbox{MLT}^{-2}] \), implying that
\( b \) has dimension \( [\hbox{MT}^{-1}] \). \( A/b \) then has dimension
\( LT^{-1} \), and \( A/(b\psi) \) gets dimension \( [L] \), which matches
what we want for \( u_c \).)

<p>
The differential equation on dimensionless form becomes

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + Q^{-1}\frac{d\bar u}{d\bar t} + \bar u =
\gamma
\cos(\delta\bar t),
\quad \bar u(0)=\alpha,\ \bar u'(0)=\beta,
\tag{2.86}
\end{equation}
$$

with

<p>
<!-- \frac{A}{b\omega} -->

$$
\begin{align}
\alpha &= \frac{I}{u_c} = \frac{Ib}{A}\sqrt{\frac{k}{m}},
\tag{2.87}\\ 
\beta  &= \frac{Vt_c}{u_c} = \frac{Vb}{A},
\tag{2.88}\\ 
\gamma &= \frac{t_c^2 A}{mu_c} = \frac{b\omega}{k},
\tag{2.89}\\ 
\delta &= \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega} = 1\tp
\tag{2.90}
\end{align}
$$

<h3 id="___sec89">Choice of \( u_c \) when \( \omega\gg\psi \) </h3>

<p>
In the limit \( \omega\gg\psi \) and \( t\gg B^{-1} \),

$$ u \approx \frac{A}{m\omega^2}\cos\psi t = \frac{A}{k}\cos\psi t,$$

showing that \( u_c=A/k \) is an appropriate displacement scale.
(Alternatively, we get this scale also from demanding \( \gamma=1 \) in the ODE.)
The dimensionless numbers \( \alpha \), \( \beta \), and \( \delta \) are as
for the forced vibrations without damping.

<h3 id="___sec90">Choice of \( u_c \) when \( \omega\ll\psi \) </h3>

<p>
In the limit \( \omega\ll\psi \), we should base \( t_c \) on the rapid
variations in the excitation: \( t_c=1/\psi \).

<h3 id="___sec91">Software </h3>

<p>
It is easy to reuse a solver for a general vibration problem also
in the dimensionless case.
In particular, we may use the <code>solver</code> function in the
file <a href="http://tinyurl.com/o8pb3yy/vib.py" target="_self"><tt>vib.py</tt></a>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">solver</span>(I, V, m, b, s, F, dt, T, damping<span style="color: #666666">=</span><span style="color: #BA2121">&#39;linear&#39;</span>):
</pre></div>
<p>
for solving the ODE problem

$$ mu'' + f(u') + s(u) = F(t),\quad u(0)=I,\ u'(0)=V,\ t\in (0,T],$$

with time steps <code>dt</code>. With <code>damping='linear'</code>, we have \( f(u')=bu' \), while the
other value is <code>'quadratic'</code>, meaning \( f(u')=b|u'|u' \).
Given the dimensionless numbers \( \alpha \), \( \beta \), \( \gamma \), \( \delta \),
and \( Q \),
an appropriate call for solving <a href="#mjx-eqn-2.73">(2.73)</a> is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">u, t <span style="color: #666666">=</span> solver(I<span style="color: #666666">=</span>alpha, V<span style="color: #666666">=</span>beta, m<span style="color: #666666">=1</span>, b<span style="color: #666666">=1.0/</span>Q,
              s<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> u: u, F<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> t: gamma<span style="color: #666666">*</span>cos(delta<span style="color: #666666">*</span>t),
	      dt<span style="color: #666666">=2*</span>pi<span style="color: #666666">/</span>n, T<span style="color: #666666">=2*</span>pi<span style="color: #666666">*</span>P)
</pre></div>
<p>
where <code>n</code> is the number of intervals per period and <code>P</code> is the number
of periods to be simulated.
We way wrap this call in a <code>solver_scaled</code> function and wrap it furthermore
with <code>joblib</code> to avoid repeated calls,
as we explained in
the section <a href="._scaling-book005.html#sec:scale:prog">Making software for utilizing the scaled model</a>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">vib</span> <span style="color: #008000; font-weight: bold">import</span> solver <span style="color: #008000; font-weight: bold">as</span> solver_unscaled

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">solver_scaled</span>(alpha, beta, gamma, delta, Q, T, dt):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Solve u&#39;&#39; + (1/Q)*u&#39; + u = gamma*cos(delta*t),</span>
<span style="color: #BA2121; font-style: italic">    u(0)=alpha, u&#39;(1)=beta, for (0,T] with step dt.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Computing the numerical solution&#39;</span>
    <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> cos
    <span style="color: #008000; font-weight: bold">return</span> solver_unscaled(I<span style="color: #666666">=</span>alpha, V<span style="color: #666666">=</span>beta, m<span style="color: #666666">=1</span>, b<span style="color: #666666">=1./</span>Q,
                           s<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> u: u,
                           F<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> t: gamma<span style="color: #666666">*</span>cos(delta<span style="color: #666666">*</span>t),
                           dt<span style="color: #666666">=</span>dt, T<span style="color: #666666">=</span>T, damping<span style="color: #666666">=</span><span style="color: #BA2121">&#39;linear&#39;</span>)

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">joblib</span>
disk_memory <span style="color: #666666">=</span> joblib<span style="color: #666666">.</span>Memory(cachedir<span style="color: #666666">=</span><span style="color: #BA2121">&#39;temp&#39;</span>)
solver_scaled <span style="color: #666666">=</span> disk_memory<span style="color: #666666">.</span>cache(solver_scaled)
</pre></div>
<p>
This code is found in <a href="http://tinyurl.com/o8pb3yy/vib_scaled.py" target="_self"><tt>vib_scaled.py</tt></a>
and features an application for running the scaled problem with
options on the command-line for \( \alpha \), \( \beta \), \( \gamma \), \( \delta \),
\( Q \), number of time steps per period, and number of periods (see
the <code>main</code> function). It is an ideal application for exploring
scaled vibration models.

<h2 id="___sec92">Oscillating electric circuits </h2>

<p>
The differential equation for an oscillating electric circuit is
very similar to the equation for forced, damped,
mechanical vibrations, and their
dimensionless form is identical. This fact will now be demonstrated.

<p>
The current \( I(t) \) in a
circuit having an inductor with inductance \( L \), a capacitor with
capacitance \( C \), and overall resistance \( R \), obeys the equation

$$
\begin{equation}
\ddot I + \frac{R}{L}\dot I + \frac{1}{LC}I =  V(t),
\tag{2.91}
\end{equation}
$$

where \( V(t) \) is the voltage source powering the circuit.
We introduce

$$ \bar I=\frac{I}{I_c},\quad \bar t = \frac{t}{t_c},$$

and get

$$ \frac{d^2\bar I}{d\bar t^2} + \frac{t_c R}{L}\frac{d\bar I}{d\bar t}
+ \frac{t_c^2}{LC}\bar I = \frac{t_c^2V_c}{I_c} \bar V(t)\tp$$

Here, we have scaled \( V(t) \) according to

$$ \bar V(\bar t) = \frac{V(t_c\bar t)}{\max_t V(t)}\tp$$

<p>
The time scale \( t_c \) is chosen to make \( \ddot I \) and \( I/(LC) \) balance,
\( t_c = \sqrt{LC} \).
Choosing \( I_c \) to make the coefficient in the source term of unit size,
means \( I_c = LCV_c \).
With

$$ Q^{-1} = R\sqrt{\frac{C}{L}},$$

we get the scaled equation

$$
\begin{equation}
\frac{d^2\bar I}{d\bar t^2} + Q^{-1}\frac{d\bar I}{d\bar t}
+ \bar I = \bar V(t),
\tag{2.92}
\end{equation}
$$

which is basically the same as we derived for mechanical vibrations.
(Two additional dimensionless variables will arise from the initial
conditions for \( I \), just as in the mechanics cases.)

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._scaling-book005.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._scaling-book007.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>


</body>
</html>
    

