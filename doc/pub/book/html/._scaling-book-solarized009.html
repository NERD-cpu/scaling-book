<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Scaling of Differential Equations">
<meta name="keywords" content="units,base unit,length,mass,time,dimension of physical quantities,units US,units British,units conversion,units software,multiple software runs,web interface (Parampool),graphical web interface,scaling,non-dimensionalization,dimensionless variable,exponential decay,dimensionless variable,characteristic time,e-folding time,memoize function,dimensionless number,dimensionless number,dimensionless number,logistic equation,dimensionless number,frequency,frequency, angular,period (of oscillations),radians,angular frequency,quality factor $Q$,phase shift,dimensionless number,Peclet number,dimensionless number,Reynolds number,Navier-Stokes equations,dimensionless number,Reynolds number,Reynolds number,low Reynolds number flow,Stokes problem,Stokes' flow,Froude number,creeping flow,Strouhal number,vortex shedding,Euler number,Weber number,forced convection,Peclet number,Reynolds number,free convection,Grashof number,Reynolds number,Peclet number,Eckert number,Nusselt number,Lotka-Volterra, predator-pray model,Lotka-Volterra, competing species model">

<title>Scaling of Differential Equations</title>


<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/css/solarized_light_code.css" rel="stylesheet" type="text/css" title="light"/>
<script src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="http://thomasf.github.io/solarized-css/solarized-light.min.css" rel="stylesheet">
<style type="text/css">
h1 {color: #b58900;}  /* yellow */
/* h1 {color: #cb4b16;}  orange */
/* h1 {color: #d33682;}  magenta, the original choice of thomasf */
code { padding: 0px; background-color: inherit; }
pre {
  border: 0pt solid #93a1a1;
  box-shadow: none;
}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #93a1a1;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #eee8d5;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [('Preface', 0, 'ch:preface', 'ch:preface'),
              ('Dimensions and units', 0, 'scale:dimunit', 'scale:dimunit'),
              ('Fundamental concepts', 1, None, '___sec2'),
              ('Base units and dimensions', 2, None, '___sec3'),
              ('Dimensions of common physical quantities',
               2,
               None,
               '___sec4'),
              ('Prefixes for units', 2, None, '___sec5'),
              ('Unit systems', 2, None, '___sec6'),
              ('PhysicalQuantity: object for computing with units',
               2,
               'scale:PQ',
               'scale:PQ'),
              ('Parampool: user interfaces with automatic unit conversion',
               1,
               'scale:parampool',
               'scale:parampool'),
              ('Example application', 3, None, '___sec9'),
              ('Pool of parameters', 2, None, '___sec10'),
              ('Fetching pool data for computing', 2, None, '___sec11'),
              ('Reading command-line options', 2, None, '___sec12'),
              ('Setting default values in a file', 2, None, '___sec13'),
              ('Specifying multiple values of input parameters',
               2,
               None,
               '___sec14'),
              ('Generating a graphical user interface', 2, None, '___sec15'),
              ('ODE models', 0, None, '___sec16'),
              ('Exponential decay problems',
               1,
               'sec:scale:decay',
               'sec:scale:decay'),
              ('Fundamental ideas', 2, None, '___sec18'),
              ('The basic model problem', 2, None, '___sec19'),
              ('Example: Population dynamics', 3, None, '___sec20'),
              ('Example: Decay of pressure with altitude',
               3,
               None,
               '___sec21'),
              ('The technical steps of the scaling procedure',
               2,
               'sec:scale:decay:steps',
               'sec:scale:decay:steps'),
              ('Step 1: Identify independent and dependent variables',
               3,
               None,
               '___sec23'),
              ('Step 2: Make independent and dependent variables dimensionless',
               3,
               None,
               '___sec24'),
              ('Step 3: Derive the model involving only dimensionless variables',
               3,
               None,
               '___sec25'),
              ('Step 4: Make each term dimensionless', 3, None, '___sec26'),
              ('Step 5: Estimate the scales', 3, None, '___sec27'),
              ('Making software utilizing the dimensionless model',
               2,
               'sec:scale:decay:prog',
               'sec:scale:decay:prog'),
              ('Software for the original problem with dimensions',
               3,
               None,
               '___sec29'),
              ('A plain solution', 3, None, '___sec30'),
              ('Simplifying the implementation with joblib',
               3,
               None,
               '___sec31'),
              ('Scaling a generalized problem',
               2,
               'sec:scale:decay:body',
               'sec:scale:decay:body'),
              ('Exact solution', 3, None, '___sec33'),
              ('Theory', 3, None, '___sec34'),
              ('Software', 3, None, '___sec35'),
              ('Variable coefficients',
               2,
               'sec:scale:decay:jump',
               'sec:scale:decay:jump'),
              ('Scaling a cooling problem with constant surroundings',
               2,
               'scale:decay:cooling:const',
               'scale:decay:cooling:const'),
              ('Scaling a cooling problem with time-dependent surroundings',
               2,
               'scale:decay:cooling:osc',
               'scale:decay:cooling:osc'),
              ('Exact solution', 3, None, '___sec39'),
              ('Scaling', 3, None, '___sec40'),
              ('Software', 3, None, '___sec41'),
              ('Discussion of the time scale', 3, None, '___sec42'),
              ('Scaling a nonlinear ODE',
               2,
               'sec:scale:decay:nonlinear',
               'sec:scale:decay:nonlinear'),
              ('ODE systems for spreading of diseases', 2, None, '___sec44'),
              ('SIR model', 3, None, '___sec45'),
              ('SIRV model with finite immunity', 3, None, '___sec46'),
              ('Michaelis-Menten kinetics for biochemical reactions',
               2,
               'scale:MMK',
               'scale:MMK'),
              ('Classical analysis', 3, None, '___sec48'),
              ('Dimensionless ODE system', 3, None, '___sec49'),
              ('Determining scales', 3, None, '___sec50'),
              ('Analysis of the scaled system', 3, None, '___sec51'),
              ('Vibration problems', 1, 'sec:scale:vib', 'sec:scale:vib'),
              ('Undamped vibrations without forcing',
               2,
               'sec:scale:vib:undamped',
               'sec:scale:vib:undamped'),
              ('The first technical steps of scaling', 3, None, '___sec54'),
              ('The exact solution', 3, None, '___sec55'),
              ('Discussion of the displacement scale', 3, None, '___sec56'),
              ('Discussion of the time scale', 3, None, '___sec57'),
              ('Alternative displacement scale', 3, None, '___sec58'),
              ('About frequency and dimensions', 3, None, '___sec59'),
              ('Undamped vibrations with constant forcing',
               2,
               'sec:scale:vib:undamped:mg',
               'sec:scale:vib:undamped:mg'),
              ('Undamped vibrations with time-dependent forcing',
               2,
               'sec:scale:vib:undamped:F',
               'sec:scale:vib:undamped:F'),
              ('Investigating scales via analytical solutions',
               3,
               None,
               '___sec62'),
              ('The displacement and time scales', 3, None, '___sec63'),
              ('Finding the displacement scale from the differential equation',
               3,
               None,
               '___sec64'),
              ('Scaling with free vibrations as time scale',
               3,
               None,
               '___sec65'),
              ('Software', 3, None, '___sec66'),
              ('Choice of $u_c$ close to resonance', 3, None, '___sec67'),
              ('Unit size of all terms in the ODE', 3, None, '___sec68'),
              ('Choice of $u_c$ when $\\psi\\gg\\omega$',
               3,
               None,
               '___sec69'),
              ('Displacement scale based on $I$', 3, None, '___sec70'),
              ('Damped vibrations with forcing',
               2,
               'sec:scale:vib:damped:F',
               'sec:scale:vib:damped:F'),
              ('The exact solution', 3, None, '___sec72'),
              ('Choosing scales', 3, None, '___sec73'),
              ('Choice of $u_c$ at resonance', 3, None, '___sec74'),
              ('Choice of $u_c$ when $\\omega\\gg\\psi$',
               3,
               None,
               '___sec75'),
              ('Choice of $u_c$ when $\\omega\\ll\\psi$',
               3,
               None,
               '___sec76'),
              ('Oscillating electric circuits', 2, None, '___sec77'),
              ('Basic PDE models', 0, None, '___sec78'),
              ('The wave equation', 1, 'sec:scale:wave', 'sec:scale:wave'),
              ('Simple homogeneous Dirichlet conditions',
               2,
               None,
               '___sec80'),
              ('Implementation of the scaled wave equation',
               2,
               None,
               '___sec81'),
              ('Waves on a string', 3, None, '___sec82'),
              ('Detecting an already computed case', 3, None, '___sec83'),
              ('Time-dependent Dirichlet condition',
               2,
               'scale:wave:pde2',
               'scale:wave:pde2'),
              ('Velocity initial condition',
               2,
               'scale:wave:pde2:Vcond',
               'scale:wave:pde2:Vcond'),
              ('Variable wave velocity and forcing',
               2,
               'scale:wave:pde2:cvar',
               'scale:wave:pde2:cvar'),
              ('Damped wave equation',
               2,
               'scale:wave:pde2:damped',
               'scale:wave:pde2:damped'),
              ('A three-dimensional wave equation problem',
               2,
               None,
               '___sec88'),
              ('The diffusion equation',
               1,
               'sec:scale:diffu',
               'sec:scale:diffu'),
              ('Homogeneous diffusion equation',
               2,
               'sec:scale:diffu:homo1D',
               'sec:scale:diffu:homo1D'),
              ('Simplified 1D PDE', 3, None, '___sec91'),
              ('Generalized PDE', 3, None, '___sec92'),
              ('Jump boundary condition', 2, None, '___sec93'),
              ('Oscillating Dirichlet condition', 2, None, '___sec94'),
              ('Diffusion equation with source term',
               2,
               'sec:scale:diffu:source',
               'sec:scale:diffu:source'),
              ("Fisher's equation",
               2,
               'sec:scale:diffu:Fisher',
               'sec:scale:diffu:Fisher'),
              ('The convection-diffusion equation',
               1,
               'scale:convdiff',
               'scale:convdiff'),
              ('Convection-diffusion without a force term',
               2,
               None,
               '___sec98'),
              ('Stationary PDE', 2, None, '___sec99'),
              ('Convection-diffusion with a force term',
               2,
               'scale:convdiff',
               'scale:convdiff'),
              ('Advanced PDE models', 0, None, '___sec101'),
              ('The equations of linear elasticity', 1, None, '___sec102'),
              ('The Navier-Stokes equations',
               1,
               'sec:scale:ns',
               'sec:scale:ns'),
              ('The momentum equation without body forces',
               2,
               None,
               '___sec104'),
              ('The most common dimensionless form of the Navier-Stokes equations',
               2,
               None,
               '___sec105'),
              ('Scaling of time for low Reynolds numbers',
               2,
               None,
               '___sec106'),
              ('Shear stress as pressure scale', 2, None, '___sec107'),
              ('Including the gravity force', 2, None, '___sec108'),
              ('Oscillating boundary conditions', 2, None, '___sec109'),
              ('The Euler number', 2, None, '___sec110'),
              ('Free surface conditions', 2, None, '___sec111'),
              ('Thermal convection', 1, None, '___sec112'),
              ('Forced convection', 2, None, '___sec113'),
              ('Free convection',
               2,
               'scale:fluid:forced_convection',
               'scale:fluid:forced_convection'),
              ('Governing equations', 3, None, '___sec115'),
              ('Heating by viscous effects', 3, None, '___sec116'),
              ('Relation between density and temperature',
               3,
               None,
               '___sec117'),
              ('Comment on the form of the equation of continuity',
               3,
               None,
               '___sec118'),
              ('The Boussinesq approximation', 3, None, '___sec119'),
              ('Scaling', 3, None, '___sec120'),
              ('The Grashof, Prandtl, and Eckert numbers',
               2,
               None,
               '___sec121'),
              ('Heat transfer at boundaries', 2, None, '___sec122'),
              ('The bidomain model in electrophysiology',
               1,
               'scale:bidomain',
               'scale:bidomain'),
              ('Two-phase porous media flow', 1, None, '___sec124'),
              ('The Euler equations of gas dynamics', 1, None, '___sec125'),
              ('Exercises', 1, None, '___sec126'),
              ('Exercise 1: Perform unit conversion',
               2,
               'sec:scale:exer:US2SI1',
               'sec:scale:exer:US2SI1'),
              ('Problem 2: Scale a simple formula',
               2,
               'sec:scale:exer:ball_y',
               'sec:scale:exer:ball_y'),
              ('Problem 3: Scale a nonlinear ODE',
               2,
               'sec:scale:exer:ball_y_wdrag',
               'sec:scale:exer:ball_y_wdrag'),
              ('Exercise 4: Implement a scaled model with jump',
               2,
               'sec:scale:exer:decay:jump',
               'sec:scale:exer:decay:jump'),
              ('Exercise 5: Implement a scaled model for cooling',
               2,
               'sec:scale:exer:decay:cooling',
               'sec:scale:exer:decay:cooling'),
              ('Problem 6: Scale variable coefficients',
               2,
               'scale:decay:exer:decay:step',
               'scale:decay:exer:decay:step'),
              ('Exercise 7: Alternative scalings of a cooling model',
               2,
               'scale:decay:exer:cooling:Ts',
               'scale:decay:exer:cooling:Ts'),
              ('Exercise 8: Alternative scalings of a cooling model',
               2,
               'scale:decay:exer:nonlin:logistic2',
               'scale:decay:exer:nonlin:logistic2'),
              ('Exercise 9: Scale projectile motion',
               2,
               'scale:vib:exer:projectile',
               'scale:vib:exer:projectile'),
              ('Problem 10: Scale a predator-pray model',
               2,
               'scale:decay:exer:predpray',
               'scale:decay:exer:predpray'),
              ('Problem 11: Scale a model for competing species',
               2,
               'scale:decay:exer:competing_species',
               'scale:decay:exer:competing_species'),
              ('Problem 12: Find the period of sinusoidal signals',
               2,
               'scale:decay:exer:sine',
               'scale:decay:exer:sine'),
              ('Remarks', 3, None, '___sec139'),
              ('Problem 13: Scale the pendulum equation',
               2,
               'sec:scale:exer:pendulum',
               'sec:scale:exer:pendulum'),
              ("Problem 14: Scale Duffing's equation",
               2,
               'scale:vib:exer:Duffing',
               'scale:vib:exer:Duffing'),
              ('Problem 15: Scale a stationary Couette flow',
               2,
               'scale:vib:exer:stationary_Couette',
               'scale:vib:exer:stationary_Couette'),
              ('Remarks', 3, None, '___sec143'),
              ('Problem 16: Scale a starting Couette flow',
               2,
               'scale:vib:exer:starting_Couette',
               'scale:vib:exer:starting_Couette'),
              ('Exercise 17: Scale Couette flow with pressure gradient',
               2,
               'scale:vib:exer:Couette_wpressure',
               'scale:vib:exer:Couette_wpressure'),
              ('Exercise 18: Suggestions...',
               2,
               'scale::exer:suggest',
               'scale::exer:suggest'),
              ('References', 1, None, '___sec147')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\half}{\frac{1}{2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\x}{\boldsymbol{x}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
$$




    
<a name="part0009"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._scaling-book-solarized008.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._scaling-book-solarized010.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- !split -->

<h1 id="___sec97">The convection-diffusion equation </h1>
<div id="scale:convdiff"></div>

<h2 id="___sec98">Convection-diffusion without a force term </h2>

<p>
We now add a convection term \( \boldsymbol{v}\cdot\nabla u \) to the diffusion
equation to obtain the well-known convection-diffusion equation:

$$
\begin{equation}
\frac{\partial u}{\partial t} + \v\cdot\nabla u =
\dfc\nabla^2 u,
\quad  \bar x,\bar y,\bar z\in \bar\Omega,\ t\in (0, T]\tp
\tag{123}
\end{equation}
$$

The velocity field \( \v \) is prescribed, and its characteristic size \( V \)
is normally clear from the problem description.

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 7</b>: Show a couple of cases, can be the same as Navier-Stokes, where different \( V \) is obvious.)</font>
<!-- end inline comment -->

<p>
Inserting

$$ \bar x = \frac{x}{x_c},\ \bar y = \frac{y}{y_c},\ \bar z = \frac{z}{z_c},
\ \bar t = \frac{t}{t_c}, \ \bar\v = \frac{\v}{V},
\ \bar u =\frac{u}{u_c}$$

in <a href="#mjx-eqn-123">(123)</a> yields

$$
\frac{u_c}{t_c}
\frac{\partial \bar u}{\partial \bar t} +
\frac{u_c V}{L}\bar\v\cdot\bar\nabla\bar u =
\frac{\dfc u_c}{L^2}\bar\nabla^2\bar u,
\quad \bar x,\bar y,\bar z\in \Omega,\ \bar t\in (0,\bar T]\tp
$$

For \( u_c \) we simply introduce the symbol \( U \), which we may estimate
from an initial condition. It is not critical here since it vanishes
from the scaled equation anyway as long as there is no source term
present.
With some velocity measure \( V \) and length measure \( L \), it is
tempting to just let \( t_c = L/V \). The alternative is to use the
diffusion length scale \( t_c=L^2/\dfc \). Very often in these kind of
problems, the convection term \( \v\cdot\nabla u \) dominates over the
diffusion term \( \dfc\nabla^2 u \), so the time scale for convection,
which is typically \( L/V \) (the time it takes for the convection velocity
to propagate a signal through the characteristic length),
is most appropriate of the two. Only when
the diffusion term is very much larger than the convection
term (corresponding to very small Peclet numbers, see below)
we would apply \( t_c=L^2/\dfc \).
The non-dimensional form of the PDE with \( t_c=L/V \) becomes

$$
\begin{equation}
\frac{\partial \bar u}{\partial \bar t} +
\bar\v\cdot\bar\nabla\bar u =
\hbox{Pe}^{-1}\bar\nabla^2\bar u,
\quad \bar x,\bar y,\bar z\in \Omega,\ \bar t\in (0,\bar T],
\tag{124}
\end{equation}
$$

where Pe is the <em>Peclet number</em>,

$$ \hbox{Pe} = \frac{LV}{\dfc}\tp$$

Estimating the size of the convection term \( \v\cdot\nabla u \) as
\( VU/L \) and the diffusion term \( \dfc\nabla^2 u \) as \( \dfc U/L^2 \),
we see that the Peclet number measures the ratio of the convection
and the diffusion terms:

$$ \hbox{Pe} = \frac{\hbox{convection}}{\hbox{diffusion}} =
\frac{VU/L}{\dfc U/L^2}= \frac{LV}{\dfc}\tp
$$

<p>
In case we use the diffusion time scale
\( t_c=L^2/\dfc \), we get the non-dimensional PDE

$$
\begin{equation}
\frac{\partial \bar u}{\partial \bar t} +
\hbox{Pe}\,\bar\v\cdot\bar\nabla\bar u =
\bar\nabla^2\bar u,
\quad \bar x,\bar y,\bar z\in \Omega,\ \bar t\in (0,\bar T]\tp
\tag{125}
\end{equation}
$$

<p>
<div class="alert alert-block alert-notice alert-text-normal">
<b>Discussion of scales and balance of terms in the PDE.</b>
<p>
We see that <a href="#mjx-eqn-124">(124)</a> and <a href="#mjx-eqn-125">(125)</a>
are not equivalent, and they are based on two different time scales.
For moderate Peclet numbers around 1, all terms have the same size
in <a href="#mjx-eqn-124">(124)</a>, i.e., a size around unity.
For large Peclet numbers,
<a href="#mjx-eqn-124">(124)</a> expresses a balance
between the time derivative term and the convection term, both of size
unity, and then there is a very small term
\( \hbox{Pe}^{-1}\bar\nabla^2\bar u \) term because Pe is large and
\( \bar\nabla^2\bar u \) should be of size unity.
That the convection term dominates over the diffusion term is
consistent with the time scale \( t_c=L/V \) based on convection transport.
In this case, we can neglect the diffusion term as Pe goes to infinity
and work with a pure convection (or advection) equation

$$
\frac{\partial \bar u}{\partial \bar t} +
\bar\v\cdot\bar\nabla\bar u = 0\tp
$$

<p>
For small Peclet numbers, \( \hbox{Pe}^{-1}\bar\nabla^2\bar u \) becomes
very large and can only be balanced by two terms that are supposed to
be unity of size.  The time-derivative and/or the convection term must
be much larger than unity, but that means that we use wrong scales,
since right scales imply that \( \partial\bar u/\partial\bar t \) and
\( \bar v\cdot\bar\nabla\bar u \) of order unity. Switching to a time
scale based on diffusion as the dominating physical effect gives
<a href="#mjx-eqn-125">(125)</a>.  For very small Peclet numbers this
equation tells that the time-derivative balances the diffusion, while
the convection \( \bar\v\cdot\bar\nabla\bar\u \) is around
unity, but multiplied by a very small coefficient Pe, so this term is
negligible in the PDE. An approximate PDE for small Peclet numbers is
therefore

$$
\frac{\partial \bar u}{\partial \bar t}
= \bar\nabla^2\bar u\tp
$$

<p>
Scaling can with the above type of reasoning be used
to neglect terms from a differential equation under precise mathematical
conditions.
</div>


<h2 id="___sec99">Stationary PDE </h2>

<p>
Suppose the problem is stationary and that there is no need for
any time scale. How is this type of convection-diffusion problem
scaled? We get

$$
\frac{VU}{L}\bar\v\cdot\bar\nabla\bar u =
\frac{\dfc U}{L^2}\bar\nabla^2\bar u,
$$

or

$$
\begin{equation}
\bar\v\cdot\bar\nabla\bar u =
\hbox{Pe}^{-1}\bar\nabla^2\bar u\tp
\tag{126}
\end{equation}
$$

This scaling only &quot;works&quot; for moderate Peclet numbers. For very small or
very large Pe, either the convection term \( \bar\v\cdot\bar\nabla\bar u \)
or the diffusion term \( \bar\nabla^2\bar u \) must deviate significantly
from unity.

<p>
Consider the following 1D example to illustrate the point: \( \v = v\ii \),
\( v>0 \) constant, a domain \( [0,L] \), with boundary conditions \( u(0)=0 \) and
\( u(L)=U_L \),

$$ vu^{\prime} = \dfc u^{\prime\prime},\quad u(0)=0,\ u(L)=U_L\tp$$

The scaled problem reads

$$ \frac{d\bar u}{d\bar x} = \hbox{Pe}^{-1}\frac{d^2\bar u}{d\bar x^2},\quad
\bar x\in (0,1),\quad \bar u(0)=0,\ \bar u(1) = 1,$$

if we choose \( U=U_L \). The solution of the scaled problem is

$$ \bar u(\bar x) = \frac{1 - e^{\bar x\hbox{Pe}}}{1 - e^{\hbox{Pe}}}\tp$$

Figure <a href="#scale:convdiff:fig:scaled">11</a> indicates how \( \bar u \) depends on
Pe: small Pe values gives approximately a straight line while large Pe
values leads to a <em>boundary layer</em> close to \( x=1 \), where the solution
changes very rapidly.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 11:  Solution of scaled problem where the length scale depends on the Peclet number. <div id="scale:convdiff:fig:scaled"></div> </p></center>
<p><img src="fig-scale/boundary_layer1D.png" align="bottom" width=600></p>
</center>

<p>
We realize that for large Pe,

$$ \max_{\bar x}\frac{d\bar u}{d\bar x} \approx \hbox{Pe},\quad
\max_{\bar x}\frac{d^2\bar u}{d\bar x^2} \approx \hbox{Pe}^{2},$$

which are consistent results with the PDE since the double derivative term
is multiplied by \( \hbox{Pe}^{-1} \).
For small Pe,

$$ \max_{\bar x}\frac{d\bar u}{d\bar x}     \approx 1,\quad
   \max_{\bar x}\frac{d^2\bar u}{d\bar x^2} \approx 0,$$

which is also consistent with the PDE
since an almost vanishing second-order derivative
is multiplied by a very large coefficient \( \hbox{Pe}^{-1} \).
However, we have a problem with very large
derivatives of \( \bar u \) when Pe is large.

<p>
To arrive at a proper scaling for large Peclet numbers,
we need to remove the Pe coefficient
from the differential equation. There are only two scales at our
disposals: \( u_c \) and \( x_c \) for \( u \) and \( x \), respectively.
The natural value for \( u_c \) is the boundary value \( U_L \) at \( x=L \).
The scaling of \( Vu_x = \dfc u_{xx} \) then results in

$$ \frac{d\bar u}{d\bar x} = \frac{\dfc}{Vx_c}\frac{d^2\bar u}{d\bar x^2},
\quad \bar x\in (0,\bar L),\quad \bar u(0)=0,\ \bar u(\bar L)=1,$$

where \( \bar L = L/x_c \). Choosing the coefficient \( \dfc/(Vx_c) \) to
be unity results in the scale \( x_c=\dfc/V \), and \( \bar L \) becomes Pe.
The final, scaled boundary-value
problem is now

$$ \frac{d\bar u}{d\bar x} = \frac{d^2\bar u}{d\bar x^2},
\quad \bar x \in (0, \hbox{Pe}), \quad \bar u(0)=0,\ \bar u(\hbox{Pe})=1,$$

with solution

$$ \bar u(\bar x) = \frac{1 - e^{\bar x}}{1 - e^{\hbox{Pe}}}\tp$$

Figure <a href="#scale:convdiff:fig:rescaled">12</a> displays \( \bar u \) for some
Peclet numbers, and we see that the shape of the graphs are the same
with this scaling. For large Peclet numbers we realize that \( \bar u \)
and its derivatives are around unity (\( 1-e^{\hbox{Pe}}\approx -e^{\hbox{Pe}} \)),
but for small Peclet numbers \( d\bar u/d\bar x \sim \hbox{Pe}^{-1} \).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 12:  Solution of scaled problem where the length scale depends on the Peclet number. <div id="scale:convdiff:fig:rescaled"></div> </p></center>
<p><img src="fig-scale/boundary_layer1D_scale2.png" align="bottom" width=600></p>
</center>

<p>
The conclusion is that for small Peclet numbers, \( x_c=L \) is an
appropriate length scale and leads to scaled derivatives in \( [0,1] \).
The scaled equation \( \hbox{Pe}\bar u' = \bar u'' \) indicates that \( \bar
u''\approx 0 \), and the solution is close to a straight line.  For
large Pe values, \( x_c=\dfc/V \) is an appropriate length scale, and the
scaled equation expresses that the terms \( \bar u' \) and \( \bar u'' \) are
equal and of size around unity.

<h2 id="scale:convdiff">Convection-diffusion with a force term</h2>

<p>
Let us add a force term \( f(\x,t) \) to the convection-diffusion equation :

$$
\begin{equation}
\frac{\partial u}{\partial t} + \v\cdot\nabla u =
\dfc\nabla^2 u + f\tp
\tag{127}
\end{equation}
$$

The scaled version reads

$$
\frac{\partial u}{\partial t} + \frac{t_cV}{L}\bar\v\cdot\bar nabla \bar u =
\frac{t_c\dfc}{L^2}\bar\nabla^2 \bar u + \frac{t_cf_c}{u_c}\bar f\tp
$$

We can base \( t_c \) on convective transport: \( t_c = L/V \). Now,
\( u_c \) could be chosen to make the coefficient in the source term unity:
\( u_c = t_cf_c = Lf_c/V \).
This leaves us with

$$ \frac{\partial u}{\partial t} + \bar\v\cdot\bar \nabla\bar u =
\hbox{Pe}^{-1}\bar \nabla^2 \bar u + \bar f\tp
$$

<p>
In the diffusion limit, we base \( t_c \) on the diffusion time scale:
\( t_c=L^2/\dfc \), and the coefficient of the source term set to unity
determines \( u_c \) according to

$$ \frac{L^2 f_c}{\dfc u_c} = 1\quad\Rightarrow\quad u_c = \frac{L^2 f_c}{\dfc}\tp$$

The corresponding PDE reads

$$ \frac{\partial u}{\partial t} + \hbox{Pe}\,\bar\v\cdot\bar \nabla\bar u =
\bar\nabla^2 \bar u + \bar f,
$$

so for small Peclet numbers, which we have, the convective term can
be neglected and we get a pure diffusion equation with a source term.

<p>
So, what if the problem is stationary?
Then there is no time scale and we get

$$
\frac{V u_c}{L}\bar\v\cdot\bar \nabla \bar u =
\frac{u_c \dfc}{L^2}\bar\nabla^2 \bar u + f_c\bar f,
$$

or

$$
\bar\v\cdot\bar \nabla \bar u =
\hbox{Pe}^{-1}\bar\nabla^2 \bar u + \frac{f_c L}{V u_c}\bar f,
$$

Again, choosing \( u_c \) such that the source term coefficient is unity leads
to \( u_c= f_c L/V \).

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 8</b>: Suppose \( V \) is small. This suggests removing the convection <em>and</em> the source term.)</font>
<!-- end inline comment -->

<p>
<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._scaling-book-solarized008.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._scaling-book-solarized010.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


<center style="font-size:80%">
<!-- copyright --> &copy; 2015, Hans Petter Langtangen. Released under CC Attribution 4.0 license
</center>


</body>
</html>
    

