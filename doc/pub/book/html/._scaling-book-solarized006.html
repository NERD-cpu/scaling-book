<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Scaling of Differential Equations">
<meta name="keywords" content="units,base unit,length,mass,time,dimension of physical quantities,Pi theorem,Buckingham Pi theorem,units US,units British,units conversion,units software,multiple software runs,web interface (Parampool),graphical web interface,scaling,non-dimensionalization,dimensionless variable,exponential decay,dimensionless variable,characteristic time,e-folding time,memoize function,dimensionless number,dimensionless number,dimensionless number,logistic equation,dimensionless number,frequency,frequency, angular,period (of oscillations),radians,angular frequency,quality factor $Q$,phase shift,Lotka-Volterra, predator-prey model,Lotka-Volterra, competing species model,dimensionless number,Peclet number,dimensionless number,Reynolds number,thermo-elasticity,Navier-Stokes equations,dimensionless number,Reynolds number,Reynolds number,low Reynolds number flow,Stokes problem,Stokes' flow,Froude number,creeping flow,Strouhal number,vortex shedding,Euler number,Weber number,forced convection,Peclet number,Reynolds number,free convection,Grashof number,Reynolds number,Peclet number,Eckert number,Nusselt number,Mach number">

<title>Scaling of Differential Equations</title>


<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/css/solarized_light_code.css" rel="stylesheet" type="text/css" title="light"/>
<script src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="http://thomasf.github.io/solarized-css/solarized-light.min.css" rel="stylesheet">
<style type="text/css">
h1 {color: #b58900;}  /* yellow */
/* h1 {color: #cb4b16;}  orange */
/* h1 {color: #d33682;}  magenta, the original choice of thomasf */
code { padding: 0px; background-color: inherit; }
pre {
  border: 0pt solid #93a1a1;
  box-shadow: none;
}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #93a1a1;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #eee8d5;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [('Preface', 0, 'ch:preface', 'ch:preface'),
              ('Dimensions and units', 0, 'scale:dimunit', 'scale:dimunit'),
              ('Fundamental concepts', 1, None, '___sec2'),
              ('Base units and dimensions', 2, None, '___sec3'),
              ('Dimensions of common physical quantities',
               2,
               'scale:dimunit:tables',
               'scale:dimunit:tables'),
              ('Prefixes for units', 3, None, '___sec5'),
              ('The Buckingham Pi theorem',
               2,
               'scale:dimunit:Pi',
               'scale:dimunit:Pi'),
              ('Absolute errors, relative errors, and units',
               2,
               None,
               '___sec7'),
              ('Units and computers', 2, None, '___sec8'),
              ('Unit systems', 2, None, '___sec9'),
              ('Example on challenges arising from unit systems',
               2,
               None,
               '___sec10'),
              ('PhysicalQuantity: a tool for computing with units',
               2,
               'scale:PQ',
               'scale:PQ'),
              ('Parampool: user interfaces with automatic unit conversion',
               1,
               'scale:parampool',
               'scale:parampool'),
              ('Example application', 3, None, '___sec13'),
              ('Pool of parameters', 2, None, '___sec14'),
              ('Fetching pool data for computing', 2, None, '___sec15'),
              ('Reading command-line options', 2, None, '___sec16'),
              ('Setting default values in a file', 2, None, '___sec17'),
              ('Specifying multiple values of input parameters',
               2,
               None,
               '___sec18'),
              ('Generating a graphical user interface', 2, None, '___sec19'),
              ('ODE models', 0, None, '___sec20'),
              ('Exponential decay problems',
               1,
               'sec:scale:decay',
               'sec:scale:decay'),
              ('Fundamental ideas', 2, None, '___sec22'),
              ('The basic model problem', 2, None, '___sec23'),
              ('Example: Population dynamics', 3, None, '___sec24'),
              ('Example: Decay of pressure with altitude',
               3,
               None,
               '___sec25'),
              ('The technical steps of the scaling procedure',
               2,
               'sec:scale:decay:steps',
               'sec:scale:decay:steps'),
              ('Step 1: Identify independent and dependent variables',
               3,
               None,
               '___sec27'),
              ('Step 2: Make independent and dependent variables dimensionless',
               3,
               None,
               '___sec28'),
              ('Step 3: Derive the model involving only dimensionless variables',
               3,
               None,
               '___sec29'),
              ('Step 4: Make each term dimensionless', 3, None, '___sec30'),
              ('Step 5: Estimate the scales', 3, None, '___sec31'),
              ('Making software for utilizing the scaled model',
               2,
               'sec:scale:decay:prog',
               'sec:scale:decay:prog'),
              ('Software for the original problem with dimensions',
               3,
               None,
               '___sec33'),
              ('Avoiding unnecessary computations', 3, None, '___sec34'),
              ('Implementation with joblib', 3, None, '___sec35'),
              ('Scaling a generalized problem',
               2,
               'sec:scale:decay:body',
               'sec:scale:decay:body'),
              ('Exact solution', 3, None, '___sec37'),
              ('Theory', 3, None, '___sec38'),
              ('Software', 3, None, '___sec39'),
              ('Variable coefficients',
               2,
               'sec:scale:decay:jump',
               'sec:scale:decay:jump'),
              ('Scaling a cooling problem with constant surroundings',
               2,
               'scale:decay:cooling:const',
               'scale:decay:cooling:const'),
              ('Exact solution', 3, None, '___sec42'),
              ('Scaling', 3, None, '___sec43'),
              ('Software', 3, None, '___sec44'),
              ('Alternative scaling', 3, None, '___sec45'),
              ('Scaling a cooling problem with time-dependent surroundings',
               2,
               'scale:decay:cooling:osc',
               'scale:decay:cooling:osc'),
              ('Exact solution', 3, None, '___sec47'),
              ('Scaling', 3, None, '___sec48'),
              ('Software', 3, None, '___sec49'),
              ('Discussion of the time scale', 3, None, '___sec50'),
              ('Scaling a nonlinear ODE',
               2,
               'sec:scale:decay:nonlinear',
               'sec:scale:decay:nonlinear'),
              ('Scaling', 3, None, '___sec52'),
              ('Alternative scaling', 3, None, '___sec53'),
              ('SIR ODE system for spreading of diseases',
               2,
               None,
               '___sec54'),
              ('Scaling', 3, None, '___sec55'),
              ('Software', 3, None, '___sec56'),
              ('Alternative scaling', 3, None, '___sec57'),
              ('SIRV model with finite immunity', 2, None, '___sec58'),
              ('Michaelis-Menten kinetics for biochemical reactions',
               2,
               'scale:MMK',
               'scale:MMK'),
              ('Classical analysis', 3, None, '___sec60'),
              ('Dimensionless ODE system', 3, None, '___sec61'),
              ('Determining scales', 3, None, '___sec62'),
              ('Analysis of the scaled system', 3, None, '___sec63'),
              ('Vibration problems', 1, 'sec:scale:vib', 'sec:scale:vib'),
              ('Undamped vibrations without forcing',
               2,
               'sec:scale:vib:undamped',
               'sec:scale:vib:undamped'),
              ('The first technical steps of scaling', 3, None, '___sec66'),
              ('The exact solution', 3, None, '___sec67'),
              ('Discussion of the displacement scale', 3, None, '___sec68'),
              ('Discussion of the time scale', 3, None, '___sec69'),
              ('The dimensionless solution', 3, None, '___sec70'),
              ('Alternative displacement scale', 3, None, '___sec71'),
              ('About frequency and dimensions', 3, None, '___sec72'),
              ('Undamped vibrations with constant forcing',
               2,
               'sec:scale:vib:undamped:mg',
               'sec:scale:vib:undamped:mg'),
              ('Undamped vibrations with time-dependent forcing',
               2,
               'sec:scale:vib:undamped:F',
               'sec:scale:vib:undamped:F'),
              ('Investigating scales via analytical solutions',
               3,
               None,
               '___sec75'),
              ('The displacement and time scales', 3, None, '___sec76'),
              ('Finding the displacement scale from the differential equation',
               3,
               None,
               '___sec77'),
              ('Scaling with free vibrations as time scale',
               3,
               None,
               '___sec78'),
              ('Software', 3, None, '___sec79'),
              ('Choice of $u_c$ close to resonance', 3, None, '___sec80'),
              ('Unit size of all terms in the ODE', 3, None, '___sec81'),
              ('Choice of $u_c$ when $\\psi\\gg\\omega$',
               3,
               None,
               '___sec82'),
              ('Displacement scale based on $I$', 3, None, '___sec83'),
              ('Damped vibrations with forcing',
               2,
               'sec:scale:vib:damped:F',
               'sec:scale:vib:damped:F'),
              ('The exact solution', 3, None, '___sec85'),
              ('Choosing scales', 3, None, '___sec86'),
              ('Choice of $u_c$ at resonance', 3, None, '___sec87'),
              ('Choice of $u_c$ when $\\omega\\gg\\psi$',
               3,
               None,
               '___sec88'),
              ('Choice of $u_c$ when $\\omega\\ll\\psi$',
               3,
               None,
               '___sec89'),
              ('Software', 3, None, '___sec90'),
              ('Oscillating electric circuits', 2, None, '___sec91'),
              ('Exercises', 1, None, '___sec92'),
              ('Exercise 1: Perform unit conversion',
               2,
               'sec:scale:exer:US2SI1',
               'sec:scale:exer:US2SI1'),
              ('Problem 2: Scale a simple formula',
               2,
               'sec:scale:exer:ball_y',
               'sec:scale:exer:ball_y'),
              ('Exercise 3: Perform alternative scalings',
               2,
               'sec:scale:exer:decay:cooling:osc',
               'sec:scale:exer:decay:cooling:osc'),
              ('Problem 4: A nonlinear ODE for vertical motion with air resistance',
               2,
               'sec:scale:exer:ball_y_wdrag',
               'sec:scale:exer:ball_y_wdrag'),
              ('Exercise 5: Solve a decay ODE with discontinuous coefficient',
               2,
               'sec:scale:exer:decay:jump',
               'sec:scale:exer:decay:jump'),
              ('Exercise 6: Implement a scaled model for cooling',
               2,
               'sec:scale:exer:decay:cooling',
               'sec:scale:exer:decay:cooling'),
              ('Problem 7: Decay ODE with discontinuous coefficients',
               2,
               'scale:decay:exer:decay:step',
               'scale:decay:exer:decay:step'),
              ('Exercise 8: Alternative scalings of a cooling model',
               2,
               'scale:decay:exer:nonlin:logistic2',
               'scale:decay:exer:nonlin:logistic2'),
              ('Exercise 9: Projectile motion',
               2,
               'scale:vib:exer:projectile',
               'scale:vib:exer:projectile'),
              ('Problem 10: A predator-prey model',
               2,
               'scale:decay:exer:predpray',
               'scale:decay:exer:predpray'),
              ('Problem 11: A model for competing species',
               2,
               'scale:decay:exer:competing_species',
               'scale:decay:exer:competing_species'),
              ('Problem 12: Find the period of sinusoidal signals',
               2,
               'scale:decay:exer:sine',
               'scale:decay:exer:sine'),
              ('Remarks', 3, None, '___sec105'),
              ('Problem 13: Oscillating mass with sliding friction',
               2,
               'scale:vib:exer:sliding',
               'scale:vib:exer:sliding'),
              ('Problem 14: Pendulum equations',
               2,
               'sec:scale:exer:pendulum',
               'sec:scale:exer:pendulum'),
              ('Exercise 15: ODEs for a binary star',
               2,
               'sec:scale:exer:binary_star',
               'sec:scale:exer:binary_star'),
              ("Problem 16: Duffing's equation",
               2,
               'scale:vib:exer:Duffing',
               'scale:vib:exer:Duffing'),
              ('Problem 17: Vertical motion in a varying gravity field',
               2,
               'scale:vib:exer:rocket',
               'scale:vib:exer:rocket'),
              ("Problem 18: Schroedinger's equation",
               2,
               'scale:vib:exer:quantum',
               'scale:vib:exer:quantum'),
              ('Remarks', 3, None, '___sec112'),
              ('Basic PDE models', 0, None, '___sec113'),
              ('The wave equation', 1, 'sec:scale:wave', 'sec:scale:wave'),
              ('Simple homogeneous Dirichlet conditions',
               2,
               None,
               '___sec115'),
              ('Implementation of the scaled wave equation',
               2,
               None,
               '___sec116'),
              ('Waves on a string', 3, None, '___sec117'),
              ('Detecting an already computed case', 3, None, '___sec118'),
              ('Time-dependent Dirichlet condition',
               2,
               'scale:wave:pde2',
               'scale:wave:pde2'),
              ('Scaling', 3, None, '___sec120'),
              ('Software', 3, None, '___sec121'),
              ('Specific case', 3, None, '___sec122'),
              ('Velocity initial condition',
               2,
               'scale:wave:pde2:Vcond',
               'scale:wave:pde2:Vcond'),
              ('Analytical insight', 3, None, '___sec124'),
              ('Scaling', 3, None, '___sec125'),
              ('Nonzero initial shape', 3, None, '___sec126'),
              ('Variable wave velocity and forcing',
               2,
               'scale:wave:pde2:cvar',
               'scale:wave:pde2:cvar'),
              ('Non-dimensionalization', 3, None, '___sec128'),
              ('Choosing the time scale', 3, None, '___sec129'),
              ('Choosing the spatial scale', 3, None, '___sec130'),
              ('Scaling the velocity initial condition',
               3,
               None,
               '___sec131'),
              ('Damped wave equation',
               2,
               'scale:wave:pde2:damped',
               'scale:wave:pde2:damped'),
              ('A three-dimensional wave equation problem',
               2,
               None,
               '___sec133'),
              ('The diffusion equation',
               1,
               'sec:scale:diffu',
               'sec:scale:diffu'),
              ('Homogeneous 1D diffusion equation',
               2,
               'sec:scale:diffu:homo1D',
               'sec:scale:diffu:homo1D'),
              ('Generalized diffusion PDE', 2, None, '___sec136'),
              ('Jump boundary condition', 2, None, '___sec137'),
              ('Oscillating Dirichlet condition', 2, None, '___sec138'),
              ('Scaling', 3, None, '___sec139'),
              ('Reaction-diffusion equations',
               1,
               'sec:scale:diffu:Fisher',
               'sec:scale:diffu:Fisher'),
              ("Fisher's equation", 2, None, '___sec141'),
              ('Balance of all terms', 3, None, '___sec142'),
              ('Fixed length scale', 3, None, '___sec143'),
              ('Nonlinear reaction-diffusion PDE', 2, None, '___sec144'),
              ('The convection-diffusion equation',
               1,
               'scale:convdiff',
               'scale:convdiff'),
              ('Convection-diffusion without a force term',
               2,
               None,
               '___sec146'),
              ('Stationary PDE', 2, None, '___sec147'),
              ('Convection-diffusion with a source term',
               2,
               'scale:convdiff:f',
               'scale:convdiff:f'),
              ('Exercises', 1, None, '___sec149'),
              ('Problem 19: Stationary Couette flow',
               2,
               'scale:vib:exer:stationary_Couette',
               'scale:vib:exer:stationary_Couette'),
              ('Remarks', 3, None, '___sec151'),
              ('Exercise 20: Couette-Poiseuille flow',
               2,
               'scale:vib:exer:Couette_wpressure',
               'scale:vib:exer:Couette_wpressure'),
              ('Exercise 21: Pulsatile pipeflow',
               2,
               'scale:exer:pipeflow:pulsatile',
               'scale:exer:pipeflow:pulsatile'),
              ('Exercise 22: The linear cable equation',
               2,
               'scale:exer:cable_eq',
               'scale:exer:cable_eq'),
              ('Exercise 23: Heat conduction with discontinuous initial condition',
               2,
               'scale:exer:twometal',
               'scale:exer:twometal'),
              ('Advanced PDE models', 0, None, '___sec156'),
              ('The equations of linear elasticity',
               1,
               'scale:elasticity',
               'scale:elasticity'),
              ('The general time-dependent elasticity problem',
               2,
               'scale:elasticity:timedep',
               'scale:elasticity:timedep'),
              ('Software', 3, None, '___sec159'),
              ('Dimensionless stress tensor',
               2,
               'scale:elasticity:PDE1:stress',
               'scale:elasticity:PDE1:stress'),
              ('When can the acceleration term be neglected?',
               2,
               'scale:elasticity:waves',
               'scale:elasticity:waves'),
              ('S waves', 3, None, '___sec162'),
              ('P waves', 3, None, '___sec163'),
              ('Time-varying load', 3, None, '___sec164'),
              ('The stationary elasticity problem',
               2,
               'scale:elasticity:stationary',
               'scale:elasticity:stationary'),
              ('Scaling of the PDE', 3, None, '___sec166'),
              ('Scaling of displacement boundary conditions',
               3,
               None,
               '___sec167'),
              ('Scaling of traction boundary conditions',
               3,
               None,
               '___sec168'),
              ('Quasi-static thermo-elasticity',
               2,
               'scale:elasticity:thermo',
               'scale:elasticity:thermo'),
              ('The Navier-Stokes equations',
               1,
               'sec:scale:ns',
               'sec:scale:ns'),
              ('The momentum equation without body forces',
               2,
               None,
               '___sec171'),
              ('Scaling', 3, None, '___sec172'),
              ('Dimensonless PDEs and the Reynolds number',
               3,
               None,
               '___sec173'),
              ('Scaling of time for low Reynolds numbers',
               2,
               None,
               '___sec174'),
              ('Shear stress as pressure scale', 2, None, '___sec175'),
              ('Gravity force and the Froude number', 2, None, '___sec176'),
              ('Oscillating boundary conditions and the Strouhal number',
               2,
               None,
               '___sec177'),
              ('Cavitation and the Euler number', 2, None, '___sec178'),
              ('Free surface conditions and the Weber number',
               2,
               'freesurface:Weber',
               'freesurface:Weber'),
              ('Thermal convection', 1, None, '___sec180'),
              ('Forced convection', 2, None, '___sec181'),
              ('Free convection',
               2,
               'scale:fluid:forced_convection',
               'scale:fluid:forced_convection'),
              ('Governing equations', 3, None, '___sec183'),
              ('Heating by viscous effects', 3, None, '___sec184'),
              ('Relation between density and temperature',
               3,
               None,
               '___sec185'),
              ('The Boussinesq approximation', 3, None, '___sec186'),
              ('Scaling', 3, None, '___sec187'),
              ('The Grashof, Prandtl, and Eckert numbers',
               2,
               None,
               '___sec188'),
              ('Interpretations of the Grashof number', 3, None, '___sec189'),
              ('Heat transfer at boundaries and the Nusselt number',
               2,
               None,
               '___sec190'),
              ('The bidomain model in electrophysiology',
               1,
               'scale:bidomain',
               'scale:bidomain'),
              ('The bidomain model with an alternative $I_{\\rm{ion}}$',
               2,
               None,
               '___sec192'),
              ('Two-phase porous media flow', 1, None, '___sec193'),
              ('Compressible gas dynamics',
               1,
               'scale:gasdyn',
               'scale:gasdyn'),
              ('The Euler equations of gas dynamics',
               2,
               'scale:Euler_eqs',
               'scale:Euler_eqs'),
              ('General isentropic flow', 2, None, '___sec196'),
              ('Elimination of the pressure', 3, None, '___sec197'),
              ('The acoustic approximation for sound waves',
               2,
               'scale:gas:acoustic',
               'scale:gas:acoustic'),
              ('Wave nature of isentropic flow with small perturbations',
               3,
               None,
               '___sec199'),
              ('Basic scaling for small wave perturbations',
               3,
               None,
               '___sec200'),
              ('Surface gravity waves',
               1,
               'scale:surfacewaves',
               'scale:surfacewaves'),
              ('Equations for surface waves',
               2,
               'scale:surfacewaves:Eulereq',
               'scale:surfacewaves:Eulereq'),
              ('Waves in deep  water', 3, None, '___sec203'),
              ('Long waves in shallow water', 3, None, '___sec204'),
              ('Exercises', 1, None, '___sec205'),
              ('Exercise 24: Comparison of vibration models for elastic structures',
               2,
               'scale::exer:elasticity:vibmodels',
               'scale::exer:elasticity:vibmodels'),
              ('Exercise 25: A model for quasi-static poro-elasticity',
               2,
               'scale:exer:poroelasticity',
               'scale:exer:poroelasticity'),
              ('Problem 26: Starting Couette flow',
               2,
               'scale:vib:exer:starting_Couette',
               'scale:vib:exer:starting_Couette'),
              ('References', 1, None, '___sec209')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\half}{\frac{1}{2}}
\newcommand{\tp}{\thinspace .}
\newcommand{\uex}{{u_{\small\mbox{e}}}}
\newcommand{\normalvec}{\boldsymbol{n}}
\newcommand{\x}{\boldsymbol{x}}
\renewcommand{\u}{\boldsymbol{u}}
\renewcommand{\v}{\boldsymbol{v}}
\newcommand{\w}{\boldsymbol{w}}
\newcommand{\rpos}{\boldsymbol{r}}
\newcommand{\f}{\boldsymbol{f}}
\newcommand{\F}{\boldsymbol{F}}
\newcommand{\stress}{\boldsymbol{\sigma}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\U}{\boldsymbol{U}}
\newcommand{\dfc}{\alpha}  % diffusion coefficient
\newcommand{\ii}{\boldsymbol{i}}
\newcommand{\jj}{\boldsymbol{j}}
\newcommand{\kk}{\boldsymbol{k}}
\newcommand{\ir}{\boldsymbol{i}_r}
\newcommand{\ith}{\boldsymbol{i}_{\theta}}
$$




    
<a name="part0006"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._scaling-book-solarized005.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._scaling-book-solarized007.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- !split -->

<h1 id="sec:scale:vib">Vibration problems</h1>

<p>
We shall in this section
address a range of different second-order ODEs for mechanical
vibrations and demonstrate how to reason about the scaling in
different physical scenarios.

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 7</b>: Include more figures.)</font>
<!-- end inline comment -->

<h2 id="sec:scale:vib:undamped">Undamped vibrations without forcing</h2>

<p>
The simplest differential equation model for mechanical vibrations
reads

$$
\begin{equation}
mu'' + ku = 0,\quad u(0)=I,\ u'(0)=V\tp
\tag{63}
\end{equation}
$$

This is a common model for a vibrating body  with mass \( m \) attached
to a linear spring with spring constant \( k \) (and force \( -ku \)).
The quantity \( u(t) \) measures the displacement of the body.
Figure <a href="#sec:scale:vib:undamped:sketch">7</a> shows a typical mechanical
sketch of such a system: some mass can move horizontally without friction
and is connected to a spring that exerts a force \( -ku \) on the body.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 7:  Oscillating body attached to a spring. <div id="sec:scale:vib:undamped:sketch"></div> </p></center>
<p><img src="fig-scaling/oscillator_spring.png" align="bottom" width=500></p>
</center>

<h3 id="___sec66">The first technical steps of scaling </h3>

<p>
The problem <a href="#mjx-eqn-63">(63)</a> has one independent
variable \( t \) and one dependent variable \( u \). We introduce dimensionless
versions of these variables:

$$ \bar u =\frac{u}{u_c},\quad\bar t = \frac{t}{t_c},$$

where \( u_c \) and \( t_c \) are characteristic values of \( u \) and \( t \).
Inserted in <a href="#mjx-eqn-63">(63)</a>, we get

$$ m\frac{u_c}{t_c^2}\frac{d^2\bar u}{d\bar t^2} + ku_c\bar u = 0,
\quad u_c\bar u(0)=I,\quad \frac{u_c}{t_c}\frac{d\bar u}{d\bar t}(0)=V,$$

resulting in

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c^2 k}{m}\bar u = 0,
\quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}\tp
\tag{64}
\end{equation}
$$

<p>
What is an appropriate displacement scale \( u_c \)? The initial condition
\( u(0)=I \) is a candidate, i.e., \( u_c=I \). But how to choose the time scale?
Making the coefficient in front of the \( \bar u \) unity, such that
both terms balance and are of size unity, is a candidate.

<h3 id="___sec67">The exact solution </h3>

<p>
To better see what the proper scales of \( u \) and \( t \) are, we can look
into the analytical solution of this problem.
Although the exact solution of
<a href="#mjx-eqn-63">(63)</a> is quite straightforward to calculate
by hand, we take the opportunity to make use of SymPy to
find \( u(t) \). The use of SymPy can later be generalized to vibration
ODEs that are harder to solve by hand.

<p>
SymPy need all mathematical symbols to be explicitly created:

<p>
<!-- begin verbatim block  pypro-->
<pre><code>from sympy import *
u = symbols('u', cls=Function)
w = symbols('w', real=True, positive=True)
I, V, C1, C2 = symbols('I V C1 C2', real=True)
</code></pre>
<!-- end verbatim block -->
To specify the ODE to be solved, we can make a Python function returning
all the terms in the ODE:

<p>
<!-- begin verbatim block  pycod-->
<pre><code># Define differential equation: u'' + w**2*u = 0
def ode(u):
    return diff(u, t, t) + w**2*u

diffeq = ode(u(t))
</code></pre>
<!-- end verbatim block -->
The <code>diffeq</code> variable, defining the ODE, can be passed to a SymPy
function <code>dsolve</code> to find the symbolic solution of the ODE:

<p>
<!-- begin verbatim block  pycod-->
<pre><code>s = dsolve(diffeq, u(t))
# s is an u(t) == expression (Eq obj.), s.rhs grabs the expression
u_sol = s.rhs
print u_sol
</code></pre>
<!-- end verbatim block -->
The solution that gets printed is <code>C1*sin(t*w) + C2*cos(t*w)</code>, indicating
that there are two integration constants <code>C1</code> and <code>C2</code> to be determined
by the initial conditions. The result of applying these conditions is
a \( 2\times 2 \) linear system of algebraic equations that SymPy can solve
by the <code>solve</code> function. The code goes as follows:

<p>
<!-- begin verbatim block  pycod-->
<pre><code># The solution u_sol contains integration constants C1 and C2
# but these are not symbols, substitute them by symbols
u_sol = u_sol.subs('C1', C1).subs('C2', C2)

# Determine C1 and C2 from the initial conditions
ic = [u_sol.subs(t, 0) - I, u_sol.diff(t).subs(t, 0) - V]
print ic   # 2x2 algebraic system for C1 and C2
s = solve(ic, [C1, C2])
# s is now a dictionary: {C2: I, C1: V/w}
# substitute solution back in u_sol
u_sol = u_sol.subs(C1, s[C1]).subs(C2, s[C2])
print u_sol
</code></pre>
<!-- end verbatim block -->
The <code>u_sol</code> variable is now <code>I*cos(t*w) + V*sin(t*w)/w</code>.
Since symbolic software is far from bug-free and can give wrong results,
we should always check the answer. Here, we insert the solution in the ODE
to see if the result is zero, and we insert the solution in the initial
conditions to see that these are fulfilled:

<p>
<!-- begin verbatim block  pycod-->
<pre><code># Check that the solution fulfills the ODE and init.cond.
print simplify(ode(u_sol)),
print u_sol.subs(t, 0) - I, diff(u_sol, t).subs(t, 0) - V
</code></pre>
<!-- end verbatim block -->
There will be many more examples on using SymPy to find exact solutions
of differential equation problems.

<p>
The solution of the ODE in mathematical notation is

$$ u(t) = I\cos(\omega t) + \frac{V}{\omega}\sin(\omega t),\quad \omega = \sqrt{\frac{k}{m}}\tp$$

More insight arises from rewriting such an expression in the form
\( A\cos(wt - \phi) \):

$$ u(t) = \sqrt{I^2 + \frac{V^2}{\omega^2}}\cos(wt - \phi),\quad
\phi = \tan^{-1}(V/(\omega I))\tp
$$

Now we see that the \( u \) corresponds to cosine oscillations with a
phase shift \( \phi \) and amplitude \( \sqrt{I^2 + (V/\omega)^2} \).

<h3 id="___sec68">Discussion of the displacement scale </h3>

<p>
The amplitude of \( u \) is \( \sqrt{I^2 + V^2/\omega^2} \), and this
expression is obviously a candidate for \( u_c \).  However, the simpler
choice \( u_c=\max (I, V/\omega) \) is also relevant and more attractive
than the square root expression (but potentially a factor 1.4 wrong
compared to the exact amplitude).  It is not very important to have
\( |u|\leq 1 \), the point is to avoid \( |u| \) very small or large.

<h3 id="___sec69">Discussion of the time scale </h3>

<p>
What is an appropriate time scale? Looking at
<a href="#mjx-eqn-64">(64)</a> and arguing that
\( \bar u'' \) and \( \bar u \) both should be around unity in size, the
coefficient \( t_c^2k/m \) must equal unity, implying that \( t_c=\sqrt{m/k} \).
Also from the analytical solution we see that the solution goes like the
sine or cosine of \( \omega t \) so \( 1/\omega = \sqrt{m/k} \) can be a characteristic
time scale. Likewise, one period of the oscillations, \( P=2\pi/\omega \) can
be the characteristic time, leading to \( t_c=2\pi/\omega \).

<h3 id="___sec70">The dimensionless solution </h3>

<p>
With \( u_c=I \) and \( t_c=\sqrt{m/k} \) we get the scaled model

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \bar u = 0,
\quad \bar u(0)=1,\ \bar u'(0)=\alpha,
\tag{65}
\end{equation}
$$

where \( \alpha \) is a dimensionless parameter:

$$ \alpha = \frac{V}{I}\sqrt{\frac{m}{k}}\tp$$

Note that in case \( V=0 \), we have &quot;scaled away&quot; all physical parameters.
The universal solution without physical parameters is then
\( \bar u(\bar t)=\cos\bar t \).

<p>
The unscaled solution is recovered as

$$
\begin{equation}
u(t) = I\bar u(\sqrt{k/m}\bar t)\tp
\tag{66}
\end{equation}
$$

This expressions shows that the scaling is simply a matter of
<em>stretching or shrinking the axes</em>.

<h3 id="___sec71">Alternative displacement scale </h3>

<p>
Using \( u_c = V/\omega \), the equation
is not changed, but the initial conditions become

$$ \bar u(0) = \frac{I}{u_c} = \frac{I\omega}{V} =\frac{I}{V}\sqrt{\frac{k}{m}} = \alpha^{-1},\quad \bar u'(0)=1\tp$$

<p>
With \( u_c=V/\omega \) and one period as time scale,
\( t_c=2\pi\sqrt{m/k} \),
we get the alternative model

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + 4\pi^2 \bar u = 0,
\quad \bar u(0)=\alpha^{-1},\ \bar u'(0)=2\pi\tp
\tag{67}
\end{equation}
$$

The unscaled solution is in this case recovered by

$$
\begin{equation}
u(t) = V\sqrt{\frac{m}{k}}\bar u(2\pi\sqrt{k/m}\bar t)\tp
\tag{68}
\end{equation}
$$

<h3 id="___sec72">About frequency and dimensions </h3>

<p>
The solution goes like \( \cos\omega t \), where \( \omega =\sqrt{m/k} \)
must have dimension 1/s. Actually, \( \omega \) has dimension <em>radians
per second</em>: rad/s. A radian is dimensionless since it is arc (length)
divided by radius (length), but still regarded as a unit.
The period \( P \) of vibrations is a more intuitive quantity than the frequency
\( \omega \). The relation between \( P \) and \( \omega \) is \( P=2\pi/\omega \).
The number of oscillation cycles per period, \( f \), is a more intuitive
measurement of frequency and also known as <em>frequency</em>. Therefore, to be
precise, \( \omega \) should be named <em>angular frequency</em>. The relation between
\( f \) and \( T \) is \( f=1/T \), so \( f=2\pi\omega \) and measured in Hz (1/s), which is
the unit for counts per unit time.

<h2 id="sec:scale:vib:undamped:mg">Undamped vibrations with constant forcing</h2>

<p>
For vertical vibrations in the gravity field, the model
<a href="#mjx-eqn-63">(63)</a> must also take the gravity force
\( -mg \) into account:

$$ mu'' + ku = -mg\tp$$

How does the new term \( -mg \) influence
the scaling? We observe that if there is no movement of the body,
\( u''=0 \), and the spring elongation matches the gravity force:
\( ku = -mg \), leading to a steady displacement \( u=-mg/k \). We can then
have oscillations around this equilibrium point. A natural scaling
for \( u \) is therefore

$$ \bar u = \frac{u - (-mg/k)}{u_c}=\frac{uk + mg}{ku_c}\tp$$

<!-- u = - mg/k + u_c\bar u -->
The scaled differential equation with the same time scale as before
reads

$$ \frac{d^2\bar u}{d\bar t^2} + \bar u - \frac{t_c^2}{u_c}g
= -\frac{t_c^2}{u_c}g,$$

leading to

$$ \frac{d^2\bar u}{d\bar t^2} + \bar u = 0\tp$$

The initial conditions \( u(0)=I \) and \( u'(0)=V \) become, with \( u_c=I \),

$$ \bar u(0) = 1 + \frac{mg}{kI},\quad \frac{d\bar u}{d\bar t}(0)=\sqrt{\frac{m}{k}}\frac{V}{I}\tp$$

We see that the oscillations around the equilibrium point in the
gravity field are identical to the horizontal oscillations without
gravity, except for an offset \( mg/(kI) \) in the displacement.

<h2 id="sec:scale:vib:undamped:F">Undamped vibrations with time-dependent forcing</h2>

<p>
Now we add a transient forcing term \( F(t) \) to the model
<a href="#mjx-eqn-63">(63)</a>:

$$
\begin{equation}
mu'' + ku = F(t),\quad u(0)=I,\ u'(0)=V\tp
\tag{69}
\end{equation}
$$

Take the forcing to be oscillating:

$$ F(t) = A\cos(\psi t)\tp$$

The technical steps of the scaling are still the same, with the
intermediate result

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c^2 k}{m}\bar u =
\frac{t_c^2}{mu_c}A\cos(\psi t_c\bar t),
\quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}\tp
\tag{70}
\end{equation}
$$

What are typical displacement and time scales? This is not so obvious
without knowing the details of the solution, because there are
three parameters (\( I \), \( V \), and \( A \)) that influence the magnitude of \( u \).
Moreover, there are two time scales, one for the free vibrations of
the systems and one for the forced vibrations \( F(t) \).

<h3 id="___sec75">Investigating scales via analytical solutions </h3>

<p>
We may look into the exact solution to see what the scales are.  We
continue the SymPy session from the previous section and perform much
of the same steps. Note that we use <code>w</code> for \( \omega = \sqrt{k/m} \)
in the computer code (to obtain a more direct visual counterpart to
\( \omega \)).
SymPy may get confused when coefficients in differential equations
contain several symbols. We therefore rewrite the equation with
at most one symbol in each coefficient.
The amplitude \( A/m \) in the forcing term is of this reason
replaced by the symbol <code>A1</code>.

<p>
<!-- begin verbatim block  pycod-->
<pre><code>A, A1, m, psi = symbols('A A1 m psi', positive=True, real=True)
def ode(u):
    return diff(u, t, t) + w**2*u - A1*cos(psi*t)

diffeq = ode(u(t))
u_sol = dsolve(diffeq, u(t))
u_sol = u_sol.rhs

# Determine the constants C1 and C2 in u_sol
# (first substitute our own declared C1 and C2 symbols,
# then use the initial conditions)
u_sol = u_sol.subs('C1', C1).subs('C2', C2)
eqs = [u_sol.subs(t, 0) - I, u_sol.diff(t).subs(t, 0) - V]
s = solve(eqs, [C1, C2])
u_sol = u_sol.subs(C1, s[C1]).subs(C2, s[C2])

# Check that the solution fulfills the equation and init.cond.
print simplify(ode(u_sol))
print simplify(u_sol.subs(t, 0) - I)
print simplify(diff(u_sol, t).subs(t, 0) - V)

u_sol = simplify(expand(u_sol.subs(A1, A/m)))
print u_sol
</code></pre>
<!-- end verbatim block -->
The output from the last line is

<p>
<!-- begin verbatim block -->
<pre><code>A/m*cos(psi*t)/(-psi**2 + w**2) + V*sin(t*w)/w +
(A/m + I*psi**2 - I*w**2)*cos(t*w)/(psi**2 - w**2)
</code></pre>
<!-- end verbatim block -->
With a bit of rewrite this expression becomes

<p>
<!-- Note that the solution becomes a bit simpler of F is cos rather than sin -->

$$ u(t) = \frac{A/m}{\omega^2 - \psi^2}\cos(\psi t) + \frac{V}{\omega}
   \sin(\omega t) +
\left(\frac{A/m}{\psi^2 - \omega^2} + I\right) \cos (\omega t)\tp
$$

Obviously, this expression is only meaningful for \( \psi\neq\omega \). The
case \( \psi = \omega \) gives an infinite amplitude in this model, a
phenomenon known as resonance. The amplitude becomes finite when
damping is included,
see the section <a href="#sec:scale:vib:damped:F">Damped vibrations with forcing</a>.

<p>
For the case the system starts from rest, \( I=V=0 \), and the
forcing is the only driving mechanism, we can simplify:

$$
\begin{align*}
u(t) &= \frac{A}{m(\omega^2 - \psi^2)}\cos(\psi t)
+
\frac{A}{m(\psi^2 - \omega^2)}\cos (\omega t)\\ 
&= \frac{A}{m(\omega^2 - \psi^2)}(\cos(\psi t) - \cos(\omega t))\tp
\end{align*}
$$

To gain more insight, \( \cos(\psi t) - \cos(\omega t) \) can be
rewritten in terms of the mean frequency \( (\psi + \omega)/2 \) and
the difference in frequency \( (\psi - \omega)/2 \):

$$
\begin{equation}
u(t) = \frac{A}{m(\omega^2 - \psi^2)} 2
\sin\left(\frac{\psi - \omega}{2}t\right)
\sin\left(\frac{\psi + \omega}{2}t\right),
\tag{71}
\end{equation}
$$

showing that there is a signal with frequency \( (\psi + \omega)/2 \)
whose amplitude has a (much) slower frequency
\( (\psi - \omega)/2 \). Figure <a href="#sec:scale:vib:fig:envelope">8</a> shows
an example on such a signal.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 8:  Signal with frequency 3.1 and envelope frequency 0.2. <div id="sec:scale:vib:fig:envelope"></div> </p></center>
<p><img src="fig-scaling/envelope.png" align="bottom" width=600></p>
</center>

<h3 id="___sec76">The displacement and time scales </h3>

<p>
A characteristic displacement can in the latter special case
be taken as \( u_c= A/(m(\omega^2 - \psi^2)) \). This is also a relevant choice
in the more general case \( I\neq0, V\neq 0 \), unless \( I \) or \( V \)
is so large that it dominates over the amplitude
caused by the forcing. With \( u_c= A/(m(\omega^2 - \psi^2)) \) we also
have three special cases: \( \omega \ll \psi \), \( \omega \gg\psi \), and
\( \psi \sim \omega \). In the latter case we need
\( u_c= A/(m(\omega^2 - \psi^2)) \) if we want \( |u|\leq 1 \). When
\( \omega \) and \( \psi \) are significantly different, we may choose one
of them and neglect the smaller. Choosing \( \omega \) means \( u_c=A/k \),
which is the relevant scale
if \( \omega\gg\psi \). In the opposite case, \( \omega\ll\psi \),
\( u_c=A/(m\psi^2) \).

<p>
The time scale is dominated by the fastest oscillations, which are
of frequency \( \psi \) or \( \omega \) when these are close and the largest
of them when they are distant. In any case, we set
\( t_c=1/\max(\psi,\omega) \).

<h3 id="___sec77">Finding the displacement scale from the differential equation </h3>

<p>
Going back to <a href="#mjx-eqn-70">(70)</a>, we
may demand that all the three terms in the differential equation
are of size unity. This leads to \( t_c=\sqrt{m/k} \)
and \( u_c=At_c^2/m = A/k \). The formula for \( u_c \) is a kind of measure
of the ratio of the
forcing and the spring force (the dimensionless number
\( A/(ku_c) \) would be this ratio).

<p>
Looking at <a href="#mjx-eqn-71">(71)</a>, we see
that if \( \psi\ll\omega \), the amplitude can be approximated
by \( A/(m\omega^2)=A/k \), showing that the scale \( u_c=A/k \) is
relevant for small excitation frequency \( \psi \) compared to
the free vibration frequency \( \omega \).

<h3 id="___sec78">Scaling with free vibrations as time scale </h3>

<p>
The next step is to work out the dimensionless ODE for the chosen scales.
We first select the time scale based on the free oscillations
with frequency \( \omega \), i.e., \( t_c=1/\omega \). Inserting the expression in
<a href="#mjx-eqn-70">(70)</a> results in

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \bar u =
\gamma
\cos(\delta\bar t),
\quad \bar u(0)=\alpha,\ \bar u'(0)=\beta\tp
\tag{72}
\end{equation}
$$

Here we have four dimensionless variables

$$
\begin{align}
\alpha &= \frac{I}{u_c},
\tag{73}\\ 
\beta  &= \frac{Vt_c}{u_c} = \frac{V}{\omega u_c},
\tag{74}\\ 
\gamma &= \frac{t_c^2 A}{mu_c} = \frac{A}{ku_c},
\tag{75}\\ 
\delta &= \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega}\tp
\tag{76}
\end{align}
$$

We remark that the choice of \( u_c \) has so far not been made. Several
different cases will be considered below, and certain choices reduce
the number of independent dimensionless variables to three.

<p>

<!-- begin inline comment -->
<font color="red">(<b>hpl 8</b>: New comment in the paragraph above.)</font>
<!-- end inline comment -->

<p>
The four dimensionless variables above have interpretations as ratios of
physical effects:

<ul>
 <li> \( \alpha \): ratio of the initial displacement and
   the characteristic response \( u_c \),</li>
 <li> \( \beta \): ratio of the initial velocity
   and the typical velocity measure \( u_c/t_c \),</li>
 <li> \( \gamma \): ratio of
   the forcing \( A \) and the mass times acceleration \( mu_c/t_c^2 \) <em>or</em>
   the ratio of the forcing and the spring force \( ku_c \)</li>
 <li> \( \delta \): ratio of the
   frequencies or the time scales of the forcing and the free vibrations.</li>
</ul>

<h3 id="___sec79">Software </h3>

<p>
Any solver for <a href="#mjx-eqn-70">(70)</a>
can be used for <a href="#mjx-eqn-72">(72)</a>.
More details are provided at the end of
the section <a href="#sec:scale:vib:damped:F">Damped vibrations with forcing</a>.

<h3 id="___sec80">Choice of \( u_c \) close to resonance </h3>

<p>
Now we shall discuss various choices of \( u_c \).
Close to resonance, when \( \psi\sim\omega \), we may set
\( u_c=A/(m(\omega^2 - \psi^2)) \). The dimensionless numbers
become in this case

$$
\begin{align*}
\alpha &= \frac{I}{u_c} = \frac{I}{A/k}(1-\delta^2),\\ 
\beta  &= \frac{V}{\omega u_c} = \frac{V\sqrt{km}}{A}(1-\delta^2),\\ 
\gamma &= \frac{A}{ku_c} = 1-\delta^2,\\ 
\delta &= \frac{\psi}{\omega}\tp
\end{align*}
$$

With \( \psi = 0.99\omega \), \( \delta =0.99 \), \( V=0 \),
\( \alpha = \gamma = 1-\delta^2 = 0.02 \), we have the problem

$$
\frac{d^2\bar u}{d\bar t^2} + \bar u =
0.02 \cos(0.99\bar t),
\quad \bar u(0)=0.02,\ \bar u'(0)=0\tp
$$

This is a problem with a very small initial condition and a very small
forcing, but the state close to resonance brings the amplitude up to
about unity, see the result of numerical simulations with \( \delta=0.99 \) in
Figure <a href="#sec:scale:vib:fig:Fcos_b0:1">9</a>.
Neglecting \( \alpha \),
the solution is given by <a href="#mjx-eqn-71">(71)</a>,
which here means \( A=1-\delta^2 \), \( m=1 \), \( \omega=1 \), \( \psi=\delta \):

$$ \bar u(\bar t) = 2\sin(-0.005\bar t)\sin(0.995\bar t)\tp $$

Note that this is a problem which demands very high accuracy in the
numerical calculations. Using 20 time steps per period gives a
significant angular frequency error and an amplitude of about 1.4. We used
160 steps per period for the results in
Figure <a href="#sec:scale:vib:fig:Fcos_b0:1">9</a>.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 9:  Forced undamped vibrations close to resonance. <div id="sec:scale:vib:fig:Fcos_b0:1"></div> </p></center>
<p><img src="fig-scaling/vib_delta099_b0_Fcos.png" align="bottom" width=600></p>
</center>

<h3 id="___sec81">Unit size of all terms in the ODE </h3>

<p>
Using the displacement scale \( u_c=A/k \) leads to
<a href="#mjx-eqn-72">(72)</a> with

$$
\begin{align*}
\alpha &= \frac{I}{u_c} = \frac{I}{A/k},\\ 
\beta  &= \frac{V}{\omega u_c} = \frac{V k}{A\omega},\\ 
\gamma &= \frac{A}{ku_c} = 1,\\ 
\delta &= \frac{\psi}{\omega}\tp
\end{align*}
$$

Simulating a case with \( \delta=0.5 \), \( \alpha=1 \), and \( \beta=0 \) gives
the oscillations in Figure <a href="#sec:scale:vib:fig:Fcos_b0:2">10</a>, which is
a case away from resonance, and the amplitude is about unity. However,
choosing \( \delta =0.99 \) (close to resonance) results in a figure
similar to Figure <a href="#sec:scale:vib:fig:Fcos_b0:1">9</a>, except that the
amplitude is about \( 10^2 \) because of the moderate size of \( u_c \).
The present scaling is therefore most suitable away from resonance,
and when the terms containing \( \cos\omega t \) and \( \sin\omega t \)
are important (e.g., \( \omega\gg\psi \)).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 10:  Forced undamped vibrations away from resonance. <div id="sec:scale:vib:fig:Fcos_b0:2"></div> </p></center>
<p><img src="fig-scaling/vib_delta05_b0_Fcos.png" align="bottom" width=600></p>
</center>

<h3 id="___sec82">Choice of \( u_c \) when \( \psi\gg\omega \) </h3>

<p>
Finally, we may look at the case where \( \psi\gg\omega \) such that
\( u_c=A/(m\psi^2) \) is a relevant scale (i.e., omitting \( \omega^2 \) compared to
\( \psi^2 \) in the denominator), but in this case we should
use \( t_c=1/\psi \) since the force varies much faster than the
free vibrations of the system.
This choice of \( t_c \) changes the scaled ODE to

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \delta^{-2}\bar u =
\gamma
\cos(\bar t),
\quad \bar u(0)=\alpha,\ \bar u'(0)=\beta,
\tag{77}
\end{equation}
$$

where

$$
\begin{align*}
\alpha &= \frac{I}{u_c} = \frac{I}{A/k}\delta^2,\\ 
\beta  &= \frac{Vt_c}{u_c} = \frac{V\sqrt{km}}{A}\delta,\\ 
\gamma &= \frac{t_c^2 A}{mu_c} = 1,\\ 
\delta &= \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega}\tp
\end{align*}
$$

In the regime \( \psi\gg\omega \), \( \delta\gg 1 \), thus making \( \alpha \) and
\( \beta \) large.
However, if \( \alpha \) and/or \( \beta \) is large,
the initial condition dominates over the forcing, and will also dominate
the amplitude of \( u \), thereby making the scaling of \( u \) inappropriate.
In case \( I=V=0 \) so that \( \alpha=\beta=0 \),
<a href="#mjx-eqn-71">(71)</a> predicts
(\( A=m=1 \), \( \omega=\delta^{-1} \), \( \psi=1 \))

$$ \bar u(\bar t) = (\delta^{-2}-1)^{-1}2
\sin\left(\frac{1}{2}(1 -\delta^{-1})\bar t\right)
\sin\left(\frac{1}{2}(1 +\delta^{-1})\bar t\right),
$$

which has an amplitude about \( 2 \) for \( \delta\gg 1 \).
Figure <a href="#sec:scale:vib:fig:Fcos_b0:3">11</a> shows a case.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 11:  Forced undamped vibrations with rapid forcing. <div id="sec:scale:vib:fig:Fcos_b0:3"></div> </p></center>
<p><img src="fig-scaling/vib_delta10_b0_Fcos.png" align="bottom" width=600></p>
</center>

<p>
With \( \alpha=0.05\delta^2=5 \), we get a significant contribution from
the free vibrations (the homogeneous solution of the ODE) as
shown in Figure <a href="#sec:scale:vib:fig:Fcos_b0:4">12</a>. For larger \( \alpha \)
values, one must base \( u_c \) on \( I \) instead.
(The graphs in Figure <a href="#sec:scale:vib:fig:Fcos_b0:3">11</a> and
<a href="#sec:scale:vib:fig:Fcos_b0:4">12</a> were
produced by
numerical simulations with 160 time steps per period of the forcing.)

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 12:  Forced undamped vibrations with rapid forcing and initial displacement of 5. <div id="sec:scale:vib:fig:Fcos_b0:4"></div> </p></center>
<p><img src="fig-scaling/vib_delta10_b0_a5_Fcos.png" align="bottom" width=600></p>
</center>

<h3 id="___sec83">Displacement scale based on \( I \) </h3>

<p>
Choosing \( u_c=I \) gives

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \bar u =
\gamma\cos(\delta\bar t),
\quad \bar u(0)=1,\ \bar u'(0)=\beta,
\tag{78}
\end{equation}
$$

with

$$
\begin{align}
\beta  &= \frac{Vt_c}{u_c} = \frac{V}{I}\sqrt{\frac{m}{k}},
\tag{79}\\ 
\gamma & = \frac{tc^2A}{mu_c} = \frac{A}{ku_c} = \frac{A}{kI} \tp
\tag{80}
\end{align}
$$

This scaling is not relevant close to resonance since then \( u_c\gg I \).

<h2 id="sec:scale:vib:damped:F">Damped vibrations with forcing</h2>

<p>
We now introduce a linear damping force \( bu'(t) \) in the equation of motion:

$$
\begin{equation}
mu'' + bu' + ku = A\cos(\psi t),\quad u(0)=I,\ u'(0)=V\tp
\tag{81}
\end{equation}
$$

Figure <a href="#sec:scale:vib:damped:sketch">13</a> shows a typical
one-degree-of-freedom mechanical system with a linear dashpot, representing
the damper (\( bu' \)), a linear spring (\( ku \)), and an external force (\( F \)).

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 13:  Oscillating body with external force, attached to a spring and damper. <div id="sec:scale:vib:damped:sketch"></div> </p></center>
<p><img src="fig-scaling/oscillator.png" align="bottom" width=500></p>
</center>

<p>
The standard scaling procedure results in

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + \frac{t_c b}{m}\frac{d\bar u}{d\bar t}
+ \frac{t_c^2 k}{m}\bar u =
\frac{t_c^2}{mu_c}A\cos(\psi t_c\bar t),
\quad \bar u(0)=\frac{I}{u_c},\ \bar u'(0)=\frac{Vt_c}{u_c}\tp
\tag{82}
\end{equation}
$$

<h3 id="___sec85">The exact solution </h3>

<p>
To choose scales, it is (as always)
a great advantage to look into exact solutions.
Using SymPy to solve <a href="#mjx-eqn-81">(81)</a> is, in principle,
very straightforward:

<p>
<!-- begin verbatim block  pyshell-->
<pre><code>&gt;&gt;&gt; diffeq = diff(u(t), t, t) + b/m*diff(u(t), t) + w**2*u(t)
&gt;&gt;&gt; s = dsolve(diffeq, u(t))
&gt;&gt;&gt; s.rhs
C1*exp(t*(-b - sqrt(b - 2*m*w)*sqrt(b + 2*m*w))/(2*m)) +
C2*exp(t*(-b + sqrt(b - 2*m*w)*sqrt(b + 2*m*w))/(2*m))
</code></pre>
<!-- end verbatim block -->
This is indeed the correct solution, but it is on a complex
exponential function form, valid for all \( b \), \( m \), and \( \omega \). We are
interested in the case with <em>small damping</em>, \( b < 2m\omega \), where the solution
is an exponentially damped sinusoidal function. Rewriting the expression
in the right form is tricky with SymPy commands. Instead, we demonstrate
a common technique when doing symbolic computing: general procedures like
<code>dsolve</code> are replaced by manual steps. That is, we solve the ODE &quot;by hand&quot;,
but use SymPy to assist the calculations.

<p>
The solution is composed of a homogeneous
solution \( u_h \) of \( mu'' + bu' + ku=0 \) and one particular solution \( u_p \)
of the nonhomogeneous equation
\( mu'' + bu' + ku=A\cos(\psi t) \). The homogeneous solution with
damped oscillations (requiring \( b < 2\sqrt{mk} \)) can be
found by the following code. We have divided the differential equation
by \( m \) and introduced \( B=\frac{1}{2}b/m \) and let <code>A1</code> represent
\( A/m \) to simplify expressions and
help SymPy with less symbols in the equation. Without these simplifications,
SymPy stalls in the computations due to too many symbols in the equation.
The problem is actually a solid argument for scaling differential equations
before asking SymPy to solve them since scaling effectively reduces the
number of parameters in the equations!

<p>
The following SymPy steps derives the solution of the homogeneous ODE:

<p>
<!-- begin verbatim block  pycod-->
<pre><code>u = symbols('u', cls=Function)
t, w, B, A, A1, m, psi = symbols('t w B A A1 m psi',
                                 positive=True, real=True)

def ode(u, homogeneous=True):
    h = diff(u, t, t) + 2*B*diff(u, t) + w**2*u
    f = A1*cos(psi*t)
    return h if homogeneous else h - f

# Find coefficients in polynomial (in r) for exp(r*t) ansatz
r = symbols('r')
ansatz = exp(r*t)
poly = simplify(ode(ansatz)/ansatz)

# Convert to polynomial to extract coefficients
poly = Poly(poly, r)
# Extract coefficients in poly: a_*t**2 + b_*t + c_
a_, b_, c_ = poly.coeffs()
# Assume b_**2 - 4*a_*c_ &lt; 0
d = -b_/(2*a_)
if a_ == 1:
    omega = sqrt(c_ - (b_/2)**2)  # nicer formula
else:
    omega = sqrt(4*a_*c_ - b_**2)/(2*a_)

# The homogeneous solution is a linear combination of a
# cos term (u1) and a sin term (u2)
u1 = exp(d*t)*cos(omega*t)
u2 = exp(d*t)*sin(omega*t)
C1, C2, V, I = symbols('C1 C2 V I', real=True)
u_h = simplify(C1*u1 + C2*u2)
print 'u_h:', u_h
</code></pre>
<!-- end verbatim block -->
The print out shows

$$ u_h = e^{-Bt}\left(C_1 \cos(\sqrt{\omega^2 - B^2}t) +
C_2 \sin(\sqrt{\omega^2 - B^2}t)\right),$$

where \( C_1 \) and \( C_2 \) must be determined by the initial conditions later.
It is wise to check that \( u_h \) is indeed a solution of the homogeneous
differential equation:

<p>
<!-- begin verbatim block  pycod-->
<pre><code>assert simplify(ode(u_h)) == 0
</code></pre>
<!-- end verbatim block -->
We have previously just printed the residuals of the ODE and initial
conditions after inserting the solution, but it is better in a code to
let the programming language test that the residuals are symbolically zero.
This is achieved using the <code>assert</code> statement in Python. The argument is
a boolean expression, and if the expression evaluates to <code>False</code>,
an <code>AssertionError</code> is raised and the program aborts (otherwise <code>assert</code>
runs silently for a <code>True</code> boolean expression). Hereafter, we will use
<code>assert</code> for consistency checks in computer code.

<p>
The ansatz for the particular solution \( u_p \) is

$$ u_p= C_3\cos(\psi t) + C_4\sin(\psi t),$$

which inserted in the ODE gives two equations
for \( C_3 \) and \( C_4 \). The relevant SymPy statements are

<p>
<!-- begin verbatim block  pycod-->
<pre><code># Particular solution
C3, C4 = symbols('C3 C4')
u_p = C3*cos(psi*t) + C4*sin(psi*t)
eqs = simplify(ode(u_p, homogeneous=False))

# Collect cos(omega*t) terms
print 'eqs:', eqs
eq_cos = simplify(eqs.subs(sin(psi*t), 0).subs(cos(psi*t), 1))
eq_sin = simplify(eqs.subs(cos(psi*t), 0).subs(sin(psi*t), 1))
s = solve([eq_cos, eq_sin], [C3, C4])
u_p = simplify(u_p.subs(C3, s[C3]).subs(C4, s[C4]))

# Check that the solution is correct
assert simplify(ode(u_p, homogeneous=False)) == 0
</code></pre>
<!-- end verbatim block -->
Using the initial conditions for the complete solution \( u=u_h+u_p \)
determines \( C_1 \) and \( C_2 \):

<p>
<!-- begin verbatim block  pycod-->
<pre><code>u_sol = u_h + u_p  # total solution
# Initial conditions
eqs = [u_sol.subs(t, 0) - I, u_sol.diff(t).subs(t, 0) - V]
# Determine C1 and C2 from the initial conditions
s = solve(eqs, [C1, C2])
u_sol = u_sol.subs(C1, s[C1]).subs(C2, s[C2])
</code></pre>
<!-- end verbatim block -->
Finally, we should check that <code>u_sol</code> is indeed the correct solution:

<p>
<!-- begin verbatim block  pycod-->
<pre><code>checks = dict(
    ODE=simplify(expand(ode(u_sol, homogeneous=False))),
    IC1=simplify(u_sol.subs(t, 0) - I),
    IC2=simplify(diff(u_sol, t).subs(t, 0) - V))
for check in checks:
    msg = '%s residual: %s' % (check, checks[check])
    assert checks[check] == sympify(0), msg
</code></pre>
<!-- end verbatim block -->
Finally, we may take <code>u_sol = u_sol.subs(A, A/m)</code> to get the right
expression for the solution.
Using <code>latex(u_sol)</code> results in a huge expression, which should be
manually ordered to something like the following:

$$
\begin{align*} u = &
\frac{Am^{-1}}{4 B^{2} \psi^{2} +
\Omega^{2}} \left(2 B \psi
\sin{\left (\psi t \right )} - \Omega\cos{\left (\psi t \right )}\right) + \\ 
&
{e^{-B t}} \biggl(
C_1 \cos{\left( t \sqrt{\omega^{2}- B^{2}}\right)} +
C_2 \sin{\left (t \sqrt{\omega^{2}- B^{2}}\right )}\biggr)\\ 
C_1 &= \frac{Am^{-1} \Omega + 4 I B^{2} \psi^{2} +
I\Omega^2}{
4 B^{2} \psi^{2} + \Omega^2}\\ 
C_2 &=
\frac{- Am^{-1} B\Omega + 4 I B^{3} \psi^{2} +
I B\Omega^2 + 4 V B^{2}\psi^{2} +
V\Omega^2}{
\sqrt{\omega^{2} - B^{2}}
\left(4 B^{2} \psi^{2} + \Omega^2\right)},\\ 
\Omega &= \psi^2 - \omega^2\tp
\end{align*}
$$

<p>
The most important feature of this solution is that there are
two time scales with frequencies \( \psi \) and \( \sqrt{\omega^2 - B^2} \),
but the latter appears in terms that decay as \( e^{-Bt} \) in time.
The attention is usually on longer periods of time, so in that
case the solution simplifies to

$$
\begin{align}
u &= \frac{Am^{-1}}{4 B^{2} \psi^{2} +
\Omega^{2}} \left(2 B \psi
\sin{\left (\psi t \right )} - \Omega\cos{\left (\psi t \right )}\right)
\nonumber\\ 
&= \frac{A}{m}\frac{1}{\sqrt{4B^2\psi^2 + \Omega^2}}\cos(\psi t + \phi)
\frac{(\psi\omega)^{-1}}{(\psi\omega)^{-1}}
\nonumber\\ 
& = \frac{A}{k} Q\delta^{-1}\left(1 + Q^2(\delta - \delta^{-1})\right)^{-
\frac{1}{2}}\cos(\psi t + \phi),
\tag{83}
\end{align}
$$

where we have introduced the dimensionless numbers

$$ Q = \frac{\omega}{2B},\quad\delta = \frac{\psi}{\omega},$$

and

$$ \phi = \tan^{-1}\left(-\frac{2B}{\omega^2 - \psi^2}\right)
= \tan^{-1}\left(\frac{Q^{-1}}{\delta^2 - 1}\right)\tp$$

\( Q \) is commonly called <em>quality factor</em> and \( \phi \) is the
<em>phase shift</em>. Dividing
<a href="#mjx-eqn-83">(83)</a> by \( A/k \), which is a common
scale for \( u \), gives the dimensionless relation

$$
\begin{equation}
\frac{u}{A/k} = \frac{Q}{\delta} R(Q,\delta)^{\frac{1}{2}}\cos(\psi t + \phi),
\quad
R(Q,\delta) = \left(1 + Q^2(\delta - \delta^{-1})\right)^{-1}\tp
\tag{84}
\end{equation}
$$

<h3 id="___sec86">Choosing scales </h3>

<p>
Much of the discussion about scales in the previous sections are
relevant also when damping is included.  Although the oscillations
with frequency \( \sqrt{\omega^2-B^2} \) die out for \( t\gg B^{-1} \), we
start with using this frequency for the time scale.  A highly relevant
assumption for engineering applications of
<a href="#mjx-eqn-81">(81)</a> is that the damping is small.
Therefore, \( \sqrt{\omega^2-B^2} \) is close to \( \omega \) and we simply
apply \( t_c=1/\omega \) as before (if not the interest in large \( t \) for
which the oscillations with frequency \( \omega \) has died out).

<p>
The coefficient in front of the \( \bar u' \) term then becomes

$$ \frac{b}{m\omega} = \frac{2B}{\omega} = Q^{-1}\tp$$

The rest of the ODE is given in the previous section, and the particular
formulas depend on the choices of \( t_c \) and \( u_c \).

<h3 id="___sec87">Choice of \( u_c \) at resonance </h3>

<p>
The relevant scale for \( u_c \) at or nearby resonance (\( \psi = \omega \))
becomes different from the previous section, since with damping,
the maximum amplitude is a finite value. For \( t\gg B^{-1} \) when the
\( \sin\psi t \) term is dominating, we have for \( \psi = \omega \):

$$ u = \frac{Am^{-1}2B\psi}{4B^2\psi^2}\sin (\psi t) =
\frac{A}{2Bm\psi}\sin (\psi t) =
\frac{A}{b\psi}\sin (\psi t)
\tp
$$

This motivates the choice

$$ u_c = \frac{A}{b\psi} = \frac{A}{b\omega}\tp$$

(It is wise during computations like this to stop and check the
dimensions: \( A \) must be \( [\hbox{MLT}^{-2}] \) from the original
equation (\( F(t) \) must have the same dimension as \( mu'' \)),
\( bu' \) also has dimension \( [\hbox{MLT}^{-2}] \), implying that
\( b \) has dimension \( [\hbox{MT}^{-1}] \). \( A/b \) then has dimension
\( LT^{-1} \), and \( A/(b\psi) \) gets dimension \( [L] \), which matches
what we want for \( u_c \).)

<p>
The differential equation on dimensionless form becomes

$$
\begin{equation}
\frac{d^2\bar u}{d\bar t^2} + Q^{-1}\frac{d\bar u}{d\bar t} + \bar u =
\gamma
\cos(\delta\bar t),
\quad \bar u(0)=\alpha,\ \bar u'(0)=\beta,
\tag{85}
\end{equation}
$$

with

<p>
<!-- \frac{A}{b\omega} -->

$$
\begin{align}
\alpha &= \frac{I}{u_c} = \frac{Ib}{A}\sqrt{\frac{k}{m}},
\tag{86}\\ 
\beta  &= \frac{Vt_c}{u_c} = \frac{Vb}{A},
\tag{87}\\ 
\gamma &= \frac{t_c^2 A}{mu_c} = \frac{b\omega}{k},
\tag{88}\\ 
\delta &= \frac{t_c}{\psi^{-1}} = \frac{\psi}{\omega} = 1\tp
\tag{89}
\end{align}
$$

<h3 id="___sec88">Choice of \( u_c \) when \( \omega\gg\psi \) </h3>

<p>
In the limit \( \omega\gg\psi \) and \( t\gg B^{-1} \),

$$ u \approx \frac{A}{m\omega^2}\cos\psi t = \frac{A}{k}\cos\psi t,$$

showing that \( u_c=A/k \) is an appropriate displacement scale.
(Alternatively, we get this scale also from demanding \( \gamma=1 \) in the ODE.)
The dimensionless numbers \( \alpha \), \( \beta \), and \( \delta \) are as
for the forced vibrations without damping.

<h3 id="___sec89">Choice of \( u_c \) when \( \omega\ll\psi \) </h3>

<p>
In the limit \( \omega\ll\psi \), we should base \( t_c \) on the rapid
variations in the excitation: \( t_c=1/\psi \).

<h3 id="___sec90">Software </h3>

<p>
It is easy to reuse a solver for a general vibration problem also
in the dimensionless case.
In particular, we may use the <code>solver</code> function in the
file <a href="http://tinyurl.com/o8pb3yy/vib.py" target="_self"><tt>vib.py</tt></a>:

<p>
<!-- begin verbatim block  pycod-->
<pre><code>def solver(I, V, m, b, s, F, dt, T, damping='linear'):
</code></pre>
<!-- end verbatim block -->
for solving the ODE problem

$$ mu'' + f(u') + s(u) = F(t),\quad u(0)=I,\ u'(0)=V,\ t\in (0,T],$$

with time steps <code>dt</code>. With <code>damping='linear'</code>, we have \( f(u')=bu' \), while the
other value is <code>'quadratic'</code>, meaning \( f(u')=b|u'|u' \).
Given the dimensionless numbers \( \alpha \), \( \beta \), \( \gamma \), \( \delta \),
and \( Q \),
an appropriate call for solving <a href="#mjx-eqn-72">(72)</a> is

<p>
<!-- begin verbatim block  pycod-->
<pre><code>u, t = solver(I=alpha, V=beta, m=1, b=1.0/Q,
              s=lambda u: u, F=lambda t: gamma*cos(delta*t),
	      dt=2*pi/n, T=2*pi*P)
</code></pre>
<!-- end verbatim block -->
where <code>n</code> is the number of intervals per period and <code>P</code> is the number
of periods to be simulated.
We way wrap this call in a <code>solver_scaled</code> function and wrap it furthermore
with <code>joblib</code> to avoid repeated calls,
as we explained in
the section <a href="._scaling-book-solarized005.html#sec:scale:decay:prog">Making software for utilizing the scaled model</a>:

<p>
<!-- begin verbatim block  pycod-->
<pre><code>from vib import solver as solver_unscaled

def solver_scaled(alpha, beta, gamma, delta, Q, T, dt):
    &quot;&quot;&quot;
    Solve u'' + (1/Q)*u' + u = gamma*cos(delta*t),
    u(0)=alpha, u'(1)=beta, for (0,T] with step dt.
    &quot;&quot;&quot;
    print 'Computing the numerical solution'
    from math import cos
    return solver_unscaled(I=alpha, V=beta, m=1, b=1./Q,
                           s=lambda u: u,
                           F=lambda t: gamma*cos(delta*t),
                           dt=dt, T=T, damping='linear')

import joblib
disk_memory = joblib.Memory(cachedir='temp')
solver_scaled = disk_memory.cache(solver_scaled)
</code></pre>
<!-- end verbatim block -->
This code is found in <a href="http://tinyurl.com/o8pb3yy/vib_scaled.py" target="_self"><tt>vib_scaled.py</tt></a>
and features an application for running the scaled problem with
options on the command-line for \( \alpha \), \( \beta \), \( \gamma \), \( \delta \),
\( Q \), number of time steps per period, and number of periods (see
the <code>main</code> function). It is an ideal application for exploring
scaled vibration models.

<h2 id="___sec91">Oscillating electric circuits </h2>

<p>
The differential equation for an oscillating electric circuit is
very similar to the equation for forced, damped,
mechanical vibrations, and their
dimensionless form is identical. This fact will now be demonstrated.

<p>
The current \( I(t) \) in a
circuit with an inductor with inductance \( L \), a capacitor with
capacitance \( C \), and overall resistance \( R \), obeys the equation

$$
\begin{equation}
\ddot I + \frac{R}{L}\dot I + \frac{1}{LC}I =  V(t),
\tag{90}
\end{equation}
$$

where \( V(t) \) is the voltage source powering the circuit.
We introduce

$$ \bar I=\frac{I}{I_c},\quad \bar t = \frac{t}{t_c},$$

and get

$$ \frac{d^2\bar I}{d\bar t^2} + \frac{t_c R}{L}\frac{d\bar I}{d\bar t}
+ \frac{t_c^2}{LC}\bar I = \frac{t_c^2V_c}{I_c} \bar V(t)\tp$$

Here, we have scaled \( V(t) \) according to

$$ \bar V(\bar t) = \frac{V(t_c\bar t)}{\max_t V(t)}\tp$$

<p>
The time scale \( t_c \) is chosen to make \( \ddot I \) and \( I/(LC) \) balance,
\( t_c = \sqrt{LC} \).
Choosing \( I_c \) to make the coefficient in the source term of unit size,
means \( I_c = LCV_c \).
With

$$ Q^{-1} = R\sqrt{\frac{C}{L}},$$

we get the scaled equation

$$
\begin{equation}
\frac{d^2\bar I}{d\bar t^2} + Q^{-1}\frac{d\bar I}{d\bar t}
+ \bar I = \bar V(t),
\tag{91}
\end{equation}
$$

which is basically the same as we derived for mechanical vibrations.
(Two additional dimensionless variables will arise from the initial
conditions for \( I \), just as in the mechanics cases.)

<h1 id="___sec92">Exercises </h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:US2SI1">Exercise 1: Perform unit conversion</h2>

<p>
Density (mass per volume: \( [\hbox{ML}^{-3}] \)) of water is
given as 1.05 ounce per fluid ounce. Use the <code>PhysicalQuantity</code> object
to convert to \( \hbox{kg\,m}^{-3} \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->Filename: <code>density_conversion</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:ball_y">Problem 2: Scale a simple formula</h2>

<p>
The height \( y \) of a body thrown up in the air is given by

$$ y = v_0t - \frac{1}{2}gt^2,$$

where \( t \) is time, \( v_0 \) is the initial velocity of the body at \( t=0 \),
and \( g \) is the acceleration of gravity. Scale this formula. Use
two choices of the characteristic time: the time it takes to reach the
maximum \( y \) value and the time it takes to return to \( y=0 \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->Filename: <code>vertical_motion</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:decay:cooling:osc">Exercise 3: Perform alternative scalings</h2>

<p>
The problem in the section <a href="._scaling-book-solarized005.html#scale:decay:cooling:osc">Scaling a cooling problem with time-dependent surroundings</a> applies a
temperature scaling

$$ \bar T = \frac{T-T_0}{T_m-T_0},$$

which is not always suitable.

<p>
<b>a)</b>
Consider the case \( T_0=T_m \) and the fact that \( |T_m-T_0| \) does not
represent the characteristic temperature scale since it
collapses to zero. Formulate a suitable
scaling in this case. The figure below corresponds to \( T_m=25 \) C,
\( T_0=24.9 \) C, and \( a=2.5 \) C. We clearly see that \( \bar T \) is
not of size unity.

<p>
<center><p><img src="fig-scaling/osc_cooling_wrong_scale.png" align="bottom" width=500></p></center>

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>b)</b>
Consider the case where \( a \) is much larger than \( |T_m-T_0| \).
What is an appropriate scaling of the temperature?

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:ball_y_wdrag">Problem 4: A nonlinear ODE for vertical motion with air resistance</h2>

<p>
The velocity \( v(t) \)
of a body moving vertically through a fluid in the gravity field,
with fluid drag and buoyancy, is governed by ODE

$$ mv' = -\frac{1}{2}C_D\varrho A |v|v - mg + \varrho V g,\quad v(0)=v_0,$$

where \( t \) is time, \( m \) is the mass of the body, \( C_D \) is a drag coefficient,
\( \varrho \) is the density of the fluid, \( A \) is the cross-sectional area
perpendicular to the motion, \( g \) is the acceleration of gravity,
and \( V \) is the volume of the body. Scale this ODE.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->Filename: <code>vertical_motion_with_drag</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:decay:jump">Exercise 5: Solve a decay ODE with discontinuous coefficient</h2>

<p>
Make software for the problem in the section <a href="._scaling-book-solarized005.html#sec:scale:decay:jump">Variable coefficients</a>
so that you can produce Figure <a href="._scaling-book-solarized005.html#sec:scale:decay:jump:fig">4</a>.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<b>Hint.</b>
Follow the ideas for software in the section <a href="._scaling-book-solarized005.html#sec:scale:decay:body">Scaling a generalized problem</a>: use the
<a href="http://tinyurl.com/o8pb3yy/decay_vc.py" target="_self"><tt>decay_vc.py</tt></a> module as computational
engine and modify the
<a href="http://tinyurl.com/o8pb3yy/falling_body.py" target="_self"><tt>falling_body.py</tt></a> code.

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->Filename: <code>decay_jump</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:decay:cooling">Exercise 6: Implement a scaled model for cooling</h2>

<p>
Use software for the unscaled problem <a href="._scaling-book-solarized005.html#mjx-eqn-17">(17)</a>
to compute the solution of the
scaled problem <a href="._scaling-book-solarized005.html#mjx-eqn-24">(24)</a>.
Let \( T_s \) be a function of time.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<b>Hint.</b>
You may use the general software <a href="http://tinyurl.com/o8pb3yy/decay_vc.py" target="_self"><tt>decay_vc.py</tt></a>
for computing with the cooling model.
See the section <a href="._scaling-book-solarized005.html#sec:scale:decay:body">Scaling a generalized problem</a> for more ideas.

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->Filename: <code>cooling1</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:decay:exer:decay:step">Problem 7: Decay ODE with discontinuous coefficients</h2>

<p>
The goal of this exercise is to scale the problem
\( u^{\prime}(t) = -a(t)u(t) + b(t) \), \( u(0)=I \), when

$$
a(t) =\left\lbrace\begin{array}{ll}
Q, & t < s,\\ 
Q - A, & t\geq s,\end{array}\right.
\quad b = \left\lbrace\begin{array}{ll}
\epsilon t, & t < s,\\ 
0, & t\geq s,\end{array}\right.
$$

Here, \( Q,A,\epsilon >0 \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->Filename: <code>decay_varcoeff</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:decay:exer:nonlin:logistic2">Exercise 8: Alternative scalings of a cooling model</h2>

<p>
Implement the scaled model <a href="._scaling-book-solarized005.html#mjx-eqn-30">(30)</a>
and produce a plot with curves corresponding to various values of
\( \alpha \) and \( p \) to summarize how \( \bar u(\bar t) \) looks like.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<b>Hint.</b>
A centered Crank-Nicolson-style
scheme for <a href="._scaling-book-solarized005.html#mjx-eqn-30">(30)</a>
can use an old time value for the nonlinear coefficient:

$$ \frac{\bar u^{n+1} - \bar u^n}{\Delta t} =
(1 - \alpha\bar u^n)^p\frac{1}{2}(\bar u^n + \bar u^{n+1})\tp$$

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>growth</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:projectile">Exercise 9: Projectile motion</h2>

<p>
We have the following mathematical model for the motion of a projectile
in two dimensions:

$$ m\ddot\x + \frac{1}{2}C_D\varrho A|\dot\x|\dot\x
= -mg\jj,\quad \x(0)=\boldsymbol{0},\ \dot\x(0)=v_0\cos\theta\ii +
v_0\sin\theta\jj\tp$$

Here, \( m \) is the mass of the projectile, \( \x=x\ii + y\jj \) is
the position vector of the projectile, \( \ii \) and \( \jj \)
are unit vectors along the \( x \) and \( y \) axes, respectively,
\( \ddot\x \) and \( \dot\x \) is the second- and first-order
time derivative of \( \x(t) \), \( C_D \) is a drag coefficient
depending on the shape of the projectile (can be taken as 0.4 for a sphere),
\( \varrho \) is the density of the air, \( A \) is the cross section area
(can be taken as \( \pi R^2 \) for a sphere of radius \( R \)), \( g \) is gravity,
\( v_0 \) is the initial velocity of the projectile in a direction that makes
the angle \( \theta \) with the ground.

<p>
<b>a)</b>
Neglect the air resistance term proportional to \( \dot\x \) and solve
analytically for \( \x(t) \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>b)</b>
Make the model for projectile motion with air resistance non-dimensional.
Use the maximum height from the simplification in a) as length scale.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>c)</b>
Make the model dimensionless again, but this time by demanding that
the scaled initial velocity is unity in \( x \) direction.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>d)</b>
A soccer ball has diameter \( R=11 \) cm and mass 0.43 kg, the density of air
is 1.2 \( \hbox{kg}\hbox{m}^{-3} \), a soft kick has velocity 10 km/h,
while a hard kick may have 120 km/h. Estimate the dimensionless parameter
in the scaled problem for a soft and a hard kick with
\( \theta \) corresponding to 30 degrees. Solve the scaled
differential equation for these values and plot the trajectory (\( y \) versus
\( x \)) for the two cases.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
Filename: <code>projectile</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:decay:exer:predpray">Problem 10: A predator-prey model</h2>

<p>
The evolution of animal populations with a predator and a prey (e.g.,
lynx and hares, or foxes and rabbits) can be described by the
Lotka-Volterra ODE system

$$
\begin{align}
H^{\prime} &= H(a - bL),
\tag{92}\\ 
L^{\prime} &= L(dH - c),
\tag{93}\\ 
H(0)&=H_0,
\tag{94}\\ 
L(0)&=L_0\tp
\tag{95}
\end{align}
$$

Here, \( H \) is the number of animals of the prey (say hares)
and \( L \) is the corresponding measure of the predator population (say lynx).
There are six parameters: \( a \), \( b \), \( c \), \( d \), \( H_0 \), and \( L_0 \).

<p>
The terms has the following meanings:

<ul>
 <li> \( aH \) is the exponential
   population growth of \( H \) due to births and deaths and is governed by
   the access to nutrition,</li>
 <li> \( -bHL \) is the loss of preys because they are eaten by predators,</li>
 <li> \( dHL \) is the increase of predators because they eat prays (but only
   a fraction of the eaten preys, \( bHL \), contribute to population growth
   of the predator and therefore \( d < b \)),</li>
 <li> \( -cL \) is the exponential decay in the predator population because of
   deaths (the increase is modeled by \( dHL \)).</li>
</ul>

Dimensionless independent and dependent variables are introduced as usual
by

$$ \bar t = \frac{t}{t_c},\quad
\bar H = \frac{H}{H_c},\quad \bar L = \frac{L}{L_c},
$$

where \( t_c \), \( H_c \), and \( L_c \) are scales to be determined. Inserted
in the ODE problem we arrive at

$$
\begin{align}
\frac{H_0}{t_c}\frac{d\bar H}{d\bar t} &= H_0\bar H(a - bH_0\bar L),
\tag{96}\\ 
\frac{H_0}{t_c}\frac{d\bar L}{d\bar t} &= H_0\bar L(dH_0\bar H - c),
\tag{97}\\ 
H_c\bar H(0) &= H_0,
\tag{98}\\ 
L_c\bar H(0) &= L_0\tp
\tag{99}
\end{align}
$$

<p>
<b>a)</b>
Consider first a simple, intuitive scaling of \( H \) and \( L \) based on
initial conditions \( H_c=H_0 \)
and \( L_c=H_c \). This means that \( \bar H \) starts out at unity and \( \bar L \)
starts out as the fraction \( L_0/H_0 \). Find a time scale and identify
dimensionless parameters in the scaled ODE problem.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>b)</b>
Try a different scaling where the aim is to adjust the scales such that
the ODEs become as simple as possible, i.e, have as few dimensionless
parameters as possible. Compare with the scaling in a).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>c)</b>
A more mathematical approach to determining suitable scales for \( H \) and \( L \)
consists in finding the stationary points \( (H,L) \) of the ODE system,
where \( H^{\prime}=L^{\prime}=0 \), and use such points as characteristic
sizes of the dependent variables. Show that \( H^{\prime}=L^{\prime}=0 \)
implies \( H=L=0 \) or \( L=a/b \) and \( H=c/d \). Use \( H_c=a/b \), \( L_c=c/d \),
and find a time scale. Compare with the result in b).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
Filename: <code>predator_prey</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:decay:exer:competing_species">Problem 11: A model for competing species</h2>

<p>
Let \( N_1(t) \) and \( N_2(t) \) be the number of animals in two
competing species. A generalized Lotka-Volterra model
is based on a logistic growth of each specie and a predator-prey like
interaction (cf. <a href="#scale:decay:exer:predpray">Problem 10: A predator-prey model</a>):

$$
\begin{align}
\frac{dN_1}{dt} &= r_1N_1\left( 1 - \frac{N_1}{M_1} - s_{12}\frac{N_2}{M_1}\right),
\tag{100}\\ 
\frac{dN_2}{dt} &= r_2N_2\left( 1 - \frac{N_2}{M_2} - s_{21}\frac{N_1}{M_2}\right),
\tag{101}
\end{align}
$$

where \( r_1 \), \( r_2 \), \( M_1 \), \( M_2 \), \( s_{12} \), and \( s_{21} \) are given constants.
The initial conditions specify \( N_1 \) and \( N_2 \) at \( t=0 \).
Find suitable scales and derive a dimensionless ODE problem.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->Filename: <code>competing_species</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:decay:exer:sine">Problem 12: Find the period of sinusoidal signals</h2>

<p>
This exercise aims at investigating various concepts like period, wave length,
and frequency in non-damped and damped sinusoidal signals.

<p>
<b>a)</b>
Plot the function

$$ u(t) = A\sin(\omega t), $$

for \( t\in [0, 8\pi/\omega] \). Choose \( \omega \) and \( A \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>b)</b>
The <em>period</em> \( P \) of \( u \) is the shortest distance between two peaks (where
\( u=A \)). Show mathematically that

$$ P = \frac{2\pi}{\omega}\tp$$

Frequently, \( P \) is also referred to as the <em>wave length</em> of \( u \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>c)</b>
Plot the damped signal \( u(t)=e^{-at}\sin (\omega t) \) over four periods
of \( sin(\omega t) \). Choose \( \omega \), \( A \), and \( a \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>d)</b>
What is the period of \( u(t)=e^{-at}\sin (\omega t) \)? We define the
period \( P \) as the shortest distance between two peaks of the signal.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<b>Hint.</b>
Use that \( v = p\cos(\omega t) + q\sin (\omega t) \) can be rewritten
as \( v = B\cos(\omega t - \phi) \) with \( B=\sqrt{p^2 + q^2} \) and
\( \phi = \tan^{-1}(p/q) \). Use such a rewrite of \( u' \) to find the peaks of
\( u \) and then the period.

<p>
<!-- --- end hint in exercise --- -->

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
Filename: <code>sine_period</code>.

<p>
<!-- Closing remarks for this Problem -->

<h3 id="___sec105">Remarks </h3>

<p>
The <em>frequency</em> is the number of up and down cycles in one unit time.
Since there is one cycle in a period \( P \), the frequency is \( f =1/P \),
measured in Hz.
The <em>angular frequency</em> \( \omega \) is then \( \omega = 2\pi/P = 2\pi f \).

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:sliding">Problem 13: Oscillating mass with sliding friction</h2>

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 14:  Body sliding on a surface. <div id="scale:vib:exer:sliding:fig"></div> </p></center>
<p><img src="fig-scaling/oscillator_sliding.png" align="bottom" width=500></p>
</center>

<p>
A mass attached to a spring is sliding on a surface and subject to
a friction force, see Figure <a href="#scale:vib:exer:sliding:fig">14</a>.
The spring represents a force \( -ku\ii \), where \( k \) is the spring stiffness.
The friction force is proportional to the normal force on the surface,
\( -mg\jj \), and given by \( -f(\dot u)\ii \), where

$$ f(\dot u) = \left\lbrace\begin{array}{ll}
-\mu mg,& \dot u < 0,\\ 
\mu mg, & \dot u > 0,\\ 
0,      & \dot u=0
\end{array}\right.$$

Here, \( \mu \) is a friction coefficient. With the signum function

$$ \mbox{sign(x)} = \left\lbrace\begin{array}{ll}
-1,& x < 0,\\ 
1, & x > 0,\\ 
0, & x=0
\end{array}\right.$$

we can simply write \( f(\dot u) = \mu mg\,\hbox{sign}(\dot u) \)
(the sign function is implemented by <code>numpy.sign</code>).

<p>
The ODE problem for this one-dimensional oscillatory motion reads

$$
\begin{equation}
m\ddot u + \mu mg\hbox{sign}(\dot u) + ku = 0,\quad u(0)=I,\ \dot u(0)=V\tp
\tag{102}
\end{equation}
$$

<p>
<b>a)</b>
Scale the problem.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>b)</b>
Implement the scaled model. Simulate for \( \alpha = 0, 0.05, 0.1 \)
and \( \beta =0 \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
Filename: <code>sliding_box</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:pendulum">Problem 14: Pendulum equations</h2>

<p>
The equation for a so-called simple pendulum with a mass \( m \) at the end is

$$
\begin{equation}
mL\ddot\theta + mg\sin\theta = 0,
\tag{103}
\end{equation}
$$

where \( \theta(t) \) is the angle with the vertical, \( L \) is the length of
the pendulum, and \( g \) is the acceleration of gravity.

<p>
A physical pendulum with moment of inertia \( I \) is governed by
a similar equation,

$$
\begin{equation}
I\ddot\theta + mgL\sin\theta = 0\tp
\tag{104}
\end{equation}
$$

Both equations have the initial conditions \( \theta(0)=\Theta \) and
\( \theta'(0)=0 \) (start at rest).

<p>
<b>a)</b>
Use \( \theta \) as dimensionless unknown, find a proper time scale,
and scale both differential equations.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>b)</b>
Some may argue that \( \theta \) is not dimensionless since it is measured
in radians. One may introduce a truly dimensionless angle \( \bar\theta
\in [0,1] \). Set up the scaled ODE problem in this case.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>c)</b>
Simulate the problem in b) for \( \Theta = 1,20,45,60 \) measured in degrees.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
Filename: <code>pendulum</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:scale:exer:binary_star">Exercise 15: ODEs for a binary star</h2>

<p>
The equations for a <a href="https://en.wikipedia.org/wiki/Binary_star" target="_self">binary star</a>,
or a planet and a moon, are

$$
\begin{align}
m_A\ddot\x_A &= \F,
\tag{105}\\ 
m_B\ddot\x_B &= -\F,
\tag{106}
\end{align}
$$

where \( \x_A \) is the position of object (star) A, and \( \x_B \) is the position
object B. The corresponding masses are \( m_A \) and \( m_B \).
The only force is the gravity force

$$ \F = \frac{Gm_Am_B}{||\rpos||^3}\rpos,$$

where

$$ \rpos(t) = \x_B(t) - \x_A(t),$$

and \( G \) is the gravitational constant: \( G=6.674\cdot 10^{-11}\hbox{ Nm}^2/\hbox{kg}^2 \). A problem with these equations is that the parameters are very large
(\( m_A \), \( m_B \), \( ||\rpos|| \)) or very small (\( G \)). The rotation time
for binary stars can be very small and large as well.

<p>
<b>a)</b>
Scale the equations.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>b)</b>
Solve the scaled equations numerically for two cases:

<ol>
<li> a planet around a star:
   \( \alpha = 10^{-3} \), \( \x_A(0)=(1,0) \), \( \dot\x_A(0)=(0,1) \),
   \( \x_B(0)=0 \), \( \dot\x_B(0)=0 \)</li>
<li> two stars:
   \( \alpha = \half \), \( \x_A(0)=(1,0) \), \( \dot\x_A(0)=(0,\half) \),
   \( \x_B(0)=0 \), \( \dot\x_B(0)=(0,-\half) \)</li>
</ol>

An assumption here is that the orbits are co-planar such that they can
be taken to lie in the \( xy \) plane.

<p>
Here is a movie of two rotating stars (point 2 above):

<p>

<div>
<video  loop controls width='640' height='365' preload='none'>
    <source src='mov-scaling/binary_star/movie.mp4'  type='video/mp4;  codecs="avc1.42E01E, mp4a.40.2"'>
    <source src='mov-scaling/binary_star/movie.webm' type='video/webm; codecs="vp8, vorbis"'>
    <source src='mov-scaling/binary_star/movie.ogg'  type='video/ogg;  codecs="theora, vorbis"'>
</video>
</div>
<p><em></em></p>

<!-- Issue warning if in a Safari browser -->
<script language="javascript">
if (!!(window.safari)) {
  document.write("<div style=\"width: 95%%; padding: 10px; border: 1px solid #100; border-radius: 4px;\"><p><font color=\"red\">The above movie will not play in Safari - use Chrome, Firefox, or Opera.</font></p></div>")}
</script>

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
Filename: <code>binary_star</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:Duffing">Problem 16: Duffing's equation</h2>

<p>
Duffing's equation is a vibration equation with linear and cubic
spring terms:

$$ mu'' + k_0u + k_1u^3 = 0,\quad u(0)=U_0,\ u'(0)=0\tp$$

Scale this problem.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->Filename: <code>Duffing_eq</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:rocket">Problem 17: Vertical motion in a varying gravity field</h2>

<p>
A body (e.g., projectile or rocket) is launched at the earth's surface
at velocity \( V \). The body's distance (height) from the earth's surface
at time \( t \) is represented by the function \( h(t) \).
Unless \( h \) is very much smaller than the earth's radius \( R \), the motion
takes place in a varying gravity field. The governing ODE problem for
\( h(t) \) is then

$$
\begin{equation}
h''(t) = -\frac{R^2g}{(h+R)^2},\quad h(0)=0,\ h'(0)=V,\quad t\in (0,T],
\tag{107}
\end{equation}
$$

where \( g \) is the acceleration of gravity at the earth's surface.

<p>
The goal is to discuss three scalings of this problem. First we introduce

$$ \bar h = \frac{h}{h_c},\quad \bar t = \frac{t}{t_c},$$

which gives the dimensionless ODE

$$
\frac{d^2\bar h}{d\bar t^2} = -\frac{t_c^2}{h_c}\frac{R^2g}{(h_c\bar h+R)^2}
= -\frac{t_c^2}{h_c^3}\frac{R^2g}{\left(\bar h+ R/h_c\right)^2}
$$

and the dimensionless initial condition

$$ \frac{d\bar h}{d\bar t}(0) = \frac{t_cV}{h_c}\tp$$

The key dimensionless variable in this problem turns out to be

$$ \epsilon = \frac{V}{\sqrt{Rg}}\tp$$

<p>
<b>a)</b>
Assume we study the motion over long distances such that
\( h \) may be of the same size as \( R \). In this case, \( h_c=R \) is a
reasonable choice. Determine \( t_c \) from requiring the initial velocity
to be unity. Set up the dimensionless ODE problem.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>b)</b>
As a), but determine \( t_c \) by demanding both terms in the scaled ODE to
have unit coefficients.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>c)</b>
For small initial velocity \( V \), \( h \) will be small compared to \( R \).
In the limit \( h/R\rightarrow 0 \),
the governing equation simplifies to the well-known motion in a
constant gravity field: \( h''=-g \). Use this model to suggest a time and
length scale, and derive a dimensionless ODE problem.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>d)</b>
Give an interpretation of the dimensionless parameter \( \epsilon \).

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>e)</b>
Solve numerically for \( \bar h(\bar t) \) in each of the three scalings in
a), b), and c), with \( \epsilon^2 =0.01, 0.1, 0.5, 1, 2 \).
When are the various scalings appropriate? (That is, when are \( \bar t \)
and \( \bar h \) of size unity or at least not very small or big?)

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
Filename: <code>varying_gravity</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="scale:vib:exer:quantum">Problem 18: Schroedinger's equation</h2>

<p>
A simplified stationary
Schroedinger's equation for one electron, assuming radial symmetry, takes
the form

$$
\begin{equation}
-\frac{\hbar^2}{2m}
\left(\frac{1}{r^2}\frac{d}{dr}\left(r^2\frac{d}{dr}\right)\right) R
+ V(r)R = ER,
\tag{108}
\end{equation}
$$

where \( r \) is the radial coordinate, \( R \) is the wave function,
\( \hbar \) is Planck's constant, \( m \) is the mass of the electron,
\( V= \) is the force potential, which is here taken as the
Coulomb potential \( V(r) = {e^2}/(8\pi\epsilon_0 r) \)
(where \( e \) is the charge of the electron and \( \epsilon_0 \) is the
permittivity of free space), and \( E \) is
the eigenvalue, for the energy, to be determined along with \( R(r) \).

<p>
Show that the scaled version of <a href="#mjx-eqn-108">(108)</a> can be written

$$
\begin{equation}
- \left(\frac{1}{r^2}\frac{d}{dr}\left(r^2\frac{d}{dr}\right)\right)
\bar R + \frac{1}{\bar r}\bar R = \lambda\bar R,
\tag{109}
\end{equation}
$$

where \( \lambda \) is a dimensionless eigenvalue

$$ \lambda = \frac{2E}{\hbar}\sqrt{\frac{m}{k}}\tp$$

The symbol \( \bar r \) is the scaled coordinate, and \( \bar R \) is a scaled
version of \( R \) (the scaling factor drops out of the equation).
The length scale, which arises naturally, is the
<a href="https://en.wikipedia.org/wiki/Bohr_radius" target="_self">Bohr radius</a>.

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->Filename: <code>Schroedinger</code>.

<p>
<!-- Closing remarks for this Problem -->

<h3 id="___sec112">Remarks </h3>

<p>
Introducing \( u=\bar r\bar R \) and renaming \( \bar r \) to \( x \),
<a href="#mjx-eqn-109">(109)</a> can be recast to the simple form

$$ -u'' + x^{-2}u = \lambda u,$$

which is a simpler eigenvalue problem to solve numerically (the boundary
conditions are \( u(0)=0 \) and \( \lim_{x\rightarrow\infty}u(x)=0 \)).

<p>
<!-- --- end exercise --- -->

<p>
<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._scaling-book-solarized005.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._scaling-book-solarized007.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>


</body>
</html>
    

